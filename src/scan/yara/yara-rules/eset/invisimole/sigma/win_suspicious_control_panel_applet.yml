action: global
title: Suspicious Control Panel Applet Detected
id: df2378d6-6dc5-472b-9cf0-37862e8422f3
status: experimental
description: A new Control Panel Applet was registered, or an unsigned Control Panel Applet was loaded. This technique can be used by threat actors to achieve persistence of a malicious DLL file using Control Panel.
references:
    - https://www.welivesecurity.com/2020/06/18/digging-up-invisimole-hidden-arsenal/
author: ESET Research
date: 2021/05/17
tags:
    - attack.defense_evasion
    - attack.t1218.002
detection:
    condition: 1 of them
falsepositives:
    - Unknown
level: medium
---
logsource:
    category: image_load
    product: windows
    definition: 'Note that you have to configure logging events associated with this registry key'
detection:
    selection:
        ImageLoaded|endswith: '.cpl'
        Signed: "FALSE"
---
logsource:
    category: registry_event
    product: windows
detection:
    selection:
        TargetObject|startswith: 'HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Control Panel\CPLs'
        Details|endswith: '.cpl'