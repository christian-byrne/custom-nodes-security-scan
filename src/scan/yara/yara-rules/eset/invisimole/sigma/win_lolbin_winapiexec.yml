title: WinApiExec Tool Executed
id: f3a30cd7-f3ac-4b9d-9d6d-e1b3e2bc41de
status: experimental
description: Detects execution of legitimate WinApiExec tool, that allows running Windows API functions through command line parameters. This LOLBin is misused by InvisiMole Group to mask execution of malware, as reported in June 2020.
references:
    - https://rammichael.com/winapiexec
    - https://www.welivesecurity.com/2020/06/18/digging-up-invisimole-hidden-arsenal/
author: ESET Research
date: 2021/05/17
tags:
    - attack.defense_evasion
    - attack.t1202
logsource:
    category: process_creation
    product: windows
detection:
    hash:
        sha1:
            - '9fdb5b3311ba5b61ff9008469dbaff271c29fa51'
            - '4a6dc6a32a777dc5dd47221bf79604bc0258a987'
    filename:
        Image|endswith:
            - '\winapiexec.exe'
            - '\winapiexec64.exe'
    condition: 1 of them
falsepositives:
    - Legitimate use of WinApiExec tool
level: medium