action: global
title: Gamaredon/InvisiMole Activity
id: 56631df2-708b-4f10-aef1-547eaad8daab
status: experimental
description: Detects artefacts associated with InvisiMole TCP downloader delivered by Gamaredon group, as reported in June 2020
references:
    - https://www.welivesecurity.com/2020/06/18/digging-up-invisimole-hidden-arsenal/
author: ESET Research
date: 2021/05/17
tags:
    - attack.execution
    - attack.defense_evasion
    - attack.t1059.003
    - attack.t1202
falsepositives:
    - Unlikely
level: high
---
logsource:
    category: process_creation
    product: windows
detection:
    dropper:
        sha1:
            - '303A63CE12AD42900DA257428E2FD4DE4F9829DC'
            - '4B8E11E0734D3109627FF8871EF7DB14C0DE9C41'
    winapiexec_path:
        Image|endswith: '\intel_log64.exe'
        ParentCommandLine|endswith:
            - '\api64.cmd'
            - '\intel_log64.cmd'
    winapiexec_hash:
        sha1:
            - '9fdb5b3311ba5b61ff9008469dbaff271c29fa51'
            - '4a6dc6a32a777dc5dd47221bf79604bc0258a987'
    commandline:
        CommandLine|contains:
            - '$a:0x24A48D48E5894855,0x789D8948FFFFFD40,0x48F84D8948FFFFFD'
            - '0x55FF0001D4C0B9E0,0x0000FFFFFD8AE9A0,0x0000000000000000,0x00658D48E5894855, 0x360 , CreateThread 0 0 $$:1'
            - 'M-g-t-p-g-n-5-4-0-f-n-n----NqcfNkdtct'
    condition: dropper or (commandline and (1 of winapiexec*))
---
logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|endswith:
            - '\Temp\api64.cmd'
            - '\Temp\intel_log64.cmd'
            - '\Temp\intel_log64.exe'
    condition: selection