= Kobalos -- Indicators of Compromise

These are the IoCs from
https://www.welivesecurity.com/wp-content/uploads/2021/01/ESET_Kobalos.pdf[
"A wild Kobalos appears: Tricksy Linux malware goes after HPCs"]
white paper.

A blog post summarizing ESET's research is also available on
https://www.welivesecurity.com[WeLiveSecurity] at
https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/.

== Samples

.Kobalos
[options="header"]
|========
| SHA-1 | Target OS | Embedded in | Reachability
| `fbf0a76ced2939d1f7ec5f9ea58c5a294207f7fe` | RHEL | sshd | Wait for connection from source port 55201
| `479f470e83f9a5b66363fba5547fdfcf727949da` | Debian | Stand-alone | Connects to 151.80.57.191:7070
| `affa12cc94578d63a8b178ae19f6601d5c8bb224` | FreeBSD | sshd | Wait for connection from source port 55201
| `325f24e8f5d56db43d6914d9234c08c888cdae50` | Ubuntu | sshd | Wait for connection from source port 55201
| `a4050a8171b0fa3ae9031e0f8b7272facf04a3aa` | Arch Linux | sshd | Wait for connection from source port 55201
|========

.SSH credential stealer
[options="header"]
|========
| SHA-1 | Target OS | Writes to
| `6616de799b5105ee2eb83bbe25c7f4433420dff7` | RHEL | `/var/run/nscd/ns.pid`
| `e094dd02cc954b6104791925e0d1880782b046cf` | RHEL | `/var/run/udev/ud.pid`
| `1dd0edc5744d63a731db8c3b42efbd09d91fed78` | FreeBSD | `/var/run/udevd.pid`
| `c1f530d3c189b9a74dbe02cfeb29f38be8ca41ba` | Arch Linux | `/var/run/nscd/ns.pid`
| `659cbdf9288137937bb71146b6f722ffcda1c5fe` | Ubuntu | `/var/run/sshd/sshd.pid`
|========

== Keys

=== RSA public key

----
-----BEGIN PUBLIC KEY-----
MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAOUgD8sEF1kZ04QxCd60HrB+TxWnLQED
wzb0sZ8vMMD6xnUAJspdYzSVDnRnKYjTOM43qtLNcJOwVj6cuC1uHHMCAwEAAQ==
-----END PUBLIC KEY-----
----

=== Static RC4 key for strings

----
AE0E05090F3AC2B50B1BC6E91D2FE3CE
----

== YARA rules

See link:kobalos.yar[`kobalos.yar`]
