# Proof of concept byte sequence generation for Chafer - see blog post
# 
# Author: Nikolaos P - NCC Group
#   Date: March 2019

import random
import time
import struct
from ctypes import *
import ctypes
dt3 = "eytmg01srv"
dt4 = "12qw!@QW"
bytes_to_be_added_to_file_data = [0]*0x26 # initialize

def sar_8(a, width):
    sign = a & 0x80
    a &= 0x7F
    a >>= width
    a |= sign
    return a

def generate_bytes_sequence():
	rand_bytes = b"\x08\x94\x22\x13\xE9\x29\x27\x2D\xFD\x9E\xF9\x34\x79\x1A\x41\x0F\x3B\xD2\x22\x16\xF1\x05\xEE\x27\x9D\x46\x2D\x15\x9E\xC1\xBA\x33\xA7\x10\x6F\x2F\xD5\x53\xEF\x34\xFA\xD5\xB9\x32\x6D\xC7\xBF\x2A\xEC\x45\x48\x12\x7C\x64\xB9\x28\x1A\xD0\x35\x13\x9C\x25\x6C\x05\xBB\x1E\xD6\x11\x20\xFB\xDC\x1D\x08\x45\x62\x14\xD6\x36\x81\x34\x2A\x1D\xEF\x11\xB5\x2B\x0A\x08\xCE\x3C\xCF\x02\xCC\xC1\xDF\x23\x75\x3A\xF0\x13\x0E\x1F\x7A\x1D\x1D\x68\xAF\x09\xBC\xCA\xD6\x23\xFC\xFA\x9E\x21\x9C\x24\x1F\x26\xB5\xF6\x74\x35\x97\x34\x8B\x1C\x64\x3B\x71\x3B\xB0\x87\x74\x12\xD6\x66\x1C\x01\xDF\xD8\xCB\x0C\x41\xA2\x9F\x27\x19\xF8\x4C\x00\x63\xB9\x86\x03\x82\x0D\xAD\x38\xE2\xA9\xCD\x31\x76\xA3\xEB\x33\xA7\x73\x1B\x13\x7E\x32\xA9\x01\xC4\x8D\x20\x27\x5E\x93\x3B\x13\xFB\xED\x6D\x32\xB8\x28\x26\x0F\x37\x43\xAC\x07\xBC\x37\xC5\x09\x67\xA1\xFA\x1D\x64\x6C\x97\x2B\xC7\x7F\x78\x0F\xEB\x91\x8C\x11\x95\x53\xE2\x26\x9C\xE9\xD8\x25\x74\xF7\xD8\x0A\xB8\x00\x02\x03\xBA\x80\xCA\x0D\x23\x6A\x95\x2B\xEE\xD4\x77\x15\x6C\xDD\xE5\x16\xDB\x3E\x90\x27\x0C\x5F\x3A\x1E\x37\xDA\x1D\x2C\xE6\x77\xCF\x0C\x28\x2B\x21\x07\xDE\xB0\x4E\x00\xBD\x71\xFD\x03\xE0\xC0\x27\x1F\x0F\x32\x9E\x12\xDE\x26\x80\x15\x24\x6F\xDA\x0A\x2B\xC6\xFF\x0C\x6E\x9B\xDE\x0F\x22\x80\xC7\x18\xE6\xFA\x4B\x06\xA7\xB3\x0A\x37\x30\x45\x50\x22\x78\x18\x5D\x15\x9F\x10\x10\x3A\xE4\x1C\xDB\x04\xF1\xB4\xE4\x18\xF8\x01\x5C\x0C\x7F\x16\x0D\x26\xC9\xEA\xB9\x0E\x41\x22\x2F\x09\x1B\xFA\x4A\x38\xE2\x8E\x63\x2F\x1A\x8D\xE8\x0D\x30\xEE\xD7\x39\xAD\x91\x45\x1C\x5A\x67\xC1\x09\xB6\x71\xBD\x0C\x52\x13\xFB\x38\xF4\xF5\x5A\x26\x00\x94\x0D\x01\x54\xEA\xB1\x05\x63\xC0\xB6\x39\x12\x67\x85\x35\xA8\x03\x06\x07\xBF\x98\xA2\x27\xB3\xEC\xC3\x36\xFA\x1E\xC9\x0F\x63\xF7\x81\x24\x46\x70\xED\x0F\x04\x15\x78\x34\x74\x17\x78\x29\x41\x6E\xF2\x2A\xB2\xC6\xF0\x2B\x33\x3B\x29\x2E\x1F\xC1\x3F\x2B\xE6\x10\xFF\x0F\xF5\x84\x30\x3A\xCB\xE2\x8E\x30\x82\x49\x11\x00\xCA\xC1\xC2\x36\x01\x8D\x77\x1B\xEB\x53\x4E\x0E\x24\xE0\x60\x26\x5B\x21\x8E\x25\x62\x0A\x2F\x20\x5E\xFA\xB9\x09\x7E\x89\x5C\x09\xC7\x38\xE5\x04\x2B\x35\xBA\x35\xD8\xA9\x92\x15\x3E\x23\x7B\x23\x52\x8E\x8A\x2B\x4C\x61\x03\x23\x7F\x43\x92\x22\x1F\x16\x19\x35\x4C\x38\x80\x19\xED\x22\x9B\x0A\x48\xD6\x13\x19\x0E\x32\x0D\x36\x02\xC7\xA1\x1F\x8B\xF2\x0E\x0A\xD4\xCC\x8D\x03\xFC\x0B\xB5\x17\xD3\x40\xE9\x08\xC7\xEC\x0D\x35\x92\xBD\xA1\x25\x55\xA4\x20\x31\xCE\x6D\x0D\x17\x6C\x22\x70\x29\xD4\xC2\x1E\x14\x1F\xE4\x34\x25\x45\xF5\xA5\x1B\xED\x0E\x93\x06\x81\x6E\x08\x1B\x43\xBF\x26\x01\x64\xEE\x38\x06\x6B\x77\x35\x34\x1A\x45\x93\x3B\xAF\x7D\x54\x0B\x7C\xB3\xB0\x0C\x12\xCA\x23\x30\xE8\xEC\xF7\x13\x17\x96\x55\x26\xEF\xBA\x17\x0C\xD8\xB2\xA6\x02\xDE\xC5\x7E\x0A\x57\xEF\x00\x0B\xDB\x4B\x8D\x02\x4F\xF2\x15\x0A\x81\xEA\x98\x14\x86\x1C\x8D\x25\xFD\xA1\x69\x13\xE3\xB6\xDF\x12\xF2\xF2\x4E\x14\x50\xFE\xA4\x27\x83\xE9\x79\x1B\x74\x73\x58\x28\x5C\xD9\xBE\x2E\xB3\x7B\x83\x19\x99\x9B\xC5\x1F\x88\xE0\x45\x2C\xC8\xFC\x4E\x01\x9B\xB0\x58\x2B\xA3\x79\xD4\x3A\xAF\x41\xC0\x2F\x48\xC8\x69\x03\x49\xA5\x59\x31\xD3\x60\x42\x23\xF4\xCC\x75\x00\xAE\x91\xD4\x25\x66\xFE\x80\x30\xD6\xF2\x1F\x36\xBD\x1F\x9C\x25\xF6\x93\xD6\x23\x36\x8D\x93\x2C\x6C\x88\x4C\x00\x62\xDC\xC9\x19\xF6\x37\xB6\x27\xC2\xC7\xAE\x14\x8D\x72\x92\x30\x39\x75\xB7\x2E\x9F\xD2\xD9\x1B\x33\xA5\x52\x0B\x2E\x9F\x79\x1F\xDB\x0C\xA0\x2E\xF0\x18\xC2\x0D\x22\xF4\x50\x3B\x1C\x2A\x43\x26\x74\x54\x86\x36\x25\xEC\x97\x26\xA1\x9C\xE9\x14\xF6\x61\x41\x2D\x6A\x92\x44\x0C\x23\x38\xB8\x22\x5B\x84\xA6\x02\x03\x06\x39\x30\xAC\xA4\xF9\x0F\x90\xF9\xFF\x17\x21\xC0\x11\x00\x13\xB7\x94\x1B\xF4\x03\x28\x07\xDE\xED\x3F\x37\xB0\x35\x39\x19\xC2\xC6\x03\x04\x36\x2C\x4D\x25\xE3\xA1\x4E\x36\x83\x49\x50\x0F\x00\xBF\x4C\x2B\x13\x63\x46\x01\xEF\x20\x15\x2E\x25\xBD\xB2\x1C\xF4\xBE\xD4\x25\x5E\x58\x15\x00\x4F\x96\x8F\x1E\x81\xB1\x69\x14\xD1\x9C\xC6\x27\x3F\xE5\x3C\x23\x24\x57\x0F\x2B\x63\xDF\x2A\x2C\x34\x4F\x58\x23\x9A\x02\x3A\x12\x61\x87\x9B\x27\x67\x48\xC5\x09\x61\x3D\xD8\x1C\x09\xC1\x1C\x35\x94\x5A\x8C\x31\xE3\xB1\x1B\x07\x9D\x38\xEA\x17\xB8\xCA\xD9\x15\x9B\x9B\xBF\x31\x77\x99\x44\x04\xB1\x44\x45\x35\x6A\x8E\x58\x33\xB0\x59\x74\x27\xBB\x9E\x99\x08\xF4\x7A\x08\x1F\x97\xEB\x67\x37\x25\x8C\xFB\x1D\x25\xDE\x05\x35\x00\x5C\x20\x11\xAA\x67\xCB\x1C\xBA\x40\x3A\x0E\x0B\x16\x03\x12\xF2\x0C\x31\x2F\x29\xEF\x05\x3A\x2F\x85\x11\x19\x44\xAF\x09\x1E\x04\x81\xDF\x38\x4F\x16\x2D\x09\x88\x31\x5E\x07\x88\x34\x59\x02\xE2\xBC\x41\x36\xF6\x37\xDB\x04\x12\x56\xEA\x15\xF3\xB0\x69\x07\xF2\xE5\xC7\x1A\xC4\x74\xB7\x21\x02\x77\x3D\x11\x23\xA3\xCD\x28\x0E\xF8\x8A\x31\x16\xCD\x3E\x25\x31\x23\xBC\x1C\xD2\xD0\xEC\x10\x47\x42\x83\x04\x6A\x76\xC1\x07\x56\x40\x4B\x37\x8A\x82\x8B\x19\xA4\x47\x45\x2E\x79\x1F\xD5\x12\xF1\xB5\xCA\x05\x5B\x8B\x3F\x11\x6B\x49\x80\x0E\x3C\xC7\xEB\x2B\x61\xBF\xF5\x14\x5A\xEF\x53\x38\x84\xAB\x0A\x39\x51\x4F\xCD\x21\x60\x3B\x4C\x28\xEA\x07\x07\x2E\xE8\x3D\xA3\x3A\x60\xE0\xF9\x26\x42\x0C\xE9\x23\xE0\x96\x8E\x16\xDE\xD4\x73\x08\x42\x82\x83\x29\xEA\x23\x3B\x19\xCE\x93\x6E\x34\x9F\xDE\x21\x0F\x45\x0B\xEE\x23\x92\xB7\xE0\x22\x69\x76\x6E\x31\x0A\x57\x2E\x0D\x9F\x28\xA9\x16\x3D\x55\xB5\x2D\xE4\x79\xC8\x1C\x1C\xA2\x6E\x2B\x68\x78\x04\x31\x3F\x15\xFE\x30\xCA\x85\xDB\x19\x11\x7D\x8C\x3A\x38\x59\xA2\x1D\xAD\xB4\xE0\x0A\x03\x6E\xFC\x14\xB4\x7B\x8A\x21\x1E\xDD\x74\x1D\x7E\x5B\xF3\x1E\xDA\x2C\x2F\x19\x2E\x7A\x52\x06\x88\x55\xF9\x11\x0F\xA9\xD9\x07\x27\xCD\x45\x06\x9B\x56\x28\x1B\xA8\xD3\x3A\x2C\x20\x92\x65\x07\x33\xBD\x4A\x24\x10\x31\xA9\x31\x8C\x59\xEB\x09\xB9\x8F\x6F\x00\x9B\xB8\xD6\x0E\xB1\x32\x61\x09\x94\x63\xBA\x27\x31\xD0\xFC\x28\xC7\x1F\x19\x17\x1B\x04\xD3\x28\xB2\x26\xDD\x08\xF8\x1F\x64\x2E\x5C\xD6\x0B\x1C\x04\xE9\x56\x20\xC0\xBE\x3C\x00\xAE\x59\xEE\x39\x90\x3A\x66\x00\x1D\xFD\xA0\x02\x26\xE4\x3C\x29\x84\xF8\x4C\x1A\xBA\x22\xAD\x0A\x90\xF0\xCA\x24\x17\x09\x47\x1A\x29\xF3\x0D\x03\xB1\xEE\x08\x1D\x19\x60\x08\x0E\xA7\xC1\x48\x36\xE8\xEA\x79\x00\x44\x4B\xA0\x20\x82\x48\x03\x2E\xE5\x22\x32\x12\x1C\x12\x26\x22\x2C\xAB\xAE\x1B\xBA\x9D\x4F\x2A\x52\xF4\x66\x1C\x82\x50\x35\x54\x53\x1E\xA5\x59\xF0\x0B\x26\xAE\x47\x1D\x74\x19\x7A\x2A\xE0\x9F\x11\x2A\x30\x63\x8D\x12\xBE\x32\x33\x38\x04\xF2\x3C\x1D\xD1\x49\x0E\x13\x47\x8A\xBC\x29\xDD\xD9\xC4\x16\xE2\xB2\x8B\x06\x8D\x9D\xCF\x25\xFD\x98\xAE\x0A\x72\xD6\x87\x18\x36\x2D\xA8\x3A\xF5\xEB\x6A\x32\xA1\x68\x39\x26\x2F\x41\x53\x32\x45\x43\x46\x2F\xC1\x28\x35\x35\xBB\xA7\xC6\x38\x22\xAB\xD5\x24\xE1\xB4\xA4\x17\x00\x44\xF6\x25\x1E\x92\xA2\x10\x7E\x27\x3F\x04\xDB\x72\x21\x17\xE8\xDB\x9C\x34\xBA\x07\x03\x1C\x3C\xBA\x7E\x19\x41\x32\x8D\x2C\x29\xC7\xE2\x18\x33\x29\xB8\x1F\x16\x07\x06\x1D\x7E\xB0\xD0\x06\xAC\x3F\x27\x2A\xCA\x64\xCC\x30\x82\x3B\x0E\x25\xE5\xA1\x92\x00\x2B\xF3\x5C\x20\x39\x66\xE4\x01\x6B\x8C\xED\x0D\x91\xAD\x87\x36\x53\x73\x48\x14\xB5\x03\x12\x06\xEB\x5B\x5A\x38\xF3\x9F\x4F\x00\xC6\xA1\xA8\x31\xF4\xF4\xE0\x36\x03\xA2\xE0\x20\x6A\x6F\xBD\x02\x71\x60\x3F\x17\xDD\x45\xD6\x0C\x8E\xC5\x99\x04\x87\xC5\x17\x23\x88\x5E\xE0\x19\x99\x67\xDC\x0E\x54\x2A\x16\x31\xEC\x5D\xC9\x1C\xBE\x21\x35\x0B\x72\xD5\x62\x0D\xCD\x61\x8D\x21\x26\x67\x63\x08\x78\x64\x54\x0B\x4F\xBD\x14\x20\xAB\x16\x56\x08\xF9\x16\x86\x1D\x12\xD3\x6E\x08\x20\xB4\xE1\x0C\x28\x89\xCA\x38\x72\x67\xCC\x2A\xFB\xBB\x25\x26\x15\xD2\xF1\x1E\x59\x14\xB2\x16\xDA\x45\xA0\x06\xC2\xA2\x41\x03\x60\xBB\xCB\x34\xDA\x21\xEE\x2E\x98\x7F\x87\x35\xD1\x25\xD2\x09\xC4\xCC\x4B\x28\xFD\xEB\xC7\x30\x42\x8C\x8F\x12\x1D\x47\x8B\x10\x53\x89\x23\x1D\xB3\xAD\x3D\x0A\x5E\xD1\xA6\x32\xA8\x32\x09\x2E\x0A\x85\x48\x27\xED\xE2\x45\x3A\x70\x20\x6E\x34\x3B\xCC\xBF\x2A\xE5\x79\x8A\x0B\x5F\x45\x58\x2D\x8E\x22\x41\x0C\x86\x3D\xF2\x31\x20\x01\x2B\x36\x78\x1C\xA6\x14\x6A\x40\x8C\x19\xE0\xF2\x82\x0B\x3B\x13\x17\x39\x8C\xC3\x29\x06\x14\x9F\x37\x0C\x37\xD0\x4E\x17\x47\xCE\xB1\x03\xDE\x63\x27\x19\x58\xE7\x26\x01\xB2\xBA\x66\x00\x8C\x17\xB4\x29\x33\x23\x06\x05\xF0\x29\x55\x11\xC8\xA4\x38\x06\x10\xD7\x39\x07\x30\x95\xA6\x04\x49\x84\x7D\x08\xC9\x28\xC4\x02\x71\x47\x5D\x30\xBE\x23\xBD\x29\xF9\x37\xD8\x0F\x04\x1B\xA8\x32\x58\xBB\xF9\x33\x1E\x1C\x45\x13\x5E\xD2\x08\x2E\x92\x14\x3F\x0F\x0E\x51\x0D\x03\x58\x85\x34\x2A\xBE\x69\x4E\x29\x53\xC9\xF8\x06\x8A\x93\x49\x33\x4C\x0A\x8F\x21\x68\x54\x95\x15\x9C\x90\xBF\x02\x0E\x8A\x0B\x36\x42\x6A\xF5\x1E\xE0\x58\x3C\x2E\x80\xA7\x13\x35\xDE\xEB\xD4\x03\x67\x9F\x79\x14\x4C\x6D\x7C\x25\x91\x1A\x71\x1D\xF4\x2D\x37\x1B\x6D\x48\xFC\x00\xD7\x74\x4F\x35\x29\x4A\x04\x01\x2B\x4D\xD5\x05\xE9\x42\xD6\x12\xB5\x10\xF0\x11\xC9\x02\x3D\x16\x13\x3D\xBF\x1E\x81\x40\x6B\x04\x9C\xA7\x4C\x13\xEE\x85\x2A\x20\x9B\xD4\x7F\x35\x1B\x9F\xD3\x2A\x69\x83\x9D\x11\xF7\x44\xE5\x34\xBD\x9D\x70\x3A\x82\x53\x73\x2D\x4B\xB6\x87\x37\x87\xE2\x4A\x17\xEF\x4D\x23\x2E\xFC\x87\x62\x18\x6D\xDD\x43\x11\x2A\x55\x17\x13\x49\x50\xD3\x2D\x3F\x8B\xD3\x2C\xB4\x52\x55\x1B\x2F\x06\xBC\x32\xCF\xBB\x1A\x25\x16\x5D\xC1\x10\xDF\x7C\x64\x10\x41\xDB\x56\x14\x54\x52\x3A\x35\x3A\x01\x7C\x28\x4D\x8F\xEB\x00\x81\xB3\xE1\x33\x2E\xF6\xE1\x02\xB2\xE7\xBF\x0D\xE6\x3E\x85\x12\x60\xF6\xD9\x3A\x9C\x7A\xFE\x36\xAE\x0E\x4A\x14\x9A\x95\x0F\x37\xB6\x7E\x1A\x17\xA6\xCA\x08\x24\x3F\x0A\x67\x0A\x08\xD7\x56\x25\xF1\xFF\x56\x37\x5F\x6D\xF3\x31\x9E\xC2\x76\x2B\x04\xEE\x3F\x1A\xF8\xC6\xAD\x06\xAB\x97\x38\x29\x5C\x90\x21\x2E\xC2\xCE\x99\x10\x7B\xF5\x10\x33\x90\x9A\x69\x1C\xE5\xA4\x28\x0C\xAB\x75\xCA\x0F\xE0\xD9\xB2\x0A\x47\x62\x88\x2D\x74\xFD\xA8\x3A\x80\x82\xD6\x0E\x05\x18\x3E\x22\x41\xB5\x64\x2D\xC0\x82\xE6\x36\x79\xB1\xEF\x19\xBF\xB7\x51\x20\x8F\xB3\xFA\x37\xEA\xE9\x69\x1F\x88\x66\x93\x1F\x0C\x9F\x5B\x1C\xE2\x5A\xCD\x01\xB8\x0F\x43\x3E\xB6\x23\x86\x2B\xB8\x1D\x40\xD6\x5F\x22\xCC\xA6\xC8\x25\xBA\x30\xFE\x08\x59\x51\xB4\x03\xCE\xFE\x50\x14\xB3\x50\xD7\x24\x67\xF0\xAA\x36\xDC\xCD\x82\x26\xF9\x25\xBE\x05\x3E\x1F\xB4\x2D\x6A\xF6\xF6\x2F\x00\x18\x31\x1E\xD0\xF8\xAC\x1F\x69\x91\x95\x1E\x2C\xF9\xF9\x32\x08\xFA\xC4\x38\xA1\x19\x77\x36\xEF\x3C\x7D\x39\x92\xCA\xB4\x06\x94\x74\x9C\x25\x6F\x03\x7F\x22\xC8\xAC\x76\x14\xBA\x3F\x5F\x18\x76\x28\x3F\x00\xF1\xF1\x57\x0B\xC6\x0F\x24\x00\xFC\x2B\xB6\x23\xF0\xB6\x10\x2F\x47\x3A\x27\x16\xAE\xA5\x5E\x3B\xEE\x41\x53\x25\x85\x75\x13\x0E\x94\x6D\x13\x32\xA7\x69\x6F\x09\xB4\x86\xD1\x38\x1F\x3E\xD3\x14\xE6\xAE\x13\x30\x47\x80\x8A\x1B\x35\x84\x7A\x33\x03\x66\x40\x19\x36\xC7\xB5\x01\xE9\x66\x1A\x05\xCE\xDC\x6C\x10\x74\xF3\x0D\x18\x4A\x16\x54\x17\x99\x48\xA4\x22\xB4\x3B\x4D\x11\x9F\x05\x11\x13\xDA\x5E\x0A\x2E\x1B\xEA\xC7\x1A\xBB\xD2\xAE\x31\x2D\xA7\xBD\x2D\xC1\x0A\x87\x19\x41\xB1\x94\x1E\x7C\xC9\x8B\x39\x56\x10\x2C\x31\x2B\x5C\x6E\x02\x6D\x8A\x0C\x23\x02\xD5\x16\x17\x52\x65\x47\x34\xA6\x84\x5C\x1A\x07\xD4\x9F\x18\x37\x4E\x7B\x1E\x98\x1D\x2F\x38\x6A\xD7\xD0\x03\xFD\x1F\x40\x10\xA5\x4B\xA2\x00\x77\x57\x39\x00\x21\x3C\xD3\x2E\xED\x92\xDA\x2A\x29\x09\xDE\x10\x00\x6E\x9F\x25\x00\xBC\x0E\x31\xB6\x2F\x94\x25\x56\x19\xAD\x1A\xFD\x27\x6B\x04\x38\x09\x46\x01\x87\x41\x6D\x18\x3A\x28\xFA\x0E\x2E\x78\x88\x04\x70\x1B\x53\x00\xED\xA7\x04\x33\xF7\x51\x26\x05\x62\xE4\x11\x0C\xA9\x48\x0F\x3B\xBB\x6B\x48\x29\x9E\x6A\x84\x0B\x5D\x72\xA8\x33\x56\x46\x56\x10\x30\xEB\x60\x05\xEA\x88\xB8\x30\x92\x98\xE4\x06\x26\x95\x01\x05\xF4\x4A\x3E\x2E\xEE\x06\x6C\x3B\xA8\x6B\x98\x09\x08\x14\x76\x37\xB3\x96\x6C\x28\x33\xBE\x8B\x26\xCD\x33\x0D\x07\x3F\x27\x82\x09\x7B\xD0\xEA\x0F\x42\xC0\xA3\x28\x8F\x20\x5F\x1A\x10\x73\x35\x15\x2D\x21\x0F\x30\x6E\x5B\x5F\x05\x13\xC5\x2B\x07\xED\xD1\xFD\x1B\x96\x32\x5B\x01\x3A\x37\x99\x1B\xDD\x2D\x09\x0C\x00\x98\x78\x08\x9C\xC5\x7D\x17\x6D\x57\x12\x21\x6E\x29\x65\x35\x9C\x38\xE0\x25\xE1\x63\x74\x17\x63\x2E\x27\x02\xBF\xD4\x17\x13\x48\xC5\xDB\x34\x1B\x38\x91\x09\xE9\xA7\xC3\x0E\xBE\xB3\x4D\x18\xD5\xF7\xFD\x16\xCD\xA0\x5D\x23\x3F\x16\x15\x37\xD5\x49\xF8\x12\x4D\x99\xCB\x1A\xFF\x3B\x1D\x07\x24\x26\x10\x31\xB9\xEE\x9D\x0C\x29\xB9\xBE\x1D\xA4\xE8\x0A\x13\x81\x02\x94\x22\x1A\x6F\xF3\x03\x3C\xB7\x4F\x20\xE4\xBB\x99\x19\x87\x00\x8F\x2A\x1C\x61\x0F\x0C\xAD\xB3\x00\x29\xC8\x84\x31\x36\x85\x4B\xFA\x12\xAD\xBE\x15\x39\x78\x2E\x21\x19\xEF\x10\xBF\x13\x12\x96\xF8\x02\x50\x25\x67\x1C\xC2\x35\x6A\x09\xD6\xA1\xE1\x15\xF5\x68\x18\x3A\x43\x70\x83\x26\xF5\x21\x8A\x07\x23\x3C\xFE\x16\x49\xF1\xE0\x07\xAE\x5F\x86\x18\xE3\x08\xAE\x3A\x66\x0D\xBF\x35\xCE\x15\x63\x37\x09\xA2\x45\x00\x45\x1E\x6F\x2A\xB9\x93\xE5\x35\x33\x33\x53\x03\x0B\x24\x7D\x29\xF1\xA4\xD3\x33\x98\x49\x51\x01\xA0\xEA\xFF\x04\x65\xEA\xC7\x0F\xFC\x45\x67\x02\x08\x4F\x9E\x24\x9A\x9E\xC6\x28\xEA\x15\xC1\x0E\xC1\x08\x8E\x1C\x6E\xFB\x46\x16\x4C\xE1\x06\x2C\x6D\x6E\x1B\x10\x96\xEF\xE5\x22\x4B\x78\xCA\x35\x01\xF2\xBF\x2D\x9B\xD4\x48\x2E\x15\xA3\x6F\x0C\x15\x8A\x17\x0B\xD5\x1D\xD3\x25\x86\x66\xB5\x25\x7C\x48\xB6\x26\x81\x29\x94\x22\x78\x87\x3B\x3B\xE2\xA3\xA8\x3A\x90\x95\x16\x2F\x6C\x0F\xB7\x0C\x07\x33\xAD\x36\x3F\x50\xED\x17\x5D\x1A\x78\x09\xF6\x92\x07\x21\x94\x5A\x2A\x18\x47\x43\x86\x00\xD9\x2E\xED\x2B\x4C\xB7\x86\x0C\xBD\xE1\x8E\x35\x78\xE4\xDE\x31\x23\x3F\x8D\x02\x1C\x2D\x25\x28\xF1\xF7\x9D\x2F\x63\xB7\xCF\x33\xFC\x44\xA5\x29\x13\x3E\x5E\x32\xB7\x7B\x68\x22\x0F\xB2\x5D\x09\xC9\xCA\x38\x1E\x19\x52\x3F\x2D\xD4\x8F\x4B\x04\x27\x50\x31\x0D\x57\x31\x21\x31\xB2\x4C\x15\x15\x14\x52\xE2\x17\x1C\x5C\x6C\x01\xD8\x38\x8C\x00\xBB\xE1\xF9\x16\xA0\x04\x6E\x1B\xF6\xFC\xA9\x30\x64\xD6\xD2\x20\x70\xB0\xA1\x28\xCA\x89\xDE\x25\x53\xF9\xF0\x32\x1B\xD1\x7A\x34\x0B\xF9\x90\x07\x24\x30\x95\x0D\x97\x39\xE3\x04\xCB\x94\x80\x2B\xF3\xC3\x68\x2D\x43\xB9\x23\x19\x83\x9F\xE6\x2F\xF6\x11\x46\x37\xA0\x9B\x96\x16\x89\x93\x59\x32\xA9\xF5\x7A\x20\x4A\x2D\x63\x31\xC4\x3D\xB9\x20\x7D\x36\xC2\x18\xDE\x24\x4F\x39\x2F\xC5\x4F\x36\x69\x45\xDD\x1E\x49\x4B\x10\x1F\xB4\x55\x24\x06\xED\x04\x0B\x08\xB2\xAC\x60\x17\x17\xA7\xDF\x00\xBC\x6E\x83\x23\x25\xC9\xFB\x0C\xA2\x69\x6F\x14\xD9\x7A\x0E\x38\xDD\x51\xBF\x17\x8C\xA5\x00\x19\x7B\x03\x68\x19\x40\xF3\xA4\x29\x95\x34\x03\x29\x2A\x76\x73\x27\xE9\x6D\x68\x08\x8B\xA4\x80\x13\x07\x8A\xC0\x24\x34\xBB\xA2\x1C\xD7\x76\x46\x18\xE5\xD2\x7B\x0E\xBD\x2D\x3C\x05\x34\x28\x49\x2F\xE9\x0C\x85\x28\x2A\xF3\xB0\x24\x75\x9E\x9E\x22\xD5\xCD\x82\x28\x14\x46\x97\x00\x90\xA0\x19\x2F\xF0\x4F\x65\x24\x8F\xD6\xA3\x33\xE4\xB5\x81\x06\xD9\xDF\x9C\x0C\x02\x65\xD8\x1F\x87\xAF\xAD\x01\xD2\x93\x28\x0B\x5E\xFB\xA6\x18\x6E\x9C\x46\x22\xA1\x4D\x96\x00\x95\x00\x7D\x17\xB8\xC5\x29\x22\xCA\x65\x40\x29\xAF\x98\x0F\x0A\xEE\xD1\x35\x05\x03\xDC\xF7\x27\xC9\x00\x87\x00\x11\x29\xDF\x03\xF6\xE5\xF0\x01\xA4\xD7\x59\x0A\xA9\x0F\xE4\x34\x1C\x05\x59\x10\xA6\xFD\x76\x32\x9E\x4D\x92\x12\xA5\x97\xE7\x1B\x6B\x25\x78\x31\x54\xB7\xA3\x37\x9D\x08\x1D\x2C\xD3\x94\x5A\x20\xEA\x72\xA4\x35\xBF\x8E\x22\x1F\x66\x1F\xBA\x34\x7A\x40\x94\x11\xEB\xBF\x21\x19\x02\x41\x94\x37\xCB\xC0\x55\x27\x72\xA3\x75\x04\x28\x81\x43\x1C\x1A\xBE\xDC\x38\x25\x77\x17\x2E\xB3\xCD\x53\x11\xA5\x36\x12\x0B\x18\x72\x6A\x1B\x4C\x87\x3A\x27\x4F\x19\x98\x0D\xEA\x9C\x77\x06\x32\x7A\x4C\x08\x4C\x05\x7A\x00\xC1\xA6\x9F\x11\x93\x63\xEF\x1F\x60\x81\x9F\x31\x73\xB8\x22\x15\x20\xA2\xB3\x2F\xDE\x19\xBD\x34\x45\xDC\x25\x0E\x10\xDA\x4A\x12\x25\xD7\x20\x30\xCD\xC1\xA7\x1A\xF5\x47\x32\x1D\x4A\xF4\x54\x22\x95\xA5\x63\x35\xD0\xE3\xBD\x28\x25\xA3\x55\x08\x8E\xC1\x57\x01\xDB\xC1\xCA\x0C\x97\x1C\x0F\x0D\x93\xD4\x33\x38\x22\x25\xC7\x21\x9D\x49\x4D\x2D\x8F\xF4\x2C\x07\x0B\xF4\x05\x2B\x28\xEF\x28\x0C\x9F\xF3\xA0\x2A\x9A\x20\x33\x0D\xB0\xF1\xB2\x2B\x39\x9F\x07\x25\x68\x75\xD4\x01\x82\xF7\x31\x29\x07\xEA\x54\x23\x11\x81\x38\x21\x73\x0A\x18\x2A\x6B\x4D\x93\x30\x21\xDA\x73\x0A\xDA\x8E\xB7\x01\xE5\x8C\x76\x03\x27\x53\x58\x10\x51\x4C\xB8\x16\x33\x21\xB2\x37\xE5\x0E\x25\x27\x6D\x72\xF9\x31\x5D\xD2\xFE\x0C\xF4\x15\xC5\x11\x58\x15\x87\x27\xE5\x44\xB8\x0B\x96\xF8\x86\x1A\xAA\x1C\xE6\x05\x03\xF0\x51\x0F\xE4\x43\x1F\x1C\x1B\x94\x1E\x0A\xD5\x93\x2A\x2E\xD4\xFF\x0B\x09\x74\xC9\xDC\x1E\x2F\x16\x57\x1D\xF8\xF1\x78\x27\x82\x68\xC2\x06\x37\x31\xC7\x03\x68\xBC\x5E\x09\x94\xED\x50\x0A\xF4\x88\x78\x1E\x37\x00\x44\x19\x00\xC0\x82\x15\xB9\x2C\xED\x29\xAC\x2C\x03\x26\xE2\xA5\x46\x20\x22\x95\x89\x2A\x52\xA7\x00\x2D\x4D\x88\xFF\x30\x1A\x60\x2E\x21\x00\x80\xDA\x2C\xE6\x75\x5C\x14\xA8\x49\x7F\x3A\xB6\x55\x16\x22\xF5\xAC\x1D\x3A\xFC\x06\x7B\x10\xCC\x9C\x93\x1A\x72\x6F\x96\x37\xB3\x2B\x03\x18\x51\x50\x18\x00\xAD\x55\xB3\x0F\xCB\x2F\xD2\x2D\x7F\xFA\x1A\x32\x4F\xD8\x50\x02\x00\x42\xE1\x28\xE1\x45\x16\x38\x96\x92\xC0\x33\x04\x35\x5C\x36\x9C\xCF\x59\x01\x0B\xD9\x7E\x20\x96\x23\x71\x20\x8A\x5D\x5C\x21\xE1\x82\xE5\x1A\x4D\x67\x2E\x04\xC4\x4C\x56\x33\x2E\x07\x4E\x23\x86\x73\xD9\x37\x64\xDE\x80\x0D\x68\x57\x20\x2E\xBB\x25\xD1\x36\x89\x9D\xE1\x1A\xE9\x90\xF2\x31\x37\x64\x15\x1A\x39\xEC\x1C\x16\x24\x14\xFE\x23\x59\xA0\xD9\x1E\xBF\xA4\xA8\x25\x3F\x5B\xB8\x29\xDD\x14\xD1\x38\x8E\xCE\x75\x19\xB7\xA4\x62\x0A\x13\x57\xD9\x1D\x6C\x54\xDC\x32\xC6\x17\x5A\x3B\x43\xC6\xC9\x30\xBE"
	generated_bytes = []
	size = len(dt3)+len(dt4)+16
	calc_result = size%4+size
	tickcount = windll.kernel32.GetTickCount()
	srand = random.seed(tickcount)
	tick_rand = random.randint(0, 2147483647) %1024 # in C RAND_MAX == 2147483647
	bytes_to_be_added_to_file_data[0] = tick_rand& 0xff
	bytes_to_be_added_to_file_data[1] = ctypes.c_uint16(tick_rand).value >> 8
	if(calc_result/4>0):
		counter = calc_result/4
		while(counter>0):
			v12 = rand_bytes[tick_rand*4+3]
			v13 = rand_bytes[tick_rand*4:][:4]
			v13 = v13.encode('hex') #mad skillz here
			v13 = struct.pack('<I',int(v13,16)).encode('hex')
			v15 = 1
			v14 = int(v13,16)>> 0x10
			v16 = int(v13,16) >> 8
			if ( rand_bytes[tick_rand*4]):
				v15 = ord(rand_bytes[tick_rand*4]) &0xff
			generated_bytes.append(v15)
			v17 = 1
			if(v16&0xff):
				v17 = v16&0xff
			generated_bytes.append(v17)
			v18 = 1
			if(v14&0xff):
				v18 = v14 & 0xff
			generated_bytes.append(v18)
			v19 = 1
			if(v12):
				v19 = ord(v12) & 0xff
			generated_bytes.append(v19)
			tick_rand = (tick_rand+1)%1024
			counter = counter-1
			
	return generated_bytes

def generate_bytes(passed_str):
	random_bytes= generate_bytes_sequence()

	bytes_to_be_added_to_file_data[2] = len(dt3+dt4)+16
	bytes_to_be_added_to_file_data[4] = random_bytes[0] ^ 0x77
	bytes_to_be_added_to_file_data[12]  = random_bytes[8] ^ 0x69
	bytes_to_be_added_to_file_data[5] = random_bytes[1] ^ 0x69
	bytes_to_be_added_to_file_data[7] = random_bytes[3] ^ 0x63
	bytes_to_be_added_to_file_data[6] = random_bytes[2] ^ 0x73
	bytes_to_be_added_to_file_data[8] = random_bytes[4] ^ 0x72
	bytes_to_be_added_to_file_data[11] =random_bytes[7] ^ 0x6c
	bytes_to_be_added_to_file_data[9] = random_bytes[5] ^ 0x5c
	bytes_to_be_added_to_file_data[10] = random_bytes[6] ^ 0x63
	bytes_to_be_added_to_file_data[13] = random_bytes[9] ^ 0x5c

	for i in range(len(dt3)):
		bytes_to_be_added_to_file_data[14+i]= ord(dt3[i]) ^ random_bytes[0xA+i]

	bytes_to_be_added_to_file_data[24] = random_bytes[len(dt3)+0xA] ^ 0x5c
	
	for i in range(len(dt4)):
		bytes_to_be_added_to_file_data[25+i]= ord(dt4[i]) ^ random_bytes[len(dt3)+0xB+i]

	bytes_to_be_added_to_file_data[29] = random_bytes[len(dt4)+0xB+len(dt3)] ^ 0x5c
		
	for i in range(len(passed_str)):
		bytes_to_be_added_to_file_data[34+i] = ord(passed_str[i])^ random_bytes[len(dt4)+len(dt3)+0xc+i]
	
	bytes_to_be_added_to_file_data[37] = random_bytes[len(dt3)+0xc+len(passed_str)+len(dt4)] ^ 0x5c
	print '[{}]'.format(', '.join(hex(x) for x in bytes_to_be_added_to_file_data))
	
passed_str = "rqo"
generate_bytes(passed_str)