title: CVE-2024-3400 - Palo Alto Networks Firewalls Command Injection
id: 4478ac7b-edc2-4868-aaa4-6508928ec609
status: experimental
description: |
    Detects GET requests to '/global-protect/login[or]logout.esp' that indicate possible exploitation of the vulnerability CVE-2024-3400.
references:
    - https://https://security.paloaltonetworks.com/CVE-2024-3400
    - https://www.rapid7.com/blog/post/2024/04/12/etr-cve-2024-3400-critical-command-injection-vulnerability-in-palo-alto-networks-firewalls-2/
    - https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
    - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
author: Christiaan Beek, Rapid7 Labs
date: 2024/04/17
tags:
    - attack.initial_access
    - attack.persistence
    - cve.2024.3400
logsource:
    category: syslog
detection:
    selection_method_and_response:
    cs-method: POST

    selection_uri:
        cs-uri-stem|contains: 
        - '/global-protect/login.esp'
        - '/global-protect/logout.esp'
        - '/ssl-vpn/hipreport.esp'
    condition: selection_method_and_response and 1 of selection_uri
falsepositives:
    - Unknown
level: critical

