
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">22541</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/External/SDN-1.1/lupa/__init__.py" target="_blank">/ComfyUI-BlenderAI-node/External/SDN-1.1/lupa/__init__.py</a><br>
    <b>Line number: </b>25<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
9	    try:
10	        from os import RTLD_NOW, RTLD_GLOBAL
11	    except ImportError:
12	        from DLFCN import RTLD_NOW, RTLD_GLOBAL  # Py2.7
13	    dlopen_flags = RTLD_NOW | RTLD_GLOBAL
14	
15	    import sys
16	    old_flags = sys.getdlopenflags()
17	    try:
18	        sys.setdlopenflags(dlopen_flags)
19	        import lupa._lupa
20	    finally:
21	        sys.setdlopenflags(old_flags)
22	
23	try:
24	    _try_import_with_global_library_symbols()
25	except:
26	    pass
27	
28	del _try_import_with_global_library_symbols
29	
30	
31	# Find the implementation with the latest Lua version available.
32	_newest_lib = None
33	
34	
35	def _import_newest_lib():
36	    global _newest_lib
37	    if _newest_lib is not None:
38	        return _newest_lib
39	
40	    import os.path
41	    import re
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/External/websocket/_core.py" target="_blank">/ComfyUI-BlenderAI-node/External/websocket/_core.py</a><br>
    <b>Line number: </b>503<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
487	                while timeout is None or time.time() - start_time &lt; timeout:
488	                    try:
489	                        frame = self.recv_frame()
490	                        if frame.opcode != ABNF.OPCODE_CLOSE:
491	                            continue
492	                        if isEnabledForError():
493	                            recv_status = struct.unpack(&quot;!H&quot;, frame.data[0:2])[0]
494	                            if recv_status &gt;= 3000 and recv_status &lt;= 4999:
495	                                debug(&quot;close status: &quot; + repr(recv_status))
496	                            elif recv_status != STATUS_NORMAL:
497	                                error(&quot;close status: &quot; + repr(recv_status))
498	                        break
499	                    except:
500	                        break
501	                self.sock.settimeout(sock_timeout)
502	                self.sock.shutdown(socket.SHUT_RDWR)
503	            except:
504	                pass
505	
506	            self.shutdown()
507	
508	    def abort(self):
509	        &quot;&quot;&quot;
510	        Low-level asynchronous abort, wakes up other threads that are waiting in recv_*
511	        &quot;&quot;&quot;
512	        if self.connected:
513	            self.sock.shutdown(socket.SHUT_RDWR)
514	
515	    def shutdown(self):
516	        &quot;&quot;&quot;
517	        close socket, immediately.
518	        &quot;&quot;&quot;
519	        if self.sock:
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak SHA1 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/External/websocket/_handshake.py" target="_blank">/ComfyUI-BlenderAI-node/External/websocket/_handshake.py</a><br>
    <b>Line number: </b>183<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
167	    if subprotocols:
168	        subproto = headers.get(&quot;sec-websocket-protocol&quot;, None)
169	        if not subproto or subproto.lower() not in [s.lower() for s in subprotocols]:
170	            error(&quot;Invalid subprotocol: &quot; + str(subprotocols))
171	            return False, None
172	        subproto = subproto.lower()
173	
174	    result = headers.get(&quot;sec-websocket-accept&quot;, None)
175	    if not result:
176	        return False, None
177	    result = result.lower()
178	
179	    if isinstance(result, str):
180	        result = result.encode(&#x27;utf-8&#x27;)
181	
182	    value = (key + &quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;).encode(&#x27;utf-8&#x27;)
183	    hashed = base64encode(hashlib.sha1(value).digest()).strip().lower()
184	    success = hmac.compare_digest(hashed, result)
185	
186	    if success:
187	        return True, subproto
188	    else:
189	        return False, None
190	
191	
192	def _create_sec_websocket_key():
193	    randomness = os.urandom(16)
194	    return base64encode(randomness).decode(&#x27;utf-8&#x27;).strip()
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/External/websocket/_wsdump.py" target="_blank">/ComfyUI-BlenderAI-node/External/websocket/_wsdump.py</a><br>
    <b>Line number: </b>184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
168	            return frame.opcode, None
169	        elif frame.opcode == websocket.ABNF.OPCODE_PING:
170	            ws.pong(frame.data)
171	            return frame.opcode, frame.data
172	
173	        return frame.opcode, frame.data
174	
175	    def recv_ws():
176	        while True:
177	            opcode, data = recv()
178	            msg = None
179	            if opcode == websocket.ABNF.OPCODE_TEXT and isinstance(data, bytes):
180	                data = str(data, &quot;utf-8&quot;)
181	            if isinstance(data, bytes) and len(data) &gt; 2 and data[:2] == b&#x27;\037\213&#x27;:  # gzip magick
182	                try:
183	                    data = &quot;[gzip] &quot; + str(gzip.decompress(data), &quot;utf-8&quot;)
184	                except:
185	                    pass
186	            elif isinstance(data, bytes):
187	                try:
188	                    data = &quot;[zlib] &quot; + str(zlib.decompress(data, -zlib.MAX_WBITS), &quot;utf-8&quot;)
189	                except:
190	                    pass
191	
192	            if isinstance(data, bytes):
193	                data = repr(data)
194	
195	            if args.verbose:
196	                msg = &quot;%s: %s&quot; % (websocket.ABNF.OPCODE_MAP.get(opcode), data)
197	            else:
198	                msg = data
199	
200	            if msg is not None:
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/External/websocket/_wsdump.py" target="_blank">/ComfyUI-BlenderAI-node/External/websocket/_wsdump.py</a><br>
    <b>Line number: </b>189<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
173	        return frame.opcode, frame.data
174	
175	    def recv_ws():
176	        while True:
177	            opcode, data = recv()
178	            msg = None
179	            if opcode == websocket.ABNF.OPCODE_TEXT and isinstance(data, bytes):
180	                data = str(data, &quot;utf-8&quot;)
181	            if isinstance(data, bytes) and len(data) &gt; 2 and data[:2] == b&#x27;\037\213&#x27;:  # gzip magick
182	                try:
183	                    data = &quot;[gzip] &quot; + str(gzip.decompress(data), &quot;utf-8&quot;)
184	                except:
185	                    pass
186	            elif isinstance(data, bytes):
187	                try:
188	                    data = &quot;[zlib] &quot; + str(zlib.decompress(data, -zlib.MAX_WBITS), &quot;utf-8&quot;)
189	                except:
190	                    pass
191	
192	            if isinstance(data, bytes):
193	                data = repr(data)
194	
195	            if args.verbose:
196	                msg = &quot;%s: %s&quot; % (websocket.ABNF.OPCODE_MAP.get(opcode), data)
197	            else:
198	                msg = data
199	
200	            if msg is not None:
201	                if args.timings:
202	                    console.write(str(time.time() - start_time) + &quot;: &quot; + msg)
203	                else:
204	                    console.write(msg)
205	
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/trie.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/trie.py</a><br>
    <b>Line number: </b>4<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	# Refeence: https://github.com/DominikDoom/a1111-sd-webui-tagcomplete
2	from __future__ import annotations
3	import time
4	import pickle
5	from pathlib import Path
6	from threading import Thread
7	from functools import lru_cache
8	DEBUG = True
9	CACHE_VERSION = (0, 0, 1)
10	danbooru_type = {&quot;0&quot;: &quot;General&quot;,
11	                 &quot;1&quot;: &quot;Artist&quot;,
12	                 &quot;3&quot;: &quot;Copyright&quot;,
13	                 &quot;4&quot;: &quot;Character&quot;,
14	                 &quot;5&quot;: &quot;Meta&quot;}
15	e621_type = {&quot;-1&quot;: &quot;Invalid&quot;,
16	             &quot;0&quot;: &quot;General&quot;,
17	             &quot;1&quot;: &quot;Artist&quot;,
18	             &quot;3&quot;: &quot;Copyright&quot;,
19	             &quot;4&quot;: &quot;Character&quot;,
20	             &quot;5&quot;: &quot;Species&quot;,
21	             &quot;6&quot;: &quot;Invalid&quot;,
22	             &quot;7&quot;: &quot;Meta&quot;,
23	             &quot;8&quot;: &quot;Lore&quot;, }
24	
25	
26	def timeit(func):
27	    def wrap(*args, **kwargs):
28	        ts = time.time()
29	        res = func(*args, **kwargs)
30	        if DEBUG:
31	            print(f&quot;Func {func.__name__}: {time.time()-ts:.4f}s&quot;)
32	        return res
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/trie.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/trie.py</a><br>
    <b>Line number: </b>194<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
178	    def bl_search(self, prefix, max_size=100):
179	        if prefix in Trie.SEARCH_CACHE:
180	            return Trie.SEARCH_CACHE[prefix]
181	        w1 = self.bl_search1(prefix, max_size)
182	        w2 = self.fuzzy_search(prefix, max_size)
183	        if w2:
184	            w1.extend(w2)
185	            w1.sort(reverse=True)
186	            Trie.SEARCH_CACHE[prefix] = w1
187	        return w1
188	
189	    @timeit
190	    def from_cache(self):
191	        if not self.CACHE_PATH.exists():
192	            return
193	        # ts = time.time()
194	        data: dict = pickle.load(open(self.CACHE_PATH.as_posix(), &quot;rb+&quot;))
195	        if data.get(&quot;version&quot;) != CACHE_VERSION:
196	            self.CACHE_PATH.unlink()
197	            return
198	        # print(time.time()- ts)
199	        self.root = data.pop(&quot;root&quot;, None)
200	        self.word_list = data.pop(&quot;word_list&quot;, None)
201	        return self.is_loaded()
202	
203	    @timeit
204	    def to_cache(self):
205	        &quot;&quot;&quot;快速序列化 root 和 word_list到缓存文件&quot;&quot;&quot;
206	        data = {&quot;root&quot;: self.root, &quot;word_list&quot;: self.word_list, &quot;version&quot;: CACHE_VERSION}
207	        # ts = time.time()
208	        pickle.dump(data, open(self.CACHE_PATH.as_posix(), &quot;wb+&quot;))
209	        # print(time.time()- ts)
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/words_collection.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/words_collection.py</a><br>
    <b>Line number: </b>5<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	# Refeence: https://github.com/DominikDoom/a1111-sd-webui-tagcomplete
2	from __future__ import annotations
3	import bpy
4	import time
5	import pickle
6	import csv
7	import traceback
8	from pathlib import Path
9	from ..kclogger import logger
10	
11	CACHE_VERSION = (1, 0)
12	
13	
14	def timeit(func):
15	    def wrap(*args, **kwargs):
16	        ts = time.time()
17	        res = func(*args, **kwargs)
18	        print(f&quot;Func {func.__name__}: {time.time()-ts:.4f}s&quot;)
19	        return res
20	    return wrap
21	
22	
23	class Words:
24	    SEARCH_CACHE = {}
25	    FLAGS = set()
26	    CACHE_PATH = Path(__file__).parent / &quot;words_collection.cache&quot;
27	
28	    def __init__(self):
29	        self.word_list: list[tuple] = []
30	        self.word_map: dict[str, tuple] = {}
31	
32	    def read_tags(self):
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/words_collection.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/words_collection.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
18	        print(f&quot;Func {func.__name__}: {time.time()-ts:.4f}s&quot;)
19	        return res
20	    return wrap
21	
22	
23	class Words:
24	    SEARCH_CACHE = {}
25	    FLAGS = set()
26	    CACHE_PATH = Path(__file__).parent / &quot;words_collection.cache&quot;
27	
28	    def __init__(self):
29	        self.word_list: list[tuple] = []
30	        self.word_map: dict[str, tuple] = {}
31	
32	    def read_tags(self):
33	        if self.CACHE_PATH.exists():
34	            cache = pickle.loads(self.CACHE_PATH.read_bytes())
35	            if isinstance(cache, list):
36	                self.read_raw_tags()
37	            elif cache.get(&quot;VERSION&quot;, (0, 0)) &lt; CACHE_VERSION:
38	                self.read_raw_tags()
39	            else:
40	                self.word_list = cache.get(&quot;WORDS&quot;, [])
41	        else:
42	            self.read_raw_tags()
43	
44	    def read_raw_tags(self):
45	        self.word_list = self.read_csv()
46	        data = {&quot;VERSION&quot;: CACHE_VERSION, &quot;WORDS&quot;: self.word_list}
47	        if self.CACHE_PATH.exists():
48	            self.CACHE_PATH.unlink()
49	        self.CACHE_PATH.write_bytes(pickle.dumps(data))
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/words_re.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/words_re.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from __future__ import annotations
2	import pickle
3	import json
4	import time
5	from pathlib import Path
6	from functools import lru_cache
7	import difflib
8	
9	def timeit(func):
10	    def wrap(*args, **kwargs):
11	        ts = time.time()
12	        res = func(*args, **kwargs)
13	        print(f&quot;Func {func.__name__}: {time.time()-ts:.4f}s&quot;)
14	        return res
15	    return wrap
16	
17	
18	danbooru_type = {&quot;0&quot;: &quot;General&quot;,
19	                 &quot;1&quot;: &quot;Artist&quot;,
20	                 &quot;3&quot;: &quot;Copyright&quot;,
21	                 &quot;4&quot;: &quot;Character&quot;,
22	                 &quot;5&quot;: &quot;Meta&quot;}
23	e621_type = {&quot;-1&quot;: &quot;Invalid&quot;,
24	             &quot;0&quot;: &quot;General&quot;,
25	             &quot;1&quot;: &quot;Artist&quot;,
26	             &quot;3&quot;: &quot;Copyright&quot;,
27	             &quot;4&quot;: &quot;Character&quot;,
28	             &quot;5&quot;: &quot;Species&quot;,
29	             &quot;6&quot;: &quot;Invalid&quot;,
30	             &quot;7&quot;: &quot;Meta&quot;,
31	             &quot;8&quot;: &quot;Lore&quot;, }
32	COLOR_MAP = {
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/words_re.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/words_re.py</a><br>
    <b>Line number: </b>192<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
176	    else:
177	        f = open(path.as_posix(), &quot;wb&quot;)
178	    try:
179	        pickle.dump(data, f)
180	    finally:
181	        f.close()
182	
183	
184	@timeit
185	def load_from_file(data_path: Path, with_lzma=False):
186	    trie = None
187	    if not data_path.exists():
188	        ...
189	    if with_lzma:
190	        import lzma
191	        with lzma.open(data_path.as_posix(), &quot;rb&quot;) as f:
192	            trie = pickle.load(f)
193	    else:
194	        with open(data_path.as_posix(), &quot;rb&quot;) as f:
195	            trie = pickle.load(f)
196	    return trie
197	
198	
199	@timeit
200	def init_words(with_lzma=False, fake=False):
201	    if fake:
202	        Words.WORDS = Words()
203	        return
204	    if with_lzma:
205	        data_path = Path(__file__).parent / &quot;words.xz&quot;
206	    else:
207	        data_path = Path(__file__).parent / &quot;words.pk&quot;
</pre>
</div>


</div>
</div>

<div id="issue-11">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/MultiLineText/words_re.py" target="_blank">/ComfyUI-BlenderAI-node/MultiLineText/words_re.py</a><br>
    <b>Line number: </b>195<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
179	        pickle.dump(data, f)
180	    finally:
181	        f.close()
182	
183	
184	@timeit
185	def load_from_file(data_path: Path, with_lzma=False):
186	    trie = None
187	    if not data_path.exists():
188	        ...
189	    if with_lzma:
190	        import lzma
191	        with lzma.open(data_path.as_posix(), &quot;rb&quot;) as f:
192	            trie = pickle.load(f)
193	    else:
194	        with open(data_path.as_posix(), &quot;rb&quot;) as f:
195	            trie = pickle.load(f)
196	    return trie
197	
198	
199	@timeit
200	def init_words(with_lzma=False, fake=False):
201	    if fake:
202	        Words.WORDS = Words()
203	        return
204	    if with_lzma:
205	        data_path = Path(__file__).parent / &quot;words.xz&quot;
206	    else:
207	        data_path = Path(__file__).parent / &quot;words.pk&quot;
208	
209	    words = csv_to_words()
210	    save_to_file(words, data_path, with_lzma)
</pre>
</div>


</div>
</div>

<div id="issue-12">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/blueprints.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/blueprints.py</a><br>
    <b>Line number: </b>1112<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
1096	def upload_image(img_path):
1097	    from .manager import TaskManager
1098	
1099	    url = f&quot;{TaskManager.server.get_url()}/upload/image&quot;
1100	    img_path = Path(img_path)
1101	    if img_path.is_dir() or not img_path.exists():
1102	        return
1103	
1104	    # 准备文件数据
1105	    try:
1106	        import requests
1107	        from urllib3.util import Timeout
1108	        data = {&quot;overwrite&quot;: &quot;true&quot;, &quot;subfolder&quot;: &quot;SDN&quot;}
1109	        img_type = f&quot;image/{img_path.suffix.replace(&#x27;.&#x27;, &#x27;&#x27;)}&quot;
1110	        files = {&#x27;image&#x27;: (img_path.name, img_path.read_bytes(), img_type)}
1111	        timeout = Timeout(connect=5, read=5)
1112	        url = url.replace(&quot;0.0.0.0&quot;, &quot;127.0.0.1&quot;)
1113	        response = requests.post(url, data=data, files=files, timeout=timeout)
1114	        # 检查响应
1115	        if response.status_code == 200:
1116	            logger.info(&quot;Upload Image Success&quot;)
1117	            # {&#x27;name&#x27;: &#x27;icon.png&#x27;, &#x27;subfolder&#x27;: &#x27;SDN&#x27;, &#x27;type&#x27;: &#x27;input&#x27;}
1118	            return response.json()
1119	        else:
1120	            logger.error(f&quot;{_T(&#x27;Upload Image Fail&#x27;)}: [{response.status_code}] {response.text}&quot;)
1121	    except Exception as e:
1122	        logger.error(f&quot;{_T(&#x27;Upload Image Fail&#x27;)}: {e}&quot;)
1123	
1124	
1125	def cache_to_local(data, suffix=&quot;png&quot;, save_path=&quot;&quot;) -&gt; Path:
1126	    &#x27;&#x27;&#x27;data = {&quot;filename&quot;: filename, &quot;subfolder&quot;: subfolder, &quot;type&quot;: folder_type}&#x27;&#x27;&#x27;
1127	    url_values = urllib.parse.urlencode(data)
</pre>
</div>


</div>
</div>

<div id="issue-13">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/blueprints.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/blueprints.py</a><br>
    <b>Line number: </b>1131<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
1115	        if response.status_code == 200:
1116	            logger.info(&quot;Upload Image Success&quot;)
1117	            # {&#x27;name&#x27;: &#x27;icon.png&#x27;, &#x27;subfolder&#x27;: &#x27;SDN&#x27;, &#x27;type&#x27;: &#x27;input&#x27;}
1118	            return response.json()
1119	        else:
1120	            logger.error(f&quot;{_T(&#x27;Upload Image Fail&#x27;)}: [{response.status_code}] {response.text}&quot;)
1121	    except Exception as e:
1122	        logger.error(f&quot;{_T(&#x27;Upload Image Fail&#x27;)}: {e}&quot;)
1123	
1124	
1125	def cache_to_local(data, suffix=&quot;png&quot;, save_path=&quot;&quot;) -&gt; Path:
1126	    &#x27;&#x27;&#x27;data = {&quot;filename&quot;: filename, &quot;subfolder&quot;: subfolder, &quot;type&quot;: folder_type}&#x27;&#x27;&#x27;
1127	    url_values = urllib.parse.urlencode(data)
1128	    from .manager import TaskManager
1129	    url = f&quot;{TaskManager.server.get_url()}/view?{url_values}&quot;
1130	    # logger.debug(f&#x27;requesting {url} for image data&#x27;)
1131	    with urllib.request.urlopen(url) as response:
1132	        img_data = response.read()
1133	        if not save_path:
1134	            suffix = suffix if suffix.startswith(&quot;.&quot;) else f&quot;.{suffix}&quot;
1135	            save_path = Path(tempfile.gettempdir()) / data.get(&#x27;filename&#x27;, f&#x27;preview{suffix}&#x27;)
1136	        with open(save_path, &quot;wb&quot;) as f:
1137	            f.write(img_data)
1138	        return save_path
1139	
1140	
1141	class 预览(BluePrintBase):
1142	    comfyClass = &quot;预览&quot;
1143	
1144	    def spec_extra_properties(s, properties, nname, ndesc):
1145	        prop = bpy.props.CollectionProperty(type=Images)
1146	        properties[&quot;prev&quot;] = prop
</pre>
</div>


</div>
</div>

<div id="issue-14">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py</a><br>
    <b>Line number: </b>38<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
22	EXT_PATH = COMFY_PATH.joinpath(&quot;web&quot;, &quot;extensions&quot;, ADDON_NAME)
23	CUR_PATH = Path(__file__).parent
24	
25	def rmtree(path: Path):
26	    # unlink symbolic link
27	    if not path.exists():
28	        return
29	    if Path(path.resolve()).as_posix() != path.as_posix():
30	        path.unlink()
31	        return
32	    if path.is_file():
33	        path.unlink()
34	    elif path.is_dir():
35	        # 移除 .git
36	        if path.name == &quot;.git&quot;:
37	            if platform.system() == &quot;darwin&quot;:
38	                from subprocess import call
39	                call([&#x27;rm&#x27;, &#x27;-rf&#x27;, path.as_posix()])
40	            elif platform.system() == &quot;Windows&quot;:
41	                os.system(f&#x27;rd/s/q &quot;{path.as_posix()}&quot;&#x27;)
42	            return
43	        for child in path.iterdir():
44	            rmtree(child)
45	        try:
46	            path.rmdir()  # nas 的共享盘可能会有残留
47	        except BaseException:
48	            ...
49	
50	def register():
51	    import nodes
52	    if hasattr(nodes, &quot;EXTENSION_WEB_DIRS&quot;):
53	        rmtree(EXT_PATH)
</pre>
</div>


</div>
</div>

<div id="issue-15">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py</a><br>
    <b>Line number: </b>39<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
23	CUR_PATH = Path(__file__).parent
24	
25	def rmtree(path: Path):
26	    # unlink symbolic link
27	    if not path.exists():
28	        return
29	    if Path(path.resolve()).as_posix() != path.as_posix():
30	        path.unlink()
31	        return
32	    if path.is_file():
33	        path.unlink()
34	    elif path.is_dir():
35	        # 移除 .git
36	        if path.name == &quot;.git&quot;:
37	            if platform.system() == &quot;darwin&quot;:
38	                from subprocess import call
39	                call([&#x27;rm&#x27;, &#x27;-rf&#x27;, path.as_posix()])
40	            elif platform.system() == &quot;Windows&quot;:
41	                os.system(f&#x27;rd/s/q &quot;{path.as_posix()}&quot;&#x27;)
42	            return
43	        for child in path.iterdir():
44	            rmtree(child)
45	        try:
46	            path.rmdir()  # nas 的共享盘可能会有残留
47	        except BaseException:
48	            ...
49	
50	def register():
51	    import nodes
52	    if hasattr(nodes, &quot;EXTENSION_WEB_DIRS&quot;):
53	        rmtree(EXT_PATH)
54	        return
</pre>
</div>


</div>
</div>

<div id="issue-16">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py</a><br>
    <b>Line number: </b>39<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
23	CUR_PATH = Path(__file__).parent
24	
25	def rmtree(path: Path):
26	    # unlink symbolic link
27	    if not path.exists():
28	        return
29	    if Path(path.resolve()).as_posix() != path.as_posix():
30	        path.unlink()
31	        return
32	    if path.is_file():
33	        path.unlink()
34	    elif path.is_dir():
35	        # 移除 .git
36	        if path.name == &quot;.git&quot;:
37	            if platform.system() == &quot;darwin&quot;:
38	                from subprocess import call
39	                call([&#x27;rm&#x27;, &#x27;-rf&#x27;, path.as_posix()])
40	            elif platform.system() == &quot;Windows&quot;:
41	                os.system(f&#x27;rd/s/q &quot;{path.as_posix()}&quot;&#x27;)
42	            return
43	        for child in path.iterdir():
44	            rmtree(child)
45	        try:
46	            path.rmdir()  # nas 的共享盘可能会有残留
47	        except BaseException:
48	            ...
49	
50	def register():
51	    import nodes
52	    if hasattr(nodes, &quot;EXTENSION_WEB_DIRS&quot;):
53	        rmtree(EXT_PATH)
54	        return
</pre>
</div>


</div>
</div>

<div id="issue-17">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/custom_nodes/Cup-ClipBoard/__init__.py</a><br>
    <b>Line number: </b>41<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
25	def rmtree(path: Path):
26	    # unlink symbolic link
27	    if not path.exists():
28	        return
29	    if Path(path.resolve()).as_posix() != path.as_posix():
30	        path.unlink()
31	        return
32	    if path.is_file():
33	        path.unlink()
34	    elif path.is_dir():
35	        # 移除 .git
36	        if path.name == &quot;.git&quot;:
37	            if platform.system() == &quot;darwin&quot;:
38	                from subprocess import call
39	                call([&#x27;rm&#x27;, &#x27;-rf&#x27;, path.as_posix()])
40	            elif platform.system() == &quot;Windows&quot;:
41	                os.system(f&#x27;rd/s/q &quot;{path.as_posix()}&quot;&#x27;)
42	            return
43	        for child in path.iterdir():
44	            rmtree(child)
45	        try:
46	            path.rmdir()  # nas 的共享盘可能会有残留
47	        except BaseException:
48	            ...
49	
50	def register():
51	    import nodes
52	    if hasattr(nodes, &quot;EXTENSION_WEB_DIRS&quot;):
53	        rmtree(EXT_PATH)
54	        return
55	    link_func = shutil.copytree
56	    if os.name == &quot;nt&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-18">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>19<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
3	import re
4	import shutil
5	import sys
6	import json
7	import time
8	import atexit
9	import aud
10	from platform import system
11	import struct
12	from concurrent.futures import ThreadPoolExecutor
13	from copy import deepcopy
14	from shutil import rmtree
15	from urllib import request
16	from urllib.parse import urlparse
17	from urllib.error import URLError
18	from threading import Thread
19	from subprocess import Popen, PIPE, STDOUT
20	from pathlib import Path
21	from queue import Queue
22	from ..utils import rmtree as rt, logger, _T, PkgInstaller, update_screen
23	from ..timer import Timer
24	from ..preference import get_pref
25	from .history import History
26	from ..External.websocket import WebSocketApp
27	
28	
29	def get_ip():
30	    return TaskManager.server.get_ip()
31	
32	
33	def get_port():
34	    return TaskManager.server.get_port()
</pre>
</div>


</div>
</div>

<div id="issue-19">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>38<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
22	from ..utils import rmtree as rt, logger, _T, PkgInstaller, update_screen
23	from ..timer import Timer
24	from ..preference import get_pref
25	from .history import History
26	from ..External.websocket import WebSocketApp
27	
28	
29	def get_ip():
30	    return TaskManager.server.get_ip()
31	
32	
33	def get_port():
34	    return TaskManager.server.get_port()
35	
36	
37	def get_url():
38	    return TaskManager.server.get_url().replace(&quot;0.0.0.0&quot;, &quot;localhost&quot;)
39	
40	
41	WITH_PROXY = False
42	if not WITH_PROXY:
43	    request.install_opener(request.build_opener(request.ProxyHandler({})))
44	
45	
46	class Task:
47	    def __init__(self, task=None, pre=None, post=None, tree=None) -&gt; None:
48	        self.task = task
49	        self.res = Queue()
50	        self._pre = pre
51	        self._post = post
52	        from .tree import CFNodeTree
53	        from .nodes import NodeBase
</pre>
</div>


</div>
</div>

<div id="issue-20">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>693<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
677	        self.launch_ip = get_ip()
678	        self.launch_port = get_port()
679	        self.launch_url = f&quot;http://{self.launch_ip}:{self.launch_port}&quot;
680	        # cmd = &quot; &quot;.join([str(python), arg])
681	        # 加了 stderr后 无法获取 进度?
682	        # logger.debug(&quot; &quot;.join(args))
683	        if system() == &#x27;Linux&#x27;:
684	            args = &quot; &quot;.join(args)
685	            args = f&quot;source {pref.python_path}/activate; {args}&quot;
686	            if Path(&quot;/opt/intel/oneapi/setvars.sh&quot;).exists():
687	                args = &quot;source /opt/intel/oneapi/setvars.sh; &quot; + args
688	                logger.warning(&quot;Using Intel OneAPI&quot;)
689	            args = [&quot;/bin/bash&quot;, &quot;-c&quot;, args]  # shell=True will use /bin/sh which can&#x27;t source
690	        # mac
691	        if system() == &quot;Darwin&quot;:
692	            os.environ[&quot;PYTORCH_ENABLE_MPS_FALLBACK&quot;] = &quot;1&quot;
693	        p = Popen(args, stdout=PIPE, stderr=STDOUT, cwd=Path(model_path).resolve().as_posix())
694	        self.child = p
695	        self.pid = p.pid
696	        self.exited_status[self.pid] = False
697	        pidpath.write_text(str(p.pid))
698	        atexit.register(self.child.kill)
699	        Thread(target=self.stdout_listen, daemon=True).start()
700	        return self.wait_connect()
701	
702	    def close(self):
703	        pidpath = Path(__file__).parent / &quot;pid&quot;
704	        if pidpath.exists():
705	            self.force_kill(pidpath.read_text())
706	            pidpath.unlink()
707	
708	        if self.child:
</pre>
</div>


</div>
</div>

<div id="issue-21">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>757<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
741	
742	        if not PkgInstaller.try_install(&quot;psutil&quot;):
743	            logger.error(&quot;psutil not installed please disable proxy and try again!&quot;)
744	            return
745	        if not PkgInstaller.is_installed(&quot;psutil&quot;):
746	            logger.error(&quot;psutil not installed please disable proxy and try again!&quot;)
747	            return
748	        import psutil
749	        pid = int(pid)
750	        if sys.platform == &quot;win32&quot;:
751	            try:
752	                process = psutil.Process(pid)
753	                if &quot;python&quot; not in process.name():
754	                    return
755	                process.kill()
756	                # os.system(f&#x27;taskkill /F /IM {process.name()}&#x27;)
757	                os.system(f&#x27;taskkill /pid {pid} -t -f&#x27;)
758	            except psutil.NoSuchProcess:
759	                return
760	        elif sys.platform == &quot;darwin&quot;:
761	            try:
762	                process = psutil.Process(pid)
763	                if &quot;python&quot; in process.name().lower():
764	                    # process.kill()
765	                    os.system(f&quot;kill -9 {pid}&quot;)
766	            except psutil.NoSuchProcess:
767	                return
768	        else:
769	            ...
770	            # os.kill(pid, signal.SIGKILL)
771	        logger.error(&quot;%s id -&gt; %s&quot;, _T(&quot;Kill Last ComfyUI Process&quot;), pid)
772	
</pre>
</div>


</div>
</div>

<div id="issue-22">
<div class="issue-block issue-sev-high">
    <b>start_process_with_a_shell: </b> Starting a process with a shell, possible injection detected, security issue.<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>765<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
749	        pid = int(pid)
750	        if sys.platform == &quot;win32&quot;:
751	            try:
752	                process = psutil.Process(pid)
753	                if &quot;python&quot; not in process.name():
754	                    return
755	                process.kill()
756	                # os.system(f&#x27;taskkill /F /IM {process.name()}&#x27;)
757	                os.system(f&#x27;taskkill /pid {pid} -t -f&#x27;)
758	            except psutil.NoSuchProcess:
759	                return
760	        elif sys.platform == &quot;darwin&quot;:
761	            try:
762	                process = psutil.Process(pid)
763	                if &quot;python&quot; in process.name().lower():
764	                    # process.kill()
765	                    os.system(f&quot;kill -9 {pid}&quot;)
766	            except psutil.NoSuchProcess:
767	                return
768	        else:
769	            ...
770	            # os.kill(pid, signal.SIGKILL)
771	        logger.error(&quot;%s id -&gt; %s&quot;, _T(&quot;Kill Last ComfyUI Process&quot;), pid)
772	
773	    def run_pre(self):
774	        &quot;&quot;&quot;
775	        Check pre install
776	        &quot;&quot;&quot;
777	        # controlnet check
778	        logger.warning(_T(&quot;ControlNet Init....&quot;))
779	        python = get_pref().get_python()
780	        model_path = get_pref().model_path
</pre>
</div>


</div>
</div>

<div id="issue-23">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>802<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
786	                command = [python.as_posix()]
787	                command.append(&quot;-s&quot;)
788	                command.append(&quot;-m&quot;)
789	                command.append(&quot;pip&quot;)
790	                command.append(&quot;install&quot;)
791	                command.append(&quot;-r&quot;)
792	                command.append((controlnet / &quot;requirements.txt&quot;).as_posix())
793	                command.append(&quot;--extra-index-url&quot;)
794	                command.append(&quot;https://download.pytorch.org/whl/cu117&quot;)
795	                command.append(&quot;--no-warn-script-location&quot;)
796	                if fast_url := PkgInstaller.select_pip_source():
797	                    site = urlparse(fast_url)
798	                    command.append(&quot;-i&quot;)
799	                    command.append(fast_url)
800	                    command.append(&quot;--trusted-host&quot;)
801	                    command.append(site.netloc)
802	                proc = Popen(command, cwd=model_path)
803	                proc.wait()
804	
805	        logger.warning(_T(&quot;ControlNet Init Finished.&quot;))
806	        logger.warning(_T(&quot;If controlnet still not worked, install manually by double clicked {}&quot;).format((controlnet / &quot;install.bat&quot;).as_posix()))
807	
808	    def stdout_listen(self):
809	        p = self.child
810	        pid = self.pid
811	        while p.poll() is None and self.child == p:
812	            line = p.stdout.readline().strip()
813	            if not line:
814	                continue
815	            # logger.info(line)
816	            # print(re.findall(&quot;\|(.*?)[&quot;, line.decode(&quot;gbk&quot;)))
817	            if &quot;# 😺dzNodes:&quot;.encode() in line:
</pre>
</div>


</div>
</div>

<div id="issue-24">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>1012<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
996	            TaskManager.put_error_msg(_T(&quot;Server Not Launched, Add Task Failed&quot;))
997	            TaskManager.put_error_msg(_T(&quot;Please Check ComfyUI Directory&quot;))
998	            logger.error(_T(&quot;Server Not Launched&quot;))
999	            return
1000	        TaskManager.task_queue.put(Task(task, pre=pre, post=post, tree=tree))
1001	
1002	    @staticmethod
1003	    def push_res(res):
1004	        logger.debug(_T(&quot;Add Result&quot;))
1005	        TaskManager.cur_task.res.put(res)
1006	        TaskManager.res_queue.put(TaskManager.cur_task)
1007	
1008	    @staticmethod
1009	    def clear_cache():
1010	        req = request.Request(f&quot;{TaskManager.server.get_url()}/cup/clear_cache&quot;, method=&quot;POST&quot;)
1011	        try:
1012	            request.urlopen(req)
1013	        except URLError:
1014	            ...
1015	
1016	    # def get_temp_directory():
1017	    #     req = request.Request(f&quot;{TaskManager.server.get_url()}/cup/get_temp_directory&quot;, method=&quot;POST&quot;)
1018	    #     try:
1019	    #         res = request.urlopen(req)
1020	    #         return res.read().decode()
1021	    #     except Exception as e:
1022	    #         ...
1023	    #     return &quot;&quot;
1024	
1025	    @staticmethod
1026	    def interrupt():
1027	        from http.client import RemoteDisconnected
</pre>
</div>


</div>
</div>

<div id="issue-25">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>1031<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
1015	
1016	    # def get_temp_directory():
1017	    #     req = request.Request(f&quot;{TaskManager.server.get_url()}/cup/get_temp_directory&quot;, method=&quot;POST&quot;)
1018	    #     try:
1019	    #         res = request.urlopen(req)
1020	    #         return res.read().decode()
1021	    #     except Exception as e:
1022	    #         ...
1023	    #     return &quot;&quot;
1024	
1025	    @staticmethod
1026	    def interrupt():
1027	        from http.client import RemoteDisconnected
1028	        import traceback
1029	        req = request.Request(f&quot;{TaskManager.server.get_url()}/interrupt&quot;, method=&quot;POST&quot;)
1030	        try:
1031	            request.urlopen(req)
1032	        except URLError:
1033	            ...
1034	        except RemoteDisconnected:
1035	            ...
1036	        except Exception:
1037	            traceback.print_exc()
1038	
1039	    @staticmethod
1040	    def clear_all():
1041	        TaskManager.interrupt()
1042	        while not TaskManager.task_queue.empty():
1043	            TaskManager.task_queue.get()
1044	        TaskManager.progress = {}
1045	
1046	    @staticmethod
</pre>
</div>


</div>
</div>

<div id="issue-26">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>1073<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
1057	            logger.debug(_T(&quot;Submit Task&quot;))
1058	            TaskManager.cur_task = task
1059	            try:
1060	                TaskManager.submit(task)
1061	            except Exception as e:
1062	                logger.error(e)
1063	                TaskManager.put_error_msg(str(e), with_clear=True)
1064	                TaskManager.mark_finished(with_noexe=False)
1065	        logger.debug(_T(&quot;Poll Task Thread Exit&quot;))
1066	
1067	    @staticmethod
1068	    def query_server_task():
1069	        if not TaskManager.is_launched():
1070	            return {&quot;queue_pending&quot;: [], &quot;queue_running&quot;: []}
1071	        try:
1072	            req = request.Request(f&quot;{TaskManager.server.get_url()}/queue&quot;)
1073	            res = request.urlopen(req)
1074	            res = json.loads(res.read().decode())
1075	        except BaseException:
1076	            res = {&quot;queue_pending&quot;: [], &quot;queue_running&quot;: []}
1077	        return res
1078	
1079	    @staticmethod
1080	    def submit(task: Task):
1081	        task.submit_pre()
1082	        task: dict[str, tuple] = task.task
1083	        prompt = task[&quot;prompt&quot;]
1084	        for node in prompt:
1085	            prompt[node][1]()
1086	        TaskManager.clear_error_msg()
1087	
1088	        def queue_task(task: dict):
</pre>
</div>


</div>
</div>

<div id="issue-27">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/manager.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/manager.py</a><br>
    <b>Line number: </b>1108<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
1092	            api = task.get(&quot;api&quot;)
1093	            if api == &quot;prompt&quot;:
1094	                prompt = {node: task.get(&quot;prompt&quot;)[node][0] for node in task.get(&quot;prompt&quot;)}
1095	
1096	                cid = TaskManager.SessionId[&quot;SessionId&quot;]
1097	                content = {&quot;client_id&quot;: cid,
1098	                           &quot;prompt&quot;: prompt,
1099	                           &quot;extra_data&quot;: {
1100	                               &quot;extra_pnginfo&quot;: {&quot;workflow&quot;: task.get(&quot;workflow&quot;)}
1101	                           }}
1102	                data = json.dumps(content).encode()
1103	                req = request.Request(f&quot;{TaskManager.server.get_url()}/{api}&quot;, data=data)
1104	                History.put_history(task.get(&quot;workflow&quot;))
1105	                # logger.debug(f&#x27;post to {TaskManager.server.get_url()}/{api}:&#x27;)
1106	                # logger.debug(data.decode())
1107	                try:
1108	                    request.urlopen(req)
1109	                except request.HTTPError as e:
1110	                    print(_T(&quot;Invalid Node Connection&quot;))
1111	                    TaskManager.put_error_msg(_T(&quot;Invalid Node Connection&quot;))
1112	                    err_parser = TaskErrPaser()
1113	                    err_parser.parse(e)
1114	                    if err_parser.error_info:
1115	                        TaskManager.mark_finished_with_info([])
1116	                    else:
1117	                        TaskManager.mark_finished()
1118	                except URLError:
1119	                    TaskManager.put_error_msg(_T(&quot;Server Not Launched&quot;))
1120	                    TaskManager.mark_finished(with_noexe=False)
1121	                except Exception as e:
1122	                    logger.error(e)
1123	                    TaskManager.put_error_msg(str(e))
</pre>
</div>


</div>
</div>

<div id="issue-28">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/nodes.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/nodes.py</a><br>
    <b>Line number: </b>135<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
119	        # prev_dir = Path(get_pref().model_path) / &quot;models&quot;
120	        # {
121	        #     &quot;ckpt_name&quot;: prev_dir / &quot;checkpoints&quot;,
122	        # }
123	        for class_type, pathmap in name2path.items():
124	            path_list = {}
125	            PREVICONPATH[class_type] = path_list
126	            for name, mpath in pathmap.items():
127	                reg_name = get_reg_name(name)
128	                path_list[reg_name] = d[mpath][0]
129	    return PREVICONPATH.get(nname, {})
130	
131	
132	def calc_hash_type(stype):
133	    from .blueprints import is_bool_list, is_all_str_list
134	    if is_bool_list(stype):
135	        hash_type = md5(&quot;{True, False}&quot;.encode()).hexdigest()
136	    elif not is_all_str_list(stype):
137	        hash_type = md5(&quot;,&quot;.join([str(i) for i in stype]).encode()).hexdigest()
138	    else:
139	        try:
140	            hash_type = md5(&quot;,&quot;.join(stype).encode()).hexdigest()
141	        except TypeError as e:
142	            winfo = str(stype)
143	            if len(winfo) &gt; 100:
144	                winfo = winfo[:40] + &quot;......&quot;
145	            raise TypeError(f&quot;{_T(&#x27;Non-Standard Enum&#x27;)} -&gt; {winfo}&quot;) from e
146	    return hash_type
147	
148	
149	class PropGen:
150	    @staticmethod
</pre>
</div>


</div>
</div>

<div id="issue-29">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/nodes.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/nodes.py</a><br>
    <b>Line number: </b>137<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
121	        #     &quot;ckpt_name&quot;: prev_dir / &quot;checkpoints&quot;,
122	        # }
123	        for class_type, pathmap in name2path.items():
124	            path_list = {}
125	            PREVICONPATH[class_type] = path_list
126	            for name, mpath in pathmap.items():
127	                reg_name = get_reg_name(name)
128	                path_list[reg_name] = d[mpath][0]
129	    return PREVICONPATH.get(nname, {})
130	
131	
132	def calc_hash_type(stype):
133	    from .blueprints import is_bool_list, is_all_str_list
134	    if is_bool_list(stype):
135	        hash_type = md5(&quot;{True, False}&quot;.encode()).hexdigest()
136	    elif not is_all_str_list(stype):
137	        hash_type = md5(&quot;,&quot;.join([str(i) for i in stype]).encode()).hexdigest()
138	    else:
139	        try:
140	            hash_type = md5(&quot;,&quot;.join(stype).encode()).hexdigest()
141	        except TypeError as e:
142	            winfo = str(stype)
143	            if len(winfo) &gt; 100:
144	                winfo = winfo[:40] + &quot;......&quot;
145	            raise TypeError(f&quot;{_T(&#x27;Non-Standard Enum&#x27;)} -&gt; {winfo}&quot;) from e
146	    return hash_type
147	
148	
149	class PropGen:
150	    @staticmethod
151	    def _find_icon_local(nname, inp_name, item):
152	        prev_path_list = get_icon_path(nname).get(inp_name)
</pre>
</div>


</div>
</div>

<div id="issue-30">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/nodes.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/nodes.py</a><br>
    <b>Line number: </b>140<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
124	            path_list = {}
125	            PREVICONPATH[class_type] = path_list
126	            for name, mpath in pathmap.items():
127	                reg_name = get_reg_name(name)
128	                path_list[reg_name] = d[mpath][0]
129	    return PREVICONPATH.get(nname, {})
130	
131	
132	def calc_hash_type(stype):
133	    from .blueprints import is_bool_list, is_all_str_list
134	    if is_bool_list(stype):
135	        hash_type = md5(&quot;{True, False}&quot;.encode()).hexdigest()
136	    elif not is_all_str_list(stype):
137	        hash_type = md5(&quot;,&quot;.join([str(i) for i in stype]).encode()).hexdigest()
138	    else:
139	        try:
140	            hash_type = md5(&quot;,&quot;.join(stype).encode()).hexdigest()
141	        except TypeError as e:
142	            winfo = str(stype)
143	            if len(winfo) &gt; 100:
144	                winfo = winfo[:40] + &quot;......&quot;
145	            raise TypeError(f&quot;{_T(&#x27;Non-Standard Enum&#x27;)} -&gt; {winfo}&quot;) from e
146	    return hash_type
147	
148	
149	class PropGen:
150	    @staticmethod
151	    def _find_icon_local(nname, inp_name, item):
152	        prev_path_list = get_icon_path(nname).get(inp_name)
153	        if not prev_path_list:
154	            return 0
155	
</pre>
</div>


</div>
</div>

<div id="issue-31">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/test.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/test.py</a><br>
    <b>Line number: </b>1<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import subprocess
2	
3	c = &quot;&quot;&quot;
4	import sys
5	import time
6	for i in range(5):
7	    sys.stdout.write(&#x27;Processing&#x27;)
8	    sys.stdout.flush()
9	    time.sleep(1)
10	
11	for i in range(5):
12	    sys.stderr.write(&#x27;Processing&#x27;)
13	    sys.stderr.flush()
14	    time.sleep(1)
15	
16	&quot;&quot;&quot;
17	# p = subprocess.Popen([&quot;python3&quot;, &quot;-c&quot;, c], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
18	# while p.poll() is None:
19	#     print(&quot;----&quot;, p.stderr.readline().decode())
20	
21	
22	# import subprocess
23	# import select
24	# import fcntl
25	# import os
26	
27	# # 创建子进程
28	# p = subprocess.Popen([&quot;python3&quot;, &quot;-c&quot;, c], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
29	
30	# # 将子进程stderr设置为非阻塞
31	# fd = p.stderr.fileno()
32	# flags = fcntl.fcntl(fd, fcntl.F_GETFL)
</pre>
</div>


</div>
</div>

<div id="issue-32">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/tree.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/tree.py</a><br>
    <b>Line number: </b>7<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from __future__ import annotations
2	from typing import Any
3	import bpy
4	import typing
5	import time
6	import sys
7	import pickle
8	import traceback
9	import inspect
10	import types
11	from hashlib import md5
12	from mathutils import Color
13	from string import ascii_letters, digits
14	from bpy.app.translations import pgettext
15	from threading import Thread
16	from functools import partial
17	from collections import OrderedDict
18	from bpy.types import NodeTree
19	from nodeitems_utils import NodeCategory, NodeItem, unregister_node_categories, _node_categories
20	from .nodes import nodes_reg, nodes_unreg, NodeParser, NodeBase, clear_nodes_data_cache
21	from ..utils import logger, Icon, rgb2hex, hex2rgb, _T, FSWatcher
22	from ..datas import EnumCache
23	from ..timer import Timer
24	from ..translations import ctxt, get_ori_name
25	from .utils import THelper
26	from contextlib import contextmanager
27	
28	TREE_NAME = &quot;CFNODES_SYS&quot;
29	TREE_TYPE = &quot;CFNodeTree&quot;
30	
31	
32	class InvalidNodeType(Exception):
</pre>
</div>


</div>
</div>

<div id="issue-33">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/tree.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/tree.py</a><br>
    <b>Line number: </b>148<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
132	        def __contains__(self, id):
133	            return id in self._get_id_pool()
134	
135	        def __or__(self, __value: Any) -&gt; set:
136	            return self._get_id_pool() | __value
137	
138	        def __iter__(self) -&gt; typing.Iterator[Any]:
139	            return iter(self._get_id_pool())
140	
141	        def __repr__(self) -&gt; str:
142	            return repr(self._get_id_pool())
143	
144	        def _get_id_pool(self) -&gt; set:
145	            if &quot;ID_POOL&quot; not in self.tree:
146	                self.tree[&quot;ID_POOL&quot;] = pickle.dumps(set())
147	            try:
148	                return pickle.loads(self.tree[&quot;ID_POOL&quot;])
149	            except pickle.UnpicklingError:
150	                self.tree[&quot;ID_POOL&quot;] = pickle.dumps(set())
151	            return pickle.loads(self.tree[&quot;ID_POOL&quot;])
152	
153	        def _set_id_pool(self, value):
154	            if not isinstance(value, set):
155	                raise TypeError(&quot;ID POOL must be set&quot;)
156	            try:
157	                self.inner_set(value)
158	            except AttributeError:
159	                logger.error(traceback.format_exc())
160	                Timer.put((self.inner_set, value))
161	
162	        def inner_set(self, value):
163	            self.tree[&quot;ID_POOL&quot;] = pickle.dumps(value)
</pre>
</div>


</div>
</div>

<div id="issue-34">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/tree.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/tree.py</a><br>
    <b>Line number: </b>151<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
135	        def __or__(self, __value: Any) -&gt; set:
136	            return self._get_id_pool() | __value
137	
138	        def __iter__(self) -&gt; typing.Iterator[Any]:
139	            return iter(self._get_id_pool())
140	
141	        def __repr__(self) -&gt; str:
142	            return repr(self._get_id_pool())
143	
144	        def _get_id_pool(self) -&gt; set:
145	            if &quot;ID_POOL&quot; not in self.tree:
146	                self.tree[&quot;ID_POOL&quot;] = pickle.dumps(set())
147	            try:
148	                return pickle.loads(self.tree[&quot;ID_POOL&quot;])
149	            except pickle.UnpicklingError:
150	                self.tree[&quot;ID_POOL&quot;] = pickle.dumps(set())
151	            return pickle.loads(self.tree[&quot;ID_POOL&quot;])
152	
153	        def _set_id_pool(self, value):
154	            if not isinstance(value, set):
155	                raise TypeError(&quot;ID POOL must be set&quot;)
156	            try:
157	                self.inner_set(value)
158	            except AttributeError:
159	                logger.error(traceback.format_exc())
160	                Timer.put((self.inner_set, value))
161	
162	        def inner_set(self, value):
163	            self.tree[&quot;ID_POOL&quot;] = pickle.dumps(value)
164	
165	    def get_id_pool(self) -&gt; Pool:
166	        return self.Pool(self)
</pre>
</div>


</div>
</div>

<div id="issue-35">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/tree.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/tree.py</a><br>
    <b>Line number: </b>994<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
978	
979	    menu_types = []
980	    for cat in cat_list:
981	        reg_nodetree(cat.identifier, cat.menus, sub=True)
982	        __data__ = {
983	            &quot;bl_space_type&quot;: &#x27;NODE_EDITOR&#x27;,
984	            &quot;bl_label&quot;: cat.name,
985	            &quot;category&quot;: cat,
986	            &quot;poll&quot;: cat.poll,
987	            &quot;draw&quot;: draw_node_item,
988	        }
989	        class_name = gen_cat_id(cat.identifier)
990	        registered_menu = registered_menus.pop(class_name, None)
991	        if registered_menu and getattr(registered_menu, &quot;is_registered&quot;):
992	            try:
993	                bpy.utils.unregister_class(registered_menu)
994	            except Exception:
995	                pass
996	        menu_type = type(class_name, (bpy.types.Menu,), __data__)
997	        menu_types.append(menu_type)
998	        registered_menus[class_name] = menu_type
999	        bpy.utils.register_class(menu_type)
1000	    if sub:
1001	        return
1002	
1003	    def draw_add_menu(self, context):
1004	        layout = self.layout
1005	
1006	        for cat in cat_list:
1007	            if cat.poll(context):
1008	                layout.menu(gen_cat_id(cat.identifier))
1009	
1010	    _node_categories[identifier] = (cat_list, draw_add_menu, menu_types)
</pre>
</div>


</div>
</div>

<div id="issue-36">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/SDNode/tree.py" target="_blank">/ComfyUI-BlenderAI-node/SDNode/tree.py</a><br>
    <b>Line number: </b>1030<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
1014	    node_cat = []
1015	    for cat, nodes in nodetree_desc.items():
1016	        ocat = cat
1017	        rep_chars = r&quot;&quot;&quot;!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^_`{|}~ &quot;&quot;&quot;
1018	        chars = ascii_letters + digits
1019	        for i, c in enumerate(rep_chars):
1020	            cat = cat.replace(c, chars[i])
1021	        # 替换所有非ascii字符为X
1022	        cat = &quot;&quot;.join([c if c in chars else &quot;X&quot; for c in cat])
1023	        if cat and cat[-1] not in chars:
1024	            cat = cat[:-1] + &quot;z&quot;
1025	        items = []
1026	        menus = []
1027	        for item in nodes[&quot;items&quot;]:
1028	            items.append(CFNodeItem(item))
1029	        menus.extend(load_node(nodes.get(&quot;menus&quot;, {}), root=cat, proot=f&quot;{proot}/{ocat}&quot;))
1030	        hash_root = md5(proot.encode()).hexdigest()[:5]
1031	        if not root:
1032	            cat_id = cat
1033	        else:
1034	            cat_id = f&quot;{root}_{cat}_{hash_root}&quot;
1035	        if len(cat_id) &gt; 50:
1036	            cat_id = f&quot;{cat}_{hash_root}&quot;
1037	        if not cat_id:
1038	            cat_id = &quot;NoCategory&quot;
1039	        if not ocat:
1040	            ocat = &quot;NoCategory&quot;
1041	        cfn_cat = CFNodeCategory(cat_id, name=ocat, items=items, menus=menus)
1042	        node_cat.append(cfn_cat)
1043	    return node_cat
1044	
1045	
</pre>
</div>


</div>
</div>

<div id="issue-37">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>274<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
258	    count_page_current: bpy.props.IntProperty(default=0, min=0, name=&quot;Drag Link Result Page Current&quot;)
259	
260	    def parse_comfyUIStart(self):
261	        config = []
262	        try:
263	            path = Path(sys.argv[sys.argv.index(&quot;comfyUIStart&quot;) + 1])
264	            if not path.exists():
265	                logger.error(_T(&quot;Invalid Config File Path&quot;))
266	                return []
267	            config = json.loads(path.read_text(encoding=&quot;utf-8&quot;))
268	            if not isinstance(config, list):
269	                return []
270	            for piece in config:
271	                # --listen 127.0.0.1 --port 8188
272	                if ip := re.match(r&quot;--listen\s+([0-9.]+)&quot;, piece):
273	                    ip = ip.group(1)
274	                    ip = {&quot;0.0.0.0&quot;: &quot;127.0.0.1&quot;}.get(ip, ip)
275	                    self.ip = ip
276	                if port := re.match(r&quot;.*?--port\s+([0-9]+)&quot;, piece):
277	                    self.port = int(port.group(1))
278	            config = &quot; &quot;.join(config)
279	            config = re.split(r&quot;\s(?=(?:[^\&quot;]*\&quot;[^\&quot;]*\&quot;)*[^\&quot;]*$)&quot;, config)
280	            # logger.info(f&quot;{_T(&#x27;Reparse Config&#x27;)}: {config}&quot;)
281	            # config = &quot; &quot;.join(config).split(&quot; &quot;)  # resplit
282	            for i, piece in enumerate(config):
283	                if piece[0] == piece[-1] == &quot;\&quot;&quot;:
284	                    piece = Path(piece.replace(&quot;\&quot;&quot;, &quot;&quot;)).resolve()
285	                    piece = FSWatcher.to_str(piece)
286	                    config[i] = piece
287	            if &quot;--auto-launch&quot; in config:
288	                config.remove(&quot;--auto-launch&quot;)
289	            if &quot;--disable-auto-launch&quot; in config:
</pre>
</div>


</div>
</div>

<div id="issue-38">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>451<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
435	            self.count_page_prev = False
436	            self.count_page_current -= 1
437	            bpy.ops.sdn.mouse_pos_rec(&quot;INVOKE_DEFAULT&quot;, action=&quot;ORI&quot;)
438	            from .Linker.linker import P
439	            bpy.context.window.cursor_warp(P.x, P.y)
440	            bpy.ops.comfy.swapper(&quot;INVOKE_DEFAULT&quot;, action=&quot;DRAW&quot;)
441	            bpy.context.window.cursor_warp(P.ori_x, P.ori_y)
442	    count_page_prev: bpy.props.BoolProperty(default=False,
443	                                            name=&quot;Drag Link Result Page Prev&quot;,
444	                                            update=update_count_page_prev)
445	
446	    @staticmethod
447	    def get_cuda_list():
448	        &quot;&quot;&quot;
449	        借助nvidia-smi获取CUDA版本列表
450	        &quot;&quot;&quot;
451	        import subprocess
452	        try:
453	            res = subprocess.check_output(&quot;nvidia-smi -L&quot;, shell=True).decode(&quot;utf-8&quot;)
454	            # GPU 0: NVIDIA GeForce GTX 1060 5GB (UUID: xxxx)
455	            items = [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
456	            for line in res.split(&quot;\n&quot;):
457	                m = re.search(r&quot;GPU (\d+): NVIDIA GeForce (.*) \(UUID: GPU-.*\)&quot;, line)
458	                if not line.startswith(&quot;GPU&quot;) or not m:
459	                    continue
460	                items.append((m.group(1), m.group(2), &quot;&quot;, len(items),))
461	            return items
462	        except BaseException:
463	            return [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
464	
465	    cuda: bpy.props.EnumProperty(name=&quot;cuda&quot;, items=get_cuda_list())
466	
</pre>
</div>


</div>
</div>

<div id="issue-39">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>453<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
437	            bpy.ops.sdn.mouse_pos_rec(&quot;INVOKE_DEFAULT&quot;, action=&quot;ORI&quot;)
438	            from .Linker.linker import P
439	            bpy.context.window.cursor_warp(P.x, P.y)
440	            bpy.ops.comfy.swapper(&quot;INVOKE_DEFAULT&quot;, action=&quot;DRAW&quot;)
441	            bpy.context.window.cursor_warp(P.ori_x, P.ori_y)
442	    count_page_prev: bpy.props.BoolProperty(default=False,
443	                                            name=&quot;Drag Link Result Page Prev&quot;,
444	                                            update=update_count_page_prev)
445	
446	    @staticmethod
447	    def get_cuda_list():
448	        &quot;&quot;&quot;
449	        借助nvidia-smi获取CUDA版本列表
450	        &quot;&quot;&quot;
451	        import subprocess
452	        try:
453	            res = subprocess.check_output(&quot;nvidia-smi -L&quot;, shell=True).decode(&quot;utf-8&quot;)
454	            # GPU 0: NVIDIA GeForce GTX 1060 5GB (UUID: xxxx)
455	            items = [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
456	            for line in res.split(&quot;\n&quot;):
457	                m = re.search(r&quot;GPU (\d+): NVIDIA GeForce (.*) \(UUID: GPU-.*\)&quot;, line)
458	                if not line.startswith(&quot;GPU&quot;) or not m:
459	                    continue
460	                items.append((m.group(1), m.group(2), &quot;&quot;, len(items),))
461	            return items
462	        except BaseException:
463	            return [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
464	
465	    cuda: bpy.props.EnumProperty(name=&quot;cuda&quot;, items=get_cuda_list())
466	
467	    def ip_check(self, context):
468	        &quot;&quot;&quot;检查IP地址是否合法&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-40">
<div class="issue-block issue-sev-low">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>453<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
437	            bpy.ops.sdn.mouse_pos_rec(&quot;INVOKE_DEFAULT&quot;, action=&quot;ORI&quot;)
438	            from .Linker.linker import P
439	            bpy.context.window.cursor_warp(P.x, P.y)
440	            bpy.ops.comfy.swapper(&quot;INVOKE_DEFAULT&quot;, action=&quot;DRAW&quot;)
441	            bpy.context.window.cursor_warp(P.ori_x, P.ori_y)
442	    count_page_prev: bpy.props.BoolProperty(default=False,
443	                                            name=&quot;Drag Link Result Page Prev&quot;,
444	                                            update=update_count_page_prev)
445	
446	    @staticmethod
447	    def get_cuda_list():
448	        &quot;&quot;&quot;
449	        借助nvidia-smi获取CUDA版本列表
450	        &quot;&quot;&quot;
451	        import subprocess
452	        try:
453	            res = subprocess.check_output(&quot;nvidia-smi -L&quot;, shell=True).decode(&quot;utf-8&quot;)
454	            # GPU 0: NVIDIA GeForce GTX 1060 5GB (UUID: xxxx)
455	            items = [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
456	            for line in res.split(&quot;\n&quot;):
457	                m = re.search(r&quot;GPU (\d+): NVIDIA GeForce (.*) \(UUID: GPU-.*\)&quot;, line)
458	                if not line.startswith(&quot;GPU&quot;) or not m:
459	                    continue
460	                items.append((m.group(1), m.group(2), &quot;&quot;, len(items),))
461	            return items
462	        except BaseException:
463	            return [(&quot;default&quot;, &quot;Auto&quot;, &quot;&quot;, 0,)]
464	
465	    cuda: bpy.props.EnumProperty(name=&quot;cuda&quot;, items=get_cuda_list())
466	
467	    def ip_check(self, context):
468	        &quot;&quot;&quot;检查IP地址是否合法&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-41">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>493<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
477	            ip[i] = str(min(255, max(0, v)))
478	        self[&quot;ip&quot;] = &quot;.&quot;.join(ip)
479	
480	    ip: bpy.props.StringProperty(default=&quot;127.0.0.1&quot;, name=&quot;IP&quot;, description=&quot;Service IP Address&quot;,
481	                                 update=ip_check)
482	    port: bpy.props.IntProperty(default=8189, min=1000, max=65535, name=&quot;Port&quot;, description=&quot;Service Port&quot;)
483	
484	    pref_dirs: bpy.props.CollectionProperty(type=PresetsDirDesc, name=&quot;Custom Presets&quot;, description=&quot;Custom Presets&quot;)
485	    pref_dirs_init: bpy.props.BoolProperty(default=True, name=&quot;Init Custom Preset Path&quot;, description=&quot;Create presets/groups dir if not exists&quot;)
486	
487	    rt_track_freq: bpy.props.FloatProperty(default=0.5, min=0.01, name=&quot;Viewport Track Frequency&quot;)
488	    view_context: bpy.props.BoolProperty(default=True, name=&quot;Use View Context&quot;, description=&quot;If enalbed use scene settings, otherwise use the current 3D view for rt rendering.&quot;)
489	
490	    def update_open_dir1(self, context):
491	        if self.open_dir1:
492	            self.open_dir1 = False
493	            os.startfile(Path(self.model_path) / &quot;models/checkpoints&quot;)
494	
495	    open_dir1: bpy.props.BoolProperty(default=False, name=&quot;Open CKPT Folder&quot;, update=update_open_dir1)
496	
497	    def update_open_dir2(self, context):
498	        if self.open_dir2:
499	            self.open_dir2 = False
500	            os.startfile(Path(self.model_path) / &quot;models/loras&quot;)
501	    open_dir2: bpy.props.BoolProperty(default=False, name=&quot;Open LoRA Folder&quot;, update=update_open_dir2)
502	
503	    def update_open_dir3(self, context):
504	        if self.open_dir3:
505	            self.open_dir3 = False
506	            os.startfile(self.model_path)
507	
508	    open_dir3: bpy.props.BoolProperty(default=False, name=&quot;Open ComfyUI Folder&quot;, update=update_open_dir3)
</pre>
</div>


</div>
</div>

<div id="issue-42">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>500<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
484	    pref_dirs: bpy.props.CollectionProperty(type=PresetsDirDesc, name=&quot;Custom Presets&quot;, description=&quot;Custom Presets&quot;)
485	    pref_dirs_init: bpy.props.BoolProperty(default=True, name=&quot;Init Custom Preset Path&quot;, description=&quot;Create presets/groups dir if not exists&quot;)
486	
487	    rt_track_freq: bpy.props.FloatProperty(default=0.5, min=0.01, name=&quot;Viewport Track Frequency&quot;)
488	    view_context: bpy.props.BoolProperty(default=True, name=&quot;Use View Context&quot;, description=&quot;If enalbed use scene settings, otherwise use the current 3D view for rt rendering.&quot;)
489	
490	    def update_open_dir1(self, context):
491	        if self.open_dir1:
492	            self.open_dir1 = False
493	            os.startfile(Path(self.model_path) / &quot;models/checkpoints&quot;)
494	
495	    open_dir1: bpy.props.BoolProperty(default=False, name=&quot;Open CKPT Folder&quot;, update=update_open_dir1)
496	
497	    def update_open_dir2(self, context):
498	        if self.open_dir2:
499	            self.open_dir2 = False
500	            os.startfile(Path(self.model_path) / &quot;models/loras&quot;)
501	    open_dir2: bpy.props.BoolProperty(default=False, name=&quot;Open LoRA Folder&quot;, update=update_open_dir2)
502	
503	    def update_open_dir3(self, context):
504	        if self.open_dir3:
505	            self.open_dir3 = False
506	            os.startfile(self.model_path)
507	
508	    open_dir3: bpy.props.BoolProperty(default=False, name=&quot;Open ComfyUI Folder&quot;, update=update_open_dir3)
509	
510	    def update_open_dir4(self, context):
511	        if self.open_dir4:
512	            self.open_dir4 = False
513	            os.startfile(Path(self.model_path) / &quot;SDNodeTemp&quot;)
514	
515	    open_dir4: bpy.props.BoolProperty(default=False,
</pre>
</div>


</div>
</div>

<div id="issue-43">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>506<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
490	    def update_open_dir1(self, context):
491	        if self.open_dir1:
492	            self.open_dir1 = False
493	            os.startfile(Path(self.model_path) / &quot;models/checkpoints&quot;)
494	
495	    open_dir1: bpy.props.BoolProperty(default=False, name=&quot;Open CKPT Folder&quot;, update=update_open_dir1)
496	
497	    def update_open_dir2(self, context):
498	        if self.open_dir2:
499	            self.open_dir2 = False
500	            os.startfile(Path(self.model_path) / &quot;models/loras&quot;)
501	    open_dir2: bpy.props.BoolProperty(default=False, name=&quot;Open LoRA Folder&quot;, update=update_open_dir2)
502	
503	    def update_open_dir3(self, context):
504	        if self.open_dir3:
505	            self.open_dir3 = False
506	            os.startfile(self.model_path)
507	
508	    open_dir3: bpy.props.BoolProperty(default=False, name=&quot;Open ComfyUI Folder&quot;, update=update_open_dir3)
509	
510	    def update_open_dir4(self, context):
511	        if self.open_dir4:
512	            self.open_dir4 = False
513	            os.startfile(Path(self.model_path) / &quot;SDNodeTemp&quot;)
514	
515	    open_dir4: bpy.props.BoolProperty(default=False,
516	                                      name=&quot;Open Cache Folder&quot;,
517	                                      update=update_open_dir4)
518	
519	    def draw_custom_presets(self, layout: bpy.types.UILayout):
520	        box = layout.box()
521	        box.label(text=&quot;Custom Presets&quot;, text_ctxt=ctxt)
</pre>
</div>


</div>
</div>

<div id="issue-44">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/preference.py" target="_blank">/ComfyUI-BlenderAI-node/preference.py</a><br>
    <b>Line number: </b>513<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
497	    def update_open_dir2(self, context):
498	        if self.open_dir2:
499	            self.open_dir2 = False
500	            os.startfile(Path(self.model_path) / &quot;models/loras&quot;)
501	    open_dir2: bpy.props.BoolProperty(default=False, name=&quot;Open LoRA Folder&quot;, update=update_open_dir2)
502	
503	    def update_open_dir3(self, context):
504	        if self.open_dir3:
505	            self.open_dir3 = False
506	            os.startfile(self.model_path)
507	
508	    open_dir3: bpy.props.BoolProperty(default=False, name=&quot;Open ComfyUI Folder&quot;, update=update_open_dir3)
509	
510	    def update_open_dir4(self, context):
511	        if self.open_dir4:
512	            self.open_dir4 = False
513	            os.startfile(Path(self.model_path) / &quot;SDNodeTemp&quot;)
514	
515	    open_dir4: bpy.props.BoolProperty(default=False,
516	                                      name=&quot;Open Cache Folder&quot;,
517	                                      update=update_open_dir4)
518	
519	    def draw_custom_presets(self, layout: bpy.types.UILayout):
520	        box = layout.box()
521	        box.label(text=&quot;Custom Presets&quot;, text_ctxt=ctxt)
522	        header = box.row(align=True)
523	        header.operator(PresetsDirEdit.bl_idname, text=&quot;Add Custom Presets Dir&quot;, icon=&quot;ADD&quot;, text_ctxt=ctxt).action = &quot;ADD&quot;
524	        header.prop(self, &quot;pref_dirs_init&quot;, text=&quot;&quot;, icon=&quot;FILE_REFRESH&quot;, text_ctxt=ctxt)
525	        col = box.column(align=True)
526	        col.scale_y = 1.1
527	        for i, item in enumerate(self.pref_dirs):
528	            row = col.row(align=True)
</pre>
</div>


</div>
</div>

<div id="issue-45">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/prop.py" target="_blank">/ComfyUI-BlenderAI-node/prop.py</a><br>
    <b>Line number: </b>95<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
79	            if file.suffix != &quot;.json&quot;:
80	                continue
81	            icon_id = Icon[&quot;None&quot;]
82	            for img in pd.iterdir():
83	                if not (file.name in img.stem and img.suffix in IMG_SUFFIX):
84	                    continue
85	                icon_id = Icon.reg_icon(img)
86	            items.append((str(file), file.stem, &quot;&quot;, icon_id, len(items)))
87	        items.sort(key=lambda x: x[1])
88	        Prop.cache[&quot;presets&quot;][pd] = items
89	        return Prop.cache[&quot;presets&quot;][pd]
90	    presets: bpy.props.EnumProperty(items=presets_items, name=&quot;Presets&quot;)
91	
92	    def update_open_presets_dir(self, context):
93	        if self.open_presets_dir:
94	            self.open_presets_dir = False
95	            os.startfile(str(PRESETS_DIR))
96	
97	    open_presets_dir: bpy.props.BoolProperty(default=False, name=&quot;Open NodeGroup Presets Folder&quot;, update=update_open_presets_dir)
98	
99	    def groups_dir_items(self, context):
100	        Prop.update_prop_cache([GROUPS_DIR], &quot;groups&quot;)
101	        return Prop.cache[&quot;groups_dir&quot;]
102	
103	    groups_dir: bpy.props.EnumProperty(items=groups_dir_items, name=&quot;Groups Directory&quot;)
104	
105	    def groups_items(self, context):
106	        gd = FSWatcher.to_path(self.groups_dir)
107	        if Prop.cache[&quot;groups&quot;].get(gd) and not FSWatcher.consume_change(gd):
108	            return Prop.cache[&quot;groups&quot;][gd]
109	        items = []
110	        if not gd.exists():
</pre>
</div>


</div>
</div>

<div id="issue-46">
<div class="issue-block issue-sev-low">
    <b>start_process_with_no_shell: </b> Starting a process without a shell.<br>
    <b>Test ID:</b> B606<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/prop.py" target="_blank">/ComfyUI-BlenderAI-node/prop.py</a><br>
    <b>Line number: </b>129<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b606_start_process_with_no_shell.html</a><br>

<div class="code">
<pre>
113	            if file.suffix != &quot;.json&quot;:
114	                continue
115	            icon_id = Icon[&quot;None&quot;]
116	            for img in gd.iterdir():
117	                if not (file.name in img.stem and img.suffix in IMG_SUFFIX):
118	                    continue
119	                icon_id = Icon.reg_icon(img)
120	            items.append((str(file), file.stem, &quot;&quot;, icon_id, len(items)))
121	        items.sort(key=lambda x: x[1])
122	        Prop.cache[&quot;groups&quot;][gd] = items
123	        return Prop.cache[&quot;groups&quot;][gd]
124	    groups: bpy.props.EnumProperty(items=groups_items, name=&quot;Presets&quot;)
125	
126	    def update_open_groups_dir(self, context):
127	        if self.open_groups_dir:
128	            self.open_groups_dir = False
129	            os.startfile(str(GROUPS_DIR))
130	
131	    open_groups_dir: bpy.props.BoolProperty(default=False, name=&quot;Open NodeTree Presets Folder&quot;, update=update_open_groups_dir)
132	
133	    def open_pref_update(self, context):
134	        from . import bl_info
135	        if self.open_pref:
136	            self.open_pref = False
137	            category = bl_info.get(&#x27;category&#x27;)
138	
139	            import addon_utils
140	            bpy.ops.screen.userpref_show()
141	            bpy.context.preferences.active_section = &#x27;ADDONS&#x27;
142	            if category is None:
143	                bpy.context.window_manager.addon_search = bl_info.get(&#x27;name&#x27;)
144	            else:
</pre>
</div>


</div>
</div>

<div id="issue-47">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/utils.py" target="_blank">/ComfyUI-BlenderAI-node/utils.py</a><br>
    <b>Line number: </b>570<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
554	        FSWatcher._watcher_queue.put(None)
555	        FSWatcher._running = False
556	
557	    @staticmethod
558	    def consume_change(path) -&gt; bool:
559	        path = FSWatcher.to_path(path)
560	        if path in FSWatcher._watcher_path and FSWatcher._watcher_path[path]:
561	            FSWatcher._watcher_path[path] = False
562	            return True
563	        return False
564	
565	    @lru_cache
566	    @staticmethod
567	    def get_nas_mapping():
568	        if platform.system() != &quot;Windows&quot;:
569	            return {}
570	        import subprocess
571	        result = subprocess.run(&quot;net use&quot;, capture_output=True, text=True, encoding=&quot;gbk&quot;, check=True)
572	        if result.returncode != 0 or result.stdout is None:
573	            return {}
574	        nas_mapping = {}
575	        try:
576	            lines = result.stdout.strip().split(&quot;\n&quot;)[4:]
577	            for line in lines:
578	                columns = line.split()
579	                if len(columns) &lt; 3:
580	                    continue
581	                local_drive = columns[1] + &quot;/&quot;
582	                nas_path = Path(columns[2]).resolve().as_posix()
583	                nas_mapping[local_drive] = nas_path
584	        except Exception:
585	            ...
</pre>
</div>


</div>
</div>

<div id="issue-48">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/utils.py" target="_blank">/ComfyUI-BlenderAI-node/utils.py</a><br>
    <b>Line number: </b>571<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
555	        FSWatcher._running = False
556	
557	    @staticmethod
558	    def consume_change(path) -&gt; bool:
559	        path = FSWatcher.to_path(path)
560	        if path in FSWatcher._watcher_path and FSWatcher._watcher_path[path]:
561	            FSWatcher._watcher_path[path] = False
562	            return True
563	        return False
564	
565	    @lru_cache
566	    @staticmethod
567	    def get_nas_mapping():
568	        if platform.system() != &quot;Windows&quot;:
569	            return {}
570	        import subprocess
571	        result = subprocess.run(&quot;net use&quot;, capture_output=True, text=True, encoding=&quot;gbk&quot;, check=True)
572	        if result.returncode != 0 or result.stdout is None:
573	            return {}
574	        nas_mapping = {}
575	        try:
576	            lines = result.stdout.strip().split(&quot;\n&quot;)[4:]
577	            for line in lines:
578	                columns = line.split()
579	                if len(columns) &lt; 3:
580	                    continue
581	                local_drive = columns[1] + &quot;/&quot;
582	                nas_path = Path(columns[2]).resolve().as_posix()
583	                nas_mapping[local_drive] = nas_path
584	        except Exception:
585	            ...
586	        return nas_mapping
</pre>
</div>


</div>
</div>

<div id="issue-49">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-BlenderAI-node/utils.py" target="_blank">/ComfyUI-BlenderAI-node/utils.py</a><br>
    <b>Line number: </b>571<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
555	        FSWatcher._running = False
556	
557	    @staticmethod
558	    def consume_change(path) -&gt; bool:
559	        path = FSWatcher.to_path(path)
560	        if path in FSWatcher._watcher_path and FSWatcher._watcher_path[path]:
561	            FSWatcher._watcher_path[path] = False
562	            return True
563	        return False
564	
565	    @lru_cache
566	    @staticmethod
567	    def get_nas_mapping():
568	        if platform.system() != &quot;Windows&quot;:
569	            return {}
570	        import subprocess
571	        result = subprocess.run(&quot;net use&quot;, capture_output=True, text=True, encoding=&quot;gbk&quot;, check=True)
572	        if result.returncode != 0 or result.stdout is None:
573	            return {}
574	        nas_mapping = {}
575	        try:
576	            lines = result.stdout.strip().split(&quot;\n&quot;)[4:]
577	            for line in lines:
578	                columns = line.split()
579	                if len(columns) &lt; 3:
580	                    continue
581	                local_drive = columns[1] + &quot;/&quot;
582	                nas_path = Path(columns[2]).resolve().as_posix()
583	                nas_mapping[local_drive] = nas_path
584	        except Exception:
585	            ...
586	        return nas_mapping
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
