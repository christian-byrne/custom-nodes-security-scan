
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">11910</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
27	import comfy.model_management
28	import folder_paths as comfy_paths
29	from comfy_extras.chainner_models import model_loading
30	import ast
31	import glob
32	import hashlib
33	import json
34	import nodes
35	import math
36	import numpy as np
37	from numba import jit
38	import os
39	import random
40	import re
41	import requests
42	import socket
43	import subprocess
44	import sys
45	import datetime
46	import time
47	import torch
48	from tqdm import tqdm
49	
50	p310_plus = (sys.version_info &gt;= (3, 10))
51	
52	MANIFEST = {
53	    &quot;name&quot;: &quot;WAS Node Suite&quot;,
54	    &quot;version&quot;: (2,2,2),
55	    &quot;author&quot;: &quot;WASasquatch&quot;,
56	    &quot;project&quot;: &quot;https://github.com/WASasquatch/was-node-suite-comfyui&quot;,
57	    &quot;description&quot;: &quot;An extensive node suite for ComfyUI with over 180 new nodes&quot;,
58	}
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>335<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
319	                    with open(STYLES_PATH, &quot;w&quot;, encoding=&#x27;utf-8&#x27;) as f:
320	                        json.dump(styles, f, indent=4)
321	
322	            del styles
323	
324	            cstr(f&quot;Styles import complete.&quot;).msg.print()
325	
326	        else:
327	            cstr(f&quot;Styles file `{webui_styles_file}` does not exist.&quot;).error.print()
328	
329	
330	#! SUITE SPECIFIC CLASSES &amp; FUNCTIONS
331	
332	# Freeze PIP modules
333	def packages(versions=False):
334	    import sys
335	    import subprocess
336	    return [( r.decode().split(&#x27;==&#x27;)[0] if not versions else r.decode() ) for r in subprocess.check_output([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;freeze&#x27;]).split()]
337	
338	def install_package(package, uninstall_first: Union[List[str], str] = None):
339	    if os.getenv(&quot;WAS_BLOCK_AUTO_INSTALL&quot;, &#x27;False&#x27;).lower() in (&#x27;true&#x27;, &#x27;1&#x27;, &#x27;t&#x27;):
340	        cstr(f&quot;Preventing package install of &#x27;{package}&#x27; due to WAS_BLOCK_INSTALL env&quot;).msg.print()
341	    else:
342	        if uninstall_first is None:
343	            return
344	
345	        if isinstance(uninstall_first, str):
346	            uninstall_first = [uninstall_first]
347	
348	        cstr(f&quot;Uninstalling {&#x27;, &#x27;.join(uninstall_first)}..&quot;)
349	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;uninstall&#x27;, *uninstall_first])
350	        cstr(&quot;Installing package...&quot;).msg.print()
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>336<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
320	                        json.dump(styles, f, indent=4)
321	
322	            del styles
323	
324	            cstr(f&quot;Styles import complete.&quot;).msg.print()
325	
326	        else:
327	            cstr(f&quot;Styles file `{webui_styles_file}` does not exist.&quot;).error.print()
328	
329	
330	#! SUITE SPECIFIC CLASSES &amp; FUNCTIONS
331	
332	# Freeze PIP modules
333	def packages(versions=False):
334	    import sys
335	    import subprocess
336	    return [( r.decode().split(&#x27;==&#x27;)[0] if not versions else r.decode() ) for r in subprocess.check_output([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;freeze&#x27;]).split()]
337	
338	def install_package(package, uninstall_first: Union[List[str], str] = None):
339	    if os.getenv(&quot;WAS_BLOCK_AUTO_INSTALL&quot;, &#x27;False&#x27;).lower() in (&#x27;true&#x27;, &#x27;1&#x27;, &#x27;t&#x27;):
340	        cstr(f&quot;Preventing package install of &#x27;{package}&#x27; due to WAS_BLOCK_INSTALL env&quot;).msg.print()
341	    else:
342	        if uninstall_first is None:
343	            return
344	
345	        if isinstance(uninstall_first, str):
346	            uninstall_first = [uninstall_first]
347	
348	        cstr(f&quot;Uninstalling {&#x27;, &#x27;.join(uninstall_first)}..&quot;)
349	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;uninstall&#x27;, *uninstall_first])
350	        cstr(&quot;Installing package...&quot;).msg.print()
351	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;-q&#x27;, &#x27;install&#x27;, package])
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>349<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
333	def packages(versions=False):
334	    import sys
335	    import subprocess
336	    return [( r.decode().split(&#x27;==&#x27;)[0] if not versions else r.decode() ) for r in subprocess.check_output([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;freeze&#x27;]).split()]
337	
338	def install_package(package, uninstall_first: Union[List[str], str] = None):
339	    if os.getenv(&quot;WAS_BLOCK_AUTO_INSTALL&quot;, &#x27;False&#x27;).lower() in (&#x27;true&#x27;, &#x27;1&#x27;, &#x27;t&#x27;):
340	        cstr(f&quot;Preventing package install of &#x27;{package}&#x27; due to WAS_BLOCK_INSTALL env&quot;).msg.print()
341	    else:
342	        if uninstall_first is None:
343	            return
344	
345	        if isinstance(uninstall_first, str):
346	            uninstall_first = [uninstall_first]
347	
348	        cstr(f&quot;Uninstalling {&#x27;, &#x27;.join(uninstall_first)}..&quot;)
349	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;uninstall&#x27;, *uninstall_first])
350	        cstr(&quot;Installing package...&quot;).msg.print()
351	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;-q&#x27;, &#x27;install&#x27;, package])
352	
353	# Tensor to PIL
354	def tensor2pil(image):
355	    return Image.fromarray(np.clip(255. * image.cpu().numpy().squeeze(), 0, 255).astype(np.uint8))
356	
357	# PIL to Tensor
358	def pil2tensor(image):
359	    return torch.from_numpy(np.array(image).astype(np.float32) / 255.0).unsqueeze(0)
360	
361	# PIL Hex
362	def pil2hex(image):
363	    return hashlib.sha256(np.array(tensor2pil(image)).astype(np.uint16).tobytes()).hexdigest()
364	
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>351<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
335	    import subprocess
336	    return [( r.decode().split(&#x27;==&#x27;)[0] if not versions else r.decode() ) for r in subprocess.check_output([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;freeze&#x27;]).split()]
337	
338	def install_package(package, uninstall_first: Union[List[str], str] = None):
339	    if os.getenv(&quot;WAS_BLOCK_AUTO_INSTALL&quot;, &#x27;False&#x27;).lower() in (&#x27;true&#x27;, &#x27;1&#x27;, &#x27;t&#x27;):
340	        cstr(f&quot;Preventing package install of &#x27;{package}&#x27; due to WAS_BLOCK_INSTALL env&quot;).msg.print()
341	    else:
342	        if uninstall_first is None:
343	            return
344	
345	        if isinstance(uninstall_first, str):
346	            uninstall_first = [uninstall_first]
347	
348	        cstr(f&quot;Uninstalling {&#x27;, &#x27;.join(uninstall_first)}..&quot;)
349	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;uninstall&#x27;, *uninstall_first])
350	        cstr(&quot;Installing package...&quot;).msg.print()
351	        subprocess.check_call([sys.executable, &#x27;-s&#x27;, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;-q&#x27;, &#x27;install&#x27;, package])
352	
353	# Tensor to PIL
354	def tensor2pil(image):
355	    return Image.fromarray(np.clip(255. * image.cpu().numpy().squeeze(), 0, 255).astype(np.uint8))
356	
357	# PIL to Tensor
358	def pil2tensor(image):
359	    return torch.from_numpy(np.array(image).astype(np.float32) / 255.0).unsqueeze(0)
360	
361	# PIL Hex
362	def pil2hex(image):
363	    return hashlib.sha256(np.array(tensor2pil(image)).astype(np.uint16).tobytes()).hexdigest()
364	
365	# PIL to Mask
366	def pil2mask(image):
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>454<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
438	            sha256_hash.update(chunk)
439	    return sha256_hash.hexdigest()
440	
441	# Batch Seed Generator
442	def seed_batch(seed, batches, seeds):
443	    rng = np.random.default_rng(seed)
444	    btch = [rng.choice(2**32 - 1, seeds, replace=False).tolist() for _ in range(batches)]
445	    return btch
446	
447	# Download File
448	def download_file(url, filename=None, path=None):
449	    if not filename:
450	        filename = url.split(&#x27;/&#x27;)[-1]
451	    if not path:
452	        path = &#x27;.&#x27;
453	    save_path = os.path.join(path, filename)
454	    response = requests.get(url, stream=True)
455	    if response.status_code == requests.codes.ok:
456	        file_size = int(response.headers.get(&#x27;Content-Length&#x27;, 0))
457	        with open(save_path, &#x27;wb&#x27;) as file:
458	            with tqdm(total=file_size, unit=&#x27;B&#x27;, unit_scale=True, unit_divisor=1024) as progress:
459	                for chunk in response.iter_content(chunk_size=1024):
460	                    file.write(chunk)
461	                    progress.update(len(chunk))
462	        print(f&quot;Downloaded file saved at: {save_path}&quot;)
463	        return True
464	    elif response.status_code == requests.codes.not_found:
465	        cstr(&quot;Error: File not found.&quot;).error.print()
466	    else:
467	        cstr(f&quot;Error: Failed to download file. Status code: {response.status_code}&quot;).error.print()
468	    return False
469	
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>478<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
462	        print(f&quot;Downloaded file saved at: {save_path}&quot;)
463	        return True
464	    elif response.status_code == requests.codes.not_found:
465	        cstr(&quot;Error: File not found.&quot;).error.print()
466	    else:
467	        cstr(f&quot;Error: Failed to download file. Status code: {response.status_code}&quot;).error.print()
468	    return False
469	
470	# NSP Function
471	
472	def nsp_parse(text, seed=0, noodle_key=&#x27;__&#x27;, nspterminology=None, pantry_path=None):
473	    if nspterminology is None:
474	        # Fetch the NSP Pantry
475	        if pantry_path is None:
476	            pantry_path = DEFAULT_NSP_PANTRY_PATH
477	        if not os.path.exists(pantry_path):
478	            response = urlopen(&#x27;https://raw.githubusercontent.com/WASasquatch/noodle-soup-prompts/main/nsp_pantry.json&#x27;)
479	            tmp_pantry = json.loads(response.read())
480	            # Dump JSON locally
481	            pantry_serialized = json.dumps(tmp_pantry, indent=4)
482	            with open(pantry_path, &quot;w&quot;) as f:
483	                f.write(pantry_serialized)
484	            del response, tmp_pantry
485	
486	        # Load local pantry
487	        with open(pantry_path, &#x27;r&#x27;) as f:
488	            nspterminology = json.load(f)
489	
490	    if seed &gt; 0 or seed &lt; 0:
491	        random.seed(seed)
492	
493	    # Parse Text
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>7420<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
7404	
7405	        if &#x27;A&#x27; in i.getbands():
7406	            mask = np.array(i.getchannel(&#x27;A&#x27;)).astype(np.float32) / 255.0
7407	            mask = 1. - torch.from_numpy(mask)
7408	        else:
7409	            mask = torch.zeros((64, 64), dtype=torch.float32, device=&quot;cpu&quot;)
7410	
7411	        if filename_text_extension == &quot;true&quot;:
7412	            filename = os.path.basename(image_path)
7413	        else:
7414	            filename = os.path.splitext(os.path.basename(image_path))[0]
7415	
7416	        return (image, mask, filename)
7417	
7418	    def download_image(self, url):
7419	        try:
7420	            response = requests.get(url)
7421	            response.raise_for_status()
7422	            img = Image.open(BytesIO(response.content))
7423	            return img
7424	        except requests.exceptions.HTTPError as errh:
7425	            cstr(f&quot;HTTP Error: ({url}): {errh}&quot;).error.print()
7426	        except requests.exceptions.ConnectionError as errc:
7427	            cstr(f&quot;Connection Error: ({url}): {errc}&quot;).error.print()
7428	        except requests.exceptions.Timeout as errt:
7429	            cstr(f&quot;Timeout Error: ({url}): {errt}&quot;).error.print()
7430	        except requests.exceptions.RequestException as err:
7431	            cstr(f&quot;Request Exception: ({url}): {err}&quot;).error.print()
7432	
7433	    @classmethod
7434	    def IS_CHANGED(cls, image_path):
7435	        if image_path.startswith(&#x27;http&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>10932<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
10916	
10917	    RETURN_TYPES = (TEXT_TYPE,)
10918	    FUNCTION = &quot;random_prompt&quot;
10919	
10920	    CATEGORY = &quot;WAS Suite/Text&quot;
10921	
10922	    def random_prompt(self, search_seed=None):
10923	        if search_seed in [&#x27;&#x27;, &#x27; &#x27;]:
10924	            search_seed = None
10925	        return (self.search_lexica_art(search_seed), )
10926	
10927	    def search_lexica_art(self, query=None):
10928	        if not query:
10929	            query = random.choice([&quot;portrait&quot;,&quot;landscape&quot;,&quot;anime&quot;,&quot;superhero&quot;,&quot;animal&quot;,&quot;nature&quot;,&quot;scenery&quot;])
10930	        url = f&quot;https://lexica.art/api/v1/search?q={query}&quot;
10931	        try:
10932	            response = requests.get(url)
10933	            data = response.json()
10934	            images = data.get(&quot;images&quot;, [])
10935	            if not images:
10936	                return &quot;404 not found error&quot;
10937	            random_image = random.choice(images)
10938	            prompt = random_image.get(&quot;prompt&quot;)
10939	        except Exception:
10940	            cstr(&quot;Unable to establish connection to Lexica API.&quot;).error.print()
10941	            prompt = &quot;404 not found error&quot;
10942	
10943	        return prompt
10944	
10945	# BLIP Model Loader
10946	
10947	class WAS_BLIP_Model_Loader:
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>11370<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
11354	            install_package(&quot;gitpython&quot;)
11355	
11356	        if not os.path.exists(os.path.join(WAS_SUITE_ROOT, &#x27;repos&#x27;+os.sep+&#x27;SAM&#x27;)):
11357	            from git.repo.base import Repo
11358	            cstr(&quot;Installing SAM...&quot;).msg.print()
11359	            Repo.clone_from(&#x27;https://github.com/facebookresearch/segment-anything&#x27;, os.path.join(WAS_SUITE_ROOT, &#x27;repos&#x27;+os.sep+&#x27;SAM&#x27;))
11360	
11361	        sys.path.append(os.path.join(WAS_SUITE_ROOT, &#x27;repos&#x27;+os.sep+&#x27;SAM&#x27;))
11362	
11363	        sam_dir = os.path.join(MODELS_DIR, &#x27;sam&#x27;)
11364	        if not os.path.exists(sam_dir):
11365	            os.makedirs(sam_dir, exist_ok=True)
11366	
11367	        sam_file = os.path.join(sam_dir, model_filename)
11368	        if not os.path.exists(sam_file):
11369	            cstr(&quot;Selected SAM model not found. Downloading...&quot;).msg.print()
11370	            r = requests.get(model_url, allow_redirects=True)
11371	            open(sam_file, &#x27;wb&#x27;).write(r.content)
11372	
11373	        from segment_anything import build_sam_vit_h, build_sam_vit_l, build_sam_vit_b
11374	
11375	        if model_size == &#x27;ViT-H&#x27;:
11376	            sam_model = build_sam_vit_h(sam_file)
11377	        elif model_size == &#x27;ViT-L&#x27;:
11378	            sam_model = build_sam_vit_l(sam_file)
11379	        elif model_size == &#x27;ViT-B&#x27;:
11380	            sam_model = build_sam_vit_b(sam_file)
11381	        else:
11382	            raise ValueError(f&quot;SAM model does not match the model_size: &#x27;{model_size}&#x27;.&quot;)
11383	
11384	        return (sam_model, )
11385	
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="was-node-suite-comfyui/WAS_Node_Suite.py" target="_blank">was-node-suite-comfyui/WAS_Node_Suite.py</a><br>
    <b>Line number: </b>12000<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
11984	        url = &quot;https://api.random.org/json-rpc/2/invoke&quot;
11985	        headers = {&quot;Content-Type&quot;: &quot;application/json&quot;}
11986	        payload = {
11987	            &quot;jsonrpc&quot;: &quot;2.0&quot;,
11988	            &quot;method&quot;: &quot;generateIntegers&quot;,
11989	            &quot;params&quot;: {
11990	                &quot;apiKey&quot;: api_key,
11991	                &quot;n&quot;: amount,
11992	                &quot;min&quot;: minimum,
11993	                &quot;max&quot;: maximum,
11994	                &quot;replacement&quot;: True,
11995	                &quot;base&quot;: 10
11996	            },
11997	            &quot;id&quot;: 1
11998	        }
11999	
12000	        response = requests.post(url, headers=headers, data=json.dumps(payload))
12001	        if response.status_code == 200:
12002	            data = response.json()
12003	            if &quot;result&quot; in data:
12004	                return data[&quot;result&quot;][&quot;random&quot;][&quot;data&quot;], float(data[&quot;result&quot;][&quot;random&quot;][&quot;data&quot;]), int(data[&quot;result&quot;][&quot;random&quot;][&quot;data&quot;])
12005	
12006	        return [0]
12007	
12008	    @classmethod
12009	    def IS_CHANGED(cls, api_key, mode, **kwargs):
12010	        m = hashlib.sha256()
12011	        m.update(api_key)
12012	        if mode == &#x27;fixed&#x27;:
12013	            return m.digest().hex()
12014	        return float(&quot;NaN&quot;)
12015	
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
