
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">2452</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/ComfyUI-LivePortraitKJ/liveportrait/template_maker.py" target="_blank">/ComfyUI-LivePortraitKJ/liveportrait/template_maker.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	# coding: utf-8
2	
3	&quot;&quot;&quot;
4	Make video template
5	&quot;&quot;&quot;
6	
7	import os
8	import cv2
9	import numpy as np
10	import pickle
11	from tqdm import tqdm
12	from .utils.cropper import Cropper
13	
14	from .utils.io import load_driving_info
15	from .utils.camera import get_rotation_matrix
16	from .utils.helper import mkdir, basename
17	from .utils.rprint import rlog as log
18	from .config.crop_config import CropConfig
19	from .config.inference_config import InferenceConfig
20	from .live_portrait_wrapper import LivePortraitWrapper
21	
22	class TemplateMaker:
23	
24	    def __init__(self, inference_cfg: InferenceConfig, crop_cfg: CropConfig):
25	        self.live_portrait_wrapper: LivePortraitWrapper = LivePortraitWrapper(cfg=inference_cfg)
26	        self.cropper = Cropper(crop_cfg=crop_cfg)
27	
28	    def make_motion_template(self, video_fp: str, output_path: str, **kwargs):
29	        &quot;&quot;&quot; make video template (.pkl format)
30	        video_fp: driving video file path
31	        output_path: where to save the pickle file
32	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py" target="_blank">/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py</a><br>
    <b>Line number: </b>9<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	# coding: utf-8
2	
3	&quot;&quot;&quot;
4	functions for processing video
5	&quot;&quot;&quot;
6	
7	import os.path as osp
8	import numpy as np
9	import subprocess
10	import imageio
11	import cv2
12	
13	from tqdm import tqdm
14	from .helper import prefix
15	from .rprint import rprint as print
16	
17	
18	def exec_cmd(cmd):
19	    subprocess.run(cmd, shell=True, check=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
20	
21	
22	def images2video(images, wfp, **kwargs):
23	    fps = kwargs.get(&#x27;fps&#x27;, 30)
24	    video_format = kwargs.get(&#x27;format&#x27;, &#x27;mp4&#x27;)  # default is mp4 format
25	    codec = kwargs.get(&#x27;codec&#x27;, &#x27;libx264&#x27;)  # default is libx264 encoding
26	    quality = kwargs.get(&#x27;quality&#x27;)  # video quality
27	    pixelformat = kwargs.get(&#x27;pixelformat&#x27;, &#x27;yuv420p&#x27;)  # video pixel format
28	    image_mode = kwargs.get(&#x27;image_mode&#x27;, &#x27;rgb&#x27;)
29	    macro_block_size = kwargs.get(&#x27;macro_block_size&#x27;, 2)
30	    ffmpeg_params = [&#x27;-crf&#x27;, str(kwargs.get(&#x27;crf&#x27;, 18))]
31	
32	    writer = imageio.get_writer(
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py" target="_blank">/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py</a><br>
    <b>Line number: </b>19<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
3	&quot;&quot;&quot;
4	functions for processing video
5	&quot;&quot;&quot;
6	
7	import os.path as osp
8	import numpy as np
9	import subprocess
10	import imageio
11	import cv2
12	
13	from tqdm import tqdm
14	from .helper import prefix
15	from .rprint import rprint as print
16	
17	
18	def exec_cmd(cmd):
19	    subprocess.run(cmd, shell=True, check=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
20	
21	
22	def images2video(images, wfp, **kwargs):
23	    fps = kwargs.get(&#x27;fps&#x27;, 30)
24	    video_format = kwargs.get(&#x27;format&#x27;, &#x27;mp4&#x27;)  # default is mp4 format
25	    codec = kwargs.get(&#x27;codec&#x27;, &#x27;libx264&#x27;)  # default is libx264 encoding
26	    quality = kwargs.get(&#x27;quality&#x27;)  # video quality
27	    pixelformat = kwargs.get(&#x27;pixelformat&#x27;, &#x27;yuv420p&#x27;)  # video pixel format
28	    image_mode = kwargs.get(&#x27;image_mode&#x27;, &#x27;rgb&#x27;)
29	    macro_block_size = kwargs.get(&#x27;macro_block_size&#x27;, 2)
30	    ffmpeg_params = [&#x27;-crf&#x27;, str(kwargs.get(&#x27;crf&#x27;, 18))]
31	
32	    writer = imageio.get_writer(
33	        wfp, fps=fps, format=video_format,
34	        codec=codec, quality=quality, ffmpeg_params=ffmpeg_params, pixelformat=pixelformat, macro_block_size=macro_block_size
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py" target="_blank">/ComfyUI-LivePortraitKJ/liveportrait/utils/video.py</a><br>
    <b>Line number: </b>138<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
122	            self.writer.append_data(image)
123	
124	    def close(self):
125	        if self.writer is not None:
126	            self.writer.close()
127	
128	
129	def change_video_fps(input_file, output_file, fps=20, codec=&#x27;libx264&#x27;, crf=5):
130	    cmd = f&quot;ffmpeg -i {input_file} -c:v {codec} -crf {crf} -r {fps} {output_file} -y&quot;
131	    exec_cmd(cmd)
132	
133	
134	def get_fps(filepath):
135	    import ffmpeg
136	    probe = ffmpeg.probe(filepath)
137	    video_stream = next((stream for stream in probe[&#x27;streams&#x27;] if stream[&#x27;codec_type&#x27;] == &#x27;video&#x27;), None)
138	    fps = eval(video_stream[&#x27;avg_frame_rate&#x27;])
139	    return fps
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
