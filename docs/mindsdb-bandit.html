
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">115844</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/__main__.py" target="_blank">/mindsdb/mindsdb/__main__.py</a><br>
    <b>Line number: </b>161<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
145	
146	    mp.freeze_support()
147	    config = Config()
148	
149	    environment = config.get(&quot;environment&quot;)
150	    if environment == &quot;aws_marketplace&quot;:
151	        try:
152	            register_oauth_client()
153	        except Exception as e:
154	            logger.error(f&quot;Something went wrong during client register: {e}&quot;)
155	    elif environment != &quot;local&quot;:
156	        try:
157	            aws_meta_data = get_aws_meta_data()
158	            config.update({
159	                &#x27;aws_meta_data&#x27;: aws_meta_data
160	            })
161	        except Exception:
162	            pass
163	
164	    is_cloud = config.get(&quot;cloud&quot;, False)
165	
166	    if not is_cloud:
167	        logger.debug(&quot;Applying database migrations&quot;)
168	        try:
169	            from mindsdb.migrations import migrate
170	            migrate.migrate_to_head()
171	        except Exception as e:
172	            logger.error(f&quot;Error! Something went wrong during DB migrations: {e}&quot;)
173	
174	    if args.verbose is True:
175	        # Figure this one out later
176	        pass
177	
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/common/check_auth.py" target="_blank">/mindsdb/mindsdb/api/common/check_auth.py</a><br>
    <b>Line number: </b>13<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
1	import traceback
2	
3	from mindsdb.utilities import log
4	
5	logger = log.getLogger(__name__)
6	
7	
8	def check_auth(username, password, scramble_func, salt, company_id, config):
9	    try:
10	        hardcoded_user = config[&#x27;auth&#x27;].get(&#x27;username&#x27;)
11	        hardcoded_password = config[&#x27;auth&#x27;].get(&#x27;password&#x27;)
12	        if hardcoded_password is None:
13	            hardcoded_password = &#x27;&#x27;
14	        hardcoded_password_hash = scramble_func(hardcoded_password, salt)
15	        hardcoded_password = hardcoded_password.encode()
16	
17	        if password is None:
18	            password = &#x27;&#x27;
19	        if isinstance(password, str):
20	            password = password.encode()
21	
22	        if username != hardcoded_user:
23	            logger.warning(f&#x27;Check auth, user={username}: user mismatch&#x27;)
24	            return {
25	                &#x27;success&#x27;: False
26	            }
27	
28	        if password != hardcoded_password and password != hardcoded_password_hash:
29	            logger.warning(f&#x27;check auth, user={username}: password mismatch&#x27;)
30	            return {
31	                &#x27;success&#x27;: False
32	            }
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/common/check_auth.py" target="_blank">/mindsdb/mindsdb/api/common/check_auth.py</a><br>
    <b>Line number: </b>18<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
2	
3	from mindsdb.utilities import log
4	
5	logger = log.getLogger(__name__)
6	
7	
8	def check_auth(username, password, scramble_func, salt, company_id, config):
9	    try:
10	        hardcoded_user = config[&#x27;auth&#x27;].get(&#x27;username&#x27;)
11	        hardcoded_password = config[&#x27;auth&#x27;].get(&#x27;password&#x27;)
12	        if hardcoded_password is None:
13	            hardcoded_password = &#x27;&#x27;
14	        hardcoded_password_hash = scramble_func(hardcoded_password, salt)
15	        hardcoded_password = hardcoded_password.encode()
16	
17	        if password is None:
18	            password = &#x27;&#x27;
19	        if isinstance(password, str):
20	            password = password.encode()
21	
22	        if username != hardcoded_user:
23	            logger.warning(f&#x27;Check auth, user={username}: user mismatch&#x27;)
24	            return {
25	                &#x27;success&#x27;: False
26	            }
27	
28	        if password != hardcoded_password and password != hardcoded_password_hash:
29	            logger.warning(f&#x27;check auth, user={username}: password mismatch&#x27;)
30	            return {
31	                &#x27;success&#x27;: False
32	            }
33	
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/datahub/datanodes/integration_datanode.py" target="_blank">/mindsdb/mindsdb/api/executor/datahub/datanodes/integration_datanode.py</a><br>
    <b>Line number: </b>177<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
161	            return
162	
163	        insert_columns = [Identifier(parts=[x.alias]) for x in result_set.columns]
164	
165	        # adapt table types
166	        for col_idx, col in enumerate(result_set.columns):
167	            column_type = table_columns_meta[col.alias]
168	
169	            type_name = &#x27;str&#x27;
170	            if column_type == Integer:
171	                type_name = &#x27;int&#x27;
172	            elif column_type == Float:
173	                type_name = &#x27;float&#x27;
174	
175	            try:
176	                result_set.set_col_type(col_idx, type_name)
177	            except Exception:
178	                pass
179	
180	        values = result_set.to_lists()
181	
182	        if len(values) == 0:
183	            # not need to insert
184	            return
185	
186	        insert_ast = Insert(
187	            table=table_name,
188	            columns=insert_columns,
189	            values=values,
190	            is_plain=True
191	        )
192	
193	        try:
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/datahub/datanodes/project_datanode.py" target="_blank">/mindsdb/mindsdb/api/executor/datahub/datanodes/project_datanode.py</a><br>
    <b>Line number: </b>163<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
147	                return df, columns_info
148	
149	            kb_table = session.kb_controller.get_table(query_table, self.project.id)
150	            if kb_table:
151	                # this is the knowledge db
152	                df = kb_table.select_query(query)
153	                columns_info = [
154	                    {
155	                        &#x27;name&#x27;: k,
156	                        &#x27;type&#x27;: v
157	                    }
158	                    for k, v in df.dtypes.items()
159	                ]
160	
161	                return df, columns_info
162	
163	            raise EntityNotExistsError(f&quot;Can&#x27;t select from {query_table} in project&quot;)
164	        else:
165	            raise NotImplementedError(f&quot;Query not supported {query}&quot;)
166	
167	    def create_table(self, table_name: Identifier, result_set=None, is_replace=False, **kwargs):
168	        # is_create - create table
169	        # is_replace - drop table if exists
170	        # is_create==False and is_replace==False: just insert
171	
172	        from mindsdb.api.executor.controllers.session_controller import SessionController
173	        session = SessionController()
174	
175	        table_name = table_name.parts[-1]
176	        kb_table = session.kb_controller.get_table(table_name, self.project.id)
177	        if kb_table:
178	            # this is the knowledge db
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/sql_query/sql_query.py" target="_blank">/mindsdb/mindsdb/api/executor/sql_query/sql_query.py</a><br>
    <b>Line number: </b>152<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
136	                        &#x27;integration_name&#x27;: project_name,  # integration_name,
137	                        &#x27;timeseries&#x27;: False,
138	                        &#x27;id&#x27;: model[&#x27;id&#x27;],
139	                        &#x27;to_predict&#x27;: model[&#x27;predict&#x27;],
140	                    }
141	                    predictor_metadata.append(predictor)
142	
143	                continue
144	
145	            if model_record.status == &#x27;error&#x27;:
146	                dot_version_str = &#x27;&#x27;
147	                and_version_str = &#x27;&#x27;
148	                if table_version is not None:
149	                    dot_version_str = f&#x27;.{table_version}&#x27;
150	                    and_version_str = f&#x27; and version = {table_version}&#x27;
151	
152	                raise BadTableError(dedent(f&#x27;&#x27;&#x27;\
153	                    The model &#x27;{table_name}{dot_version_str}&#x27; cannot be used as it is currently in &#x27;error&#x27; status.
154	                    For detailed information about the error, please execute the following command:
155	
156	                        select error from information_schema.models where name = &#x27;{table_name}&#x27;{and_version_str};
157	                &#x27;&#x27;&#x27;))
158	
159	            ts_settings = model_record.learn_args.get(&#x27;timeseries_settings&#x27;, {})
160	            predictor = {
161	                &#x27;name&#x27;: table_name,
162	                &#x27;integration_name&#x27;: project_name,   # integration_name,
163	                &#x27;timeseries&#x27;: False,
164	                &#x27;id&#x27;: model_record.id,
165	                &#x27;to_predict&#x27;: model_record.to_predict,
166	            }
167	            if ts_settings.get(&#x27;is_timeseries&#x27;) is True:
168	                window = ts_settings.get(&#x27;window&#x27;)
169	                order_by = ts_settings.get(&#x27;order_by&#x27;)
170	                if isinstance(order_by, list):
171	                    order_by = order_by[0]
172	                group_by = ts_settings.get(&#x27;group_by&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/sql_query/steps/join_step.py" target="_blank">/mindsdb/mindsdb/api/executor/sql_query/steps/join_step.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
54	                    return Identifier(parts=[&#x27;table_a&#x27;, col_name])
55	
56	                cols = right_data.find_columns(alias, table_alias)
57	                if len(cols) == 1:
58	                    col_name = cols[0].get_hash_name(prefix=&#x27;B&#x27;)
59	                    return Identifier(parts=[&#x27;table_b&#x27;, col_name])
60	
61	            if step.query.condition is None:
62	                raise NotSupportedYet(&#x27;Unable to join table without condition&#x27;)
63	
64	            condition = copy.deepcopy(step.query.condition)
65	            query_traversal(condition, adapt_condition)
66	
67	            join_condition = SqlalchemyRender(&#x27;postgres&#x27;).get_string(condition)
68	            join_type = step.query.join_type
69	
70	        query = f&quot;&quot;&quot;
71	                       SELECT * FROM table_a {join_type} table_b
72	                       ON {join_condition}
73	                   &quot;&quot;&quot;
74	        resp_df, _description = query_df_with_type_infer_fallback(query, {
75	            &#x27;table_a&#x27;: table_a,
76	            &#x27;table_b&#x27;: table_b
77	        })
78	
79	        resp_df = resp_df.replace({np.nan: None})
80	
81	        names_a.update(names_b)
82	        data = ResultSet().from_df_cols(resp_df, col_names=names_a)
83	
84	        for col in data.find_columns(&#x27;__mindsdb_row_id&#x27;):
85	            data.del_column(col)
86	
87	        return data
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/utilities/functions.py" target="_blank">/mindsdb/mindsdb/api/executor/utilities/functions.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
17	#         return None
18	#     return candidates[0]
19	
20	
21	def download_file(url):
22	    try:
23	        parse_result = urllib.parse.urlparse(url)
24	        scheme = parse_result.scheme
25	    except ValueError:
26	        raise Exception(f&#x27;Invalid url: {url}&#x27;)
27	    except Exception as e:
28	        raise Exception(f&#x27;URL parsing error: {e}&#x27;)
29	    temp_dir = tempfile.mkdtemp(prefix=&#x27;mindsdb_file_download_&#x27;)
30	    if scheme == &#x27;&#x27;:
31	        raise Exception(f&quot;Unknown url schema: {url}&quot;)
32	
33	    response = requests.get(url)
34	    temp_file_path = Path(temp_dir).joinpath(&#x27;file&#x27;)
35	    with open(str(temp_file_path), &#x27;wb&#x27;)as file:
36	        file.write(response.content)
37	    return str(temp_file_path)
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/executor/utilities/sql.py" target="_blank">/mindsdb/mindsdb/api/executor/utilities/sql.py</a><br>
    <b>Line number: </b>160<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
144	                    node.args.append(0)
145	            elif fnc_name == &#x27;json_extract&#x27;:
146	                json_columns.add(node.args[0].parts[-1])
147	            else:
148	                if user_functions is not None:
149	                    user_functions.check_function(node)
150	
151	    query_traversal(query_ast, adapt_query)
152	
153	    # convert json columns
154	    encoder = CustomJSONEncoder()
155	
156	    def _convert(v):
157	        if isinstance(v, dict) or isinstance(v, list):
158	            try:
159	                return encoder.encode(v)
160	            except Exception:
161	                pass
162	        return v
163	    for column in json_columns:
164	        df[column] = df[column].apply(_convert)
165	
166	    render = SqlalchemyRender(&#x27;postgres&#x27;)
167	    try:
168	        query_str = render.get_string(query_ast, with_failback=False)
169	    except Exception as e:
170	        logger.error(
171	            f&quot;Exception during query casting to &#x27;postgres&#x27; dialect. Query: {str(query)}. Error: {e}&quot;
172	        )
173	        query_str = render.get_string(query_ast, with_failback=True)
174	
175	    # workaround to prevent duckdb.TypeMismatchException
176	    if len(df) &gt; 0:
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/gui.py" target="_blank">/mindsdb/mindsdb/api/http/gui.py</a><br>
    <b>Line number: </b>24<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
8	
9	from mindsdb.utilities.config import Config
10	from mindsdb.utilities import log
11	
12	logger = log.getLogger(__name__)
13	
14	
15	def download_gui(destignation, version):
16	    if isinstance(destignation, str):
17	        destignation = Path(destignation)
18	    dist_zip_path = str(destignation.joinpath(&quot;dist.zip&quot;))
19	    bucket = &quot;https://mindsdb-web-builds.s3.amazonaws.com/&quot;
20	
21	    resources = [{&quot;url&quot;: bucket + &quot;dist-V&quot; + version + &quot;.zip&quot;, &quot;path&quot;: dist_zip_path}]
22	
23	    def get_resources(resource):
24	        response = requests.get(resource[&quot;url&quot;])
25	        if response.status_code != requests.status_codes.codes.ok:
26	            raise Exception(f&quot;Error {response.status_code} GET {resource[&#x27;url&#x27;]}&quot;)
27	        open(resource[&quot;path&quot;], &quot;wb&quot;).write(response.content)
28	
29	    try:
30	        for r in resources:
31	            get_resources(r)
32	    except Exception as e:
33	        logger.error(f&quot;Error during downloading files from s3: {e}&quot;)
34	        return False
35	
36	    static_folder = destignation
37	    static_folder.mkdir(mode=0o777, exist_ok=True, parents=True)
38	    ZipFile(dist_zip_path).extractall(static_folder)
39	
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/initialize.py" target="_blank">/mindsdb/mindsdb/api/http/initialize.py</a><br>
    <b>Line number: </b>366<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
350	    api = Swagger_Api(
351	        app,
352	        authorizations=authorizations,
353	        security=[&#x27;apikey&#x27;],
354	        url_prefix=&#x27;:8000&#x27;,
355	        prefix=&#x27;/api&#x27;,
356	        doc=&#x27;/doc/&#x27;
357	    )
358	
359	    api.representations[&#x27;application/json&#x27;] = custom_output_json
360	
361	    port = config[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;port&#x27;]
362	    host = config[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;host&#x27;]
363	
364	    # NOTE rewrite it, that hotfix to see GUI link
365	    if not no_studio:
366	        if host in (&quot;&quot;, &quot;0.0.0.0&quot;):
367	            url = f&quot;http://127.0.0.1:{port}/&quot;
368	        else:
369	            url = f&quot;http://{host}:{port}/&quot;
370	        logger.info(f&quot; - GUI available at {url}&quot;)
371	
372	        pid = os.getpid()
373	        x = threading.Thread(target=_open_webbrowser, args=(url, pid, port, init_static_thread, config[&#x27;paths&#x27;][&#x27;static&#x27;]), daemon=True)
374	        x.start()
375	
376	    return app, api
377	
378	
379	def initialize_interfaces(app):
380	    app.integration_controller = integration_controller
381	    app.database_controller = DatabaseController()
</pre>
</div>


</div>
</div>

<div id="issue-11">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/namespaces/auth.py" target="_blank">/mindsdb/mindsdb/api/http/namespaces/auth.py</a><br>
    <b>Line number: </b>80<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
64	        config = Config()
65	        code = request.args.get(&quot;code&quot;)
66	
67	        aws_meta_data = config[&quot;aws_meta_data&quot;]
68	        public_hostname = aws_meta_data[&quot;public-hostname&quot;]
69	        instance_id = aws_meta_data[&quot;instance-id&quot;]
70	
71	        oauth_meta = config[&quot;auth&quot;][&quot;oauth&quot;]
72	        client_id = oauth_meta[&quot;client_id&quot;]
73	        client_secret = oauth_meta[&quot;client_secret&quot;]
74	        auth_server = oauth_meta[&quot;server_host&quot;]
75	        client_basic = base64.b64encode(
76	            f&quot;{client_id}:{client_secret}&quot;.encode()
77	        ).decode()
78	
79	        redirect_uri = f&quot;https://{public_hostname}{request.path}&quot;
80	        response = requests.post(
81	            f&quot;https://{auth_server}/auth/token&quot;,
82	            data={
83	                &quot;code&quot;: code,
84	                &quot;grant_type&quot;: &quot;authorization_code&quot;,
85	                &quot;redirect_uri&quot;: redirect_uri,
86	            },
87	            headers={&quot;Authorization&quot;: f&quot;Basic {client_basic}&quot;},
88	        )
89	        tokens = response.json()
90	        if &quot;expires_in&quot; in tokens:
91	            tokens[&quot;expires_at&quot;] = round(time.time() + tokens[&quot;expires_in&quot;] - 1)
92	            del tokens[&quot;expires_in&quot;]
93	
94	        user_data = request_user_info(tokens[&quot;access_token&quot;])
95	
96	        previous_username = config[&quot;auth&quot;][&quot;oauth&quot;].get(&quot;username&quot;)
97	        new_username = user_data[&quot;name&quot;]
98	        if previous_username is not None and new_username != previous_username:
99	            return redirect(&quot;/forbidden&quot;)
100	
101	        config.update(
102	            {
103	                &quot;auth&quot;: {
</pre>
</div>


</div>
</div>

<div id="issue-12">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/namespaces/file.py" target="_blank">/mindsdb/mindsdb/api/http/namespaces/file.py</a><br>
    <b>Line number: </b>110<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
94	                &quot;File already exists&quot;,
95	                f&quot;File with name &#x27;{data[&#x27;file&#x27;]}&#x27; already exists&quot;,
96	            )
97	
98	        if data.get(&quot;source_type&quot;) == &quot;url&quot;:
99	            url = data[&quot;source&quot;]
100	            data[&quot;file&quot;] = clear_filename(data[&quot;name&quot;])
101	
102	            config = Config()
103	            is_cloud = config.get(&quot;cloud&quot;, False)
104	            if is_cloud and is_private_url(url):
105	                return http_error(
106	                    400, f&#x27;URL is private: {url}&#x27;
107	                )
108	
109	            if is_cloud is True and ctx.user_class != 1:
110	                info = requests.head(url)
111	                file_size = info.headers.get(&quot;Content-Length&quot;)
112	                try:
113	                    file_size = int(file_size)
114	                except Exception:
115	                    pass
116	
117	                if file_size is None:
118	                    return http_error(
119	                        400,
120	                        &quot;Error getting file info&quot;,
121	                        &quot;Сan&#x27;t determine remote file size&quot;,
122	                    )
123	                if file_size &gt; 1024 * 1024 * 100:
124	                    return http_error(
125	                        400, &quot;File is too big&quot;, &quot;Upload limit for file is 100Mb&quot;
</pre>
</div>


</div>
</div>

<div id="issue-13">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/namespaces/file.py" target="_blank">/mindsdb/mindsdb/api/http/namespaces/file.py</a><br>
    <b>Line number: </b>114<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
98	        if data.get(&quot;source_type&quot;) == &quot;url&quot;:
99	            url = data[&quot;source&quot;]
100	            data[&quot;file&quot;] = clear_filename(data[&quot;name&quot;])
101	
102	            config = Config()
103	            is_cloud = config.get(&quot;cloud&quot;, False)
104	            if is_cloud and is_private_url(url):
105	                return http_error(
106	                    400, f&#x27;URL is private: {url}&#x27;
107	                )
108	
109	            if is_cloud is True and ctx.user_class != 1:
110	                info = requests.head(url)
111	                file_size = info.headers.get(&quot;Content-Length&quot;)
112	                try:
113	                    file_size = int(file_size)
114	                except Exception:
115	                    pass
116	
117	                if file_size is None:
118	                    return http_error(
119	                        400,
120	                        &quot;Error getting file info&quot;,
121	                        &quot;Сan&#x27;t determine remote file size&quot;,
122	                    )
123	                if file_size &gt; 1024 * 1024 * 100:
124	                    return http_error(
125	                        400, &quot;File is too big&quot;, &quot;Upload limit for file is 100Mb&quot;
126	                    )
127	            with requests.get(url, stream=True) as r:
128	                if r.status_code != 200:
129	                    return http_error(
130	                        400, &quot;Error getting file&quot;, f&quot;Got status code: {r.status_code}&quot;
</pre>
</div>


</div>
</div>

<div id="issue-14">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/namespaces/file.py" target="_blank">/mindsdb/mindsdb/api/http/namespaces/file.py</a><br>
    <b>Line number: </b>127<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
111	                file_size = info.headers.get(&quot;Content-Length&quot;)
112	                try:
113	                    file_size = int(file_size)
114	                except Exception:
115	                    pass
116	
117	                if file_size is None:
118	                    return http_error(
119	                        400,
120	                        &quot;Error getting file info&quot;,
121	                        &quot;Сan&#x27;t determine remote file size&quot;,
122	                    )
123	                if file_size &gt; 1024 * 1024 * 100:
124	                    return http_error(
125	                        400, &quot;File is too big&quot;, &quot;Upload limit for file is 100Mb&quot;
126	                    )
127	            with requests.get(url, stream=True) as r:
128	                if r.status_code != 200:
129	                    return http_error(
130	                        400, &quot;Error getting file&quot;, f&quot;Got status code: {r.status_code}&quot;
131	                    )
132	                file_path = os.path.join(temp_dir_path, data[&quot;file&quot;])
133	                with open(file_path, &quot;wb&quot;) as f:
134	                    for chunk in r.iter_content(chunk_size=8192):
135	                        f.write(chunk)
136	
137	        original_file_name = clear_filename(data.get(&quot;original_file_name&quot;))
138	
139	        file_path = os.path.join(temp_dir_path, data[&quot;file&quot;])
140	        lp = file_path.lower()
141	        if lp.endswith((&quot;.zip&quot;, &quot;.tar.gz&quot;)):
142	            if lp.endswith(&quot;.zip&quot;):
</pre>
</div>


</div>
</div>

<div id="issue-15">
<div class="issue-block issue-sev-high">
    <b>tarfile_unsafe_members: </b> tarfile.extractall used without any validation. Please check and discard dangerous members.<br>
    <b>Test ID:</b> B202<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/namespaces/file.py" target="_blank">/mindsdb/mindsdb/api/http/namespaces/file.py</a><br>
    <b>Line number: </b>144<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b202_tarfile_unsafe_members.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b202_tarfile_unsafe_members.html</a><br>

<div class="code">
<pre>
128	                if r.status_code != 200:
129	                    return http_error(
130	                        400, &quot;Error getting file&quot;, f&quot;Got status code: {r.status_code}&quot;
131	                    )
132	                file_path = os.path.join(temp_dir_path, data[&quot;file&quot;])
133	                with open(file_path, &quot;wb&quot;) as f:
134	                    for chunk in r.iter_content(chunk_size=8192):
135	                        f.write(chunk)
136	
137	        original_file_name = clear_filename(data.get(&quot;original_file_name&quot;))
138	
139	        file_path = os.path.join(temp_dir_path, data[&quot;file&quot;])
140	        lp = file_path.lower()
141	        if lp.endswith((&quot;.zip&quot;, &quot;.tar.gz&quot;)):
142	            if lp.endswith(&quot;.zip&quot;):
143	                with zipfile.ZipFile(file_path) as f:
144	                    f.extractall(temp_dir_path)
145	            elif lp.endswith(&quot;.tar.gz&quot;):
146	                with tarfile.open(file_path) as f:
147	                    safe_extract(f, temp_dir_path)
148	            os.remove(file_path)
149	            files = os.listdir(temp_dir_path)
150	            if len(files) != 1:
151	                os.rmdir(temp_dir_path)
152	                return http_error(
153	                    400, &quot;Wrong content.&quot;, &quot;Archive must contain only one data file.&quot;
154	                )
155	            file_path = os.path.join(temp_dir_path, files[0])
156	            mindsdb_file_name = files[0]
157	            if not os.path.isfile(file_path):
158	                os.rmdir(temp_dir_path)
159	                return http_error(
</pre>
</div>


</div>
</div>

<div id="issue-16">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/http/start.py" target="_blank">/mindsdb/mindsdb/api/http/start.py</a><br>
    <b>Line number: </b>39<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
23	    server = os.environ.get(&#x27;MINDSDB_DEFAULT_SERVER&#x27;, &#x27;waitress&#x27;)
24	    db.init()
25	    init_lexer_parsers()
26	
27	    if app is None:
28	        app = initialize_app(config, no_studio)
29	
30	    port = config[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;port&#x27;]
31	    host = config[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;host&#x27;]
32	
33	    process_cache.init()
34	
35	    if server.lower() == &quot;waitress&quot;:
36	        logger.debug(&quot;Serving HTTP app with waitress..&quot;)
37	        serve(
38	            app,
39	            host=&#x27;*&#x27; if host in (&#x27;&#x27;, &#x27;0.0.0.0&#x27;) else host,
40	            port=port,
41	            threads=16,
42	            max_request_body_size=1073741824 * 10,
43	            inbuf_overflow=1073741824 * 10
44	        )
45	    elif server.lower() == &quot;flask&quot;:
46	        logger.debug(&quot;Serving HTTP app with flask..&quot;)
47	        # that will &#x27;disable access&#x27; log in console
48	
49	        app.run(debug=False, port=port, host=host)
50	    elif server.lower() == &#x27;gunicorn&#x27;:
51	        try:
52	            from mindsdb.api.http.gunicorn_wrapper import StandaloneApplication
53	        except ImportError:
54	            logger.error(
</pre>
</div>


</div>
</div>

<div id="issue-17">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/mongo/responders/insert.py" target="_blank">/mindsdb/mindsdb/api/mongo/responders/insert.py</a><br>
    <b>Line number: </b>203<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
187	                    # TODO implement group modifiers
188	                    ast_query = find_to_ast(
189	                        query, request_env.get(&quot;database&quot;, &quot;mindsdb&quot;)
190	                    )
191	
192	                    # to string
193	                    query_str = ast_query.to_string()
194	                elif method == &quot;aggregate&quot;:
195	                    query = {
196	                        &quot;aggregate&quot;: mql.collection,
197	                        &quot;pipeline&quot;: mql.pipeline[0][&quot;args&quot;][0],
198	                    }
199	                    ast_query = aggregate_to_ast(
200	                        query, request_env.get(&quot;database&quot;, &quot;mindsdb&quot;)
201	                    )
202	                    query_str = ast_query.to_string()
203	            except Exception:
204	                # keep query
205	                pass
206	
207	            repeat_str = doc.get(&quot;schedule_str&quot;).lower().lstrip(&quot;every &quot;)
208	
209	            ast_query = CreateJob(
210	                name=Identifier(doc[&quot;name&quot;]),
211	                start_str=doc.get(&quot;start_at&quot;),
212	                end_str=doc.get(&quot;end_at&quot;),
213	                query_str=query_str,
214	                repeat_str=repeat_str,
215	            )
216	            run_sql_command(request_env, ast_query)
217	
218	    def _insert_ml_engine(self, query, request_env, mindsdb_env):
219	        for doc in query[&quot;documents&quot;]:
220	
</pre>
</div>


</div>
</div>

<div id="issue-18">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py" target="_blank">/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py</a><br>
    <b>Line number: </b>97<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
81	from mindsdb.utilities.context import context as ctx
82	from mindsdb.utilities.wizards import make_ssl_cert
83	
84	logger = log.getLogger(__name__)
85	
86	
87	def empty_fn():
88	    pass
89	
90	
91	def check_auth(username, password, scramble_func, salt, company_id, config):
92	    &quot;&quot;&quot; &quot;&quot;&quot;
93	    try:
94	        hardcoded_user = config[&quot;auth&quot;].get(&quot;username&quot;)
95	        hardcoded_password = config[&quot;auth&quot;].get(&quot;password&quot;)
96	        if hardcoded_password is None:
97	            hardcoded_password = &quot;&quot;
98	        hardcoded_password_hash = scramble_func(hardcoded_password, salt)
99	        hardcoded_password = hardcoded_password.encode()
100	
101	        if password is None:
102	            password = &quot;&quot;
103	        if isinstance(password, str):
104	            password = password.encode()
105	
106	        if username != hardcoded_user:
107	            logger.warning(f&quot;Check auth, user={username}: user mismatch&quot;)
108	            return {&quot;success&quot;: False}
109	
110	        if password != hardcoded_password and password != hardcoded_password_hash:
111	            logger.warning(f&quot;check auth, user={username}: password mismatch&quot;)
112	            return {&quot;success&quot;: False}
</pre>
</div>


</div>
</div>

<div id="issue-19">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py" target="_blank">/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py</a><br>
    <b>Line number: </b>102<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
86	
87	def empty_fn():
88	    pass
89	
90	
91	def check_auth(username, password, scramble_func, salt, company_id, config):
92	    &quot;&quot;&quot; &quot;&quot;&quot;
93	    try:
94	        hardcoded_user = config[&quot;auth&quot;].get(&quot;username&quot;)
95	        hardcoded_password = config[&quot;auth&quot;].get(&quot;password&quot;)
96	        if hardcoded_password is None:
97	            hardcoded_password = &quot;&quot;
98	        hardcoded_password_hash = scramble_func(hardcoded_password, salt)
99	        hardcoded_password = hardcoded_password.encode()
100	
101	        if password is None:
102	            password = &quot;&quot;
103	        if isinstance(password, str):
104	            password = password.encode()
105	
106	        if username != hardcoded_user:
107	            logger.warning(f&quot;Check auth, user={username}: user mismatch&quot;)
108	            return {&quot;success&quot;: False}
109	
110	        if password != hardcoded_password and password != hardcoded_password_hash:
111	            logger.warning(f&quot;check auth, user={username}: password mismatch&quot;)
112	            return {&quot;success&quot;: False}
113	
114	        logger.info(f&quot;Check auth, user={username}: Ok&quot;)
115	        return {&quot;success&quot;: True, &quot;username&quot;: username}
116	    except Exception as e:
117	        logger.error(f&quot;Check auth, user={username}: ERROR&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-20">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py" target="_blank">/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py</a><br>
    <b>Line number: </b>283<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
267	                    )
268	                    self.packet(
269	                        ErrPacket,
270	                        err_code=ERR.ER_PASSWORD_NO_MATCH,
271	                        msg=&quot;caching_sha2_password without SSL not supported&quot;,
272	                    ).send()
273	                    return False
274	
275	                logger.debug(
276	                    f&quot;Check auth, user={username}, ssl={self.session.is_ssl}, auth_method={client_auth_plugin}: &quot;
277	                    f&quot;switch auth method to {new_method}&quot;
278	                )
279	                password = switch_auth(new_method)
280	
281	                if new_method == &quot;caching_sha2_password&quot;:
282	                    if password == b&quot;\x00&quot;:
283	                        password = &quot;&quot;
284	                    else:
285	                        password = get_fast_auth_password()
286	        elif &quot;caching_sha2_password&quot; in client_auth_plugin:
287	            logger.debug(
288	                f&quot;Check auth, user={username}, ssl={self.session.is_ssl}, auth_method={client_auth_plugin}: &quot;
289	                &quot;check auth using caching_sha2_password&quot;
290	            )
291	            password = handshake_resp.enc_password.value
292	            if password == b&quot;\x00&quot;:
293	                password = &quot;&quot;
294	            else:
295	                # FIXME https://github.com/mindsdb/mindsdb/issues/1374
296	                # if self.session.is_ssl:
297	                #     password = get_fast_auth_password()
298	                # else:
</pre>
</div>


</div>
</div>

<div id="issue-21">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py" target="_blank">/mindsdb/mindsdb/api/mysql/mysql_proxy/mysql_proxy.py</a><br>
    <b>Line number: </b>293<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
277	                    f&quot;switch auth method to {new_method}&quot;
278	                )
279	                password = switch_auth(new_method)
280	
281	                if new_method == &quot;caching_sha2_password&quot;:
282	                    if password == b&quot;\x00&quot;:
283	                        password = &quot;&quot;
284	                    else:
285	                        password = get_fast_auth_password()
286	        elif &quot;caching_sha2_password&quot; in client_auth_plugin:
287	            logger.debug(
288	                f&quot;Check auth, user={username}, ssl={self.session.is_ssl}, auth_method={client_auth_plugin}: &quot;
289	                &quot;check auth using caching_sha2_password&quot;
290	            )
291	            password = handshake_resp.enc_password.value
292	            if password == b&quot;\x00&quot;:
293	                password = &quot;&quot;
294	            else:
295	                # FIXME https://github.com/mindsdb/mindsdb/issues/1374
296	                # if self.session.is_ssl:
297	                #     password = get_fast_auth_password()
298	                # else:
299	                password = switch_auth()
300	        elif &quot;mysql_native_password&quot; in client_auth_plugin:
301	            logger.debug(
302	                f&quot;Check auth, user={username}, ssl={self.session.is_ssl}, auth_method={client_auth_plugin}: &quot;
303	                &quot;check auth using mysql_native_password&quot;
304	            )
305	            password = handshake_resp.enc_password.value
306	        else:
307	            logger.debug(
308	                f&quot;Check auth, user={username}, ssl={self.session.is_ssl}, auth_method={client_auth_plugin}: &quot;
</pre>
</div>


</div>
</div>

<div id="issue-22">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/api/postgres/postgres_proxy/postgres_proxy.py" target="_blank">/mindsdb/mindsdb/api/postgres/postgres_proxy/postgres_proxy.py</a><br>
    <b>Line number: </b>308<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
292	    def send(self, message: PostgresMessage):
293	        self.logger.debug(&quot;Sending message of type %s&quot; % message.__class__.__name__)
294	        message.send(self.wfile)
295	
296	    def handshake(self):
297	        self.client_buffer.read_verify_ssl_request()
298	        # self.send(NoticeResponse()) -- Should Probably not send. Looks in protocol manual to be sent for warning
299	        self.logger.debug(&quot;Sending No to SSL Request&quot;)
300	        PostgresPacketBuilder().write_char(b&#x27;N&#x27;, self.wfile)
301	        self.user_parameters = self.client_buffer.read_startup_message()
302	
303	    def authenticate(self, ask_for_password=False):
304	        if ask_for_password:
305	            self.send(AuthenticationClearTextPassword())
306	            password = self.client_buffer.read_authentication(encoding=self.charset)
307	        else:
308	            password = &#x27;&#x27;
309	        username = self.user_parameters[b&#x27;user&#x27;].decode(encoding=self.charset)
310	        auth_data = self.server.check_auth(username, password, scramble_func, self.salt, ctx.company_id)
311	        if auth_data[&#x27;success&#x27;]:
312	            self.logger.debug(&quot;Authentication succeeded&quot;)
313	            self.session.username = auth_data[&#x27;username&#x27;]
314	            self.session.auth = True
315	            self.send(AuthenticationOk())
316	            return True
317	        else:
318	            if not ask_for_password:  # try asking for password
319	                return self.authenticate(ask_for_password=True)
320	            self.logger.debug(&quot;Authentication failed&quot;)
321	            self.send(ConnectionFailure(message=&quot;Authentication failed.&quot;))
322	            return False
323	
</pre>
</div>


</div>
</div>

<div id="issue-23">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'demo_password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/aerospike_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/aerospike_handler/connection_args.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
24	        &#x27;label&#x27;: &#x27;Host&#x27;
25	    },
26	    port={
27	        &#x27;type&#x27;: ARG_TYPE.INT,
28	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Aerospike server. Must be an integer.&#x27;,
29	        &#x27;required&#x27;: True,
30	        &#x27;label&#x27;: &#x27;Port&#x27;
31	    },
32	    namespace={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;The namespace name to use for the query in the Aerospike server.&#x27;,
35	        &#x27;required&#x27;: True,
36	        &#x27;label&#x27;: &#x27;namespace&#x27;
37	    }
38	)
39	
40	connection_args_example = OrderedDict(
41	    user=&quot;demo_user&quot;,
42	    password=&quot;demo_password&quot;,
43	    host=&#x27;127.0.0.1&#x27;,
44	    port=3000,
45	    namespace=&quot;demo&quot;,
46	)
</pre>
</div>


</div>
</div>

<div id="issue-24">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/airtable_handler/airtable_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/airtable_handler/airtable_handler.py</a><br>
    <b>Line number: </b>62<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
46	        if self.is_connected is True:
47	            self.disconnect()
48	
49	    def connect(self) -&gt; StatusResponse:
50	        &quot;&quot;&quot;
51	        Set up the connection required by the handler.
52	        Returns:
53	            HandlerStatusResponse
54	        &quot;&quot;&quot;
55	
56	        if self.is_connected is True:
57	            return self.connection
58	
59	        url = f&quot;https://api.airtable.com/v0/{self.connection_data[&#x27;base_id&#x27;]}/{self.connection_data[&#x27;table_name&#x27;]}&quot;
60	        headers = {&quot;Authorization&quot;: &quot;Bearer &quot; + self.connection_data[&#x27;api_key&#x27;]}
61	
62	        response = requests.get(url, headers=headers)
63	        response = response.json()
64	        records = response[&#x27;records&#x27;]
65	
66	        new_records = True
67	        while new_records:
68	            try:
69	                if response[&#x27;offset&#x27;]:
70	                    params = {&quot;offset&quot;: response[&#x27;offset&#x27;]}
71	                    response = requests.get(url, params=params, headers=headers)
72	                    response = response.json()
73	
74	                    new_records = response[&#x27;records&#x27;]
75	                    records = records + new_records
76	            except Exception:
77	                new_records = False
</pre>
</div>


</div>
</div>

<div id="issue-25">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/airtable_handler/airtable_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/airtable_handler/airtable_handler.py</a><br>
    <b>Line number: </b>71<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
55	
56	        if self.is_connected is True:
57	            return self.connection
58	
59	        url = f&quot;https://api.airtable.com/v0/{self.connection_data[&#x27;base_id&#x27;]}/{self.connection_data[&#x27;table_name&#x27;]}&quot;
60	        headers = {&quot;Authorization&quot;: &quot;Bearer &quot; + self.connection_data[&#x27;api_key&#x27;]}
61	
62	        response = requests.get(url, headers=headers)
63	        response = response.json()
64	        records = response[&#x27;records&#x27;]
65	
66	        new_records = True
67	        while new_records:
68	            try:
69	                if response[&#x27;offset&#x27;]:
70	                    params = {&quot;offset&quot;: response[&#x27;offset&#x27;]}
71	                    response = requests.get(url, params=params, headers=headers)
72	                    response = response.json()
73	
74	                    new_records = response[&#x27;records&#x27;]
75	                    records = records + new_records
76	            except Exception:
77	                new_records = False
78	
79	        rows = [record[&#x27;fields&#x27;] for record in records]
80	        globals()[self.connection_data[&#x27;table_name&#x27;]] = pd.DataFrame(rows)
81	
82	        self.connection = duckdb.connect()
83	        self.is_connected = True
84	
85	        return self.connection
86	
</pre>
</div>


</div>
</div>

<div id="issue-26">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/altibase_handler/altibase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/altibase_handler/altibase_handler.py</a><br>
    <b>Line number: </b>238<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
222	                TABLE_TYPE 
223	            FROM 
224	                system_.sys_tables_ 
225	            WHERE 
226	                user_id = USER_ID();
227	            &#x27;&#x27;&#x27;
228	
229	        return self.native_query(query)
230	
231	    def get_columns(self, table_name: str) -&gt; Response:
232	        &quot;&quot;&quot; Returns a list of entity columns
233	        Args:
234	            table_name (str): name of one of tables returned by self.get_tables()
235	        Returns:
236	            HandlerResponse
237	        &quot;&quot;&quot;
238	        query = f&quot;&quot;&quot;
239	            SELECT 
240	                COLUMN_NAME, 
241	                DATA_TYPE 
242	            FROM 
243	                system_.sys_columns_ ct 
244	            inner join 
245	                system_.sys_tables_ tt 
246	                on ct.table_id=tt.table_id 
247	            where 
248	                tt.table_name = &#x27;{table_name.capitalize()}&#x27;;
249	            &quot;&quot;&quot;
250	        
251	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-27">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'manager'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/altibase_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/altibase_handler/connection_args.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Altibase server.&#x27;
27	    },
28	    jdbcClass = {
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The driver class of the Altibase JDBC driver&#x27;
31	    },
32	    jdbcJarLocation = {
33	        &#x27;type&#x27;: ARG_TYPE.PATH,
34	        &#x27;description&#x27;: &#x27;The location of the Altibase JDBC driver jar file&#x27;
35	    },
36	    dsn = {
37	        &#x27;type&#x27;: ARG_TYPE.STR,
38	        &#x27;description&#x27;: &#x27;Datasource name of the Altibase server. NOTE: use dsn if you want to use an ODBC connection.&#x27;
39	    }
40	)
41	
42	connection_args_example = OrderedDict(
43	    host = &#x27;127.0.0.1&#x27;,
44	    port = 20300,
45	    user = &#x27;sys&#x27;,
46	    password = &#x27;manager&#x27;,
47	    database = &#x27;mydb&#x27;,
48	    jdbcClass=&#x27;Altibase.jdbc.driver.AltibaseDriver&#x27;,
49	    jdbcJarLocation=&#x27;/data/altibase_home/lib/Altibase.jar&#x27;
50	)
</pre>
</div>


</div>
</div>

<div id="issue-28">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/aqicn_handler/aqicn.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/aqicn_handler/aqicn.py</a><br>
    <b>Line number: </b>11<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
1	import requests
2	
3	
4	class AQIClient:
5	    def __init__(self, api_key):
6	        self.api_key = api_key
7	        self.params = {&quot;token&quot;: api_key}
8	        self.base_endpoint = &quot;https://api.waqi.info/feed&quot;
9	
10	    def make_request(self, url):
11	        resp = requests.get(url, params=self.params)
12	        res = resp.json()
13	        content = {}
14	        if res[&quot;status&quot;] == &quot;ok&quot;:
15	            content = {&#x27;content&#x27;: resp.json(), &#x27;code&#x27;: 200}
16	        else:
17	            content = {&#x27;content&#x27;: resp.json(), &#x27;code&#x27;: 404}
18	        return content
19	
20	    def air_quality_city(self, city):
21	        url = f&#x27;{self.base_endpoint}/{city}/&#x27;
22	        return self.make_request(url)
23	
24	    def air_quality_lat_lng(self, lat, lng):
25	        url = f&#x27;{self.base_endpoint}/geo:{lat};{lng}/&#x27;
26	        return self.make_request(url)
27	
28	    def air_quality_user_location(self):
29	        url = f&#x27;{self.base_endpoint}/here/&#x27;
30	        return self.make_request(url)
</pre>
</div>


</div>
</div>

<div id="issue-29">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/athena_handler/athena_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/athena_handler/athena_handler.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
156	        &quot;&quot;&quot;
157	        return self.native_query(query)
158	
159	    def get_columns(self, table_name: str) -&gt; StatusResponse:
160	        &quot;&quot;&quot;
161	        Returns a list of entity columns.
162	        Args:
163	            table_name (str): name of one of tables returned by self.get_tables()
164	        Returns:
165	            Response: A response object containing the column details
166	        Raises:
167	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
168	        &quot;&quot;&quot;
169	        if not table_name or not isinstance(table_name, str):
170	            raise ValueError(&quot;Invalid value for table name provided.&quot;)
171	
172	        query = f&quot;&quot;&quot;
173	            select
174	                column_name as &quot;Field&quot;,
175	                data_type as &quot;Type&quot;
176	            from
177	                information_schema.columns
178	            where
179	                table_name = &#x27;{table_name}&#x27;
180	        &quot;&quot;&quot;
181	        return self.native_query(query)
182	
183	    def _wait_for_query_to_complete(self, query_execution_id: str) -&gt; str:
184	        &quot;&quot;&quot;
185	        Wait for the Athena query to complete.
186	        Args:
187	            query_execution_id (str): ID of the query to wait for
188	        Returns:
189	            str: Query execution status
190	        &quot;&quot;&quot;
191	        while True:
192	            response = self.connection.get_query_execution(QueryExecutionId=query_execution_id)
193	            status = response[&#x27;QueryExecution&#x27;][&#x27;Status&#x27;][&#x27;State&#x27;]
194	            if status in [&#x27;SUCCEEDED&#x27;, &#x27;FAILED&#x27;, &#x27;CANCELLED&#x27;]:
195	                return status
</pre>
</div>


</div>
</div>

<div id="issue-30">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<default>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/athena_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/athena_handler/connection_args.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;The Athena Workgroup&#x27;
27	    },
28	    catalog={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The AWS Data Catalog&#x27;
31	    },
32	    results_output_location={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;The Athena Query Results Output Location s3://bucket-path/athena-query-results&#x27;
35	    },
36	    check_interval={
37	        &#x27;type&#x27;: ARG_TYPE.INT,
38	        &#x27;description&#x27;: &#x27;The interval in seconds to check Athena for query results. Default is 0 seconds.&#x27;
39	    }
40	)
41	
42	connection_args_example = OrderedDict(
43	    aws_access_key_id=&#x27;&lt;default&gt;&#x27;,
44	    aws_secret_access_key=&#x27;&lt;default&gt;&#x27;,
45	    region_name=&#x27;us-east-1&#x27;,
46	    catalog=&#x27;AwsDataCatalog&#x27;,
47	    database=&#x27;default&#x27;,
48	    workgroup=&#x27;primary&#x27;,
49	    results_output_location=&#x27;s3://&lt;bucket&gt;/athena-query-results/&#x27;,
50	    check_interval=0
51	)
</pre>
</div>


</div>
</div>

<div id="issue-31">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'aws_secret_access_key'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/athena_handler/tests/test_athena_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/athena_handler/tests/test_athena_handler.py</a><br>
    <b>Line number: </b>21<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
5	
6	
7	class CursorContextManager(Mock):
8	    def __enter__(self):
9	        return self
10	
11	    def __exit__(self, *args):
12	        pass
13	
14	    description = [[&#x27;a&#x27;]]
15	
16	    def fetchall(self):
17	        return [[1]]
18	
19	
20	class AthenaHandlerTest(unittest.TestCase):
21	    dummy_connection_data = OrderedDict(
22	        aws_access_key_id=&#x27;aws_access_key_id&#x27;,
23	        aws_secret_access_key=&#x27;aws_secret_access_key&#x27;,
24	        region_name=&#x27;us-east-1&#x27;,
25	        database=&#x27;default&#x27;,
26	        workgroup=&#x27;my_workgroup&#x27;,
27	        catalog=&#x27;AwsDataCatalog&#x27;,
28	        results_output_location=&#x27;s3://bucket-path/athena-query-results&#x27;,
29	        check_interval=0
30	    )
31	
32	    def setUp(self):
33	        self.patcher = patch(&#x27;boto3.client&#x27;)
34	        self.mock_client = self.patcher.start()
35	        self.mock_client.return_value = MagicMock()
36	        self.handler = AthenaHandler(&#x27;athena&#x27;, connection_data=self.dummy_connection_data)
37	
38	    def tearDown(self):
39	        self.patcher.stop()
40	
41	    def test_connect_success(self):
42	        connection = self.handler.connect()
43	        self.assertIsNotNone(connection)
44	        self.assertTrue(self.handler.is_connected)
45	
</pre>
</div>


</div>
</div>

<div id="issue-32">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/athena_handler/tests/test_athena_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/athena_handler/tests/test_athena_handler.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
36	        self.handler = AthenaHandler(&#x27;athena&#x27;, connection_data=self.dummy_connection_data)
37	
38	    def tearDown(self):
39	        self.patcher.stop()
40	
41	    def test_connect_success(self):
42	        connection = self.handler.connect()
43	        self.assertIsNotNone(connection)
44	        self.assertTrue(self.handler.is_connected)
45	
46	    def test_get_columns(self):
47	        self.handler.native_query = MagicMock()
48	
49	        table_name = &quot;mock_table&quot;
50	        self.handler.get_columns(table_name)
51	
52	        expected_query = f&quot;&quot;&quot;
53	            select
54	                column_name as &quot;Field&quot;,
55	                data_type as &quot;Type&quot;
56	            from
57	                information_schema.columns
58	            where
59	                table_name = &#x27;{table_name}&#x27;
60	        &quot;&quot;&quot;
61	
62	        self.handler.native_query.assert_called_once_with(expected_query)
63	
64	    def test_get_tables(self):
65	        self.handler.native_query = MagicMock()
66	
67	        self.handler.get_tables()
68	
69	        expected_query = &quot;&quot;&quot;
70	            select
71	                table_schema,
72	                table_name,
73	                table_type
74	            from
75	                information_schema.tables
</pre>
</div>


</div>
</div>

<div id="issue-33">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/aurora_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/aurora_handler/connection_args.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
27	    },
28	    db_engine={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &quot;The database engine of the Amazon Aurora DB cluster. This can take one of two values: &#x27;mysql&#x27; or &#x27;postgresql&#x27;. This parameter is optional, but if it is not provided, &#x27;aws_access_key_id&#x27; and &#x27;aws_secret_access_key&#x27; parameters must be provided&quot;
31	    },
32	    aws_access_key_id={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &quot;The access key for the AWS account. This parameter is optional and is only required to be provided if the &#x27;db_engine&#x27; parameter is not provided.&quot;
35	    },
36	    aws_secret_access_key={
37	        &#x27;type&#x27;: ARG_TYPE.STR,
38	        &#x27;description&#x27;: &quot;The secret key for the AWS account. This parameter is optional and is only required to be provided if the &#x27;db_engine&#x27; parameter is not provided.&quot;,
39	        &#x27;secret&#x27;: True
40	    },
41	)
42	
43	connection_args_example = OrderedDict(
44	    db_engine=&#x27;mysql&#x27;,
45	    host=&#x27;mysqlcluster.cluster-123456789012.us-east-1.rds.amazonaws.com&#x27;,
46	    port=3306,
47	    user=&#x27;root&#x27;,
48	    password=&#x27;password&#x27;,
49	    database=&#x27;database&#x27;
50	)
</pre>
</div>


</div>
</div>

<div id="issue-34">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/autogluon_handler/autogluon_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/autogluon_handler/autogluon_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Optional
2	
3	import dill
4	import pandas as pd
5	
6	from autogluon.tabular import TabularPredictor
7	from type_infer.api import infer_types
8	
9	from mindsdb.integrations.libs.base import BaseMLEngine
10	from mindsdb.utilities import log
11	from .config import ClassificationConfig, RegressionConfig
12	
13	
14	logger = log.getLogger(__name__)
15	
16	
17	class AutoGluonHandler(BaseMLEngine):
18	    name = &quot;autogluon&quot;
19	
20	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[dict] = None) -&gt; None:
21	        config_args = args[&#x27;using&#x27;]
22	
23	        target_dtype = infer_types(df, 0).to_dict()[&quot;dtypes&quot;][target]
24	
25	        if target_dtype in [&#x27;binary&#x27;, &#x27;categorical&#x27;, &#x27;tags&#x27;]:
26	            config = ClassificationConfig(**config_args)
27	
28	            model = TabularPredictor(label=target, )
29	        elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
30	            config = RegressionConfig(**config_args)
31	
32	            model = TabularPredictor(label=target)
</pre>
</div>


</div>
</div>

<div id="issue-35">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/autogluon_handler/autogluon_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/autogluon_handler/autogluon_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
26	            config = ClassificationConfig(**config_args)
27	
28	            model = TabularPredictor(label=target, )
29	        elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
30	            config = RegressionConfig(**config_args)
31	
32	            model = TabularPredictor(label=target)
33	
34	        else:
35	            raise Exception(&#x27;This task is not supported!&#x27;)
36	
37	        model.fit(df, **vars(config))
38	        self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model))
39	        self.model_storage.json_set(&#x27;args&#x27;, args)
40	
41	    def predict(self, df: Optional[pd.DataFrame] = None, args: Optional[dict] = None) -&gt; None:
42	        model = dill.loads(self.model_storage.file_get(&#x27;model&#x27;))
43	        df = df.drop(&#x27;__mindsdb_row_id&#x27;, axis=1)
44	
45	        predictions = model.predict(df)
46	
47	        args = self.model_storage.json_get(&#x27;args&#x27;)
48	        df[args[&#x27;target&#x27;]] = predictions
49	
50	        return df
51	
52	    def describe(self, attribute: Optional[str] = None) -&gt; pd.DataFrame:
53	
54	        args = self.model_storage.json_get(&quot;args&quot;)
55	
56	        if attribute == &quot;args&quot;:
57	            return pd.DataFrame(args.items(), columns=[&quot;key&quot;, &quot;value&quot;])
</pre>
</div>


</div>
</div>

<div id="issue-36">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/autosklearn_handler/autosklearn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/autosklearn_handler/autosklearn_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Optional, Dict
2	
3	import dill
4	import pandas as pd
5	from type_infer.api import infer_types
6	import autosklearn.classification as automl_classification
7	import autosklearn.regression as automl_regression
8	
9	from .config import ClassificationConfig, RegressionConfig
10	
11	from mindsdb.integrations.libs.base import BaseMLEngine
12	
13	
14	class AutoSklearnHandler(BaseMLEngine):
15	    &quot;&quot;&quot;
16	    Integration with the Auto-Sklearn ML library.
17	    &quot;&quot;&quot;
18	
19	    name = &#x27;autosklearn&#x27;
20	
21	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[dict] = None) -&gt; None:
22	        config_args = args[&#x27;using&#x27;]
23	
24	        target_dtype = infer_types(df, 0).to_dict()[&quot;dtypes&quot;][target]
25	
26	        if target_dtype in [&#x27;binary&#x27;, &#x27;categorical&#x27;, &#x27;tags&#x27;]:
27	            config = ClassificationConfig(**config_args)
28	
29	            model = automl_classification.AutoSklearnClassifier(**vars(config))
30	
31	        elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
32	            config = RegressionConfig(**config_args)
</pre>
</div>


</div>
</div>

<div id="issue-37">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/autosklearn_handler/autosklearn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/autosklearn_handler/autosklearn_handler.py</a><br>
    <b>Line number: </b>45<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
29	            model = automl_classification.AutoSklearnClassifier(**vars(config))
30	
31	        elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
32	            config = RegressionConfig(**config_args)
33	
34	            model = automl_regression.AutoSklearnRegressor(**vars(config))
35	
36	        else:
37	            raise Exception(&#x27;This task is not supported!&#x27;)
38	
39	        model.fit(df.drop(target, axis=1), df[target])
40	
41	        self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model))
42	        self.model_storage.json_set(&#x27;args&#x27;, args)
43	
44	    def predict(self, df: Optional[pd.DataFrame] = None, args: Optional[dict] = None) -&gt; None:
45	        model = dill.loads(self.model_storage.file_get(&#x27;model&#x27;))
46	        df = df.drop(&#x27;__mindsdb_row_id&#x27;, axis=1)
47	
48	        predictions = model.predict(df)
49	
50	        args = self.model_storage.json_get(&#x27;args&#x27;)
51	        df[args[&#x27;target&#x27;]] = predictions
52	
53	        return df
</pre>
</div>


</div>
</div>

<div id="issue-38">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py</a><br>
    <b>Line number: </b>155<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
139	            query (ASTNode): An ASTNode representing the SQL query to be executed.
140	
141	        Returns:
142	            Response: The response from the `native_query` method, containing the result of the SQL query execution.
143	        &quot;&quot;&quot;
144	        renderer = SqlalchemyRender(BigQueryDialect)
145	        query_str = renderer.get_string(query, with_failback=True)
146	        return self.native_query(query_str)
147	
148	    def get_tables(self) -&gt; Response:
149	        &quot;&quot;&quot;
150	        Retrieves a list of all non-system tables and views in the configured dataset of the BigQuery warehouse.
151	
152	        Returns:
153	            Response: A response object containing the list of tables and views, formatted as per the `Response` class.
154	        &quot;&quot;&quot;
155	        query = f&quot;&quot;&quot;
156	            SELECT table_name, table_schema, table_type
157	            FROM `{self.connection_data[&#x27;project_id&#x27;]}.{self.connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.TABLES`
158	            WHERE table_type IN (&#x27;BASE TABLE&#x27;, &#x27;VIEW&#x27;)
159	        &quot;&quot;&quot;
160	        result = self.native_query(query)
161	        return result
162	
163	    def get_columns(self, table_name) -&gt; Response:
164	        &quot;&quot;&quot;
165	        Retrieves column details for a specified table in the configured dataset of the BigQuery warehouse.
166	
167	        Args:
168	            table_name (str): The name of the table for which to retrieve column information.
169	
170	        Returns:
171	            Response: A response object containing the column details, formatted as per the `Response` class.
172	        Raises:
173	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
174	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-39">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/bigquery_handler/bigquery_handler.py</a><br>
    <b>Line number: </b>175<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
159	        &quot;&quot;&quot;
160	        result = self.native_query(query)
161	        return result
162	
163	    def get_columns(self, table_name) -&gt; Response:
164	        &quot;&quot;&quot;
165	        Retrieves column details for a specified table in the configured dataset of the BigQuery warehouse.
166	
167	        Args:
168	            table_name (str): The name of the table for which to retrieve column information.
169	
170	        Returns:
171	            Response: A response object containing the column details, formatted as per the `Response` class.
172	        Raises:
173	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
174	        &quot;&quot;&quot;
175	        query = f&quot;&quot;&quot;
176	            SELECT column_name AS Field, data_type as Type
177	            FROM `{self.connection_data[&#x27;project_id&#x27;]}.{self.connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.COLUMNS`
178	            WHERE table_name = &#x27;{table_name}&#x27;
179	        &quot;&quot;&quot;
180	        result = self.native_query(query)
181	        return result
</pre>
</div>


</div>
</div>

<div id="issue-40">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>15<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	&quot;&quot;&quot; BYOM: Bring Your Own Model
2	
3	env vars to contloll BYOM:
4	 - MINDSDB_BYOM_ENABLED - can BYOM be uysed or not. Locally enabled by default.
5	 - MINDSDB_BYOM_INHOUSE_ENABLED - enable or disable &#x27;inhouse&#x27; BYOM usage. Locally enabled by default.
6	 - MINDSDB_BYOM_DEFAULT_TYPE - [inhouse|venv] default byom type. Locally it is &#x27;venv&#x27; by default.
7	 - MINDSDB_BYOM_TYPE - [safe|unsafe] - obsolete, same as above.
8	&quot;&quot;&quot;
9	
10	
11	import os
12	import re
13	import sys
14	import shutil
15	import pickle
16	import tarfile
17	import tempfile
18	import traceback
19	import subprocess
20	from enum import Enum
21	from pathlib import Path
22	from datetime import datetime
23	from typing import Optional, Dict, Union
24	
25	import pandas as pd
26	from pandas.api import types as pd_types
27	
28	from mindsdb.utilities import log
29	from mindsdb.utilities.config import Config
30	from mindsdb.utilities.fs import safe_extract
31	from mindsdb.interfaces.storage import db
32	from mindsdb.integrations.libs.base import BaseMLEngine
</pre>
</div>


</div>
</div>

<div id="issue-41">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>19<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
3	env vars to contloll BYOM:
4	 - MINDSDB_BYOM_ENABLED - can BYOM be uysed or not. Locally enabled by default.
5	 - MINDSDB_BYOM_INHOUSE_ENABLED - enable or disable &#x27;inhouse&#x27; BYOM usage. Locally enabled by default.
6	 - MINDSDB_BYOM_DEFAULT_TYPE - [inhouse|venv] default byom type. Locally it is &#x27;venv&#x27; by default.
7	 - MINDSDB_BYOM_TYPE - [safe|unsafe] - obsolete, same as above.
8	&quot;&quot;&quot;
9	
10	
11	import os
12	import re
13	import sys
14	import shutil
15	import pickle
16	import tarfile
17	import tempfile
18	import traceback
19	import subprocess
20	from enum import Enum
21	from pathlib import Path
22	from datetime import datetime
23	from typing import Optional, Dict, Union
24	
25	import pandas as pd
26	from pandas.api import types as pd_types
27	
28	from mindsdb.utilities import log
29	from mindsdb.utilities.config import Config
30	from mindsdb.utilities.fs import safe_extract
31	from mindsdb.interfaces.storage import db
32	from mindsdb.integrations.libs.base import BaseMLEngine
33	from mindsdb.integrations.libs.const import PREDICTOR_STATUS
34	from mindsdb.integrations.utilities.utils import format_exception_error
</pre>
</div>


</div>
</div>

<div id="issue-42">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>420<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
404	
405	class ModelWrapperUnsafe:
406	    &quot;&quot;&quot; Model wrapper that executes learn/predict in current process
407	    &quot;&quot;&quot;
408	
409	    def __init__(self, code, modules_str, engine_id, engine_version: int):
410	        module = import_string(code)
411	        model_class = find_model_class(module)
412	        self.model_class = model_class
413	        self.model_instance = self.model_class()
414	
415	    def train(self, df, target, args):
416	        self.model_instance.train(df, target, args)
417	        return pickle.dumps(self.model_instance.__dict__, protocol=5)
418	
419	    def predict(self, df, model_state, args):
420	        model_state = pickle.loads(model_state)
421	        self.model_instance.__dict__ = model_state
422	        try:
423	            result = self.model_instance.predict(df, args)
424	        except Exception:
425	            result = self.model_instance.predict(df)
426	        return result
427	
428	    def finetune(self, df, model_state, args):
429	        self.model_instance.__dict__ = pickle.loads(model_state)
430	
431	        call_args = [df]
432	        if args:
433	            call_args.append(args)
434	
435	        self.model_instance.finetune(df, args)
</pre>
</div>


</div>
</div>

<div id="issue-43">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>429<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
413	        self.model_instance = self.model_class()
414	
415	    def train(self, df, target, args):
416	        self.model_instance.train(df, target, args)
417	        return pickle.dumps(self.model_instance.__dict__, protocol=5)
418	
419	    def predict(self, df, model_state, args):
420	        model_state = pickle.loads(model_state)
421	        self.model_instance.__dict__ = model_state
422	        try:
423	            result = self.model_instance.predict(df, args)
424	        except Exception:
425	            result = self.model_instance.predict(df)
426	        return result
427	
428	    def finetune(self, df, model_state, args):
429	        self.model_instance.__dict__ = pickle.loads(model_state)
430	
431	        call_args = [df]
432	        if args:
433	            call_args.append(args)
434	
435	        self.model_instance.finetune(df, args)
436	
437	        return pickle.dumps(self.model_instance.__dict__, protocol=5)
438	
439	    def describe(self, model_state, attribute: Optional[str] = None) -&gt; pd.DataFrame:
440	        if hasattr(self.model_instance, &#x27;describe&#x27;):
441	            model_state = pickle.loads(model_state)
442	            self.model_instance.__dict__ = model_state
443	            return self.model_instance.describe(attribute)
444	        return pd.DataFrame()
</pre>
</div>


</div>
</div>

<div id="issue-44">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>441<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
425	            result = self.model_instance.predict(df)
426	        return result
427	
428	    def finetune(self, df, model_state, args):
429	        self.model_instance.__dict__ = pickle.loads(model_state)
430	
431	        call_args = [df]
432	        if args:
433	            call_args.append(args)
434	
435	        self.model_instance.finetune(df, args)
436	
437	        return pickle.dumps(self.model_instance.__dict__, protocol=5)
438	
439	    def describe(self, model_state, attribute: Optional[str] = None) -&gt; pd.DataFrame:
440	        if hasattr(self.model_instance, &#x27;describe&#x27;):
441	            model_state = pickle.loads(model_state)
442	            self.model_instance.__dict__ = model_state
443	            return self.model_instance.describe(attribute)
444	        return pd.DataFrame()
445	
446	    def func_call(self, func_name, args):
447	
448	        func = getattr(self.model_instance, func_name)
449	        return func(*args)
450	
451	    def check(self):
452	        methods = get_methods_info(self.model_instance)
453	        return methods
454	
455	
456	class ModelWrapperSafe:
</pre>
</div>


</div>
</div>

<div id="issue-45">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>538<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
522	            if self.is_cloud:
523	                raise
524	
525	            self.python_path = Path(sys.executable)
526	
527	            # try to install modules everytime
528	            self.install_modules(modules, pip_cmd=pip_cmd)
529	
530	        # fastest way to copy files if destination is NFS
531	        if self.is_cloud and self.env_storage_path != self.env_path:
532	            old_cwd = os.getcwd()
533	            os.chdir(str(bese_env_path))
534	            tar_path = self.env_path.with_suffix(&#x27;.tar&#x27;)
535	            with tarfile.open(name=str(tar_path), mode=&#x27;w&#x27;) as tar:
536	                tar.add(str(self.env_path.name))
537	            os.chdir(old_cwd)
538	            subprocess.run(
539	                [&#x27;cp&#x27;, &#x27;-R&#x27;, &#x27;--no-preserve=mode,ownership&#x27;, str(tar_path), str(base_path / tar_path.name)],
540	                check=True, shell=False
541	            )
542	            tar_path.unlink()
543	
544	    def remove_venv(self):
545	        if self.env_path is not None and self.env_path.exists():
546	            shutil.rmtree(str(self.env_path))
547	
548	        if self.is_cloud:
549	            tar_path = self.env_storage_path.with_suffix(&#x27;.tar&#x27;)
550	            tar_path.unlink()
551	
552	    def parse_requirements(self, requirements):
553	        # get requirements from string
554	        # they should be located at the top of the file, before code
555	
556	        pattern = &#x27;^[\w\\[\\]-]+[=!&lt;&gt;\s]*[\d\.]*[,=!&lt;&gt;\s]*[\d\.]*$&#x27;  # noqa
</pre>
</div>


</div>
</div>

<div id="issue-46">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>540<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
524	
525	            self.python_path = Path(sys.executable)
526	
527	            # try to install modules everytime
528	            self.install_modules(modules, pip_cmd=pip_cmd)
529	
530	        # fastest way to copy files if destination is NFS
531	        if self.is_cloud and self.env_storage_path != self.env_path:
532	            old_cwd = os.getcwd()
533	            os.chdir(str(bese_env_path))
534	            tar_path = self.env_path.with_suffix(&#x27;.tar&#x27;)
535	            with tarfile.open(name=str(tar_path), mode=&#x27;w&#x27;) as tar:
536	                tar.add(str(self.env_path.name))
537	            os.chdir(old_cwd)
538	            subprocess.run(
539	                [&#x27;cp&#x27;, &#x27;-R&#x27;, &#x27;--no-preserve=mode,ownership&#x27;, str(tar_path), str(base_path / tar_path.name)],
540	                check=True, shell=False
541	            )
542	            tar_path.unlink()
543	
544	    def remove_venv(self):
545	        if self.env_path is not None and self.env_path.exists():
546	            shutil.rmtree(str(self.env_path))
547	
548	        if self.is_cloud:
549	            tar_path = self.env_storage_path.with_suffix(&#x27;.tar&#x27;)
550	            tar_path.unlink()
551	
552	    def parse_requirements(self, requirements):
553	        # get requirements from string
554	        # they should be located at the top of the file, before code
555	
556	        pattern = &#x27;^[\w\\[\\]-]+[=!&lt;&gt;\s]*[\d\.]*[,=!&lt;&gt;\s]*[\d\.]*$&#x27;  # noqa
557	        modules = []
558	        for line in requirements.split(b&#x27;\n&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-47">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>578<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
562	                    modules.append(line)
563	                else:
564	                    raise Exception(f&#x27;Wrong requirement: {line}&#x27;)
565	
566	        is_pandas = any([m.lower().startswith(&#x27;pandas&#x27;) for m in modules])
567	        if not is_pandas:
568	            modules.append(&#x27;pandas &gt;=2.0.0, &lt;2.1.0&#x27;)
569	
570	        # for dataframe serialization
571	        modules.append(&#x27;pyarrow==14.0.1&#x27;)
572	        return modules
573	
574	    def install_modules(self, modules, pip_cmd):
575	        # install in current environment using pip
576	        for module in modules:
577	            logger.debug(f&quot;BYOM install module: {module}&quot;)
578	            p = subprocess.Popen([pip_cmd, &#x27;install&#x27;, module], stderr=subprocess.PIPE)
579	            p.wait()
580	            if p.returncode != 0:
581	                raise Exception(f&#x27;Problem with installing module {module}: {p.stderr.read()}&#x27;)
582	
583	    def _run_command(self, params):
584	        logger.debug(f&quot;BYOM run command: {params.get(&#x27;method&#x27;)}&quot;)
585	        params_enc = encode(params)
586	
587	        wrapper_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), &#x27;proc_wrapper.py&#x27;)
588	        p = subprocess.Popen(
589	            [str(self.python_path), wrapper_path],
590	            stdin=subprocess.PIPE,
591	            stdout=subprocess.PIPE,
592	            stderr=subprocess.PIPE,
593	        )
</pre>
</div>


</div>
</div>

<div id="issue-48">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/byom_handler.py</a><br>
    <b>Line number: </b>588<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
572	        return modules
573	
574	    def install_modules(self, modules, pip_cmd):
575	        # install in current environment using pip
576	        for module in modules:
577	            logger.debug(f&quot;BYOM install module: {module}&quot;)
578	            p = subprocess.Popen([pip_cmd, &#x27;install&#x27;, module], stderr=subprocess.PIPE)
579	            p.wait()
580	            if p.returncode != 0:
581	                raise Exception(f&#x27;Problem with installing module {module}: {p.stderr.read()}&#x27;)
582	
583	    def _run_command(self, params):
584	        logger.debug(f&quot;BYOM run command: {params.get(&#x27;method&#x27;)}&quot;)
585	        params_enc = encode(params)
586	
587	        wrapper_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), &#x27;proc_wrapper.py&#x27;)
588	        p = subprocess.Popen(
589	            [str(self.python_path), wrapper_path],
590	            stdin=subprocess.PIPE,
591	            stdout=subprocess.PIPE,
592	            stderr=subprocess.PIPE,
593	        )
594	
595	        p.stdin.write(params_enc)
596	        p.stdin.close()
597	        ret_enc = p.stdout.read()
598	
599	        p.wait()
600	
601	        try:
602	            ret = decode(ret_enc)
603	        except (pickle.UnpicklingError, EOFError):
604	            raise RuntimeError(p.stderr.read())
605	        return ret
606	
607	    def check(self):
608	        params = {
</pre>
</div>


</div>
</div>

<div id="issue-49">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
7	    - Wrap and run python code in separate python proceess.
8	    - Communicate with parent process throughout stdin/out using pickle to serialize objects.
9	
10	
11	The flow is as follows:
12	
13	    1. Receive module code, method with parameters and stored attributes from parent process
14	    2. A python class object is created from the code
15	    3. Class is instanced and filled with stored attributes
16	    4. A calls to the chosen method of the class is performed with any relevant parameters that were passed
17	    5. Response is generated, appropriately packaged and sent to stdout
18	    6. Exit
19	&quot;&quot;&quot;
20	
21	import io
22	import sys
23	import pickle
24	import inspect
25	from enum import Enum
26	
27	import pandas as pd
28	
29	
30	class BYOM_METHOD(Enum):
31	    CHECK = 1
32	    TRAIN = 2
33	    PREDICT = 3
34	    FINETUNE = 4
35	    DESCRIBE = 5
36	    FUNC_CALL = 6
37	
38	
</pre>
</div>


</div>
</div>

<div id="issue-50">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py</a><br>
    <b>Line number: </b>55<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
39	def pd_encode(df):
40	    return df.to_parquet(engine=&#x27;pyarrow&#x27;)
41	
42	
43	def pd_decode(encoded):
44	    fd = io.BytesIO()
45	    fd.write(encoded)
46	    fd.seek(0)
47	    return pd.read_parquet(fd, engine=&#x27;pyarrow&#x27;)
48	
49	
50	def encode(obj):
51	    return pickle.dumps(obj, protocol=5)
52	
53	
54	def decode(encoded):
55	    return pickle.loads(encoded)
56	
57	
58	def return_output(obj):
59	    # read stdin
60	    encoded = encode(obj)
61	    with open(1, &#x27;wb&#x27;) as fd:
62	        fd.write(encoded)
63	    sys.exit(0)
64	
65	
66	def get_input():
67	    # write to stdout
68	    with open(0, &#x27;rb&#x27;) as fd:
69	        encoded = fd.read()
70	        obj = decode(encoded)
</pre>
</div>


</div>
</div>

<div id="issue-51">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/byom_handler/proc_wrapper.py</a><br>
    <b>Line number: </b>80<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
64	
65	
66	def get_input():
67	    # write to stdout
68	    with open(0, &#x27;rb&#x27;) as fd:
69	        encoded = fd.read()
70	        obj = decode(encoded)
71	    return obj
72	
73	
74	def import_string(code, module_name=&#x27;model&#x27;):
75	    # import string as python module
76	
77	    import types
78	    module = types.ModuleType(module_name)
79	
80	    exec(code, module.__dict__)
81	    # sys.modules[&#x27;my_module&#x27;] = module
82	    return module
83	
84	
85	def find_model_class(module):
86	    # find the first class that contents predict and train methods
87	    for _, klass in inspect.getmembers(module, inspect.isclass):
88	        funcs = [
89	            name
90	            for name, _ in inspect.getmembers(klass, inspect.isfunction)
91	        ]
92	        if &#x27;predict&#x27; in funcs and &#x27;train&#x27; in funcs:
93	            return klass
94	    raise RuntimeError(&#x27;Unable to find model class (has to have `train` and `predict` methods)&#x27;)
95	
</pre>
</div>


</div>
</div>

<div id="issue-52">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/chromadb_handler/chromadb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/chromadb_handler/chromadb_handler.py</a><br>
    <b>Line number: </b>332<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
316	        return pd.DataFrame(payload)
317	
318	    def insert(self, table_name: str, data: pd.DataFrame):
319	        &quot;&quot;&quot;
320	        Insert data into the ChromaDB database.
321	        &quot;&quot;&quot;
322	
323	        collection = self._client.get_or_create_collection(name=table_name)
324	
325	        # drop columns with all None values
326	
327	        data.dropna(axis=1, inplace=True)
328	
329	        # ensure metadata is a dict, convert to dict if it is a string
330	        if data.get(TableField.METADATA.value) is not None:
331	            data[TableField.METADATA.value] = data[TableField.METADATA.value].apply(
332	                lambda x: x if isinstance(x, dict) else eval(x)
333	            )
334	
335	        # convert to dict
336	
337	        data = data.to_dict(orient=&quot;list&quot;)
338	
339	        collection.upsert(
340	            ids=data[TableField.ID.value],
341	            documents=data.get(TableField.CONTENT.value),
342	            embeddings=data[TableField.EMBEDDINGS.value],
343	            metadatas=data.get(TableField.METADATA.value),
344	        )
345	        self._sync()
346	
347	    def upsert(self, table_name: str, data: pd.DataFrame):
</pre>
</div>


</div>
</div>

<div id="issue-53">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/clickhouse_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/clickhouse_handler/connection_args.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
30	    },
31	    port={
32	        &#x27;type&#x27;: ARG_TYPE.INT,
33	        &#x27;description&#x27;: &#x27;The TCP/IP port of the ClickHouse server. Must be an integer.&#x27;,
34	        &#x27;required&#x27;: True,
35	        &#x27;label&#x27;: &#x27;Port&#x27;
36	    },
37	    password={
38	        &#x27;type&#x27;: ARG_TYPE.PWD,
39	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the ClickHouse server.&#x27;,
40	        &#x27;required&#x27;: True,
41	        &#x27;label&#x27;: &#x27;Password&#x27;,
42	        &#x27;secret&#x27;: True
43	    }
44	)
45	
46	connection_args_example = OrderedDict(
47	    protocol=&#x27;native&#x27;,
48	    host=&#x27;127.0.0.1&#x27;,
49	    port=9000,
50	    user=&#x27;root&#x27;,
51	    password=&#x27;password&#x27;,
52	    database=&#x27;database&#x27;
53	)
</pre>
</div>


</div>
</div>

<div id="issue-54">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/clipdrop_handler/clipdrop.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/clipdrop_handler/clipdrop.py</a><br>
    <b>Line number: </b>19<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
3	
4	
5	class ClipdropClient:
6	    def __init__(self, api_key, local_dir):
7	        self.api_key = api_key
8	        self.dir_to_save = local_dir if local_dir.endswith(&quot;/&quot;) else local_dir + &quot;/&quot;
9	        self.base_endpoint = &quot;https://clipdrop-api.co/&quot;
10	
11	    def write_to_file(self, img):
12	        f_name = self.dir_to_save + str(uuid.uuid4()) + &quot;.png&quot;
13	        with open(f_name, &quot;wb&quot;) as f:
14	            f.write(img)
15	        return f_name
16	
17	    def make_request(self, url, files={}, data={}):
18	        headers = {&quot;x-api-key&quot;: self.api_key}
19	        resp = requests.post(url, headers=headers, files=files, data=data)
20	        if resp.status_code == 200:
21	            saved_path = self.write_to_file(resp.content)
22	            return saved_path
23	        return resp.text
24	
25	    def image_extension_check(self, url):
26	        ext = url.split(&quot;.&quot;)[-1]
27	        if ext in [&quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;]:
28	            return ext
29	        raise Exception(&quot;Unknown image format. Currently jpg, jpeg &amp; png are supported.&quot;)
30	
31	    def download_image(self, url):
32	        img_ext = self.image_extension_check(url)
33	        res = requests.get(url)
34	        return {&quot;img_ext&quot;: img_ext, &quot;content&quot;: res.content}
</pre>
</div>


</div>
</div>

<div id="issue-55">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/clipdrop_handler/clipdrop.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/clipdrop_handler/clipdrop.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
17	    def make_request(self, url, files={}, data={}):
18	        headers = {&quot;x-api-key&quot;: self.api_key}
19	        resp = requests.post(url, headers=headers, files=files, data=data)
20	        if resp.status_code == 200:
21	            saved_path = self.write_to_file(resp.content)
22	            return saved_path
23	        return resp.text
24	
25	    def image_extension_check(self, url):
26	        ext = url.split(&quot;.&quot;)[-1]
27	        if ext in [&quot;jpeg&quot;, &quot;jpg&quot;, &quot;png&quot;]:
28	            return ext
29	        raise Exception(&quot;Unknown image format. Currently jpg, jpeg &amp; png are supported.&quot;)
30	
31	    def download_image(self, url):
32	        img_ext = self.image_extension_check(url)
33	        res = requests.get(url)
34	        return {&quot;img_ext&quot;: img_ext, &quot;content&quot;: res.content}
35	
36	    def remove_text(self, img_url):
37	        url = f&#x27;{self.base_endpoint}remove-text/v1&#x27;
38	        img_content = self.download_image(img_url)
39	        files = {
40	            &#x27;image_file&#x27;: (&#x27;image.jpg&#x27;, img_content[&quot;content&quot;], f&#x27;image/{img_content[&quot;img_ext&quot;]}&#x27;)
41	        }
42	        return self.make_request(url, files=files)
43	
44	    def remove_background(self, img_url):
45	        url = f&#x27;{self.base_endpoint}remove-background/v1&#x27;
46	        img_content = self.download_image(img_url)
47	        files = {
48	            &#x27;image_file&#x27;: (&#x27;image.jpg&#x27;, img_content[&quot;content&quot;], f&#x27;image/{img_content[&quot;img_ext&quot;]}&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-56">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/cloud_spanner_handler/cloud_spanner_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/cloud_spanner_handler/cloud_spanner_handler.py</a><br>
    <b>Line number: </b>205<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
189	        &#x27;&#x27;&#x27;
190	        result = self.native_query(query)
191	        df = result.data_frame
192	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
193	        return result
194	
195	    def get_columns(self, table_name: str) -&gt; Response:
196	        &quot;&quot;&quot;Get details about a table.
197	
198	        Args:
199	            table_name (str): Name of the table to retrieve details of.
200	
201	        Returns:
202	            Response: Details of the table.
203	        &quot;&quot;&quot;
204	
205	        query = f&#x27;&#x27;&#x27;
206	            SELECT
207	              t.column_name,
208	              t.spanner_type,
209	              t.is_nullable
210	            FROM
211	              information_schema.columns AS t
212	            WHERE
213	              t.table_name = &#x27;{table_name}&#x27;
214	        &#x27;&#x27;&#x27;
215	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-57">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/cloud_sql_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/cloud_sql_handler/connection_args.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Google Cloud SQL instance.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the Google Cloud SQL instance.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Google Cloud SQL instance. Must be an integer.&#x27;
27	    },
28	    db_engine={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &quot;The database engine of the Google Cloud SQL instance. This can take one of three values: &#x27;mysql&#x27;, &#x27;postgresql&#x27; or &#x27;mssql&#x27;.&quot;
31	    }
32	)
33	
34	connection_args_example = OrderedDict(
35	    db_engine=&#x27;mysql&#x27;,
36	    host=&#x27;53.170.61.16&#x27;,
37	    port=3306,
38	    user=&#x27;root&#x27;,
39	    password=&#x27;password&#x27;,
40	    database=&#x27;database&#x27;
41	)
</pre>
</div>


</div>
</div>

<div id="issue-58">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/coinbase_handler/coinbase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/coinbase_handler/coinbase_handler.py</a><br>
    <b>Line number: </b>84<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
68	        Returns StatusResponse indicating whether or not the handler is connected.
69	        &quot;&quot;&quot;
70	        response = StatusResponse(True)
71	        self.is_connected = response.success
72	        return response
73	
74	    # symbol: BTC-USD
75	    # granularity 60, 300, 900, 3600, 21600, 86400
76	    def get_coinbase_candle(self, symbol: str, granularity: int) -&gt; pd.DataFrame:
77	        jdocs = []
78	        current_time = datetime.datetime.now()
79	        start_time = current_time - datetime.timedelta(seconds=granularity)
80	        start_time_iso = start_time.isoformat().split(&quot;.&quot;)[0] + &quot;-04:00&quot;
81	        path = &quot;/products/&quot; + symbol + &quot;/candles?granularity=&quot; + str(granularity) + &quot;&amp;start=&quot; + start_time_iso
82	        headers = self.generate_api_headers(&quot;GET&quot;, path)
83	        url = _BASE_COINBASE_US_URL + path
84	        response = requests.get(url, headers=headers)
85	        candles = response.json()
86	        for candle in candles:
87	            dt = datetime.datetime.fromtimestamp(candle[0], None).isoformat()
88	            low, high, open, close, volume = candle[1:]
89	            jdoc = {&quot;symbol&quot;: symbol, &quot;low&quot;: low, &quot;high&quot;: high, &quot;open&quot;: open, &quot;close&quot;: close, &quot;volume&quot;: volume, &quot;timestamp&quot;: candle[0], &quot;timestamp_iso&quot;: dt}
90	            jdocs.append(jdoc)
91	        return pd.DataFrame(jdocs)
92	
93	    def _get_candle(self, params: Dict = None) -&gt; pd.DataFrame:
94	        &quot;&quot;&quot;Gets aggregate trade data for a symbol based on given parameters
95	
96	        Returns results as a pandas DataFrame.
97	
98	        Args:
99	            params (Dict): Trade data params (symbol, interval)
</pre>
</div>


</div>
</div>

<div id="issue-59">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'secret_key'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/coinbase_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/coinbase_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	    api_secret={
15	        &#x27;type&#x27;: ARG_TYPE.PWD,
16	        &#x27;description&#x27;: &#x27;API Secret For Connecting to CoinBase API.&#x27;,
17	        &#x27;required&#x27;: True,
18	        &#x27;label&#x27;: &#x27;API Secret&#x27;,
19	        &#x27;secret&#x27;: True
20	    },
21	    api_passphrase={
22	        &#x27;type&#x27;: ARG_TYPE.PWD,
23	        &#x27;description&#x27;: &#x27;API Passphrase.&#x27;,
24	        &#x27;required&#x27;: True,
25	        &#x27;label&#x27;: &#x27;API Passphrase&#x27;,
26	        &#x27;secret&#x27;: True
27	    },
28	)
29	
30	connection_args_example = OrderedDict(
31	    api_key=&#x27;public_key&#x27;,
32	    api_secret=&#x27;secret_key&#x27;,
33	    api_passphrase=&#x27;passphrase&#x27;
34	)
</pre>
</div>


</div>
</div>

<div id="issue-60">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/confluence_handler/tests/test_confluence_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/confluence_handler/tests/test_confluence_handler.py</a><br>
    <b>Line number: </b>50<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
34	            &quot;SELECT * FROM confluence_data.pages WHERE space=&#x27;DEMO&#x27;&quot;
35	        )
36	        assert response.type is not RESPONSE_TYPE.ERROR
37	
38	    # TODO: Uncomment when `insert` native query is fixed.
39	
40	    # def test_insert_page(self):
41	    #     query = &#x27;&#x27;&#x27;
42	    #     INSERT INTO confluence_data.pages (space, title, body)
43	    #     VALUES
44	    #     (&#x27;DEMO&#x27;, &#x27;Test page&#x27;, &#x27;Test page body&#x27;)
45	    #     &#x27;&#x27;&#x27;
46	    #     response = self.handler.native_query(query)
47	    #     assert response.type is not RESPONSE_TYPE.ERROR
48	
49	    def test_update_page(self):
50	        query = f&#x27;&#x27;&#x27;
51	        UPDATE confluence_data.pages
52	        SET title=&#x27;Title updated&#x27;, body=&#x27;Body updated&#x27;
53	        WHERE id={os.getenv(&#x27;CONFLUENCE_TEST_PAGE_ID&#x27;)}
54	        &#x27;&#x27;&#x27;
55	        response = self.handler.native_query(query)
56	        assert response.type is not RESPONSE_TYPE.ERROR
57	
58	    def test_delete_page(self):
59	        query = f&#x27;&#x27;&#x27;
60	        DELETE FROM confluence_data.pages
61	        WHERE id={os.getenv(&#x27;CONFLUENCE_TEST_PAGE_ID&#x27;)}
62	        &#x27;&#x27;&#x27;
63	        response = self.handler.native_query(query)
64	        assert response.type is not RESPONSE_TYPE.ERROR
65	
66	
67	if __name__ == &#x27;__main__&#x27;:
68	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-61">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/confluence_handler/tests/test_confluence_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/confluence_handler/tests/test_confluence_handler.py</a><br>
    <b>Line number: </b>59<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
43	    #     VALUES
44	    #     (&#x27;DEMO&#x27;, &#x27;Test page&#x27;, &#x27;Test page body&#x27;)
45	    #     &#x27;&#x27;&#x27;
46	    #     response = self.handler.native_query(query)
47	    #     assert response.type is not RESPONSE_TYPE.ERROR
48	
49	    def test_update_page(self):
50	        query = f&#x27;&#x27;&#x27;
51	        UPDATE confluence_data.pages
52	        SET title=&#x27;Title updated&#x27;, body=&#x27;Body updated&#x27;
53	        WHERE id={os.getenv(&#x27;CONFLUENCE_TEST_PAGE_ID&#x27;)}
54	        &#x27;&#x27;&#x27;
55	        response = self.handler.native_query(query)
56	        assert response.type is not RESPONSE_TYPE.ERROR
57	
58	    def test_delete_page(self):
59	        query = f&#x27;&#x27;&#x27;
60	        DELETE FROM confluence_data.pages
61	        WHERE id={os.getenv(&#x27;CONFLUENCE_TEST_PAGE_ID&#x27;)}
62	        &#x27;&#x27;&#x27;
63	        response = self.handler.native_query(query)
64	        assert response.type is not RESPONSE_TYPE.ERROR
65	
66	
67	if __name__ == &#x27;__main__&#x27;:
68	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-62">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/couchbase_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/couchbase_handler/connection_args.py</a><br>
    <b>Line number: </b>29<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
13	        &quot;description&quot;: &quot;The password to authenticate the user with the Couchbase server.&quot;,
14	        &#x27;secret&#x27;: True
15	    },
16	    bucket={
17	        &quot;type&quot;: ARG_TYPE.STR,
18	        &quot;description&quot;: &quot;The database/bucket name to use when connecting with the Couchbase server.&quot;,
19	    },
20	    host={
21	        &quot;type&quot;: ARG_TYPE.STR,
22	        &quot;description&quot;: &quot;--your-instance--.dp.cloud.couchbase.com or IP address of the Couchbase server.&quot;,
23	    },
24	    scope={
25	        &quot;type&quot;: ARG_TYPE.STR,
26	        &quot;description&quot;: &#x27;The scope use in the query context in Couchbase server. If blank, scope will be &quot;_default&quot;.&#x27;,
27	    },
28	)
29	connection_args_example = OrderedDict(
30	    host=&quot;127.0.0.1&quot;, user=&quot;root&quot;, password=&quot;password&quot;, bucket=&quot;bucket&quot;
31	)
</pre>
</div>


</div>
</div>

<div id="issue-63">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/couchbase_handler/couchbase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/couchbase_handler/couchbase_handler.py</a><br>
    <b>Line number: </b>196<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
180	            table_name (str): name of one of tables returned by self.get_tables()
181	        Returns:
182	            HandlerResponse: shoud have same columns as information_schema.columns
183	                (https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html)
184	                Column &#x27;COLUMN_NAME&#x27; is mandatory, other is optional. Hightly
185	                recomended to define also &#x27;DATA_TYPE&#x27;: it should be one of
186	                python data types (by default it str).
187	        &quot;&quot;&quot;
188	
189	        response = Response(False)
190	
191	        cluster = self.connect()
192	        bucket = cluster.bucket(self.bucket_name)
193	        cb = bucket.scope(self.scope)
194	
195	        try:
196	            q = f&quot;SELECT * FROM `{table_name}` limit 1&quot;
197	            row_iter = cb.query(q)
198	            data = []
199	            for row in row_iter:
200	                for k, v in row[table_name].items():
201	                    data.append([k, type(v).__name__])
202	            df = pd.DataFrame(data, columns=[&quot;Field&quot;, &quot;Type&quot;])
203	            response = Response(RESPONSE_TYPE.TABLE, df)
204	        except KeyspaceNotFoundException as e:
205	            response = Response(
206	                RESPONSE_TYPE.ERROR,
207	                error_message=f&quot;Error: {e.error_context.first_error_message}&quot;,
208	            )
209	
210	        return response
</pre>
</div>


</div>
</div>

<div id="issue-64">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/crate_handler/crate_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/crate_handler/crate_handler.py</a><br>
    <b>Line number: </b>208<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
192	        &quot;description&quot;: &quot;The user name used to authenticate with the CrateDB server.&quot;,
193	    },
194	    password={
195	        &quot;type&quot;: ARG_TYPE.STR,
196	        &quot;description&quot;: &quot;The password to authenticate the user with the CrateDB server.&quot;,
197	    },
198	    port={
199	        &quot;type&quot;: ARG_TYPE.INT,
200	        &quot;description&quot;: &quot;Specify port to connect CrateDB server&quot;,
201	    },
202	    schemaName={
203	        &quot;type&quot;: ARG_TYPE.STR,
204	        &quot;description&quot;: &#x27;Specify the schema name. Note: It is optional DEFAULT is &quot;doc&quot;&#x27;,
205	    },
206	)
207	
208	connection_args_example = OrderedDict(
209	    host=&quot;127.0.0.1&quot;,
210	    port=&quot;4200&quot;,
211	    password=&quot;&quot;,
212	    user=&quot;crate&quot;,
213	)
</pre>
</div>


</div>
</div>

<div id="issue-65">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/databend_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/databend_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Databend warehouse.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the Databend warehouse. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the ClickHouse server.&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    host=&#x27;some-url.aws-us-east-2.default.databend.com&#x27;,
32	    port=443,
33	    user=&#x27;root&#x27;,
34	    password=&#x27;password&#x27;,
35	    database=&#x27;test_db&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-66">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'dapi1234567890ab1cde2f3ab456c7d89efa'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/databricks_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/databricks_handler/connection_args.py</a><br>
    <b>Line number: </b>53<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
37	        &quot;label&quot;: &quot;Http headers&quot;,
38	    },
39	    catalog={
40	        &quot;type&quot;: ARG_TYPE.STR,
41	        &quot;description&quot;: &quot;Catalog to use for the connection. This parameter is optional.&quot;,
42	        &quot;required&quot;: False,
43	        &quot;label&quot;: &quot;Catalog&quot;,
44	    },
45	    schema={
46	        &quot;type&quot;: ARG_TYPE.STR,
47	        &quot;description&quot;: &quot;Schema (database) to use for the connection. This parameter is optional.&quot;,
48	        &quot;required&quot;: False,
49	        &quot;label&quot;: &quot;Schema&quot;,
50	    },
51	)
52	
53	connection_args_example = OrderedDict(
54	    server_hostname=&quot;adb-1234567890123456.7.azuredatabricks.net&quot;,
55	    http_path=&quot;sql/protocolv1/o/1234567890123456/1234-567890-test123&quot;,
56	    access_token=&quot;dapi1234567890ab1cde2f3ab456c7d89efa&quot;,
57	    schema=&quot;sales&quot;,
58	)
</pre>
</div>


</div>
</div>

<div id="issue-67">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '1234'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/db2_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/db2_handler/connection_args.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
17	    user={
18	        &quot;type&quot;: ARG_TYPE.STR,
19	        &quot;description&quot;: &quot;The user name used to authenticate with the DB2 server.&quot;,
20	    },
21	    password={
22	        &quot;type&quot;: ARG_TYPE.PWD,
23	        &quot;description&quot;: &quot;The password to authenticate the user with the DB2 server.&quot;,
24	        &#x27;secret&#x27;: True
25	    },
26	    port={
27	        &quot;type&quot;: ARG_TYPE.INT,
28	        &quot;description&quot;: &quot;Specify port to connect DB2 through TCP/IP&quot;,
29	    },
30	    schemaName={&quot;type&quot;: ARG_TYPE.STR, &quot;description&quot;: &quot;Specify the schema name &quot;},
31	)
32	
33	connection_args_example = OrderedDict(
34	    host=&quot;127.0.0.1&quot;,
35	    port=&quot;25000&quot;,
36	    password=&quot;1234&quot;,
37	    user=&quot;db2admin&quot;,
38	    schemaName=&quot;db2admin&quot;,
39	    database=&quot;BOOKS&quot;,
40	)
</pre>
</div>


</div>
</div>

<div id="issue-68">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'test'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/derby_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/derby_handler/connection_args.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;type&#x27;: ARG_TYPE.PWD,
27	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Apache Derby server.&#x27;,
28	        &#x27;secret&#x27;: True
29	    },
30	    jdbcClass={
31	        &#x27;type&#x27;: ARG_TYPE.STR,
32	        &#x27;description&#x27;: &#x27;The jdbc class which should be used to establish the connection, the default value is:  org.apache.derby.jdbc.ClientDriver.&#x27;
33	    },
34	    jdbcJarLocation={
35	        &#x27;type&#x27;: ARG_TYPE.STR,
36	        &#x27;description&#x27;: &#x27;The location of the jar files which contain the JDBC class. This need not be specified if the required classes are already added to the CLASSPATH variable.&#x27;
37	    }
38	
39	)
40	
41	
42	connection_args_example = OrderedDict(
43	    host=&#x27;localhost&#x27;,
44	    port=&#x27;1527&#x27;,
45	    user=&#x27;test&#x27;,
46	    password=&#x27;test&#x27;,
47	    database=&quot;testdb&quot;,
48	    jdbcClass=&#x27;org.apache.derby.jdbc.ClientDriver&#x27;,
49	    jdbcJarLocation=&#x27;/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derby.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbyclient.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbynet.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbyoptionaltools.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbyrun.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbyshared.jar,/opt/homebrew/Cellar/derby/10.16.1.1/libexec/lib/derbytools.jar&#x27;,
50	)
</pre>
</div>


</div>
</div>

<div id="issue-69">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/derby_handler/derby_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/derby_handler/derby_handler.py</a><br>
    <b>Line number: </b>180<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
164	            Response: The query result.
165	        &quot;&quot;&quot;
166	        if isinstance(query, ASTNode):
167	            query_str = query.to_string()
168	        else:
169	            query_str = str(query)
170	
171	        return self.native_query(query_str)
172	
173	
174	    def get_tables(self) -&gt; StatusResponse:
175	        &quot;&quot;&quot;Get a list of all the tables in the database.
176	
177	        Returns:
178	            Response: Names of the tables in the database.
179	        &quot;&quot;&quot;
180	        query = f&#x27;&#x27;&#x27;
181	        SELECT st.tablename FROM sys.systables st LEFT OUTER JOIN sys.sysschemas ss ON (st.schemaid = ss.schemaid) WHERE ss.schemaname =&#x27;{self.schema}&#x27; &#x27;&#x27;&#x27;
182	    
183	        result = self.native_query(query)
184	        df = result.data_frame
185	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
186	        return result
187	
188	    
189	    def get_columns(self, table_name: str) -&gt; StatusResponse:
190	        &quot;&quot;&quot;Get details about a table.
191	
192	        Args:
193	            table_name (str): Name of the table to retrieve details of.
194	
195	        Returns:
196	            Response: Details of the table.
</pre>
</div>


</div>
</div>

<div id="issue-70">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/derby_handler/derby_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/derby_handler/derby_handler.py</a><br>
    <b>Line number: </b>199<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
183	        result = self.native_query(query)
184	        df = result.data_frame
185	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
186	        return result
187	
188	    
189	    def get_columns(self, table_name: str) -&gt; StatusResponse:
190	        &quot;&quot;&quot;Get details about a table.
191	
192	        Args:
193	            table_name (str): Name of the table to retrieve details of.
194	
195	        Returns:
196	            Response: Details of the table.
197	        &quot;&quot;&quot;
198	
199	        query = f&#x27;&#x27;&#x27; SELECT COLUMNNAME FROM SYS.SYSCOLUMNS INNER JOIN SYS.SYSTABLES ON SYS.SYSCOLUMNS.REFERENCEID=SYS.SYSTABLES.TABLEID WHERE TABLENAME=&#x27;{table_name}&#x27; &#x27;&#x27;&#x27;
200	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-71">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py</a><br>
    <b>Line number: </b>59<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
43	        messages = MessagesTable(self)
44	        self._register_table(&#x27;messages&#x27;, messages)
45	
46	    def connect(self):
47	        &quot;&quot;&quot;
48	        Set up the connection required by the handler.
49	        Returns
50	        -------
51	        StatusResponse
52	            connection object
53	        &quot;&quot;&quot;
54	
55	        if self.is_connected:
56	            return StatusResponse(True)
57	
58	        url = f&#x27;https://discord.com/api/v10/applications/@me&#x27;
59	        result = requests.get(
60	            url,
61	            headers={
62	                &#x27;Authorization&#x27;: f&#x27;Bot {self.connection_data[&quot;token&quot;]}&#x27;,
63	                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
64	            },
65	        )
66	
67	        if result.status_code != 200:
68	            raise ValueError(result.text)
69	
70	        self.is_connected = True
71	
72	    def check_connection(self) -&gt; StatusResponse:
73	        &quot;&quot;&quot;
74	        Check connection to the handler.
75	        Returns:
76	            HandlerStatusResponse
77	        &quot;&quot;&quot;
78	
79	        response = StatusResponse(False)
80	
</pre>
</div>


</div>
</div>

<div id="issue-72">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py</a><br>
    <b>Line number: </b>144<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
128	            method_name (str): the method name
129	            params (dict): the method parameters
130	        Returns:
131	            pd.DataFrame
132	        &quot;&quot;&quot;
133	
134	        if operation == &#x27;get_messages&#x27;:
135	            param_strings = {&#x27;limit&#x27;: params[&#x27;limit&#x27;]}
136	            if &#x27;after&#x27; in params:
137	                param_strings[&#x27;after&#x27;] = self.utc_to_snowflake(params[&#x27;after&#x27;])
138	            if &#x27;before&#x27; in params:
139	                param_strings[&#x27;before&#x27;] = self.utc_to_snowflake(params[&#x27;before&#x27;])
140	
141	            url = (
142	                f&#x27;https://discord.com/api/v10/channels/{params[&quot;channel_id&quot;]}/messages&#x27;
143	            )
144	            result = requests.get(
145	                url,
146	                headers={
147	                    &#x27;Authorization&#x27;: f&#x27;Bot {self.connection_data[&quot;token&quot;]}&#x27;,
148	                    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
149	                },
150	                params=param_strings,
151	            )
152	
153	            if result.status_code != 200:
154	                raise ValueError(f&#x27;Error calling Discord API: {result.json()}&#x27;)
155	
156	            json = result.json()
157	            for message in json:
158	                author = message.get(&#x27;author&#x27;)
159	                if author is not None:
160	                    message[&#x27;author_id&#x27;] = author.get(&#x27;id&#x27;)
161	                    message[&#x27;author_username&#x27;] = author.get(&#x27;username&#x27;)
162	                    message[&#x27;author_global_name&#x27;] = author.get(&#x27;global_name&#x27;)
163	
164	            df = pd.DataFrame.from_records(json)
165	            return df
166	        elif operation == &#x27;send_message&#x27;:
</pre>
</div>


</div>
</div>

<div id="issue-73">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/discord_handler/discord_handler.py</a><br>
    <b>Line number: </b>170<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
154	                raise ValueError(f&#x27;Error calling Discord API: {result.json()}&#x27;)
155	
156	            json = result.json()
157	            for message in json:
158	                author = message.get(&#x27;author&#x27;)
159	                if author is not None:
160	                    message[&#x27;author_id&#x27;] = author.get(&#x27;id&#x27;)
161	                    message[&#x27;author_username&#x27;] = author.get(&#x27;username&#x27;)
162	                    message[&#x27;author_global_name&#x27;] = author.get(&#x27;global_name&#x27;)
163	
164	            df = pd.DataFrame.from_records(json)
165	            return df
166	        elif operation == &#x27;send_message&#x27;:
167	            url = (
168	                f&#x27;https://discord.com/api/v10/channels/{params[&quot;channel_id&quot;]}/messages&#x27;
169	            )
170	            result = requests.post(
171	                url,
172	                headers={
173	                    &#x27;Authorization&#x27;: f&#x27;Bot {self.connection_data[&quot;token&quot;]}&#x27;,
174	                    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
175	                },
176	                json={
177	                    &#x27;content&#x27;: params[&#x27;text&#x27;],
178	                },
179	            )
180	
181	            if result.status_code != 200:
182	                raise ValueError(f&#x27;Error calling Discord API: {result.json()}&#x27;)
183	
184	            df = pd.DataFrame.from_records([result.json()])
185	            return df
186	        else:
187	            raise ValueError(f&quot;Unsupported method: {operation}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-74">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/dockerhub_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/dockerhub_handler/connection_args.py</a><br>
    <b>Line number: </b>22<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
6	connection_args = OrderedDict(
7	    username={
8	        &quot;type&quot;: ARG_TYPE.STR,
9	        &quot;description&quot;: &quot;DockerHub username&quot;,
10	        &quot;required&quot;: True,
11	        &quot;label&quot;: &quot;username&quot;,
12	    },
13	    password={
14	        &quot;type&quot;: ARG_TYPE.PWD,
15	        &quot;description&quot;: &quot;DockerHub password&quot;,
16	        &quot;required&quot;: True,
17	        &quot;label&quot;: &quot;Api key&quot;,
18	        &#x27;secret&#x27;: True
19	    }
20	)
21	
22	connection_args_example = OrderedDict(
23	    username=&quot;username&quot;,
24	    password=&quot;password&quot;
25	)
</pre>
</div>


</div>
</div>

<div id="issue-75">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/documentdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/documentdb_handler/connection_args.py</a><br>
    <b>Line number: </b>47<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
31	    },
32	    port={
33	        &#x27;type&#x27;: ARG_TYPE.INT,
34	        &#x27;description&#x27;: &#x27;The TCP/IP port of the DocumentDB server. Must be an integer.&#x27;,
35	        &#x27;required&#x27;: True,
36	        &#x27;label&#x27;: &#x27;Port&#x27;,
37	    },
38	    kwargs={
39	        &#x27;type&#x27;: dict,
40	        &#x27;description&#x27;: &#x27;Additional parameters of DocumentDB same as MongoDB.&#x27;,
41	        &#x27;required&#x27;: False,
42	        &#x27;label&#x27;: &#x27;Kwargs&#x27;,
43	    },
44	)
45	
46	
47	connection_args_example = OrderedDict(
48	    host=&#x27;127.0.0.1&#x27;,
49	    port=27017,
50	    username=&#x27;documentdb&#x27;,
51	    password=&#x27;password&#x27;,
52	    database=&#x27;database&#x27;,
53	)
</pre>
</div>


</div>
</div>

<div id="issue-76">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/dremio_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/dremio_handler/connection_args.py</a><br>
    <b>Line number: </b>26<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
10	    },
11	    port={
12	        &#x27;type&#x27;: ARG_TYPE.INT,
13	        &#x27;description&#x27;: &#x27;The port that Dremio is running on.&#x27;
14	    },
15	    username={
16	        &#x27;type&#x27;: ARG_TYPE.STR,
17	        &#x27;description&#x27;: &#x27;The username used to authenticate with the Dremio server.&#x27;
18	    },
19	    password={
20	        &#x27;type&#x27;: ARG_TYPE.PWD,
21	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Dremio server.&#x27;,
22	        &#x27;secret&#x27;: True
23	    }
24	)
25	
26	connection_args_example = OrderedDict(
27	    host=&#x27;localhost&#x27;,
28	    database=9047,
29	    username=&#x27;admin&#x27;,
30	    password=&#x27;password&#x27;
31	)
</pre>
</div>


</div>
</div>

<div id="issue-77">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/dremio_handler/dremio_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/dremio_handler/dremio_handler.py</a><br>
    <b>Line number: </b>69<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
53	        if self.is_connected is True:
54	            self.disconnect()
55	
56	    def connect(self) -&gt; dict:
57	        &quot;&quot;&quot;
58	        Set up the connection required by the handler.
59	        Returns:
60	            HandlerStatusResponse
61	        &quot;&quot;&quot;
62	
63	        headers = {
64	            &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
65	        }
66	
67	        data = &#x27;{&#x27; + f&#x27;&quot;userName&quot;: &quot;{self.connection_data[&quot;username&quot;]}&quot;,&quot;password&quot;: &quot;{self.connection_data[&quot;password&quot;]}&quot;&#x27; + &#x27;}&#x27;
68	
69	        response = requests.post(self.base_url + &#x27;/apiv2/login&#x27;, headers=headers, data=data)
70	
71	        return {
72	            &#x27;Authorization&#x27;: &#x27;_dremio&#x27; + response.json()[&#x27;token&#x27;],
73	            &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
74	        }
75	
76	    def disconnect(self):
77	        &quot;&quot;&quot;
78	        Close any existing connections.
79	        &quot;&quot;&quot;
80	
81	        self.is_connected = False
82	        return
83	
84	    def check_connection(self) -&gt; StatusResponse:
</pre>
</div>


</div>
</div>

<div id="issue-78">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/dremio_handler/dremio_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/dremio_handler/dremio_handler.py</a><br>
    <b>Line number: </b>125<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
109	        &quot;&quot;&quot;
110	        Receive raw query and act upon it somehow.
111	        Args:
112	            query (str): query in native format
113	        Returns:
114	            HandlerResponse
115	        &quot;&quot;&quot;
116	
117	        query = query.replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;).replace(&#x27;\n&#x27;, &#x27; &#x27;)
118	
119	        need_to_close = self.is_connected is False
120	
121	        auth_headers = self.connect()
122	        data = &#x27;{&#x27; + f&#x27;&quot;sql&quot;: &quot;{query}&quot;&#x27; + &#x27;}&#x27;
123	
124	        try:
125	            sql_result = requests.post(self.base_url + &#x27;/api/v3/sql&#x27;, headers=auth_headers, data=data)
126	
127	            job_id = sql_result.json()[&#x27;id&#x27;]
128	
129	            if sql_result.status_code == 200:
130	                logger.info(&#x27;Job creation successful. Job id is: &#x27; + job_id)
131	            else:
132	                logger.info(&#x27;Job creation failed.&#x27;)
133	
134	            logger.info(&#x27;Waiting for the job to complete...&#x27;)
135	
136	            job_status = requests.request(&quot;GET&quot;, self.base_url + &quot;/api/v3/job/&quot; + job_id, headers=auth_headers).json()[
137	                &#x27;jobState&#x27;]
138	
139	            while job_status != &#x27;COMPLETED&#x27;:
140	                if job_status == &#x27;FAILED&#x27;:
</pre>
</div>


</div>
</div>

<div id="issue-79">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/druid_handler/druid_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/druid_handler/druid_handler.py</a><br>
    <b>Line number: </b>203<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
187	        df = result.data_frame
188	
189	        df = df[[&#x27;TABLE_NAME&#x27;, &#x27;TABLE_TYPE&#x27;]]
190	        result.data_frame = df.rename(columns={&#x27;TABLE_NAME&#x27;: &#x27;table_name&#x27;, &#x27;TABLE_TYPE&#x27;: &#x27;table_type&#x27;})
191	
192	        return result
193	
194	    def get_columns(self, table_name: str) -&gt; StatusResponse:
195	        &quot;&quot;&quot;
196	        Returns a list of entity columns.
197	        Args:
198	            table_name (str): name of one of tables returned by self.get_tables()
199	        Returns:
200	            HandlerResponse
201	        &quot;&quot;&quot;
202	
203	        query = f&quot;&quot;&quot;
204	            SELECT *
205	            FROM INFORMATION_SCHEMA.COLUMNS
206	            WHERE &quot;TABLE_SCHEMA&quot; = &#x27;druid&#x27; AND &quot;TABLE_NAME&quot; = &#x27;{table_name}&#x27;
207	        &quot;&quot;&quot;
208	        result = self.native_query(query)
209	        df = result.data_frame
210	
211	        df = df[[&#x27;COLUMN_NAME&#x27;, &#x27;DATA_TYPE&#x27;]]
212	        result.data_frame = df.rename(columns={&#x27;COLUMN_NAME&#x27;: &#x27;column_name&#x27;, &#x27;DATA_TYPE&#x27;: &#x27;data_type&#x27;})
213	
214	        return result
</pre>
</div>


</div>
</div>

<div id="issue-80">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'U/VjewPlNopsDmmwItl34r2neyC6WhZpUiip57i'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/dynamodb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/dynamodb_handler/connection_args.py</a><br>
    <b>Line number: </b>22<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
6	connection_args = OrderedDict(
7	    aws_access_key_id={
8	        &#x27;type&#x27;: ARG_TYPE.STR,
9	        &#x27;description&#x27;: &#x27;The access key for the AWS account.&#x27;
10	    },
11	    aws_secret_access_key={
12	        &#x27;type&#x27;: ARG_TYPE.STR,
13	        &#x27;description&#x27;: &#x27;The secret key for the AWS account.&#x27;,
14	        &#x27;secret&#x27;: True
15	    },
16	    region_name={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The AWS region where the DynamoDB tables are created.&#x27;
19	    }
20	)
21	
22	connection_args_example = OrderedDict(
23	    aws_access_key_id=&#x27;PCAQ2LJDOSWLNSQKOCPW&#x27;,
24	    aws_secret_access_key=&#x27;U/VjewPlNopsDmmwItl34r2neyC6WhZpUiip57i&#x27;,
25	    region_name=&#x27;us-east-1&#x27;
26	)
</pre>
</div>


</div>
</div>

<div id="issue-81">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/edgelessdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/edgelessdb_handler/connection_args.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
27	    },
28	    ssl={&#x27;type&#x27;: ARG_TYPE.BOOL, &#x27;description&#x27;: &#x27;Set it to False to disable ssl.&#x27;},
29	    ssl_ca={
30	        &#x27;type&#x27;: ARG_TYPE.PATH,
31	        &#x27;description&#x27;: &#x27;Path or URL of the Certificate Authority (CA) certificate file&#x27;,
32	    },
33	    ssl_cert={
34	        &#x27;type&#x27;: ARG_TYPE.PATH,
35	        &#x27;description&#x27;: &#x27;Path name or URL of the server public key certificate file&#x27;,
36	    },
37	    ssl_key={
38	        &#x27;type&#x27;: ARG_TYPE.PATH,
39	        &#x27;description&#x27;: &#x27;The path name or URL of the server private key file&#x27;,
40	    },
41	)
42	
43	connection_args_example = OrderedDict(
44	    host=&#x27;127.0.0.1&#x27;, port=3306, user=&#x27;root&#x27;, password=&#x27;password&#x27;, database=&#x27;database&#x27;
45	)
</pre>
</div>


</div>
</div>

<div id="issue-82">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/empress_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/empress_handler/connection_args.py</a><br>
    <b>Line number: </b>35<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
19	    password={
20	        &#x27;type&#x27;: ARG_TYPE.PWD,
21	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Empress Embedded server.&#x27;,
22	        &#x27;secret&#x27;: True
23	    },
24	    server={
25	        &#x27;type&#x27;: ARG_TYPE.STR,
26	        &#x27;description&#x27;: &#x27;The server name used to authenticate with the Empress Embedded server.&#x27;
27	    },
28	    database={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;Specify database name to connect Empress Embedded server&#x27;
31	    },
32	
33	)
34	
35	connection_args_example = OrderedDict(
36	    host=&#x27;localhost&#x27;,
37	    port=6322,
38	    user=&#x27;admin&#x27;,
39	    password=&#x27;password&#x27;,
40	    server=&#x27;test&#x27;,
41	    database=&#x27;test_db&#x27;
42	)
</pre>
</div>


</div>
</div>

<div id="issue-83">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/empress_handler/empress_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/empress_handler/empress_handler.py</a><br>
    <b>Line number: </b>197<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
181	        )
182	
183	        return response
184	
185	    def get_columns(self, table_name: str) -&gt; Response:
186	        &quot;&quot;&quot;
187	        Gets a list of column names in the specified table.
188	
189	        Args:
190	            table_name (str): The name of the table to get column names from.
191	
192	        Returns:
193	            list: A list of column names in the specified table.
194	        &quot;&quot;&quot;
195	        conn = self.connect()
196	        cursor = conn.cursor()
197	        cursor.execute(&quot;SELECT column_name FROM information_schema.columns WHERE table_name=&#x27;{}&#x27;&quot;.format(table_name))
198	        results = cursor.fetchall()
199	
200	        # construct a pandas dataframe from the query results
201	        df = pd.DataFrame(
202	            results,
203	            columns=[&#x27;column_name&#x27;, &#x27;data_type&#x27;]
204	        )
205	
206	        response = Response(
207	            RESPONSE_TYPE.TABLE,
208	            df
209	        )
210	
211	        return response
</pre>
</div>


</div>
</div>

<div id="issue-84">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>90<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
74	        if self.is_connected is True:
75	            self.disconnect()
76	
77	    def connect(self, **kwargs):
78	        if self.check_connection() == StatusResponse(True):
79	            self.is_connected = True
80	            logger.info(f&#x27;{self.name} connection successful!&#x27;)
81	            return StatusResponse(True)
82	        logger.info(f&#x27;{self.name} connection could not be made.&#x27;)
83	        return StatusResponse(False)
84	
85	    def disconnect(self, **kwargs):
86	        return
87	
88	    def check_connection(self) -&gt; StatusResponse:
89	        try:
90	            response = requests.get(build_health_url(self.basic_url), verify=self.tlsverify)
91	            if response.status_code == 204:
92	                return StatusResponse(True)
93	        except Exception as e:
94	            logger.error(f&#x27;{self.name} check connection failed with: {e}!&#x27;)
95	        return StatusResponse(False)
96	
97	    def query(self, query: ASTNode) -&gt; Response:
98	        if type(query) == Select:
99	            stream_name = query.from_table.parts[-1]  # i.e. table name
100	            params = {
101	                &#x27;embed&#x27;: &#x27;tryharder&#x27;
102	            }
103	            stream_endpoint = build_stream_url(self.basic_url, stream_name)
104	            response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
105	            entries = []
</pre>
</div>


</div>
</div>

<div id="issue-85">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>104<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
88	    def check_connection(self) -&gt; StatusResponse:
89	        try:
90	            response = requests.get(build_health_url(self.basic_url), verify=self.tlsverify)
91	            if response.status_code == 204:
92	                return StatusResponse(True)
93	        except Exception as e:
94	            logger.error(f&#x27;{self.name} check connection failed with: {e}!&#x27;)
95	        return StatusResponse(False)
96	
97	    def query(self, query: ASTNode) -&gt; Response:
98	        if type(query) == Select:
99	            stream_name = query.from_table.parts[-1]  # i.e. table name
100	            params = {
101	                &#x27;embed&#x27;: &#x27;tryharder&#x27;
102	            }
103	            stream_endpoint = build_stream_url(self.basic_url, stream_name)
104	            response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
105	            entries = []
106	            if response is not None and response.status_code == 200:
107	                json_response = response.json()
108	                for entry in json_response[&quot;entries&quot;]:
109	                    entry = entry_to_df(entry)
110	                    entries.append(entry)
111	                while True:
112	                    end_of_stream = True
113	                    if &#x27;links&#x27; in json_response:
114	                        for link in json_response[&#x27;links&#x27;]:
115	                            if &#x27;relation&#x27; in link:
116	                                if link[&#x27;relation&#x27;] == &#x27;next&#x27;:
117	                                    end_of_stream = False
118	                                    response = requests.get(build_next_url(link[&#x27;uri&#x27;], self.read_batch_size),
119	                                                            params=params, headers=self.headers, verify=self.tlsverify)
</pre>
</div>


</div>
</div>

<div id="issue-86">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>118<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
102	            }
103	            stream_endpoint = build_stream_url(self.basic_url, stream_name)
104	            response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
105	            entries = []
106	            if response is not None and response.status_code == 200:
107	                json_response = response.json()
108	                for entry in json_response[&quot;entries&quot;]:
109	                    entry = entry_to_df(entry)
110	                    entries.append(entry)
111	                while True:
112	                    end_of_stream = True
113	                    if &#x27;links&#x27; in json_response:
114	                        for link in json_response[&#x27;links&#x27;]:
115	                            if &#x27;relation&#x27; in link:
116	                                if link[&#x27;relation&#x27;] == &#x27;next&#x27;:
117	                                    end_of_stream = False
118	                                    response = requests.get(build_next_url(link[&#x27;uri&#x27;], self.read_batch_size),
119	                                                            params=params, headers=self.headers, verify=self.tlsverify)
120	                                    json_response = response.json()
121	                                    for entry in json_response[&quot;entries&quot;]:
122	                                        entry = entry_to_df(entry)
123	                                        entries.append(entry)
124	                    if end_of_stream:
125	                        break
126	
127	            df = pd.concat(entries)
128	
129	            return Response(
130	                RESPONSE_TYPE.TABLE,
131	                df
132	            )
133	        else:
134	            return Response(
</pre>
</div>


</div>
</div>

<div id="issue-87">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>151<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
135	                RESPONSE_TYPE.ERROR,
136	                error_message=&quot;Only &#x27;select&#x27; queries are supported for EventStoreDB&quot;
137	            )
138	
139	    def native_query(self, query: str) -&gt; Response:
140	        ast = self.parser(query, dialect=&#x27;mindsdb&#x27;)
141	        return self.query(ast)
142	
143	    def get_tables(self) -&gt; Response:
144	        &quot;&quot;&quot;
145	        List all streams i.e tables
146	        &quot;&quot;&quot;
147	        params = {
148	            &#x27;embed&#x27;: &#x27;tryharder&#x27;
149	        }
150	        stream_endpoint = build_streams_url(self.basic_url)
151	        response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
152	        streams = []
153	        if response is not None and response.status_code == 200:
154	            json_response = response.json()
155	            for entry in json_response[&quot;entries&quot;]:
156	                if &quot;title&quot; in entry:
157	                    streams.append(entry[&quot;title&quot;].split(&#x27;@&#x27;)[1])
158	            while True:
159	                end_of_stream = True
160	                if &#x27;links&#x27; in json_response:
161	                    for link in json_response[&#x27;links&#x27;]:
162	                        if &#x27;relation&#x27; in link:
163	                            if link[&#x27;relation&#x27;] == &#x27;next&#x27;:
164	                                end_of_stream = False
165	                                response = requests.get(build_next_url(link[&#x27;uri&#x27;], self.read_batch_size),
166	                                                        params=params, headers=self.headers, verify=self.tlsverify)
</pre>
</div>


</div>
</div>

<div id="issue-88">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>165<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
149	        }
150	        stream_endpoint = build_streams_url(self.basic_url)
151	        response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
152	        streams = []
153	        if response is not None and response.status_code == 200:
154	            json_response = response.json()
155	            for entry in json_response[&quot;entries&quot;]:
156	                if &quot;title&quot; in entry:
157	                    streams.append(entry[&quot;title&quot;].split(&#x27;@&#x27;)[1])
158	            while True:
159	                end_of_stream = True
160	                if &#x27;links&#x27; in json_response:
161	                    for link in json_response[&#x27;links&#x27;]:
162	                        if &#x27;relation&#x27; in link:
163	                            if link[&#x27;relation&#x27;] == &#x27;next&#x27;:
164	                                end_of_stream = False
165	                                response = requests.get(build_next_url(link[&#x27;uri&#x27;], self.read_batch_size),
166	                                                        params=params, headers=self.headers, verify=self.tlsverify)
167	                                json_response = response.json()
168	                                for entry in json_response[&quot;entries&quot;]:
169	                                    if &quot;title&quot; in entry:
170	                                        streams.append(entry[&quot;title&quot;].split(&#x27;@&#x27;)[1])
171	                if end_of_stream:
172	                    break
173	
174	        df = pd.DataFrame(streams,
175	                          columns=[&#x27;table_name&#x27;])
176	        return Response(
177	            RESPONSE_TYPE.TABLE,
178	            df
179	        )
180	
181	    def get_columns(self, table_name) -&gt; Response:
</pre>
</div>


</div>
</div>

<div id="issue-89">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/eventstoredb_handler/eventstoredb_handler.py</a><br>
    <b>Line number: </b>186<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
170	                                        streams.append(entry[&quot;title&quot;].split(&#x27;@&#x27;)[1])
171	                if end_of_stream:
172	                    break
173	
174	        df = pd.DataFrame(streams,
175	                          columns=[&#x27;table_name&#x27;])
176	        return Response(
177	            RESPONSE_TYPE.TABLE,
178	            df
179	        )
180	
181	    def get_columns(self, table_name) -&gt; Response:
182	        params = {
183	            &#x27;embed&#x27;: &#x27;tryharder&#x27;
184	        }
185	        stream_endpoint = build_stream_url_last_event(self.basic_url, table_name)
186	        response = requests.get(stream_endpoint, params=params, headers=self.headers, verify=self.tlsverify)
187	        entry = None
188	        if response is not None and response.status_code == 200:
189	            json_response = response.json()
190	            if json_response is not None and len(json_response) &gt; 0:
191	                entry = entry_to_df(json_response[&quot;entries&quot;][0])
192	        if entry is None:
193	            return Response(
194	                RESPONSE_TYPE.ERROR,
195	                &quot;Could not retrieve JSON event data to infer column types.&quot;
196	            )
197	        data = []
198	        for k, v in entry.items():
199	            data.append([k, v.dtypes.name])
200	        df = pd.DataFrame(data, columns=[&#x27;Field&#x27;, &#x27;Type&#x27;])
201	        return Response(
</pre>
</div>


</div>
</div>

<div id="issue-90">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/file_handler/file_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/file_handler/file_handler.py</a><br>
    <b>Line number: </b>395<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
379	                )
380	            except Exception:
381	                dialect = csv.reader(sample).dialect
382	                if dialect.delimiter not in accepted_csv_delimiters:
383	                    raise Exception(
384	                        f&quot;CSV delimeter &#x27;{dialect.delimiter}&#x27; is not supported&quot;
385	                    )
386	
387	        except csv.Error:
388	            dialect = None
389	        return dialect
390	
391	    @staticmethod
392	    def _fetch_url(url: str) -&gt; str:
393	        temp_dir = tempfile.mkdtemp(prefix=&quot;mindsdb_file_url_&quot;)
394	        try:
395	            r = requests.get(url, stream=True)
396	            if r.status_code == 200:
397	                with open(os.path.join(temp_dir, &quot;file&quot;), &quot;wb&quot;) as f:
398	                    for chunk in r:
399	                        f.write(chunk)
400	            else:
401	                raise Exception(f&quot;Response status code is {r.status_code}&quot;)
402	        except Exception as e:
403	            logger.error(f&quot;Error during getting {url}&quot;)
404	            logger.error(e)
405	            raise
406	        return os.path.join(temp_dir, &quot;file&quot;)
407	
408	    def get_tables(self) -&gt; Response:
409	        &quot;&quot;&quot;
410	        List all files
</pre>
</div>


</div>
</div>

<div id="issue-91">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/firebird_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/firebird_handler/connection_args.py</a><br>
    <b>Line number: </b>29<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
13	        &#x27;description&#x27;: &quot;&quot;&quot;
14	            The database name to use when connecting with the Firebird server. NOTE: use double backslashes (\\) for the
15	            database path on a Windows machine.
16	        &quot;&quot;&quot;
17	    },
18	    user={
19	        &#x27;type&#x27;: ARG_TYPE.STR,
20	        &#x27;description&#x27;: &#x27;The user name used to authenticate with the Firebird server.&#x27;
21	    },
22	    password={
23	        &#x27;type&#x27;: ARG_TYPE.PWD,
24	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Firebird server.&#x27;,
25	        &#x27;secret&#x27;: True
26	    }
27	)
28	
29	connection_args_example = OrderedDict(
30	    host=&#x27;localhost&#x27;,
31	    database=&#x27;/temp/test.db&#x27;,
32	    user=&#x27;sysdba&#x27;,
33	    password=&#x27;password&#x27;
34	)
</pre>
</div>


</div>
</div>

<div id="issue-92">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/firebird_handler/firebird_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/firebird_handler/firebird_handler.py</a><br>
    <b>Line number: </b>189<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
173	        &quot;&quot;&quot;
174	        result = self.native_query(query)
175	        df = result.data_frame
176	        df[df.columns[0]] = df[df.columns[0]].apply(lambda row: row.strip())
177	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
178	        return result
179	
180	    def get_columns(self, table_name: str) -&gt; StatusResponse:
181	        &quot;&quot;&quot;
182	        Returns a list of entity columns.
183	        Args:
184	            table_name (str): name of one of tables returned by self.get_tables()
185	        Returns:
186	            HandlerResponse
187	        &quot;&quot;&quot;
188	
189	        query = f&quot;&quot;&quot;
190	            SELECT
191	              RF.RDB$FIELD_NAME FIELD_NAME,
192	              CASE F.RDB$FIELD_TYPE
193	                WHEN 7 THEN
194	                  CASE F.RDB$FIELD_SUB_TYPE
195	                    WHEN 0 THEN &#x27;SMALLINT&#x27;
196	                    WHEN 1 THEN &#x27;NUMERIC(&#x27; || F.RDB$FIELD_PRECISION || &#x27;, &#x27; || (-F.RDB$FIELD_SCALE) || &#x27;)&#x27;
197	                    WHEN 2 THEN &#x27;DECIMAL&#x27;
198	                  END
199	                WHEN 8 THEN
200	                  CASE F.RDB$FIELD_SUB_TYPE
201	                    WHEN 0 THEN &#x27;INTEGER&#x27;
202	                    WHEN 1 THEN &#x27;NUMERIC(&#x27;  || F.RDB$FIELD_PRECISION || &#x27;, &#x27; || (-F.RDB$FIELD_SCALE) || &#x27;)&#x27;
203	                    WHEN 2 THEN &#x27;DECIMAL&#x27;
204	                  END
205	                WHEN 9 THEN &#x27;QUAD&#x27;
206	                WHEN 10 THEN &#x27;FLOAT&#x27;
207	                WHEN 12 THEN &#x27;DATE&#x27;
208	                WHEN 13 THEN &#x27;TIME&#x27;
209	                WHEN 14 THEN &#x27;CHAR(&#x27; || (TRUNC(F.RDB$FIELD_LENGTH / CH.RDB$BYTES_PER_CHARACTER)) || &#x27;) &#x27;
210	                WHEN 16 THEN
211	                  CASE F.RDB$FIELD_SUB_TYPE
212	                    WHEN 0 THEN &#x27;BIGINT&#x27;
213	                    WHEN 1 THEN &#x27;NUMERIC(&#x27; || F.RDB$FIELD_PRECISION || &#x27;, &#x27; || (-F.RDB$FIELD_SCALE) || &#x27;)&#x27;
214	                    WHEN 2 THEN &#x27;DECIMAL&#x27;
215	                  END
216	                WHEN 27 THEN &#x27;DOUBLE&#x27;
217	                WHEN 35 THEN &#x27;TIMESTAMP&#x27;
218	                WHEN 37 THEN &#x27;VARCHAR(&#x27; || (TRUNC(F.RDB$FIELD_LENGTH / CH.RDB$BYTES_PER_CHARACTER)) || &#x27;)&#x27;
219	                WHEN 40 THEN &#x27;CSTRING&#x27; || (TRUNC(F.RDB$FIELD_LENGTH / CH.RDB$BYTES_PER_CHARACTER)) || &#x27;)&#x27;
220	                WHEN 45 THEN &#x27;BLOB_ID&#x27;
221	                WHEN 261 THEN &#x27;BLOB SUB_TYPE &#x27; || F.RDB$FIELD_SUB_TYPE
222	                ELSE &#x27;RDB$FIELD_TYPE: &#x27; || F.RDB$FIELD_TYPE || &#x27;?&#x27;
223	              END FIELD_TYPE,
224	              IIF(COALESCE(RF.RDB$NULL_FLAG, 0) = 0, NULL, &#x27;NOT NULL&#x27;) FIELD_NULL,
225	              CH.RDB$CHARACTER_SET_NAME FIELD_CHARSET,
226	              DCO.RDB$COLLATION_NAME FIELD_COLLATION,
227	              COALESCE(RF.RDB$DEFAULT_SOURCE, F.RDB$DEFAULT_SOURCE) FIELD_DEFAULT,
228	              F.RDB$VALIDATION_SOURCE FIELD_CHECK,
229	              RF.RDB$DESCRIPTION FIELD_DESCRIPTION
230	            FROM RDB$RELATION_FIELDS RF
231	            JOIN RDB$FIELDS F ON (F.RDB$FIELD_NAME = RF.RDB$FIELD_SOURCE)
232	            LEFT OUTER JOIN RDB$CHARACTER_SETS CH ON (CH.RDB$CHARACTER_SET_ID = F.RDB$CHARACTER_SET_ID)
233	            LEFT OUTER JOIN RDB$COLLATIONS DCO ON ((DCO.RDB$COLLATION_ID = F.RDB$COLLATION_ID) AND (DCO.RDB$CHARACTER_SET_ID = F.RDB$CHARACTER_SET_ID))
234	            WHERE (RF.RDB$RELATION_NAME = &#x27;{table_name.upper()}&#x27;) AND (COALESCE(RF.RDB$SYSTEM_FLAG, 0) = 0)
235	            ORDER BY RF.RDB$FIELD_POSITION;
236	        &quot;&quot;&quot;
237	        result = self.native_query(query)
238	        df = result.data_frame
239	        result.data_frame = df.rename(columns={&#x27;FIELD_NAME&#x27;: &#x27;column_name&#x27;, &#x27;FIELD_TYPE&#x27;: &#x27;data_type&#x27;})
240	        return result
</pre>
</div>


</div>
</div>

<div id="issue-93">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/flaml_handler/flaml_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/flaml_handler/flaml_handler.py</a><br>
    <b>Line number: </b>1<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import dill
2	import pandas as pd
3	from mindsdb.integrations.libs.base import BaseMLEngine
4	from typing import Dict, Optional
5	from type_infer.api import infer_types
6	from flaml import AutoML
7	
8	
9	class FLAMLHandler(BaseMLEngine):
10	    name = &quot;FLAML&quot;
11	
12	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
13	        if args is None:
14	            args = {}
15	            
16	        if df is not None:
17	            target_dtype = infer_types(df, 0).to_dict()[&quot;dtypes&quot;][target]
18	            model = AutoML(verbose=0)
19	
20	            if target_dtype in [&#x27;binary&#x27;, &#x27;categorical&#x27;, &#x27;tags&#x27;]:
21	                model.fit(X_train=df.drop(columns=[target]),
22	                      y_train=df[target],
23	                      task=&#x27;classification&#x27;,
24	                      **args.get(&#x27;using&#x27;))
25	
26	            elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
27	                model.fit(X_train=df.drop(columns=[target]),
28	                      y_train=df[target],
29	                      task=&#x27;regression&#x27;,
30	                      **args.get(&#x27;using&#x27;))
31	                
32	            self.model_storage.json_set(&#x27;args&#x27;, args)
</pre>
</div>


</div>
</div>

<div id="issue-94">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/flaml_handler/flaml_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/flaml_handler/flaml_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
26	            elif target_dtype in [&#x27;integer&#x27;, &#x27;float&#x27;, &#x27;quantity&#x27;]:
27	                model.fit(X_train=df.drop(columns=[target]),
28	                      y_train=df[target],
29	                      task=&#x27;regression&#x27;,
30	                      **args.get(&#x27;using&#x27;))
31	                
32	            self.model_storage.json_set(&#x27;args&#x27;, args)
33	            self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model))
34	            
35	        else:
36	            raise Exception(
37	                &quot;Data is empty!!&quot;
38	            )
39	
40	    def predict(self, df: pd.DataFrame, args: Optional[Dict] = None) -&gt; pd.DataFrame:
41	
42	        model = dill.loads(self.model_storage.file_get(&quot;model&quot;))
43	        target = self.model_storage.json_get(&#x27;args&#x27;).get(&quot;target&quot;)
44	
45	        results = pd.DataFrame(model.predict(df), columns=[target])
46	
47	        return results
</pre>
</div>


</div>
</div>

<div id="issue-95">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
18	        self.domain = domain
19	        self.base_url = f&#x27;{self.domain}/api&#x27;
20	        self.access_token = access_token
21	
22	        self.headers = {
23	            &#x27;Authorization&#x27;: f&#x27;token {self.access_token}&#x27;,
24	        }
25	
26	    def get_document(self, doctype: str, name: str) -&gt; Dict:
27	        &quot;&quot;&quot;Gets a document matching the given doctype from Frappe.
28	        
29	        See https://frappeframework.com/docs/v14/user/en/api/rest#listing-documents
30	        Args:
31	            doctype (str): The document type to retrieve.
32	            name (str): Name of the document.
33	        &quot;&quot;&quot;
34	        document_response = requests.get(
35	            f&#x27;{self.base_url}/resource/{doctype}/{name}&#x27;,
36	            headers=self.headers)
37	        if not document_response.ok:
38	            document_response.raise_for_status()
39	        return document_response.json()[&#x27;data&#x27;]
40	
41	    def get_documents(self, doctype: str, limit: int = None, fields: List[str] = None, filters: List[List] = None) -&gt; List[Dict]:
42	        &quot;&quot;&quot;Gets all documents matching the given doctype from Frappe.
43	        
44	        See https://frappeframework.com/docs/v14/user/en/api/rest#listing-documents
45	        Args:
46	            doctype (str): The document type to retrieve.
47	            limit (int): At most, how many messages to return.
48	            filters (List[List]): List of filters in the form [field, operator, value] e.g. [&quot;amount&quot;, &quot;&gt;&quot;, 50]
49	        &quot;&quot;&quot;
50	        params = {
51	            &#x27;fields&#x27;: json.dumps([&quot;*&quot;])
</pre>
</div>


</div>
</div>

<div id="issue-96">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py</a><br>
    <b>Line number: </b>59<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
43	        
44	        See https://frappeframework.com/docs/v14/user/en/api/rest#listing-documents
45	        Args:
46	            doctype (str): The document type to retrieve.
47	            limit (int): At most, how many messages to return.
48	            filters (List[List]): List of filters in the form [field, operator, value] e.g. [&quot;amount&quot;, &quot;&gt;&quot;, 50]
49	        &quot;&quot;&quot;
50	        params = {
51	            &#x27;fields&#x27;: json.dumps([&quot;*&quot;])
52	        }
53	        if limit is not None:
54	            params[&#x27;limit_page_length&#x27;] = limit
55	        if filters is not None:
56	            params[&#x27;filters&#x27;] = json.dumps(filters)
57	        if fields is not None:
58	            params[&#x27;fields&#x27;] = json.dumps(fields)
59	        documents_response = requests.get(
60	            f&#x27;{self.base_url}/resource/{doctype}/&#x27;,
61	            params=params,
62	            headers=self.headers,
63	            allow_redirects=False)
64	        if documents_response.is_redirect:
65	            # We have to manually redirect to preserve the &#x27;Authorization&#x27; header.
66	            # See https://github.com/request/request/pull/1184/commits/210b326fd8625f358e06c59dc11e74468b1de515.
67	            redirect_url = documents_response.headers.get(&#x27;location&#x27;, None)
68	            if redirect_url is None:
69	                raise requests.HTTPError(&#x27;Could not find redirect URL&#x27;)
70	            documents_response = requests.get(
71	                redirect_url,
72	                params=params,
73	                headers=self.headers,
74	                allow_redirects=False)
75	
76	        if not documents_response.ok:
77	            documents_response.raise_for_status()
78	        return documents_response.json()[&#x27;data&#x27;]
</pre>
</div>


</div>
</div>

<div id="issue-97">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
54	            params[&#x27;limit_page_length&#x27;] = limit
55	        if filters is not None:
56	            params[&#x27;filters&#x27;] = json.dumps(filters)
57	        if fields is not None:
58	            params[&#x27;fields&#x27;] = json.dumps(fields)
59	        documents_response = requests.get(
60	            f&#x27;{self.base_url}/resource/{doctype}/&#x27;,
61	            params=params,
62	            headers=self.headers,
63	            allow_redirects=False)
64	        if documents_response.is_redirect:
65	            # We have to manually redirect to preserve the &#x27;Authorization&#x27; header.
66	            # See https://github.com/request/request/pull/1184/commits/210b326fd8625f358e06c59dc11e74468b1de515.
67	            redirect_url = documents_response.headers.get(&#x27;location&#x27;, None)
68	            if redirect_url is None:
69	                raise requests.HTTPError(&#x27;Could not find redirect URL&#x27;)
70	            documents_response = requests.get(
71	                redirect_url,
72	                params=params,
73	                headers=self.headers,
74	                allow_redirects=False)
75	
76	        if not documents_response.ok:
77	            documents_response.raise_for_status()
78	        return documents_response.json()[&#x27;data&#x27;]
79	
80	    def post_document(
81	            self,
82	            doctype: str,
83	            data: Dict):
84	        &quot;&quot;&quot;Creates a new document of the given doctype.
85	        See https://frappeframework.com/docs/v14/user/en/api/rest#listing-documents
86	        
87	        Args:
88	            doctype (str): Type of the document to create.
89	            data (Dict): Document object.
</pre>
</div>


</div>
</div>

<div id="issue-98">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py</a><br>
    <b>Line number: </b>91<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
75	
76	        if not documents_response.ok:
77	            documents_response.raise_for_status()
78	        return documents_response.json()[&#x27;data&#x27;]
79	
80	    def post_document(
81	            self,
82	            doctype: str,
83	            data: Dict):
84	        &quot;&quot;&quot;Creates a new document of the given doctype.
85	        See https://frappeframework.com/docs/v14/user/en/api/rest#listing-documents
86	        
87	        Args:
88	            doctype (str): Type of the document to create.
89	            data (Dict): Document object.
90	        &quot;&quot;&quot;
91	        post_response = requests.post(
92	            f&#x27;{self.base_url}/resource/{doctype}&#x27;,
93	            json=data,
94	            headers=self.headers)
95	        if not post_response.ok:
96	            if 400 &lt;= post_response.status_code &lt; 600:
97	                raise requests.HTTPError(f&#x27;{post_response.reason}: {post_response.text}&#x27;, response=post_response)
98	        return post_response.json()[&#x27;data&#x27;]
99	
100	    def ping(self) -&gt; bool:
101	        &quot;&quot;&quot;Sends a basic request to the Frappe API to see if it succeeds.
102	        
103	        Returns whether or not the connection to the Frappe API is valid.
104	        See https://frappeframework.com/docs/v14/user/en/api/rest#1-token-based-authentication
105	        &quot;&quot;&quot;
106	
107	        # No ping or similar endpoint exists, so we&#x27;ll try getting the logged in user.
108	        user_response = requests.get(
109	            f&#x27;{self.base_url}/method/frappe.auth.get_logged_user&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-99">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/frappe_handler/frappe_client.py</a><br>
    <b>Line number: </b>108<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
92	            f&#x27;{self.base_url}/resource/{doctype}&#x27;,
93	            json=data,
94	            headers=self.headers)
95	        if not post_response.ok:
96	            if 400 &lt;= post_response.status_code &lt; 600:
97	                raise requests.HTTPError(f&#x27;{post_response.reason}: {post_response.text}&#x27;, response=post_response)
98	        return post_response.json()[&#x27;data&#x27;]
99	
100	    def ping(self) -&gt; bool:
101	        &quot;&quot;&quot;Sends a basic request to the Frappe API to see if it succeeds.
102	        
103	        Returns whether or not the connection to the Frappe API is valid.
104	        See https://frappeframework.com/docs/v14/user/en/api/rest#1-token-based-authentication
105	        &quot;&quot;&quot;
106	
107	        # No ping or similar endpoint exists, so we&#x27;ll try getting the logged in user.
108	        user_response = requests.get(
109	            f&#x27;{self.base_url}/method/frappe.auth.get_logged_user&#x27;,
110	            headers=self.headers)
111	        return user_response.ok
</pre>
</div>


</div>
</div>

<div id="issue-100">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/gmail_handler/gmail_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/gmail_handler/gmail_handler.py</a><br>
    <b>Line number: </b>316<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
300	        self.scopes = self.connection_args.get(&#x27;scopes&#x27;, DEFAULT_SCOPES)
301	        self.token_file = None
302	        self.max_page_size = 500
303	        self.max_batch_size = 100
304	        self.service = None
305	        self.is_connected = False
306	
307	        self.handler_storage = kwargs[&#x27;handler_storage&#x27;]
308	
309	        emails = EmailsTable(self)
310	        self.emails = emails
311	        self._register_table(&#x27;emails&#x27;, emails)
312	
313	    def _download_secret_file(self, secret_file):
314	        # Giving more priority to the S3 file
315	        if self.credentials_url:
316	            response = requests.get(self.credentials_url)
317	            if response.status_code == 200:
318	                with open(secret_file, &#x27;w&#x27;) as creds:
319	                    creds.write(response.text)
320	                return True
321	            else:
322	                logger.error(&quot;Failed to get credentials from S3&quot;, response.status_code)
323	
324	        if self.credentials_file and os.path.isfile(self.credentials_file):
325	            copyfile(self.credentials_file, secret_file)
326	            return True
327	        return False
328	
329	    def create_connection(self):
330	        creds = None
331	
</pre>
</div>


</div>
</div>

<div id="issue-101">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/google_calendar_handler/google_calendar_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/google_calendar_handler/google_calendar_handler.py</a><br>
    <b>Line number: </b>74<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
58	        Set up any connections required by the handler
59	        Should return output of check_connection() method after attempting
60	        connection. Should switch self.is_connected.
61	        Returns:
62	            HandlerStatusResponse
63	        &quot;&quot;&quot;
64	        if self.is_connected is True:
65	            return self.service
66	
67	        secret_file = self.credentials_file
68	
69	        curr_dir = self.handler_storage.folder_get(&#x27;config&#x27;)
70	
71	        creds_file = None
72	        try:
73	            creds_file = os.path.join(curr_dir, &#x27;secret.json&#x27;)
74	        except Exception:
75	            pass
76	
77	        creds = None
78	        if os.path.isfile(creds_file):
79	            creds = Credentials.from_authorized_user_file(creds_file, self.scopes)
80	
81	        if not creds or not creds.valid:
82	            if creds and creds.expired and creds.refresh_token:
83	                creds.refresh(Request())
84	
85	                save_creds_to_file(creds, creds_file)
86	                self.handler_storage.folder_sync(&#x27;config&#x27;)
87	
88	            else:
89	                creds = google_auth_flow(secret_file, self.scopes, self.connection_data.get(&#x27;code&#x27;))
90	
</pre>
</div>


</div>
</div>

<div id="issue-102">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/google_gemini_handler/google_gemini_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/google_gemini_handler/google_gemini_handler.py</a><br>
    <b>Line number: </b>317<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
301	                    str(
302	                        genai.embed_content(
303	                            model=model_name, content=doc, task_type=task_type
304	                        )[&quot;embedding&quot;]
305	                    )
306	                    for doc in prompts
307	                ]
308	
309	            pred_df = pd.DataFrame(results, columns=[args[&quot;target&quot;]])
310	            return pred_df
311	        else:
312	            raise Exception(&quot;Embedding mode needs a question_column&quot;)
313	
314	    def vision_worker(self, args: Dict, df: pd.DataFrame):
315	        def get_img(url):
316	            # URL Validation
317	            response = requests.get(url)
318	            if response.status_code == 200 and response.headers.get(
319	                &quot;content-type&quot;, &quot;&quot;
320	            ).startswith(&quot;image/&quot;):
321	                return Image.open(BytesIO(response.content))
322	            else:
323	                raise Exception(f&quot;{url} is not vaild image URL..&quot;)
324	
325	        if args.get(&quot;img_url&quot;):
326	            urls = list(df[args[&quot;img_url&quot;]].apply(lambda x: str(x)))
327	
328	        else:
329	            raise Exception(&quot;Vision mode needs a img_url&quot;)
330	
331	        prompts = None
332	        if args.get(&quot;ctx_column&quot;):
</pre>
</div>


</div>
</div>

<div id="issue-103">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
26	        self._register_table(&#x27;hnstories&#x27;,hnstories)
27	
28	        jobstories = JobStoriesTable(self)
29	        self._register_table(&#x27;jobstories&#x27;,jobstories)
30	
31	        showstories = ShowStoriesTable(self)
32	        self._register_table(&#x27;showstories&#x27;, showstories)
33	
34	        comments = CommentsTable(self)
35	        self._register_table(&#x27;comments&#x27;, comments)
36	
37	    def connect(self):
38	        return
39	
40	    def check_connection(self) -&gt; StatusResponse:
41	        try:
42	            response = requests.get(f&#x27;{self.base_url}/maxitem.json&#x27;)
43	            response.raise_for_status()
44	            return StatusResponse(True)
45	        except Exception as e:
46	            logger.error(f&#x27;Error checking connection: {e}&#x27;)
47	            return StatusResponse(False, str(e))
48	
49	    def native_query(self, query_string: str = None):
50	        method_name, params = self.parse_native_query(query_string)
51	
52	        df = self.call_hackernews_api(method_name, params)
53	
54	        return Response(
55	            RESPONSE_TYPE.TABLE,
56	            data_frame=df
57	        )
</pre>
</div>


</div>
</div>

<div id="issue-104">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py</a><br>
    <b>Line number: </b>61<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
45	        except Exception as e:
46	            logger.error(f&#x27;Error checking connection: {e}&#x27;)
47	            return StatusResponse(False, str(e))
48	
49	    def native_query(self, query_string: str = None):
50	        method_name, params = self.parse_native_query(query_string)
51	
52	        df = self.call_hackernews_api(method_name, params)
53	
54	        return Response(
55	            RESPONSE_TYPE.TABLE,
56	            data_frame=df
57	        )
58	
59	    def get_df_from_class(self, table: StoriesTable = None, limit: int = None):
60	        url = f&#x27;{self.base_url}/{table.json_endpoint}&#x27;
61	        response = requests.get(url)
62	        data = response.json()
63	        stories_data = []
64	        if limit is None:
65	            limit = len(data)
66	        for story_id in data[:limit]:
67	            url = f&#x27;{self.base_url}/item/{story_id}.json&#x27;
68	            response = requests.get(url)
69	            story_data = response.json()
70	            stories_data.append(story_data)
71	        return pd.DataFrame(stories_data, columns=table.columns)
72	
73	    def call_hackernews_api(self, method_name: str = None, params: dict = None):
74	        story_method_handlers = {
75	            &#x27;get_top_stories&#x27;: StoriesTable,
76	            &#x27;ask_hn_stories&#x27;: HNStoriesTable,
</pre>
</div>


</div>
</div>

<div id="issue-105">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py</a><br>
    <b>Line number: </b>68<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
52	        df = self.call_hackernews_api(method_name, params)
53	
54	        return Response(
55	            RESPONSE_TYPE.TABLE,
56	            data_frame=df
57	        )
58	
59	    def get_df_from_class(self, table: StoriesTable = None, limit: int = None):
60	        url = f&#x27;{self.base_url}/{table.json_endpoint}&#x27;
61	        response = requests.get(url)
62	        data = response.json()
63	        stories_data = []
64	        if limit is None:
65	            limit = len(data)
66	        for story_id in data[:limit]:
67	            url = f&#x27;{self.base_url}/item/{story_id}.json&#x27;
68	            response = requests.get(url)
69	            story_data = response.json()
70	            stories_data.append(story_data)
71	        return pd.DataFrame(stories_data, columns=table.columns)
72	
73	    def call_hackernews_api(self, method_name: str = None, params: dict = None):
74	        story_method_handlers = {
75	            &#x27;get_top_stories&#x27;: StoriesTable,
76	            &#x27;ask_hn_stories&#x27;: HNStoriesTable,
77	            &#x27;get_job_stories&#x27;: JobStoriesTable,
78	            &#x27;show_hn_stories&#x27;: ShowStoriesTable,
79	        }
80	        if method_name in story_method_handlers:
81	            table = story_method_handlers[method_name]
82	            df = self.get_df_from_class(table)
83	        elif method_name == &#x27;get_comments&#x27;:
</pre>
</div>


</div>
</div>

<div id="issue-106">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py</a><br>
    <b>Line number: </b>86<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
70	            stories_data.append(story_data)
71	        return pd.DataFrame(stories_data, columns=table.columns)
72	
73	    def call_hackernews_api(self, method_name: str = None, params: dict = None):
74	        story_method_handlers = {
75	            &#x27;get_top_stories&#x27;: StoriesTable,
76	            &#x27;ask_hn_stories&#x27;: HNStoriesTable,
77	            &#x27;get_job_stories&#x27;: JobStoriesTable,
78	            &#x27;show_hn_stories&#x27;: ShowStoriesTable,
79	        }
80	        if method_name in story_method_handlers:
81	            table = story_method_handlers[method_name]
82	            df = self.get_df_from_class(table)
83	        elif method_name == &#x27;get_comments&#x27;:
84	            item_id = params.get(&#x27;item_id&#x27;)
85	            url = f&#x27;{self.base_url}/item/{item_id}.json&#x27;
86	            response = requests.get(url)
87	            item_data = response.json()
88	            if &#x27;kids&#x27; in item_data:
89	                comments_data = []
90	                for comment_id in item_data[&#x27;kids&#x27;]:
91	                    url = f&#x27;{self.base_url}/item/{comment_id}.json&#x27;
92	                    response = requests.get(url)
93	                    comment_data = response.json()
94	                    comments_data.append(comment_data)
95	                df = pd.DataFrame(comments_data)
96	            else:
97	                df = pd.DataFrame()
98	        else:
99	            raise ValueError(f&#x27;Unknown method_name: {method_name}&#x27;)
100	
101	        return df
</pre>
</div>


</div>
</div>

<div id="issue-107">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hackernews_handler/hn_handler.py</a><br>
    <b>Line number: </b>92<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
76	            &#x27;ask_hn_stories&#x27;: HNStoriesTable,
77	            &#x27;get_job_stories&#x27;: JobStoriesTable,
78	            &#x27;show_hn_stories&#x27;: ShowStoriesTable,
79	        }
80	        if method_name in story_method_handlers:
81	            table = story_method_handlers[method_name]
82	            df = self.get_df_from_class(table)
83	        elif method_name == &#x27;get_comments&#x27;:
84	            item_id = params.get(&#x27;item_id&#x27;)
85	            url = f&#x27;{self.base_url}/item/{item_id}.json&#x27;
86	            response = requests.get(url)
87	            item_data = response.json()
88	            if &#x27;kids&#x27; in item_data:
89	                comments_data = []
90	                for comment_id in item_data[&#x27;kids&#x27;]:
91	                    url = f&#x27;{self.base_url}/item/{comment_id}.json&#x27;
92	                    response = requests.get(url)
93	                    comment_data = response.json()
94	                    comments_data.append(comment_data)
95	                df = pd.DataFrame(comments_data)
96	            else:
97	                df = pd.DataFrame()
98	        else:
99	            raise ValueError(f&#x27;Unknown method_name: {method_name}&#x27;)
100	
101	        return df
102	
</pre>
</div>


</div>
</div>

<div id="issue-108">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hana_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hana_handler/connection_args.py</a><br>
    <b>Line number: </b>99<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
83	    splitBatchCommands={
84	        &#x27;type&#x27;: ARG_TYPE.BOOL,
85	        &#x27;description&#x27;: &#x27;Allows split and parallel execution of batch commands on partitioned tables.&#x27;
86	    },
87	    routeDirectExecute={
88	        &#x27;type&#x27;: ARG_TYPE.BOOL,
89	        &#x27;description&#x27;: dedent(&quot;&quot;&quot;Converts direct execute into prepare and execute (routed execute) if the
90	        number of index servers is more than one and if statement routing is enabled.&quot;&quot;&quot;)
91	    },
92	    secondarySessionFallback={
93	        &#x27;type&#x27;: ARG_TYPE.BOOL,
94	        &#x27;description&#x27;: dedent(&quot;&quot;&quot;Forces the ongoing transaction on a non-anchor connection to fall back
95	        to the anchor/primary connection if this connection is dropped by the network or server.&quot;&quot;&quot;)
96	    }
97	)
98	
99	connection_args_example = OrderedDict(
100	    host=&#x27;&lt;uuid&gt;.hana.trial-us10.hanacloud.ondemand.com&#x27;,
101	    port=30013,
102	    user=&#x27;DBADMIN&#x27;,
103	    password=&#x27;password&#x27;,
104	    schema=&#x27;MINDSDB&#x27;,
105	)
</pre>
</div>


</div>
</div>

<div id="issue-109">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hana_handler/hana_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hana_handler/hana_handler.py</a><br>
    <b>Line number: </b>188<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
172	
173	        return response
174	
175	    def query(self, query: ASTNode) -&gt; Response:
176	        &quot;&quot;&quot;
177	        Retrieve the data from the SQL statement with eliminated rows that dont satisfy the WHERE condition
178	        &quot;&quot;&quot;
179	
180	        query_str = self.renderer.get_string(query, with_failback=True)
181	        return self.native_query(query_str)
182	
183	    def get_tables(self) -&gt; Response:
184	        &quot;&quot;&quot;
185	        List all tables in SAP HANA in the current schema
186	        &quot;&quot;&quot;
187	
188	        return self.native_query(f&quot;&quot;&quot;
189	            SELECT SCHEMA_NAME,
190	                   TABLE_NAME,
191	                   TABLE_TYPE
192	            FROM
193	                SYS.TABLES
194	            WHERE IS_SYSTEM_TABLE = &#x27;FALSE&#x27;  
195	              AND IS_USER_DEFINED_TYPE = &#x27;FALSE&#x27;
196	              AND IS_TEMPORARY = &#x27;FALSE&#x27;
197	        &quot;&quot;&quot;)
198	
199	    def get_columns(self, table_name: str) -&gt; Response:
200	        &quot;&quot;&quot;
201	        List all columns in a table in SAP HANA in the current schema
202	        :param table_name: the table name for which to list the columns
203	        :return: returns the columns in the table
204	        &quot;&quot;&quot;
205	
206	        return self.renderer.dialect.get_columns(table_name)
</pre>
</div>


</div>
</div>

<div id="issue-110">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hive_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hive_handler/connection_args.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Hive server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the Hive server. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Hive server. Must be an integer.&#x27;
27	    },
28	    auth={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The Auth type of the Hive server.&#x27;
31	    }
32	)
33	
34	connection_args_example = OrderedDict(
35	    host=&#x27;127.0.0.1&#x27;,
36	    port=&#x27;10000&#x27;,
37	    auth=&#x27;CUSTOM&#x27;,
38	    user=&#x27;root&#x27;,
39	    password=&#x27;password&#x27;,
40	    database=&#x27;database&#x27;
41	)
</pre>
</div>


</div>
</div>

<div id="issue-111">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hsqldb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hsqldb_handler/connection_args.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
17	        &#x27;description&#x27;: &#x27;&#x27;&#x27;
18	            The database name to use when connecting.
19	        &#x27;&#x27;&#x27;
20	    },
21	    username={
22	        &#x27;type&#x27;: ARG_TYPE.STR,
23	        &#x27;description&#x27;: &#x27;The user name used to authenticate.&#x27;
24	    },
25	    password={
26	        &#x27;type&#x27;: ARG_TYPE.PWD,
27	        &#x27;description&#x27;: &#x27;The password to authenticate.&#x27;,
28	        &#x27;secret&#x27;: True
29	    },
30	    
31	)
32	
33	connection_args_example = OrderedDict(
34	    server_name = &#x27;localhost&#x27;,
35	    port =  9001,
36	    database_name = &#x27;xdb&#x27;,
37	    username = &#x27;SA&#x27;,
38	    password = &#x27;password&#x27;
39	)
</pre>
</div>


</div>
</div>

<div id="issue-112">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/hsqldb_handler/hsqldb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/hsqldb_handler/hsqldb_handler.py</a><br>
    <b>Line number: </b>184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
168	            df
169	        )
170	
171	        return response
172	
173	    def get_columns(self, table_name: str) -&gt; StatusResponse:
174	        &quot;&quot;&quot;
175	        Returns a list of entity columns.
176	        Args:
177	            table_name (str): name of one of tables returned by self.get_tables()
178	        Returns:
179	            HandlerResponse
180	        &quot;&quot;&quot;
181	
182	        connection = self.connect()
183	        cursor = connection.cursor()
184	        query = f&#x27;SELECT * FROM information_schema.columns WHERE table_name ={table_name}&#x27; # Workaround since cursor.columns() wont work with postgres driver
185	        cursor.execute(query)
186	        results = cursor.fetchall()
187	        df = pd.DataFrame(
188	            [(x[3], x[7]) for x in results],
189	            columns=[&#x27;column_name&#x27;, &#x27;data_type&#x27;]
190	        )
191	
192	        response = Response(
193	            RESPONSE_TYPE.TABLE,
194	            df
195	        )
196	
197	        return response
</pre>
</div>


</div>
</div>

<div id="issue-113">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/huggingface_api_handler/huggingface_api_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/huggingface_api_handler/huggingface_api_handler.py</a><br>
    <b>Line number: </b>79<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
63	
64	        args = args[&#x27;using&#x27;]
65	        args[&#x27;target&#x27;] = target
66	
67	        if &#x27;options&#x27; not in args:
68	            args[&#x27;options&#x27;] = {}
69	
70	        if &#x27;parameters&#x27; not in args:
71	            args[&#x27;parameters&#x27;] = {}
72	
73	        if args[&#x27;model_name&#x27;] is not None:
74	            # config.json
75	            config = {}
76	            try:
77	                config_path = hf_hub_download(args[&#x27;model_name&#x27;], &#x27;config.json&#x27;)
78	                config = json.load(open(config_path))
79	            except Exception:
80	                pass
81	
82	            if &#x27;max_length&#x27; in args:
83	                args[&#x27;options&#x27;][&#x27;max_length&#x27;] = args[&#x27;max_length&#x27;]
84	            elif &#x27;max_position_embeddings&#x27; in config:
85	                args[&#x27;options&#x27;][&#x27;max_length&#x27;] = config[&#x27;max_position_embeddings&#x27;]
86	            elif &#x27;max_length&#x27; in config:
87	                args[&#x27;options&#x27;][&#x27;max_length&#x27;] = config[&#x27;max_length&#x27;]
88	
89	            labels_default = config.get(&#x27;id2label&#x27;, {})
90	            labels_map = {}
91	            if &#x27;labels&#x27; in args:
92	                for num, value in labels_default.items():
93	                    if num.isdigit():
94	                        num = int(num)
95	                        labels_map[value] = args[&#x27;labels&#x27;][num]
</pre>
</div>


</div>
</div>

<div id="issue-114">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ignite_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ignite_handler/connection_args.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
24	    },
25	    password={
26	        &#x27;type&#x27;: ARG_TYPE.PWD,
27	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Apache Ignite cluster. This parameter is optional. Default: None.&#x27;,
28	        &#x27;required&#x27;: True,
29	        &#x27;label&#x27;: &#x27;Password&#x27;,
30	        &#x27;secret&#x27;: True
31	    },
32	    schema={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;Schema to use for the connection to the Apache Ignite cluster. This parameter is optional. Default: PUBLIC.&#x27;,
35	        &#x27;required&#x27;: True,
36	        &#x27;label&#x27;: &#x27;Schema&#x27;
37	    }
38	)
39	
40	connection_args_example = OrderedDict(
41	    host=&#x27;127.0.0.1&#x27;,
42	    port=&#x27;10800&#x27;,
43	    username=&#x27;root&#x27;,
44	    password=&#x27;password&#x27;,
45	    schema=&#x27;schema&#x27;
46	)
</pre>
</div>


</div>
</div>

<div id="issue-115">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ignite_handler/ignite_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ignite_handler/ignite_handler.py</a><br>
    <b>Line number: </b>199<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
183	            SELECT TABLE_NAME FROM SYS.TABLES
184	        &quot;&quot;&quot;
185	        result = self.native_query(query)
186	        df = result.data_frame
187	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
188	        return result
189	
190	    def get_columns(self, table_name: str) -&gt; StatusResponse:
191	        &quot;&quot;&quot;
192	        Returns a list of entity columns.
193	        Args:
194	            table_name (str): name of one of tables returned by self.get_tables()
195	        Returns:
196	            HandlerResponse
197	        &quot;&quot;&quot;
198	
199	        query = f&quot;&quot;&quot;
200	            SELECT COLUMN_NAME, TYPE FROM SYS.TABLE_COLUMNS WHERE TABLE_NAME = &#x27;{table_name.upper()}&#x27;
201	        &quot;&quot;&quot;
202	        result = self.native_query(query)
203	        df = result.data_frame
204	        df[&#x27;TYPE&#x27;] = df.apply(lambda row: row[&#x27;TYPE&#x27;].split(&#x27;.&#x27;)[-1], axis=1)
205	        df = df.iloc[2:]
206	        result.data_frame = df.rename(columns={&#x27;COLUMN_NAME&#x27;: &#x27;column_name&#x27;, &#x27;TYPE&#x27;: &#x27;data_type&#x27;})
207	        return result
</pre>
</div>


</div>
</div>

<div id="issue-116">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'P@55W0Rd'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/impala_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/impala_handler/connection_args.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Impala server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the Impala server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Impala server. Must be an integer. Default is 21050&#x27;
27	    }
28	
29	)
30	
31	connection_args_example = OrderedDict(
32	    host=&#x27;127.0.0.1&#x27;,
33	    port=21050,
34	    user=&#x27;USERNAME&#x27;,
35	    password=&#x27;P@55W0Rd&#x27;,
36	    database=&#x27;D4t4bA5e&#x27;
37	)
</pre>
</div>


</div>
</div>

<div id="issue-117">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_handler.py</a><br>
    <b>Line number: </b>102<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
86	        -------
87	        StatusResponse
88	            Request status
89	        &quot;&quot;&quot;
90	        ast = parse_sql(query, dialect=&quot;mindsdb&quot;)
91	        return self.query(ast)
92	
93	    def call_influxdb_tables(self,query):
94	        &quot;&quot;&quot;Pulls all the records from the given  InfluxDB table and returns it select()
95	    
96	        Returns
97	        -------
98	        pd.DataFrame of all the records of the particular InfluxDB 
99	        &quot;&quot;&quot;
100	        influx_connection=self.connect()
101	        if query is None:
102	            query=&#x27;SELECT * FROM &#x27;+ f&quot;{self.connection_data[&#x27;influxdb_table_name&#x27;]}&quot;
103	        
104	        table=influx_connection.query(query=query,database=self.connection_data[&#x27;influxdb_db_name&#x27;], language=&#x27;sql&#x27;)
105	        return table.to_pandas()
</pre>
</div>


</div>
</div>

<div id="issue-118">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_tables.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_tables.py</a><br>
    <b>Line number: </b>60<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
44	        except Exception as e:
45	            logger.warn(e)
46	
47	        formatted_query=self.get_select_query(table_name,selected_columns,where_conditions,order_by_conditions,query.limit)
48	        influxdb_tables_df  = self.handler.call_influxdb_tables(formatted_query)
49	
50	        return influxdb_tables_df
51	
52	    def get_columns(self) -&gt; List[str]:
53	        &quot;&quot;&quot;Gets all columns to be returned in pandas DataFrame responses
54	        Returns
55	        -------
56	        List[str]
57	            List of columns
58	        &quot;&quot;&quot;
59	        
60	        dataframe = self.handler.call_influxdb_tables(f&quot;SELECT * FROM {self.handler.connection_data[&#x27;influxdb_table_name&#x27;]} LIMIT 1&quot;)
61	
62	        return list(dataframe.columns)
63	    def get_select_query(self,table_name,selected_columns, where_conditions, order_by_conditions, result_limit):
64	        &quot;&quot;&quot;Gets Well formed Query
65	        Returns
66	        -------
67	        str
68	        &quot;&quot;&quot;
69	        columns=&quot;, &quot;.join([f&#x27;&quot;{column}&quot;&#x27; for column in selected_columns])
70	        query=f&#x27;SELECT {columns} FROM &quot;{table_name}&quot;&#x27;
71	        if(where_conditions is not None and len(where_conditions)&gt;0):
72	            query+=&quot; WHERE &quot;
73	            query+=&quot; AND &quot;.join([f&quot;{i[1]} {i[0]} {i[2]}&quot; for i in where_conditions])
74	        if (order_by_conditions!={} and order_by_conditions[&#x27;columns&#x27;] is not None and len(order_by_conditions[&#x27;columns&#x27;])&gt;0):
75	            query+=&quot; ORDER BY &quot;
</pre>
</div>


</div>
</div>

<div id="issue-119">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_tables.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/influxdb_handler/influxdb_tables.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
54	        Returns
55	        -------
56	        List[str]
57	            List of columns
58	        &quot;&quot;&quot;
59	        
60	        dataframe = self.handler.call_influxdb_tables(f&quot;SELECT * FROM {self.handler.connection_data[&#x27;influxdb_table_name&#x27;]} LIMIT 1&quot;)
61	
62	        return list(dataframe.columns)
63	    def get_select_query(self,table_name,selected_columns, where_conditions, order_by_conditions, result_limit):
64	        &quot;&quot;&quot;Gets Well formed Query
65	        Returns
66	        -------
67	        str
68	        &quot;&quot;&quot;
69	        columns=&quot;, &quot;.join([f&#x27;&quot;{column}&quot;&#x27; for column in selected_columns])
70	        query=f&#x27;SELECT {columns} FROM &quot;{table_name}&quot;&#x27;
71	        if(where_conditions is not None and len(where_conditions)&gt;0):
72	            query+=&quot; WHERE &quot;
73	            query+=&quot; AND &quot;.join([f&quot;{i[1]} {i[0]} {i[2]}&quot; for i in where_conditions])
74	        if (order_by_conditions!={} and order_by_conditions[&#x27;columns&#x27;] is not None and len(order_by_conditions[&#x27;columns&#x27;])&gt;0):
75	            query+=&quot; ORDER BY &quot;
76	            query+=&quot;, &quot;.join([f&#x27;{column_name} {&quot;ASC&quot;if asc else &quot;DESC&quot;}&#x27; for column_name,asc in zip(order_by_conditions[&#x27;columns&#x27;],order_by_conditions[&#x27;ascending&#x27;])] )
77	        if(result_limit is not None):
78	            query+=f&quot; LIMIT {result_limit}&quot;
79	        query+=&quot;;&quot;
80	        return query
81	
</pre>
</div>


</div>
</div>

<div id="issue-120">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'in4mix'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/informix_handler/informix_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/informix_handler/informix_handler.py</a><br>
    <b>Line number: </b>309<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
293	    },
294	    schema_name={
295	        &#x27;type&#x27;: ARG_TYPE.STR,
296	        &#x27;description&#x27;: &#x27;Specify the schema name for showing tables &#x27;
297	    },
298	    logging_enabled={
299	        &#x27;type&#x27;: ARG_TYPE.BOOL,
300	        &#x27;description&#x27;: &#x27;&#x27;&#x27;
301	        Used for COMMIT and ROLLBACK as this command works only for logging enabled database.
302	        Note: Its optional.
303	        Default is TRUE
304	        &#x27;&#x27;&#x27;
305	    }
306	
307	)
308	
309	connection_args_example = OrderedDict(
310	    server=&#x27;server&#x27;,
311	    database=&#x27;stores_demo&#x27;,
312	    user=&#x27;informix&#x27;,
313	    password=&#x27;in4mix&#x27;,
314	    host=&#x27;127.0.0.1&#x27;,
315	    port=&#x27;9091&#x27;,
316	    schema_name=&#x27;Love&#x27;
317	    
318	)
</pre>
</div>


</div>
</div>

<div id="issue-121">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ingres_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ingres_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    server={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The server used to authenticate with the Ingres server.&#x27;
19	    },
20	    database={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;Specify database name to connect Ingres server&#x27;
23	    },
24	    servertype={
25	        &#x27;type&#x27;: ARG_TYPE.STR,
26	        &#x27;description&#x27;: &#x27;Specify server type to connect Ingres server&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    user=&#x27;admin&#x27;,
32	    password=&#x27;password&#x27;,
33	    server=&#x27;(local)&#x27;,
34	    database=&#x27;test_db&#x27;,
35	    servertype=&#x27;ingres&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-122">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ingres_handler/ingres_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ingres_handler/ingres_handler.py</a><br>
    <b>Line number: </b>196<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
180	        )
181	
182	        return response
183	
184	    def get_columns(self, table_name: str) -&gt; Response:
185	        &quot;&quot;&quot;
186	        Gets a list of column names in the specified table.
187	
188	        Args:
189	            table_name (str): The name of the table to get column names from.
190	
191	        Returns:
192	            list: A list of column names in the specified table.
193	        &quot;&quot;&quot;
194	        conn = self.connect()
195	        cursor = conn.cursor()
196	        cursor.execute(&quot;SELECT column_name FROM iicolumns WHERE table_name = &#x27;{}&#x27;&quot;.format(table_name))
197	        results = cursor.fetchall()
198	
199	        # construct a pandas dataframe from the query results
200	        df = pd.DataFrame(
201	            results,
202	            columns=[&#x27;column_name&#x27;, &#x27;data_type&#x27;]
203	        )
204	
205	        response = Response(
206	            RESPONSE_TYPE.TABLE,
207	            df
208	        )
209	
210	        return response
</pre>
</div>


</div>
</div>

<div id="issue-123">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/instatus_handler/instatus_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/instatus_handler/instatus_handler.py</a><br>
    <b>Line number: </b>66<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
50	            response.success = True
51	        except Exception as e:
52	            logger.error(f&#x27;Error connecting to Instatus API: {e}!&#x27;)
53	            response.error_message = e
54	
55	        self.is_connected = response.success
56	        return response
57	
58	    def connect(self) -&gt; StatusResponse:
59	        # If already connected, return the existing connection
60	        if self.is_connected and self.connection:
61	            return self.connection
62	
63	        if self._api_key:
64	            try:
65	                headers = {&quot;Authorization&quot;: f&quot;Bearer {self._api_key}&quot;}
66	                response = requests.get(f&quot;{self._base_url}/v2/pages&quot;, headers=headers)
67	
68	                if response.status_code == 200:
69	                    self.connection = response
70	                    self.is_connected = True
71	                    return StatusResponse(True)
72	                else:
73	                    raise Exception(f&quot;Error connecting to Instatus API: {response.status_code} - {response.text}&quot;)
74	            except requests.RequestException as e:
75	                raise Exception(f&quot;Request to Instatus API failed: {str(e)}&quot;)
76	
77	        raise Exception(&quot;API key is missing&quot;)
78	
79	    def native_query(self, query: str) -&gt; StatusResponse:
80	        &quot;&quot;&quot;Receive and process a raw query.
81	
</pre>
</div>


</div>
</div>

<div id="issue-124">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/intercom_handler/intercom_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/intercom_handler/intercom_handler.py</a><br>
    <b>Line number: </b>62<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
46	            response.success = True
47	        except Exception as e:
48	            logger.error(f&#x27;Error connecting to Intercom API: {e}!&#x27;)
49	            response.error_message = e
50	
51	        self.is_connected = response.success
52	        return response
53	
54	    def connect(self) -&gt; StatusResponse:
55	        &quot;&quot;&quot;making the connectino object
56	        &quot;&quot;&quot;
57	        if self.is_connected and self.connection:
58	            return self.connection
59	
60	        if self._headers:
61	            try:
62	                response = requests.get(
63	                    url=self._baseUrl,
64	                    headers=self._headers
65	                )
66	                if response.status_code == 200:
67	                    self.connection = response
68	                    self.is_connected = True
69	                    return StatusResponse(True)
70	                else:
71	                    raise Exception(f&quot;Error connecting to Intercom API: {response.status_code} - {response.text}&quot;)
72	            except requests.RequestException as e:
73	                raise Exception(f&quot;Request to Intercom API failed: {str(e)}&quot;)
74	
75	        raise Exception(&quot;Access token is missing&quot;)
76	
77	    def native_query(self, query: str) -&gt; StatusResponse:
78	        &quot;&quot;&quot;Receive and process a raw query.
79	
80	        Parameters
</pre>
</div>


</div>
</div>

<div id="issue-125">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/kinetica_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/kinetica_handler/connection_args.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
36	        &#x27;label&#x27;: &#x27;Port&#x27;,
37	    },
38	    schema={
39	        &#x27;type&#x27;: ARG_TYPE.STR,
40	        &#x27;description&#x27;: &#x27;The schema in which objects are searched first.&#x27;,
41	        &#x27;required&#x27;: False,
42	        &#x27;label&#x27;: &#x27;Schema&#x27;,
43	    },
44	    sslmode={
45	        &#x27;type&#x27;: ARG_TYPE.STR,
46	        &#x27;description&#x27;: &#x27;sslmode that will be used for connection.&#x27;,
47	        &#x27;required&#x27;: False,
48	        &#x27;label&#x27;: &#x27;sslmode&#x27;,
49	    },
50	)
51	
52	connection_args_example = OrderedDict(
53	    host=&#x27;127.0.0.1&#x27;, port=5432, user=&#x27;root&#x27;, password=&#x27;password&#x27;, database=&#x27;database&#x27;
54	)
</pre>
</div>


</div>
</div>

<div id="issue-126">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py</a><br>
    <b>Line number: </b>219<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
203	            vector_filter = None
204	
205	        if vector_filter is not None:
206	            vec = json.loads(vector_filter.value) if isinstance(vector_filter.value, str) else vector_filter.value
207	            result = collection.search(vec).select(columns).to_pandas()
208	            result = result.rename(columns={&quot;_distance&quot;: TableField.DISTANCE.value})
209	        else:
210	            result = self._client.open_table(table_name).to_pandas()
211	
212	        new_columns = columns + [TableField.DISTANCE.value] if TableField.DISTANCE.value in result.columns else columns
213	
214	        col_str = &#x27;, &#x27;.join([col for col in new_columns if col in (TableField.ID.value, TableField.CONTENT.value, TableField.METADATA.value, TableField.EMBEDDINGS.value, TableField.DISTANCE.value)])
215	
216	        where_str = f&#x27;where {filters}&#x27; if filters else &#x27;&#x27;
217	        # implementing limit and offset. Not supported natively in lancedb
218	        if limit and offset:
219	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit} offset {offset}&quot;&quot;&quot;
220	        elif limit and not offset:
221	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit}&quot;&quot;&quot;
222	        elif offset and not limit:
223	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} offset {offset}&quot;&quot;&quot;
224	        else:
225	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str}&quot;&quot;&quot;
226	
227	        data_df = duckdb.query(sql).to_df()
228	        return data_df
229	
230	    def insert(
231	        self, table_name: str, data: pd.DataFrame, columns: List[str] = None
232	    ):
233	        &quot;&quot;&quot;
234	        Insert data into the LanceDB database.
</pre>
</div>


</div>
</div>

<div id="issue-127">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py</a><br>
    <b>Line number: </b>221<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
205	        if vector_filter is not None:
206	            vec = json.loads(vector_filter.value) if isinstance(vector_filter.value, str) else vector_filter.value
207	            result = collection.search(vec).select(columns).to_pandas()
208	            result = result.rename(columns={&quot;_distance&quot;: TableField.DISTANCE.value})
209	        else:
210	            result = self._client.open_table(table_name).to_pandas()
211	
212	        new_columns = columns + [TableField.DISTANCE.value] if TableField.DISTANCE.value in result.columns else columns
213	
214	        col_str = &#x27;, &#x27;.join([col for col in new_columns if col in (TableField.ID.value, TableField.CONTENT.value, TableField.METADATA.value, TableField.EMBEDDINGS.value, TableField.DISTANCE.value)])
215	
216	        where_str = f&#x27;where {filters}&#x27; if filters else &#x27;&#x27;
217	        # implementing limit and offset. Not supported natively in lancedb
218	        if limit and offset:
219	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit} offset {offset}&quot;&quot;&quot;
220	        elif limit and not offset:
221	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit}&quot;&quot;&quot;
222	        elif offset and not limit:
223	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} offset {offset}&quot;&quot;&quot;
224	        else:
225	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str}&quot;&quot;&quot;
226	
227	        data_df = duckdb.query(sql).to_df()
228	        return data_df
229	
230	    def insert(
231	        self, table_name: str, data: pd.DataFrame, columns: List[str] = None
232	    ):
233	        &quot;&quot;&quot;
234	        Insert data into the LanceDB database.
235	        In case of create table statements the there is a mismatch between the column types of the `data` pandas dataframe filled with data
236	        and the empty base table column types which raises a pa.lib.ArrowNotImplementedError, in that case the base table is deleted (doesn&#x27;t matter as it is empty)
</pre>
</div>


</div>
</div>

<div id="issue-128">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py</a><br>
    <b>Line number: </b>223<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
207	            result = collection.search(vec).select(columns).to_pandas()
208	            result = result.rename(columns={&quot;_distance&quot;: TableField.DISTANCE.value})
209	        else:
210	            result = self._client.open_table(table_name).to_pandas()
211	
212	        new_columns = columns + [TableField.DISTANCE.value] if TableField.DISTANCE.value in result.columns else columns
213	
214	        col_str = &#x27;, &#x27;.join([col for col in new_columns if col in (TableField.ID.value, TableField.CONTENT.value, TableField.METADATA.value, TableField.EMBEDDINGS.value, TableField.DISTANCE.value)])
215	
216	        where_str = f&#x27;where {filters}&#x27; if filters else &#x27;&#x27;
217	        # implementing limit and offset. Not supported natively in lancedb
218	        if limit and offset:
219	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit} offset {offset}&quot;&quot;&quot;
220	        elif limit and not offset:
221	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit}&quot;&quot;&quot;
222	        elif offset and not limit:
223	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} offset {offset}&quot;&quot;&quot;
224	        else:
225	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str}&quot;&quot;&quot;
226	
227	        data_df = duckdb.query(sql).to_df()
228	        return data_df
229	
230	    def insert(
231	        self, table_name: str, data: pd.DataFrame, columns: List[str] = None
232	    ):
233	        &quot;&quot;&quot;
234	        Insert data into the LanceDB database.
235	        In case of create table statements the there is a mismatch between the column types of the `data` pandas dataframe filled with data
236	        and the empty base table column types which raises a pa.lib.ArrowNotImplementedError, in that case the base table is deleted (doesn&#x27;t matter as it is empty)
237	        and recreated with the right datatypes
238	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-129">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lancedb_handler/lancedb_handler.py</a><br>
    <b>Line number: </b>225<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
209	        else:
210	            result = self._client.open_table(table_name).to_pandas()
211	
212	        new_columns = columns + [TableField.DISTANCE.value] if TableField.DISTANCE.value in result.columns else columns
213	
214	        col_str = &#x27;, &#x27;.join([col for col in new_columns if col in (TableField.ID.value, TableField.CONTENT.value, TableField.METADATA.value, TableField.EMBEDDINGS.value, TableField.DISTANCE.value)])
215	
216	        where_str = f&#x27;where {filters}&#x27; if filters else &#x27;&#x27;
217	        # implementing limit and offset. Not supported natively in lancedb
218	        if limit and offset:
219	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit} offset {offset}&quot;&quot;&quot;
220	        elif limit and not offset:
221	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} limit {limit}&quot;&quot;&quot;
222	        elif offset and not limit:
223	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str} offset {offset}&quot;&quot;&quot;
224	        else:
225	            sql = f&quot;&quot;&quot;select {col_str} from result {where_str}&quot;&quot;&quot;
226	
227	        data_df = duckdb.query(sql).to_df()
228	        return data_df
229	
230	    def insert(
231	        self, table_name: str, data: pd.DataFrame, columns: List[str] = None
232	    ):
233	        &quot;&quot;&quot;
234	        Insert data into the LanceDB database.
235	        In case of create table statements the there is a mismatch between the column types of the `data` pandas dataframe filled with data
236	        and the empty base table column types which raises a pa.lib.ArrowNotImplementedError, in that case the base table is deleted (doesn&#x27;t matter as it is empty)
237	        and recreated with the right datatypes
238	        &quot;&quot;&quot;
239	
240	        if TableField.METADATA.value not in data.columns:
</pre>
</div>


</div>
</div>

<div id="issue-130">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py</a><br>
    <b>Line number: </b>51<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
35	        self.rate_limit = 50
36	        self.max_batch_size = 5  # default value
37	
38	    def create(self, target: str, args=None, **kwargs):
39	
40	        args[&#x27;target&#x27;] = target
41	
42	        if &quot;using&quot; not in args:
43	            raise Exception(
44	                &quot;Leornardo Engine requires a USING clause!&quot;
45	            )
46	
47	        self.model_storage.json_set(&quot;args&quot;, args)
48	        api_key = self._get_leonardo_api_key(args, self.engine_storage)  # fetch api key
49	
50	        # check if API key is valid
51	        self.connection = requests.get(
52	            &quot;https://cloud.leonardo.ai/api/rest/v1/me&quot;,
53	            headers={
54	                &quot;accept&quot;: &quot;application/json&quot;,
55	                &quot;authorization&quot;: f&quot;Bearer {api_key}&quot;
56	            }
57	        )
58	
59	        # if valid, check if the model is valid
60	        try:
61	            if (self.connection.status_code == 200):
62	                # get all the available models
63	                available_models = self._get_platform_model(args)
64	                if not args[&#x27;using&#x27;][&#x27;model&#x27;]:
65	                    args[&#x27;using&#x27;][&#x27;model&#x27;] = self.default_model
66	                elif args[&#x27;using&#x27;][&#x27;model&#x27;] not in available_models:    # if invalid model_id is provided
67	                    raise Exception(&quot;Invalid Model ID. Please use a valid Model&quot;)
68	            else:
69	                raise Exception(&quot;Unable to make connection, please verify the API key.&quot;)
70	        except Exception:
71	            raise Exception(&quot;Auth Connection Error, please the modelId or API key&quot;)
72	
</pre>
</div>


</div>
</div>

<div id="issue-131">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py</a><br>
    <b>Line number: </b>129<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
113	
114	        if strict:
115	            raise Exception(
116	                &#x27;Missing API key &quot;api_key&quot;. Either re-create this ML_ENGINE specifying the `api_key` parameter,\
117	                 or re-create this model and pass the API key with `USING` syntax.&#x27;
118	            )
119	
120	    def _get_platform_model(self, args):
121	        &quot;&quot;&quot;
122	        Returns a list of available model based on the API key provided
123	        &quot;&quot;&quot;
124	        model_ids = []
125	
126	        args = self.model_storage.json_get(&#x27;args&#x27;)
127	        api_key = self._get_leonardo_api_key(args, self.engine_storage)
128	
129	        self.connection = requests.get(
130	            &quot;https://cloud.leonardo.ai/api/rest/v1/platformModels&quot;,
131	            headers={
132	                &quot;accept&quot;: &quot;application/json&quot;,
133	                &quot;authorization&quot;: f&quot;Bearer {api_key}&quot;
134	            }
135	        )
136	
137	        models = self.connection.json()
138	
139	        # extract the model ids from the response
140	        model_ids = [model[&#x27;id&#x27;] for model in models[&#x27;custom_models&#x27;]]
141	
142	        return model_ids
143	
144	    def predict_answer(self, prompts, **kwargs):
145	        &quot;&quot;&quot;
146	        Generates pictures based on the prompts and returns URLs with few variations.
147	
148	        Request Flow:
149	            - POST request with a prompt is sent
150	            - `generation_id` is created for the request
</pre>
</div>


</div>
</div>

<div id="issue-132">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py</a><br>
    <b>Line number: </b>184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
168	        }
169	
170	        get_headers = {
171	            &quot;accept&quot;: &quot;application/json&quot;,
172	            &quot;authorization&quot;: f&quot;Bearer {api_key}&quot;
173	        }
174	
175	        # payload
176	        generation_payload = {
177	            &quot;height&quot;: height,
178	            &quot;modelId&quot;: args[&#x27;using&#x27;][&#x27;model&#x27;],
179	            &quot;prompt&quot;: f&quot;{prompts}&quot;,
180	            &quot;width&quot;: width,
181	        }
182	
183	        # Make a POST request to generate the image
184	        response_generation = requests.post(generation_url, json=generation_payload, headers=post_headers)
185	        generation_data = response_generation.json()
186	
187	        # Wait for 15 seconds
188	
189	        time.sleep(15)
190	
191	        # extract generationID from the response
192	        generation_id = generation_data[&#x27;sdGenerationJob&#x27;][&#x27;generationId&#x27;]
193	
194	        # ENDPOINT GET URL
195	        retrieve_url = f&quot;https://cloud.leonardo.ai/api/rest/v1/generations/{generation_id}&quot;
196	
197	        # GET request to retrieve image URLs
198	        response_retrieve = requests.get(retrieve_url, headers=get_headers)
199	        retrieve_data = response_retrieve.json()
</pre>
</div>


</div>
</div>

<div id="issue-133">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/leonardoai_handler/leonardo_ai_handler.py</a><br>
    <b>Line number: </b>198<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
182	
183	        # Make a POST request to generate the image
184	        response_generation = requests.post(generation_url, json=generation_payload, headers=post_headers)
185	        generation_data = response_generation.json()
186	
187	        # Wait for 15 seconds
188	
189	        time.sleep(15)
190	
191	        # extract generationID from the response
192	        generation_id = generation_data[&#x27;sdGenerationJob&#x27;][&#x27;generationId&#x27;]
193	
194	        # ENDPOINT GET URL
195	        retrieve_url = f&quot;https://cloud.leonardo.ai/api/rest/v1/generations/{generation_id}&quot;
196	
197	        # GET request to retrieve image URLs
198	        response_retrieve = requests.get(retrieve_url, headers=get_headers)
199	        retrieve_data = response_retrieve.json()
200	
201	        # extract URLs from the response
202	        generated_images = retrieve_data[&quot;generations_by_pk&quot;][&quot;generated_images&quot;]
203	        image_urls = [image[&quot;url&quot;] for image in generated_images]
204	
205	        url_dicts = []
206	
207	        for url in image_urls:
208	            url_dicts.append({&#x27;url&#x27;: url})
209	
210	        img_urls = pd.DataFrame(url_dicts, columns=[&#x27;url&#x27;])
211	        return img_urls
212	
213	    def describe(self, attribute: Optional[str] = None) -&gt; pd.DataFrame:
</pre>
</div>


</div>
</div>

<div id="issue-134">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightfm_handler/lightfm_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightfm_handler/lightfm_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Dict, Optional
2	
3	import dill
4	import pandas as pd
5	from dataprep_ml.recommenders import RecommenderPreprocessor
6	from lightfm import LightFM
7	from lightfm.cross_validation import random_train_test_split
8	from lightfm.evaluation import auc_score, precision_at_k, recall_at_k
9	
10	from mindsdb.integrations.handlers.lightfm_handler.helpers import (
11	    get_item_item_recommendations,
12	    get_user_item_recommendations,
13	)
14	from mindsdb.integrations.handlers.lightfm_handler.settings import ModelParameters
15	from mindsdb.integrations.libs.base import BaseMLEngine
16	
17	
18	class LightFMHandler(BaseMLEngine):
19	    &quot;&quot;&quot;
20	    Integration with the lightfm Recommender library.
21	    &quot;&quot;&quot;
22	
23	    name = &quot;lightfm&quot;
24	
25	    # todo add ability to partially update model based on new data for existing users, items
26	    # todo add support for hybrid recommender
27	    def create(self, target: str, df: pd.DataFrame = None, args: Optional[Dict] = None):
28	
29	        args = args[&quot;using&quot;]
30	
31	        # get model parameters if defined by user - else use default values
32	
</pre>
</div>


</div>
</div>

<div id="issue-135">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightfm_handler/lightfm_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightfm_handler/lightfm_handler.py</a><br>
    <b>Line number: </b>104<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
88	        # if user doesn&#x27;t specify recommender type, default to user_item
89	        try:
90	            recommender_type = df[&quot;recommender_type&quot;].tolist()[0]
91	        except KeyError:
92	            recommender_type = predict_params.get(&quot;recommender_type&quot;, &quot;user_item&quot;)
93	
94	        args = self.model_storage.json_get(&quot;args&quot;)
95	
96	        # get item_id to idx and user_id to idx maps
97	        args[&quot;item_id_to_idx_map&quot;] = dict(
98	            zip(args[&quot;item_idx_to_id_map&quot;].values(), args[&quot;item_idx_to_id_map&quot;].keys())
99	        )
100	        args[&quot;user_id_to_idx_map&quot;] = dict(
101	            zip(args[&quot;user_idx_to_id_map&quot;].values(), args[&quot;user_idx_to_id_map&quot;].keys())
102	        )
103	
104	        model = dill.loads(self.model_storage.file_get(&quot;model&quot;))
105	
106	        n_users = args[&quot;n_users_items&quot;][0]
107	        n_items = args[&quot;n_users_items&quot;][1]
108	        item_ids, user_ids = None, None
109	
110	        if recommender_type == &quot;user_item&quot;:
111	            if df is not None:
112	
113	                if args[&quot;item_id&quot;] in df.columns:
114	                    n_items = df[args[&quot;item_id&quot;]].nunique()
115	                    item_ids = df[args[&quot;item_id&quot;]].unique().tolist()
116	
117	                if args[&quot;user_id&quot;] in df.columns:
118	                    n_users = df[args[&quot;user_id&quot;]].nunique()
119	                    user_ids = df[args[&quot;user_id&quot;]].unique().tolist()
</pre>
</div>


</div>
</div>

<div id="issue-136">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/functions.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/functions.py</a><br>
    <b>Line number: </b>155<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
139	            current_state_num=5, total_states=5, state_name=&#x27;Complete&#x27;
140	        )
141	        predictor_record.dtype_dict = predictor.dtype_dict
142	        db.session.commit()
143	    except Exception as e:
144	        db.session.refresh(predictor_record)
145	        predictor_record.data = {&#x27;error&#x27;: f&#x27;{traceback.format_exc()}\nMain error: {e}&#x27;}
146	        db.session.commit()
147	        raise e
148	
149	
150	@mark_process(name=&#x27;learn&#x27;)
151	def run_learn_remote(df: DataFrame, predictor_id: int) -&gt; None:
152	    try:
153	        serialized_df = json.dumps(df.to_dict())
154	        predictor_record = db.Predictor.query.with_for_update().get(predictor_id)
155	        resp = requests.post(
156	            predictor_record.data[&#x27;train_url&#x27;],
157	            json={&#x27;df&#x27;: serialized_df, &#x27;target&#x27;: predictor_record.to_predict[0]},
158	        )
159	
160	        assert resp.status_code == 200
161	        predictor_record.data[&#x27;status&#x27;] = &#x27;complete&#x27;
162	    except Exception:
163	        predictor_record.data[&#x27;status&#x27;] = &#x27;error&#x27;
164	        predictor_record.data[&#x27;error&#x27;] = str(resp.text)
165	
166	    db.session.commit()
167	
168	
169	@mark_process(name=&#x27;learn&#x27;)
170	def run_learn(df: DataFrame, args: dict, model_storage) -&gt; None:
171	    if df is None or df.shape[0] == 0:
172	        raise Exception(
173	            &#x27;No input data. Ensure the data source is healthy and try again.&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-137">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_tmp_directory: </b> Probable insecure usage of temp file/directory.<br>
    <b>Test ID:</b> B108<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b108_hardcoded_tmp_directory.html</a><br>

<div class="code">
<pre>
1	import os
2	import time
3	import unittest
4	import tempfile
5	
6	temp_dir = tempfile.mkdtemp(dir=&#x27;/tmp/&#x27;, prefix=&#x27;lightwood_handler_test_&#x27;)
7	os.environ[&#x27;MINDSDB_STORAGE_DIR&#x27;] = os.environ.get(&#x27;MINDSDB_STORAGE_DIR&#x27;, temp_dir)
8	os.environ[&#x27;MINDSDB_DB_CON&#x27;] = &#x27;sqlite:///&#x27; + os.path.join(os.environ[&#x27;MINDSDB_STORAGE_DIR&#x27;], &#x27;mindsdb.sqlite3.db&#x27;) + &#x27;?check_same_thread=False&amp;timeout=30&#x27;
9	
10	from mindsdb.migrations import migrate
11	migrate.migrate_to_head()
12	
13	from mindsdb.utilities.config import Config
14	from mindsdb.integrations.utilities.test_utils import HandlerControllerMock, PG_HANDLER_NAME, PG_CONNECTION_DATA
15	from mindsdb.interfaces.database.integrations import integration_controller
16	from mindsdb.integrations.handlers.lightwood_handler.lightwood_handler.lightwood_handler import LightwoodHandler
17	# from mindsdb.integrations.handlers.lightwood_handler.lightwood_handler.utils import load_predictor
18	from mindsdb.interfaces.storage.fs import FsStore
19	from mindsdb.interfaces.model.model_controller import ModelController
20	from mindsdb.integrations.libs.response import RESPONSE_TYPE
21	import mindsdb.interfaces.storage.db as db
22	
23	
24	# TODO: drop all models and tables when closing tests
25	class LightwoodHandlerTest(unittest.TestCase):
26	    @classmethod
27	    def setUpClass(cls):
28	        # region create permanent integrations
29	        for integration_name in [&#x27;files&#x27;, &#x27;lightwood&#x27;]:
30	            integration_record = db.Integration(
31	                name=integration_name,
32	                data={},
</pre>
</div>


</div>
</div>

<div id="issue-138">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>74<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
58	        cls.target_1 = &#x27;rental_price&#x27;
59	        cls.data_table_1 = &#x27;demo_data.home_rentals&#x27;
60	        cls.test_model_1 = &#x27;test_lightwood_home_rentals&#x27;
61	        cls.test_model_1b = &#x27;test_lightwood_home_rentals_custom&#x27;
62	
63	        cls.target_2 = &#x27;Traffic&#x27;
64	        cls.data_table_2 = &#x27;demo_data.house_sales&#x27;
65	        cls.test_model_2 = &#x27;test_lightwood_house_sales&#x27;
66	
67	    def test_00_check_connection(self):
68	        conn = self.handler.check_connection()
69	        assert conn.success
70	
71	    def test_01_drop_predictor(self):
72	        if self.test_model_1 not in self.handler.get_tables().data_frame.values:
73	            # TODO: seems redundant because of test_02
74	            query = f&quot;&quot;&quot;
75	                CREATE PREDICTOR {self.test_model_1}
76	                FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
77	                PREDICT rental_price
78	            &quot;&quot;&quot;
79	            self.handler.native_query(query)
80	        response = self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_1}&quot;)
81	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
82	
83	    def test_02_train_predictor(self):
84	        query = f&quot;&quot;&quot;
85	            CREATE PREDICTOR {self.test_model_1}
86	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
87	            PREDICT rental_price
88	        &quot;&quot;&quot;
89	        response = self.handler.native_query(query)
90	        time.sleep(5)
91	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
92	
93	    def test_03_retrain_predictor(self):
</pre>
</div>


</div>
</div>

<div id="issue-139">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>84<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
68	        conn = self.handler.check_connection()
69	        assert conn.success
70	
71	    def test_01_drop_predictor(self):
72	        if self.test_model_1 not in self.handler.get_tables().data_frame.values:
73	            # TODO: seems redundant because of test_02
74	            query = f&quot;&quot;&quot;
75	                CREATE PREDICTOR {self.test_model_1}
76	                FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
77	                PREDICT rental_price
78	            &quot;&quot;&quot;
79	            self.handler.native_query(query)
80	        response = self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_1}&quot;)
81	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
82	
83	    def test_02_train_predictor(self):
84	        query = f&quot;&quot;&quot;
85	            CREATE PREDICTOR {self.test_model_1}
86	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
87	            PREDICT rental_price
88	        &quot;&quot;&quot;
89	        response = self.handler.native_query(query)
90	        time.sleep(5)
91	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
92	
93	    def test_03_retrain_predictor(self):
94	        query = f&quot;RETRAIN {self.test_model_1}&quot;
95	        response = self.handler.native_query(query)
96	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
97	
98	    def test_04_query_predictor_single_where_condition(self):
99	        time.sleep(120) # TODO 
100	        query = f&quot;&quot;&quot;
101	            SELECT target
102	            from {self.test_model_1}
103	            WHERE sqft=100
</pre>
</div>


</div>
</div>

<div id="issue-140">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>100<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
84	        query = f&quot;&quot;&quot;
85	            CREATE PREDICTOR {self.test_model_1}
86	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
87	            PREDICT rental_price
88	        &quot;&quot;&quot;
89	        response = self.handler.native_query(query)
90	        time.sleep(5)
91	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
92	
93	    def test_03_retrain_predictor(self):
94	        query = f&quot;RETRAIN {self.test_model_1}&quot;
95	        response = self.handler.native_query(query)
96	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
97	
98	    def test_04_query_predictor_single_where_condition(self):
99	        time.sleep(120) # TODO 
100	        query = f&quot;&quot;&quot;
101	            SELECT target
102	            from {self.test_model_1}
103	            WHERE sqft=100
104	        &quot;&quot;&quot;
105	        response = self.handler.native_query(query)
106	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
107	        self.assertTrue(len(response.data_frame) == 1)
108	        self.assertTrue(response.data_frame[&#x27;sqft&#x27;][0] == 100)
109	        self.assertTrue(response.data_frame[&#x27;rental_price&#x27;][0] is not None)
110	
111	    def test_05_query_predictor_multi_where_condition(self):
112	        query = f&quot;&quot;&quot;
113	            SELECT target
114	            from {self.test_model_1}
115	            WHERE sqft=100
116	                  AND number_of_rooms=2
117	                  AND number_of_bathrooms=1
118	        &quot;&quot;&quot;
119	        response = self.handler.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-141">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>112<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
96	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
97	
98	    def test_04_query_predictor_single_where_condition(self):
99	        time.sleep(120) # TODO 
100	        query = f&quot;&quot;&quot;
101	            SELECT target
102	            from {self.test_model_1}
103	            WHERE sqft=100
104	        &quot;&quot;&quot;
105	        response = self.handler.native_query(query)
106	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
107	        self.assertTrue(len(response.data_frame) == 1)
108	        self.assertTrue(response.data_frame[&#x27;sqft&#x27;][0] == 100)
109	        self.assertTrue(response.data_frame[&#x27;rental_price&#x27;][0] is not None)
110	
111	    def test_05_query_predictor_multi_where_condition(self):
112	        query = f&quot;&quot;&quot;
113	            SELECT target
114	            from {self.test_model_1}
115	            WHERE sqft=100
116	                  AND number_of_rooms=2
117	                  AND number_of_bathrooms=1
118	        &quot;&quot;&quot;
119	        response = self.handler.native_query(query)
120	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
121	        self.assertTrue(len(response.data_frame) == 1)
122	        self.assertTrue(response.data_frame[&#x27;number_of_rooms&#x27;][0] == 2)
123	        self.assertTrue(response.data_frame[&#x27;number_of_bathrooms&#x27;][0] == 1)
124	
125	    def test_06_train_predictor_custom_jsonai(self):
126	        # TODO: turn this into a decorator?
127	        if self.test_model_1b in self.handler.get_tables().data_frame.values:  # TODO this accesor feels weird, maybe rethink output format?
128	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_1b}&quot;)
129	
130	        using_str = &#x27;model.args={&quot;submodels&quot;: [{&quot;module&quot;: &quot;LightGBM&quot;, &quot;args&quot;: {&quot;stop_after&quot;: 12, &quot;fit_on_dev&quot;: true}}]}&#x27;
131	        query = f&quot;&quot;&quot;
132	            CREATE PREDICTOR {self.test_model_1b}
133	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
</pre>
</div>


</div>
</div>

<div id="issue-142">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>131<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
115	            WHERE sqft=100
116	                  AND number_of_rooms=2
117	                  AND number_of_bathrooms=1
118	        &quot;&quot;&quot;
119	        response = self.handler.native_query(query)
120	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
121	        self.assertTrue(len(response.data_frame) == 1)
122	        self.assertTrue(response.data_frame[&#x27;number_of_rooms&#x27;][0] == 2)
123	        self.assertTrue(response.data_frame[&#x27;number_of_bathrooms&#x27;][0] == 1)
124	
125	    def test_06_train_predictor_custom_jsonai(self):
126	        # TODO: turn this into a decorator?
127	        if self.test_model_1b in self.handler.get_tables().data_frame.values:  # TODO this accesor feels weird, maybe rethink output format?
128	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_1b}&quot;)
129	
130	        using_str = &#x27;model.args={&quot;submodels&quot;: [{&quot;module&quot;: &quot;LightGBM&quot;, &quot;args&quot;: {&quot;stop_after&quot;: 12, &quot;fit_on_dev&quot;: true}}]}&#x27;
131	        query = f&quot;&quot;&quot;
132	            CREATE PREDICTOR {self.test_model_1b}
133	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_1} limit 50)
134	            PREDICT rental_price
135	            USING {using_str}
136	        &quot;&quot;&quot;
137	        response = self.handler.native_query(query)
138	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
139	        # TODO assert
140	        # m = load_predictor(self.handler.storage.get(&#x27;models&#x27;)[self.test_model_1b], self.test_model_1b)
141	        # assert len(m.ensemble.mixers) == 1
142	        # assert type(m.ensemble.mixers[0]).__name__ == &#x27;LightGBM&#x27;
143	
144	    def test_07_list_tables(self):
145	        response = self.handler.get_tables()
146	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
147	
148	    def test_08_get_columns(self):
149	        response = self.handler.get_columns(f&#x27;{self.test_model_1}&#x27;)
150	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
151	
</pre>
</div>


</div>
</div>

<div id="issue-143">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>166<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
150	        self.assertTrue(response.type == RESPONSE_TYPE.TABLE)
151	
152	    # TODO
153	    # def test_09_join_predictor_into_table(self):
154	    #     into_table = &#x27;test_join_into_lw&#x27;
155	    #     query = f&quot;SELECT tb.{self.target_1} as predicted, ta.{self.target_1} as truth, ta.sqft from {PG_HANDLER_NAME}.{self.data_table_1} AS ta JOIN {self.test_model_1} AS tb LIMIT 10&quot;
156	    #     parsed = self.handler.parser(query, dialect=self.handler.dialect)
157	    #     predicted = self.handler.join(parsed, self.data_handler, into=into_table)
158	
159	    #     # checks whether `into` kwarg does insert into the table or not
160	    #     q = f&quot;SELECT * FROM {into_table}&quot;
161	    #     qp = self.handler.parser(q, dialect=&#x27;mysql&#x27;)
162	    #     assert len(self.data_handler.query(qp).data_frame) &gt; 0
163	
164	    def test_10_train_ts_predictor_multigby_hor4(self):
165	        # TODO: handle cap/uncapped column name returned from data handler? Had to rename &#x27;MA&#x27; -&gt; &#x27;ma&#x27; for test to pass
166	        query = f&quot;&quot;&quot;
167	            CREATE PREDICTOR {self.test_model_2}
168	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
169	            PREDICT ma
170	            ORDER BY saledate
171	            GROUP BY bedrooms, type
172	            WINDOW 8
173	            HORIZON 4
174	        &quot;&quot;&quot;
175	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
176	            response = self.handler.native_query(query)
177	        else:
178	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
179	            response = self.handler.native_query(query)
180	
181	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
182	
183	        # TODO: reactivate and add to the rest of the TS tests once cache is back on
184	        # p = self.handler.storage.get(&#x27;models&#x27;)
185	        # m = load_predictor(p[self.test_model_2], self.test_model_2)
186	        # assert m.problem_definition.timeseries_settings.is_timeseries
187	
188	    def test_12_train_ts_predictor_multigby_hor1(self):
189	        query = f&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-144">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>189<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
173	            HORIZON 4
174	        &quot;&quot;&quot;
175	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
176	            response = self.handler.native_query(query)
177	        else:
178	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
179	            response = self.handler.native_query(query)
180	
181	        self.assertTrue(response.type == RESPONSE_TYPE.OK)
182	
183	        # TODO: reactivate and add to the rest of the TS tests once cache is back on
184	        # p = self.handler.storage.get(&#x27;models&#x27;)
185	        # m = load_predictor(p[self.test_model_2], self.test_model_2)
186	        # assert m.problem_definition.timeseries_settings.is_timeseries
187	
188	    def test_12_train_ts_predictor_multigby_hor1(self):
189	        query = f&quot;&quot;&quot;
190	            CREATE PREDICTOR {self.test_model_2}
191	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
192	            PREDICT ma
193	            ORDER BY saledate
194	            GROUP BY bedrooms, type
195	            WINDOW 8
196	            HORIZON 1
197	        &quot;&quot;&quot;
198	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
199	            self.handler.native_query(query)
200	        else:
201	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
202	            self.handler.native_query(query)
203	
204	    def test_13_train_ts_predictor_no_gby_hor1(self):
205	        query = f&quot;&quot;&quot;
206	            CREATE PREDICTOR {self.test_model_2}
207	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
208	            PREDICT ma
209	            ORDER BY saledate
210	            WINDOW 8
211	            HORIZON 1
212	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-145">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>205<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
189	        query = f&quot;&quot;&quot;
190	            CREATE PREDICTOR {self.test_model_2}
191	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
192	            PREDICT ma
193	            ORDER BY saledate
194	            GROUP BY bedrooms, type
195	            WINDOW 8
196	            HORIZON 1
197	        &quot;&quot;&quot;
198	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
199	            self.handler.native_query(query)
200	        else:
201	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
202	            self.handler.native_query(query)
203	
204	    def test_13_train_ts_predictor_no_gby_hor1(self):
205	        query = f&quot;&quot;&quot;
206	            CREATE PREDICTOR {self.test_model_2}
207	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
208	            PREDICT ma
209	            ORDER BY saledate
210	            WINDOW 8
211	            HORIZON 1
212	        &quot;&quot;&quot;
213	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
214	            self.handler.native_query(query)
215	        else:
216	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
217	            self.handler.native_query(query)
218	
219	    def test_14_train_ts_predictor_no_gby_hor4(self):
220	        query = f&quot;&quot;&quot;
221	            CREATE PREDICTOR {self.test_model_2}
222	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
223	            PREDICT ma
224	            ORDER BY saledate
225	            WINDOW 8
226	            HORIZON 4
227	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-146">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/tests/test_lightwood_handler.py</a><br>
    <b>Line number: </b>220<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
204	    def test_13_train_ts_predictor_no_gby_hor1(self):
205	        query = f&quot;&quot;&quot;
206	            CREATE PREDICTOR {self.test_model_2}
207	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
208	            PREDICT ma
209	            ORDER BY saledate
210	            WINDOW 8
211	            HORIZON 1
212	        &quot;&quot;&quot;
213	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
214	            self.handler.native_query(query)
215	        else:
216	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
217	            self.handler.native_query(query)
218	
219	    def test_14_train_ts_predictor_no_gby_hor4(self):
220	        query = f&quot;&quot;&quot;
221	            CREATE PREDICTOR {self.test_model_2}
222	            FROM {PG_HANDLER_NAME} (SELECT * FROM {self.data_table_2})
223	            PREDICT ma
224	            ORDER BY saledate
225	            WINDOW 8
226	            HORIZON 4
227	        &quot;&quot;&quot;
228	        if self.test_model_2 not in self.handler.get_tables().data_frame.values:
229	            self.handler.native_query(query)
230	        else:
231	            self.handler.native_query(f&quot;DROP PREDICTOR {self.test_model_2}&quot;)
232	            self.handler.native_query(query)
233	
234	    # TODO
235	    # def test_15_join_predictor_ts_into(self):
236	    #     query = f&quot;&quot;&quot;
237	    #         SELECT m.saledate as date,
238	    #                m.ma as forecast
239	    #         FROM mindsdb.{self.test_model_2} m JOIN {PG_HANDLER_NAME}.demo_data.house_sales t
240	    #         WHERE t.saledate &gt; LATEST
241	    #               AND t.type = &#x27;house&#x27;
242	    #               AND t.bedrooms = 2
</pre>
</div>


</div>
</div>

<div id="issue-147">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py</a><br>
    <b>Line number: </b>5<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import gc
2	import json
3	import sys
4	
5	import dill
6	from lightwood.api.high_level import _module_from_code
7	
8	
9	def unpack_jsonai_old_args(json_ai_override):
10	    while &#x27;.&#x27; in str(list(json_ai_override.keys())):
11	        for k in list(json_ai_override.keys()):
12	            if &#x27;.&#x27; in k:
13	                nks = k.split(&#x27;.&#x27;)
14	                obj = json_ai_override
15	                for nk in nks[:-1]:
16	                    if nk not in obj:
17	                        obj[nk] = {}
18	                    obj = obj[nk]
19	                obj[nks[-1]] = json_ai_override[k]
20	                del json_ai_override[k]
21	
22	
23	def load_predictor(predictor_dict, name):
24	    try:
25	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
26	    except Exception as e:
27	        module_name = str(e).lstrip(&quot;No module named &#x27;&quot;).split(&quot;&#x27;&quot;)[0]
28	
29	        try:
30	            del sys.modules[module_name]
31	        except Exception:
32	            pass
</pre>
</div>


</div>
</div>

<div id="issue-148">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py</a><br>
    <b>Line number: </b>25<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
9	def unpack_jsonai_old_args(json_ai_override):
10	    while &#x27;.&#x27; in str(list(json_ai_override.keys())):
11	        for k in list(json_ai_override.keys()):
12	            if &#x27;.&#x27; in k:
13	                nks = k.split(&#x27;.&#x27;)
14	                obj = json_ai_override
15	                for nk in nks[:-1]:
16	                    if nk not in obj:
17	                        obj[nk] = {}
18	                    obj = obj[nk]
19	                obj[nks[-1]] = json_ai_override[k]
20	                del json_ai_override[k]
21	
22	
23	def load_predictor(predictor_dict, name):
24	    try:
25	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
26	    except Exception as e:
27	        module_name = str(e).lstrip(&quot;No module named &#x27;&quot;).split(&quot;&#x27;&quot;)[0]
28	
29	        try:
30	            del sys.modules[module_name]
31	        except Exception:
32	            pass
33	
34	        gc.collect()
35	        _module_from_code(predictor_dict[&#x27;code&#x27;], module_name)
36	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
37	
38	
39	def rep_recur(org: dict, ovr: dict):
40	    for k in ovr:
</pre>
</div>


</div>
</div>

<div id="issue-149">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
15	                for nk in nks[:-1]:
16	                    if nk not in obj:
17	                        obj[nk] = {}
18	                    obj = obj[nk]
19	                obj[nks[-1]] = json_ai_override[k]
20	                del json_ai_override[k]
21	
22	
23	def load_predictor(predictor_dict, name):
24	    try:
25	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
26	    except Exception as e:
27	        module_name = str(e).lstrip(&quot;No module named &#x27;&quot;).split(&quot;&#x27;&quot;)[0]
28	
29	        try:
30	            del sys.modules[module_name]
31	        except Exception:
32	            pass
33	
34	        gc.collect()
35	        _module_from_code(predictor_dict[&#x27;code&#x27;], module_name)
36	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
37	
38	
39	def rep_recur(org: dict, ovr: dict):
40	    for k in ovr:
41	        if k in org:
42	            if isinstance(org[k], dict) and isinstance(ovr[k], dict):
43	                rep_recur(org[k], ovr[k])
44	            else:
45	                org[k] = ovr[k]
46	        else:
47	            org[k] = ovr[k]
</pre>
</div>


</div>
</div>

<div id="issue-150">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
20	                del json_ai_override[k]
21	
22	
23	def load_predictor(predictor_dict, name):
24	    try:
25	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
26	    except Exception as e:
27	        module_name = str(e).lstrip(&quot;No module named &#x27;&quot;).split(&quot;&#x27;&quot;)[0]
28	
29	        try:
30	            del sys.modules[module_name]
31	        except Exception:
32	            pass
33	
34	        gc.collect()
35	        _module_from_code(predictor_dict[&#x27;code&#x27;], module_name)
36	        return dill.loads(predictor_dict[&#x27;predictor&#x27;])
37	
38	
39	def rep_recur(org: dict, ovr: dict):
40	    for k in ovr:
41	        if k in org:
42	            if isinstance(org[k], dict) and isinstance(ovr[k], dict):
43	                rep_recur(org[k], ovr[k])
44	            else:
45	                org[k] = ovr[k]
46	        else:
47	            org[k] = ovr[k]
48	
49	
50	def brack_to_mod(ovr):
51	    if not isinstance(ovr, dict):
</pre>
</div>


</div>
</div>

<div id="issue-151">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lightwood_handler/utils.py</a><br>
    <b>Line number: </b>69<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
53	            for i in range(len(ovr)):
54	                ovr[i] = brack_to_mod(ovr[i])
55	        elif isinstance(ovr, str):
56	            if &#x27;(&#x27; in ovr and &#x27;)&#x27; in ovr:
57	                mod = ovr.split(&#x27;(&#x27;)[0]
58	                args = {}
59	                if &#x27;()&#x27; not in ovr:
60	                    for str_pair in ovr.split(&#x27;(&#x27;)[1].split(&#x27;)&#x27;)[0].split(&#x27;,&#x27;):
61	                        k = str_pair.split(&#x27;=&#x27;)[0].strip(&#x27; &#x27;)
62	                        v = str_pair.split(&#x27;=&#x27;)[1].strip(&#x27; &#x27;)
63	                        args[k] = v
64	
65	                ovr = {&#x27;module&#x27;: mod, &#x27;args&#x27;: args}
66	            elif &#x27;{&#x27; in ovr and &#x27;}&#x27; in ovr:
67	                try:
68	                    ovr = json.loads(ovr)
69	                except Exception:
70	                    pass
71	        return ovr
72	    else:
73	        for k in ovr.keys():
74	            ovr[k] = brack_to_mod(ovr[k])
75	
76	    return ovr
</pre>
</div>


</div>
</div>

<div id="issue-152">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/lindorm_handler/lindorm_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/lindorm_handler/lindorm_handler.py</a><br>
    <b>Line number: </b>197<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
181	
182	    def get_columns(self, table_name: str) -&gt; StatusResponse:
183	        &quot;&quot;&quot;
184	        Returns a list of entity columns.
185	        Args:
186	            table_name (str): name of one of tables returned by self.get_tables()
187	        Returns:
188	            HandlerResponse
189	        &quot;&quot;&quot;
190	
191	        need_to_close = self.is_connected is False
192	
193	        connection = self.connect()
194	        cursor = connection.cursor()
195	
196	        try:
197	            query = f&quot;SELECT * from {table_name} LIMIT 5&quot;
198	            cursor.execute(query)
199	            cursor.fetchall()
200	
201	            response = Response(
202	                RESPONSE_TYPE.TABLE,
203	                data_frame=pd.DataFrame(
204	                    [(x[0], x[1]) for x in cursor.description],
205	                    columns=[&#x27;column_name&#x27;, &#x27;data_type&#x27;]
206	                )
207	            )
208	
209	        except Exception as e:
210	            logger.error(f&#x27;Error running query: {query} on the Phoenix Query Server!&#x27;)
211	            response = Response(
212	                RESPONSE_TYPE.ERROR,
</pre>
</div>


</div>
</div>

<div id="issue-153">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py</a><br>
    <b>Line number: </b>22<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
6	
7	from tests.unit.executor_test_base import BaseExecutorTest
8	
9	OPENAI_API_KEY = os.environ.get(&quot;OPENAI_API_KEY&quot;)
10	os.environ[&quot;OPENAI_API_KEY&quot;] = OPENAI_API_KEY
11	
12	USER_MESSAGE = &quot;Write a short poem about the sky&quot;
13	MESSAGE = [{&quot;content&quot;: USER_MESSAGE, &quot;role&quot;: &quot;user&quot;}]
14	MESSAGES = [[{&quot;content&quot;: USER_MESSAGE, &quot;role&quot;: &quot;user&quot;}], [{&quot;content&quot;: &quot;The sky is blue&quot;, &quot;role&quot;: &quot;user&quot;}]]
15	
16	
17	class TestLiteLLM(BaseExecutorTest):
18	    def wait_predictor(self, project, name):
19	        # wait
20	        done = False
21	        for attempt in range(200):
22	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
23	            if not ret.empty:
24	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
25	                    done = True
26	                    break
27	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
28	                    break
29	            time.sleep(0.5)
30	        if not done:
31	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
32	
33	    def run_sql(self, sql):
34	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
35	        assert ret.error_code is None
36	        if ret.data is not None:
37	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-154">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py</a><br>
    <b>Line number: </b>73<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
57	
58	        # run predict
59	        ret = self.run_sql(
60	            &quot;&quot;&quot;
61	            SELECT *
62	            FROM proj.test_litellm_handler_on_completion_openai
63	            where text = &quot;I like to eat&quot; and mock_response = &quot;test&quot;
64	            &quot;&quot;&quot;
65	        )
66	
67	        assert ret[&quot;result&quot;][0]
68	
69	        # completion with openai using messages in predict
70	
71	        # run predict
72	        ret = self.run_sql(
73	            f&quot;&quot;&quot;
74	            SELECT *
75	            FROM proj.test_litellm_handler_on_completion_openai
76	            where messages = &quot;{MESSAGE}&quot; and mock_response = &quot;test&quot;
77	            &quot;&quot;&quot;
78	        )
79	
80	        assert ret[&quot;result&quot;][0]
81	
82	        # completion with openai using multiple messages in predict using batch_completion
83	
84	        # run predict
85	        ret = self.run_sql(
86	            f&quot;&quot;&quot;
87	            SELECT *
88	            FROM proj.test_litellm_handler_on_completion_openai
89	            where messages = &quot;{MESSAGES}&quot;
90	            &quot;&quot;&quot;
91	        )
92	
</pre>
</div>


</div>
</div>

<div id="issue-155">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py</a><br>
    <b>Line number: </b>86<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
70	
71	        # run predict
72	        ret = self.run_sql(
73	            f&quot;&quot;&quot;
74	            SELECT *
75	            FROM proj.test_litellm_handler_on_completion_openai
76	            where messages = &quot;{MESSAGE}&quot; and mock_response = &quot;test&quot;
77	            &quot;&quot;&quot;
78	        )
79	
80	        assert ret[&quot;result&quot;][0]
81	
82	        # completion with openai using multiple messages in predict using batch_completion
83	
84	        # run predict
85	        ret = self.run_sql(
86	            f&quot;&quot;&quot;
87	            SELECT *
88	            FROM proj.test_litellm_handler_on_completion_openai
89	            where messages = &quot;{MESSAGES}&quot;
90	            &quot;&quot;&quot;
91	        )
92	
93	        # check there are two results
94	        assert ret[&quot;result&quot;].shape[0] == 2
95	
96	        # completion with messages in predict with other args should fail
97	
98	        # run predict
99	        with pytest.raises(Exception):
100	            self.run_sql(
101	                f&quot;&quot;&quot;
102	                SELECT *
103	                FROM proj.test_litellm_handler_on_completion_openai
104	                where messages = &quot;{MESSAGES}&quot; and temperature = 0.5
105	                &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-156">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/litellm_handler/tests/test_litellm.py</a><br>
    <b>Line number: </b>101<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
85	        ret = self.run_sql(
86	            f&quot;&quot;&quot;
87	            SELECT *
88	            FROM proj.test_litellm_handler_on_completion_openai
89	            where messages = &quot;{MESSAGES}&quot;
90	            &quot;&quot;&quot;
91	        )
92	
93	        # check there are two results
94	        assert ret[&quot;result&quot;].shape[0] == 2
95	
96	        # completion with messages in predict with other args should fail
97	
98	        # run predict
99	        with pytest.raises(Exception):
100	            self.run_sql(
101	                f&quot;&quot;&quot;
102	                SELECT *
103	                FROM proj.test_litellm_handler_on_completion_openai
104	                where messages = &quot;{MESSAGES}&quot; and temperature = 0.5
105	                &quot;&quot;&quot;
106	            )
107	
108	    def test_completion_openai_with_prompt_template(self):
109	
110	        # create project
111	        self.run_sql(&quot;create database proj&quot;)
112	
113	        # completion with openai using prompt_template in create with single format variable
114	
115	        self.run_sql(
116	            f&quot;&quot;&quot;
117	            CREATE MODEL proj.test_litellm_handler_on_completion_openai_prompt_template
118	            PREDICT text
119	            USING
120	            engine=&quot;litellm&quot;,
</pre>
</div>


</div>
</div>

<div id="issue-157">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ludwig_handler/ludwig_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ludwig_handler/ludwig_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Optional
2	
3	import dill
4	import dask
5	import pandas as pd
6	from ludwig.automl import auto_train
7	
8	from mindsdb.integrations.libs.base import BaseMLEngine
9	from .utils import RayConnection
10	
11	
12	class LudwigHandler(BaseMLEngine):
13	    &quot;&quot;&quot;
14	    Integration with the Ludwig declarative ML library.
15	    &quot;&quot;&quot;  # noqa
16	
17	    name = &#x27;ludwig&#x27;
18	
19	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[dict] = None) -&gt; None:
20	        args = args[&#x27;using&#x27;]  # ignore the rest of the problem definition
21	
22	        # TODO: filter out incompatible use cases (e.g. time series won&#x27;t work currently)
23	        # TODO: enable custom values via `args` (mindful of local vs cloud)
24	        user_config = {&#x27;hyperopt&#x27;: {&#x27;executor&#x27;: {&#x27;gpu_resources_per_trial&#x27;: 0, &#x27;num_samples&#x27;: 3}}}  # no GPU for now
25	
26	        with RayConnection():
27	            results = auto_train(
28	                dataset=df,
29	                target=target,
30	                tune_for_memory=False,
31	                time_limit_s=120,
32	                user_config=user_config,
</pre>
</div>


</div>
</div>

<div id="issue-158">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ludwig_handler/ludwig_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ludwig_handler/ludwig_handler.py</a><br>
    <b>Line number: </b>45<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
29	                target=target,
30	                tune_for_memory=False,
31	                time_limit_s=120,
32	                user_config=user_config,
33	                # output_directory=&#x27;./&#x27;,
34	                # random_seed=42,
35	                # use_reference_config=False,
36	                # kwargs={}
37	            )
38	        model = results.best_model
39	        args[&#x27;dtype_dict&#x27;] = {f[&#x27;name&#x27;]: f[&#x27;type&#x27;] for f in model.base_config[&#x27;input_features&#x27;]}
40	        args[&#x27;accuracies&#x27;] = {&#x27;metric&#x27;: results.experiment_analysis.best_result[&#x27;metric_score&#x27;]}
41	        self.model_storage.json_set(&#x27;args&#x27;, args)
42	        self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model))
43	
44	    def predict(self, df, args=None):
45	        model = dill.loads(self.model_storage.file_get(&#x27;model&#x27;))
46	        with RayConnection():
47	            predictions = self._call_model(df, model)
48	        return predictions
49	
50	    @staticmethod
51	    def _call_model(df, model):
52	        predictions = dask.compute(model.predict(df)[0])[0]
53	        target_name = model.config[&#x27;output_features&#x27;][0][&#x27;column&#x27;]
54	
55	        if target_name not in df:
56	            predictions.columns = [target_name]
57	        else:
58	            predictions.columns = [&#x27;prediction&#x27;]
59	
60	        predictions[f&#x27;{target_name}_explain&#x27;] = None
</pre>
</div>


</div>
</div>

<div id="issue-159">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mariadb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mariadb_handler/connection_args.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
54	        &#x27;label&#x27;: &#x27;ssl_ca&#x27;
55	    },
56	    ssl_cert={
57	        &#x27;type&#x27;: ARG_TYPE.PATH,
58	        &#x27;description&#x27;: &#x27;Path name or URL of the server public key certificate file&#x27;,
59	        &#x27;required&#x27;: False,
60	        &#x27;label&#x27;: &#x27;ssl_cert&#x27;
61	    },
62	    ssl_key={
63	        &#x27;type&#x27;: ARG_TYPE.PATH,
64	        &#x27;description&#x27;: &#x27;The path name or URL of the server private key file&#x27;,
65	        &#x27;required&#x27;: False,
66	        &#x27;label&#x27;: &#x27;ssl_key&#x27;,
67	    }
68	)
69	
70	connection_args_example = OrderedDict(
71	    host=&#x27;127.0.0.1&#x27;,
72	    port=3306,
73	    user=&#x27;root&#x27;,
74	    password=&#x27;password&#x27;,
75	    database=&#x27;database&#x27;
76	)
</pre>
</div>


</div>
</div>

<div id="issue-160">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/materialize_handler/materialize_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/materialize_handler/materialize_handler.py</a><br>
    <b>Line number: </b>41<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
25	        &#x27;description&#x27;: &#x27;The user name used to authenticate with the Materialize server.&#x27;,
26	    },
27	    password={
28	        &#x27;type&#x27;: ARG_TYPE.STR,
29	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Materialize server.&#x27;,
30	    },
31	    port={
32	        &#x27;type&#x27;: ARG_TYPE.INT,
33	        &#x27;description&#x27;: &#x27;Specify port to connect Materialize server&#x27;,
34	    },
35	    database={
36	        &#x27;type&#x27;: ARG_TYPE.STR,
37	        &#x27;description&#x27;: &#x27;Specify database name  to connect Materialize server&#x27;,
38	    },
39	)
40	
41	connection_args_example = OrderedDict(
42	    host=&#x27;127.0.0.1&#x27;, port=6875, password=&#x27;&#x27;, user=&#x27;USER&#x27;, database=&#x27;materialize&#x27;
43	)
</pre>
</div>


</div>
</div>

<div id="issue-161">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '111'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/matrixone_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/matrixone_handler/connection_args.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
30	        &#x27;description&#x27;: &#x27;Set it to False to disable ssl.&#x27;
31	    },
32	    ssl_ca={
33	        &#x27;type&#x27;: ARG_TYPE.PATH,
34	        &#x27;description&#x27;: &#x27;Path or URL of the Certificate Authority (CA) certificate file&#x27;
35	    },
36	    ssl_cert={
37	        &#x27;type&#x27;: ARG_TYPE.PATH,
38	        &#x27;description&#x27;: &#x27;Path name or URL of the server public key certificate file&#x27;
39	    },
40	    ssl_key={
41	        &#x27;type&#x27;: ARG_TYPE.PATH,
42	        &#x27;description&#x27;: &#x27;The path name or URL of the server private key file&#x27;
43	    }
44	)
45	
46	connection_args_example = OrderedDict(
47	    host=&#x27;127.0.0.1&#x27;,
48	    port=6001,
49	    user=&#x27;dump&#x27;,
50	    password=&#x27;111&#x27;,
51	    database=&#x27;mo_catalog&#x27;
52	)
</pre>
</div>


</div>
</div>

<div id="issue-162">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/maxdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/maxdb_handler/connection_args.py</a><br>
    <b>Line number: </b>35<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
19	        jdbc_location={
20	            &#x27;type&#x27;: ARG_TYPE.STR,
21	            &#x27;description&#x27;: &#x27;The location of the jar file which contains the JDBC class.&#x27;
22	        },
23	        user={
24	            &#x27;type&#x27;: ARG_TYPE.STR,
25	            &#x27;description&#x27;: &#x27;The user name used to authenticate with the SAP MaxDB server.&#x27;
26	        },
27	        password={
28	            &#x27;type&#x27;: ARG_TYPE.PWD,
29	            &#x27;description&#x27;: &#x27;The password to authenticate the user with the SAP MaxDB server.&#x27;,
30	            &#x27;secret&#x27;: True
31	        }
32	)
33	
34	
35	connection_args_example = OrderedDict(
36	    host=&#x27;127.0.0.1&#x27;,
37	    port=7210,
38	    user=&#x27;DBADMIN&#x27;,
39	    password=&#x27;password&#x27;,
40	    database=&quot;MAXDB&quot;,
41	    jdbc_location=&#x27;/Users/marsid/Desktop/sapdbc.jar&#x27;,
42	)
</pre>
</div>


</div>
</div>

<div id="issue-163">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/maxdb_handler/maxdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/maxdb_handler/maxdb_handler.py</a><br>
    <b>Line number: </b>164<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
148	                of query: SELECT, INSERT, DELETE, etc
149	        Returns:
150	            HandlerResponse
151	        &quot;&quot;&quot;
152	        renderer = SqlalchemyRender(&quot;postgres&quot;)
153	        query_str = renderer.get_string(query, with_failback=True)
154	        return self.native_query(query_str)
155	
156	    def get_tables(self) -&gt; Response:
157	        &quot;&quot;&quot;
158	        Gets a list of table names in the database.
159	
160	        Returns:
161	            list: A list of table names in the database.
162	        &quot;&quot;&quot;
163	
164	        query = f&quot;SELECT TABLENAME FROM DOMAIN.TABLES WHERE TYPE = &#x27;TABLE&#x27; AND SCHEMANAME = &#x27;{self.user}&#x27;&quot;
165	        result = self.native_query(query)
166	        df = result.data_frame
167	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
168	        return result
169	
170	    def get_columns(self, table_name: str) -&gt; Response:
171	        &quot;&quot;&quot;
172	        Gets a list of column names in the specified table.
173	
174	        Args:
175	            table_name (str): The name of the table to get column names from.
176	
177	        Returns:
178	            list: A list of column names in the specified table.
179	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-164">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/maxdb_handler/maxdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/maxdb_handler/maxdb_handler.py</a><br>
    <b>Line number: </b>181<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
165	        result = self.native_query(query)
166	        df = result.data_frame
167	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
168	        return result
169	
170	    def get_columns(self, table_name: str) -&gt; Response:
171	        &quot;&quot;&quot;
172	        Gets a list of column names in the specified table.
173	
174	        Args:
175	            table_name (str): The name of the table to get column names from.
176	
177	        Returns:
178	            list: A list of column names in the specified table.
179	        &quot;&quot;&quot;
180	
181	        query = f&quot;SELECT COLUMNNAME,DATATYPE FROM DOMAIN.COLUMNS WHERE TABLENAME =&#x27;{table_name}&#x27;&quot;
182	        result = self.native_query(query)
183	        df = result.data_frame
184	        result.data_frame = df.rename(columns={&#x27;name&#x27;: &#x27;column_name&#x27;, &#x27;type&#x27;: &#x27;data_type&#x27;})
185	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-165">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/milvus_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/milvus_handler/connection_args.py</a><br>
    <b>Line number: </b>110<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
94	        &quot;type&quot;: ARG_TYPE.DICT,
95	        &quot;description&quot;: &quot;parameters of the index created on embeddings column (default={})&quot;,
96	        &quot;required&quot;: False,
97	    },
98	    create_index_metric_type={
99	        &quot;type&quot;: ARG_TYPE.STR,
100	        &quot;description&quot;: &quot;metric used to create the index (default=&#x27;L2&#x27;)&quot;,
101	        &quot;required&quot;: False,
102	    },
103	    create_index_type={
104	        &quot;type&quot;: ARG_TYPE.STR,
105	        &quot;description&quot;: &quot;the type of index (default=&#x27;AUTOINDEX&#x27;)&quot;,
106	        &quot;required&quot;: False,
107	    },
108	)
109	
110	connection_args_example = OrderedDict(
111	    alias=&quot;default&quot;,
112	    host=&quot;127.0.0.1&quot;,
113	    port=19530,
114	    user=&quot;username&quot;,
115	    password=&quot;password&quot;,
116	    search_default_limit=100,
117	    search_metric_type=&quot;L2&quot;,
118	    search_ignore_growing=True,
119	    search_params={&quot;nprobe&quot;: 10},
120	    create_auto_id=False,
121	    create_id_max_len=64,
122	    create_embedding_dim=8,
123	    create_dynamic_field=True,
124	    create_content_max_len=200,
125	    create_content_default_value=&quot;&quot;,
126	    create_schema_description=&quot;MindsDB generated table&quot;,
127	    create_alias=&quot;default&quot;,
128	    create_index_params={},
129	    create_index_metric_type=&quot;L2&quot;,
130	    create_index_type=&quot;AUTOINDEX&quot;,
131	)
</pre>
</div>


</div>
</div>

<div id="issue-166">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mlflow_handler/mlflow_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mlflow_handler/mlflow_handler.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
27	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
28	        args = args[&#x27;using&#x27;]  # ignore the rest of the problem definition
29	        connection = MlflowClient(args[&#x27;mlflow_server_url&#x27;], args[&#x27;mlflow_server_path&#x27;])
30	        model_name = args[&#x27;model_name&#x27;]
31	        mlflow_models = [model.name for model in connection.search_registered_models()]
32	
33	        if model_name not in mlflow_models:
34	            raise Exception(f&quot;Error: model &#x27;{model_name}&#x27; not found in mlflow. Check serving and try again.&quot;)
35	
36	        args[&#x27;target&#x27;] = target
37	        self._check_model_url(args[&#x27;predict_url&#x27;])
38	        self.model_storage.json_set(&#x27;args&#x27;, args)
39	
40	    def predict(self, df, args=None):
41	        args = self.model_storage.json_get(&#x27;args&#x27;)  # override any incoming args for now
42	        self._check_model_url(args[&#x27;predict_url&#x27;])
43	        resp = requests.post(args[&#x27;predict_url&#x27;],
44	                             data=df.to_json(orient=&#x27;records&#x27;),
45	                             headers={&#x27;content-type&#x27;: &#x27;application/json; format=pandas-records&#x27;})
46	        answer = resp.json()
47	        predictions = pd.DataFrame({args[&#x27;target&#x27;]: answer})
48	        return predictions
49	
50	    def describe(self, key: Optional[str] = None) -&gt; pd.DataFrame:
51	        if key == &#x27;info&#x27;:
52	            args = self.model_storage.json_get(&#x27;args&#x27;)
53	            connection = MlflowClient(args[&#x27;mlflow_server_url&#x27;], args[&#x27;self.mlflow_server_path&#x27;])
54	            models = {model.name: model for model in connection.search_registered_models()}
55	            model = models[key]
56	            latest_version = model.latest_versions[-1]
57	            description = {
58	                &#x27;NAME&#x27;: [model.name],
59	                &#x27;USER_DESCRIPTION&#x27;: [model.description],
60	                &#x27;LAST_STATUS&#x27;: [latest_version.status],
</pre>
</div>


</div>
</div>

<div id="issue-167">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mlflow_handler/mlflow_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mlflow_handler/mlflow_handler.py</a><br>
    <b>Line number: </b>79<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
63	                &#x27;TAGS&#x27;: [model.tags],
64	                &#x27;LAST_RUN_ID&#x27;: [latest_version.run_id],
65	                &#x27;LAST_SOURCE_PATH&#x27;: [latest_version.source],
66	                &#x27;LAST_USER_ID&#x27;: [latest_version.user_id],
67	                &#x27;LAST_VERSION&#x27;: [latest_version.version],
68	            }
69	            return pd.DataFrame.from_dict(description)
70	        else:
71	            tables = [&#x27;info&#x27;]
72	            return pd.DataFrame(tables, columns=[&#x27;tables&#x27;])
73	
74	
75	    @staticmethod
76	    def _check_model_url(url):
77	        &quot;&quot;&quot; try post without data, check status code not in (not_found, method_not_allowed) &quot;&quot;&quot;
78	        try:
79	            resp = requests.post(url)
80	            if resp.status_code in (404, 405):
81	                raise Exception(f&#x27;Model url is incorrect, status_code: {resp.status_code}&#x27;)
82	        except requests.RequestException as e:
83	            raise Exception(f&#x27;Model url is incorrect: {str(e)}&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-168">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'monetdb'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monetdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monetdb_handler/connection_args.py</a><br>
    <b>Line number: </b>37<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
21	    password={
22	        &#x27;type&#x27;: ARG_TYPE.PWD,
23	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the MonetDB server.&#x27;,
24	        &#x27;secret&#x27;: True
25	    },
26	    port={
27	        &#x27;type&#x27;: ARG_TYPE.INT,
28	        &#x27;description&#x27;: &#x27;Specify port to connect MonetDB through TCP/IP&#x27;
29	    },
30	    schema_name={
31	        &#x27;type&#x27;: ARG_TYPE.STR,
32	        &#x27;description&#x27;: &#x27;Specify the schema name for Listing Table &#x27;
33	    },
34	
35	)
36	
37	connection_args_example = OrderedDict(
38	    host=&#x27;127.0.0.1&#x27;,
39	    port=50000,
40	    password=&#x27;monetdb&#x27;,
41	    user=&#x27;monetdb&#x27;,
42	    schemaName=&quot;sys&quot;,
43	    database=&quot;demo&quot;,
44	)
</pre>
</div>


</div>
</div>

<div id="issue-169">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monetdb_handler/monetdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monetdb_handler/monetdb_handler.py</a><br>
    <b>Line number: </b>182<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
166	        query_str = renderer.get_string(query, with_failback=True)
167	        return self.native_query(query_str)
168	
169	
170	    def get_tables(self) -&gt; StatusResponse:
171	        &quot;&quot;&quot; Return list of entities
172	        Return list of entities that will be accesible as tables.
173	        Returns: HandlerResponse: shoud have same columns as information_schema.tables
174	                (https://dev.mysql.com/doc/refman/8.0/en/information-schema-tables-table.html)
175	                Column &#x27;TABLE_NAME&#x27; is mandatory, other is optional.
176	        &quot;&quot;&quot;
177	        self.connect()
178	        schema = schema_id(connection=self.connection,schema_name=self.schemaName)
179	
180	
181	
182	        q = f&quot;&quot;&quot;
183	            SELECT name as TABLE_NAME
184	            FROM sys.tables
185	            WHERE system = False
186	            AND type = 0
187	            AND schema_id = {schema}
188	        &quot;&quot;&quot;
189	 
190	
191	        return self.query(q)
192	
193	    
194	    def get_columns(self, table_name: str) -&gt; StatusResponse:
195	        &quot;&quot;&quot; Returns a list of entity columns
196	        Args:
197	            table_name (str): name of one of tables returned by self.get_tables()
198	        Returns:
199	            HandlerResponse: shoud have same columns as information_schema.columns
200	                (https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html)
201	                Column &#x27;COLUMN_NAME&#x27; is mandatory, other is optional. Hightly
202	                recomended to define also &#x27;DATA_TYPE&#x27;: it should be one of
203	                python data types (by default it str).
</pre>
</div>


</div>
</div>

<div id="issue-170">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monetdb_handler/monetdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monetdb_handler/monetdb_handler.py</a><br>
    <b>Line number: </b>212<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
196	        Args:
197	            table_name (str): name of one of tables returned by self.get_tables()
198	        Returns:
199	            HandlerResponse: shoud have same columns as information_schema.columns
200	                (https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html)
201	                Column &#x27;COLUMN_NAME&#x27; is mandatory, other is optional. Hightly
202	                recomended to define also &#x27;DATA_TYPE&#x27;: it should be one of
203	                python data types (by default it str).
204	        &quot;&quot;&quot;
205	        self.connect()
206	        table=table_id(
207	            connection=self.connection,
208	            table_name=table_name,
209	            schema_name=self.schemaName
210	        )
211	
212	        q = f&quot;&quot;&quot;
213	            SELECT  
214	            name as COLUMN_NAME,
215	            type as DATA_TYPE
216	            FROM sys.columns
217	            WHERE table_id = {table}
218	        &quot;&quot;&quot;
219	        return self.query(q)
</pre>
</div>


</div>
</div>

<div id="issue-171">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monetdb_handler/utils/monet_get_id.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monetdb_handler/utils/monet_get_id.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	from sqlalchemy import  exc
2	
3	def schema_id(connection, schema_name=None):
4	    &quot;&quot;&quot;Fetch the id for schema&quot;&quot;&quot;
5	    cur=connection.cursor()
6	    if schema_name is None:
7	        cur.execute(&quot;SELECT current_schema&quot;)
8	        schema_name=cur.fetchall()[0][0]
9	
10	    query = f&quot;&quot;&quot;
11	                SELECT id
12	                FROM sys.schemas
13	                WHERE name = &#x27;{schema_name}&#x27;
14	            &quot;&quot;&quot;
15	    
16	    cur.execute(query)
17	
18	    try:
19	        schema_id = cur.fetchall()[0][0]
20	    except:
21	        raise exc.InvalidRequestError(schema_name)
22	        
23	    return schema_id
24	
25	    
26	def table_id(connection, table_name, schema_name=None):
27	    &quot;&quot;&quot;Fetch the id for schema.table_name, defaulting to current schema if
28	       schema is None
29	    &quot;&quot;&quot;
30	
31	    schema_idm = schema_id(connection=connection,schema_name=schema_name)
32	
33	    q = f&quot;&quot;&quot;
34	        SELECT id
35	        FROM sys.tables
36	        WHERE name = &#x27;{table_name}&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-172">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monetdb_handler/utils/monet_get_id.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monetdb_handler/utils/monet_get_id.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
17	
18	    try:
19	        schema_id = cur.fetchall()[0][0]
20	    except:
21	        raise exc.InvalidRequestError(schema_name)
22	        
23	    return schema_id
24	
25	    
26	def table_id(connection, table_name, schema_name=None):
27	    &quot;&quot;&quot;Fetch the id for schema.table_name, defaulting to current schema if
28	       schema is None
29	    &quot;&quot;&quot;
30	
31	    schema_idm = schema_id(connection=connection,schema_name=schema_name)
32	
33	    q = f&quot;&quot;&quot;
34	        SELECT id
35	        FROM sys.tables
36	        WHERE name = &#x27;{table_name}&#x27;
37	        AND schema_id = {schema_idm}
38	        &quot;&quot;&quot;
39	    
40	    cur = connection.cursor()
41	    cur.execute(q)
42	
43	    try:
44	        table_id = cur.fetchall()[0][0] 
45	    except:
46	        raise exc.NoSuchTableError(table_name)
47	
48	    
49	
50	    return table_id
</pre>
</div>


</div>
</div>

<div id="issue-173">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mongodb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mongodb_handler/connection_args.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
24	        &#x27;label&#x27;: &#x27;Database&#x27;
25	    },
26	    host={
27	        &#x27;type&#x27;: ARG_TYPE.STR,
28	        &#x27;description&#x27;: &#x27;The host name or IP address of the MongoDB server. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;,
29	        &#x27;required&#x27;: True,
30	        &#x27;label&#x27;: &#x27;Host&#x27;
31	    },
32	    port={
33	        &#x27;type&#x27;: ARG_TYPE.INT,
34	        &#x27;description&#x27;: &#x27;The TCP/IP port of the MongoDB server. Must be an integer.&#x27;,
35	        &#x27;required&#x27;: True,
36	        &#x27;label&#x27;: &#x27;Port&#x27;
37	    },
38	)
39	
40	connection_args_example = OrderedDict(
41	    host=&#x27;127.0.0.1&#x27;,
42	    port=27017,
43	    username=&#x27;mongo&#x27;,
44	    password=&#x27;password&#x27;,
45	    database=&#x27;database&#x27;
46	)
</pre>
</div>


</div>
</div>

<div id="issue-174">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/monkeylearn_handler/monkeylearn_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/monkeylearn_handler/monkeylearn_handler.py</a><br>
    <b>Line number: </b>32<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
16	    def create_validations(self,args=None,**kwargs):
17	
18	        if &quot;using&quot; in args:
19	            args = args[&quot;using&quot;]
20	
21	        if &quot;monkeylearn_api_key&quot; not in args:
22	            raise Exception(&quot;monkeylearn_api_key not found&quot;)
23	        api_key = get_api_key(&#x27;monkeylearn&#x27;, args[&quot;using&quot;], self.engine_storage, strict=False)
24	        if &quot;model_id&quot; in args:
25	            if &quot;cl_&quot; not in args[&quot;model_id&quot;]:
26	                raise Exception(&quot;Classifier tasks are only supported currently&quot;)
27	        else:
28	            raise Exception(&quot;Enter the model_id of model you want use&quot;)
29	        model_id = args[&quot;model_id&quot;]
30	        # Check whether the model_id given by user exists in the user account or monkeylearn pre-trained models
31	        url = &#x27;https://api.monkeylearn.com/v3/classifiers/&#x27;
32	        response = requests.get(url, headers={&#x27;Authorization&#x27;: &#x27;Token {}&#x27;.format(api_key)})
33	        if response.status_code == 200:
34	            models = response.json()
35	            models_list = [model[&#x27;id&#x27;] for model in models]
36	        else:
37	            raise Exception(f&quot;Server response {response.status_code}&quot;)
38	
39	        if model_id not in models_list:
40	            raise Exception(f&quot;Model_id {args[&#x27;model_id&#x27;]} not found in MonkeyLearn pre-trained models&quot;)
41	
42	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
43	        if &quot;using&quot; in args:
44	            args = args[&#x27;using&#x27;]
45	
46	        self.model_storage.json_set(&#x27;args&#x27;, args)
47	
</pre>
</div>


</div>
</div>

<div id="issue-175">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mssql_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mssql_handler/connection_args.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
30	        &#x27;label&#x27;: &#x27;Host&#x27;
31	    },
32	    port={
33	        &#x27;type&#x27;: ARG_TYPE.INT,
34	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Microsoft SQL Server. Must be an integer.&#x27;,
35	        &#x27;required&#x27;: False,
36	        &#x27;label&#x27;: &#x27;Port&#x27;
37	    },
38	    server={
39	        &#x27;type&#x27;: ARG_TYPE.STR,
40	        &#x27;description&#x27;: &#x27;The server name of the Microsoft SQL Server. Typically only used with named instances or Azure SQL Database.&#x27;,
41	        &#x27;required&#x27;: False,
42	        &#x27;label&#x27;: &#x27;Server&#x27;
43	    }
44	)
45	
46	connection_args_example = OrderedDict(
47	    host=&#x27;127.0.0.1&#x27;,
48	    port=1433,
49	    user=&#x27;sa&#x27;,
50	    password=&#x27;password&#x27;,
51	    database=&#x27;master&#x27;
52	)
</pre>
</div>


</div>
</div>

<div id="issue-176">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mssql_handler/mssql_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mssql_handler/mssql_handler.py</a><br>
    <b>Line number: </b>186<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
170	        Returns:
171	            Response: The response from the `native_query` method, containing the result of the SQL query execution.
172	        &quot;&quot;&quot;
173	
174	        query_str = self.renderer.get_string(query, with_failback=True)
175	        logger.debug(f&quot;Executing SQL query: {query_str}&quot;)
176	        return self.native_query(query_str)
177	
178	    def get_tables(self) -&gt; Response:
179	        &quot;&quot;&quot;
180	        Retrieves a list of all non-system tables and views in the current schema of the Microsoft SQL Server database.
181	
182	        Returns:
183	            Response: A response object containing the list of tables and views, formatted as per the `Response` class.
184	        &quot;&quot;&quot;
185	
186	        query = f&quot;&quot;&quot;
187	            SELECT
188	                table_schema,
189	                table_name,
190	                table_type
191	            FROM {self.database}.INFORMATION_SCHEMA.TABLES
192	            WHERE TABLE_TYPE in (&#x27;BASE TABLE&#x27;, &#x27;VIEW&#x27;);
193	        &quot;&quot;&quot;
194	        return self.native_query(query)
195	
196	    def get_columns(self, table_name) -&gt; Response:
197	        &quot;&quot;&quot;
198	        Retrieves column details for a specified table in the Microsoft SQL Server database.
199	
200	        Args:
201	            table_name (str): The name of the table for which to retrieve column information.
202	
203	        Returns:
204	            Response: A response object containing the column details, formatted as per the `Response` class.
205	        Raises:
206	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
207	        &quot;&quot;&quot;
208	
</pre>
</div>


</div>
</div>

<div id="issue-177">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mssql_handler/mssql_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mssql_handler/mssql_handler.py</a><br>
    <b>Line number: </b>209<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
193	        &quot;&quot;&quot;
194	        return self.native_query(query)
195	
196	    def get_columns(self, table_name) -&gt; Response:
197	        &quot;&quot;&quot;
198	        Retrieves column details for a specified table in the Microsoft SQL Server database.
199	
200	        Args:
201	            table_name (str): The name of the table for which to retrieve column information.
202	
203	        Returns:
204	            Response: A response object containing the column details, formatted as per the `Response` class.
205	        Raises:
206	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
207	        &quot;&quot;&quot;
208	
209	        query = f&quot;&quot;&quot;
210	            SELECT
211	                column_name as &quot;Field&quot;,
212	                data_type as &quot;Type&quot;
213	            FROM
214	                information_schema.columns
215	            WHERE
216	                table_name = &#x27;{table_name}&#x27;
217	        &quot;&quot;&quot;
218	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-178">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mssql_handler/tests/test_mssql_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mssql_handler/tests/test_mssql_handler.py</a><br>
    <b>Line number: </b>120<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
104	
105	    def test_get_columns(self, sql_server_handler):
106	        response = sql_server_handler.get_columns(&quot;test&quot;)
107	        assert response.type == RESPONSE_TYPE.TABLE, &quot;expected a TABLE&quot;
108	        assert len(response.data_frame) &gt; 0, &quot;expected &gt; O columns&quot;
109	
110	        expected_columns = {
111	            &quot;Field&quot;: [&quot;col_one&quot;, &quot;col_two&quot;, &quot;col_three&quot;, &quot;col_four&quot;],
112	            &quot;Type&quot;: [&quot;int&quot;, &quot;int&quot;, &quot;float&quot;, &quot;varchar&quot;],
113	        }
114	        expected_df = pd.DataFrame(expected_columns)
115	        assert response.data_frame.equals(
116	            expected_df
117	        ), &quot;response does not contain the expected columns&quot;
118	
119	    def test_create_table(self, sql_server_handler):
120	        query = f&quot;&quot;&quot;
121	        IF NOT EXISTS (SELECT * FROM sys.tables WHERE name = &#x27;{self.table_for_creation}&#x27;)
122	        BEGIN
123	            CREATE TABLE {self.table_for_creation} (test_col INT)
124	        END
125	        &quot;&quot;&quot;
126	        res = sql_server_handler.native_query(query)
127	        check_valid_response(res)
128	        tables = get_table_names(sql_server_handler)
129	        assert (
130	            self.table_for_creation in tables
131	        ), f&quot;expected to have {self.table_for_creation} in database, but got: {tables}&quot;
132	
133	    def test_drop_table(self, sql_server_handler):
134	        query = f&quot;DROP TABLE IF EXISTS {self.table_for_creation}&quot;
135	        res = sql_server_handler.native_query(query)
136	        check_valid_response(res)
137	        tables = get_table_names(sql_server_handler)
138	        assert self.table_for_creation not in tables
139	
140	
</pre>
</div>


</div>
</div>

<div id="issue-179">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mysql_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mysql_handler/connection_args.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
54	        &#x27;label&#x27;: &#x27;ssl_ca&#x27;
55	    },
56	    ssl_cert={
57	        &#x27;type&#x27;: ARG_TYPE.PATH,
58	        &#x27;description&#x27;: &#x27;Path name or URL of the server public key certificate file&#x27;,
59	        &#x27;required&#x27;: False,
60	        &#x27;label&#x27;: &#x27;ssl_cert&#x27;
61	    },
62	    ssl_key={
63	        &#x27;type&#x27;: ARG_TYPE.PATH,
64	        &#x27;description&#x27;: &#x27;The path name or URL of the server private key file&#x27;,
65	        &#x27;required&#x27;: False,
66	        &#x27;label&#x27;: &#x27;ssl_key&#x27;,
67	    }
68	)
69	
70	connection_args_example = OrderedDict(
71	    host=&#x27;127.0.0.1&#x27;,
72	    port=3306,
73	    user=&#x27;root&#x27;,
74	    password=&#x27;password&#x27;,
75	    database=&#x27;database&#x27;
76	)
</pre>
</div>


</div>
</div>

<div id="issue-180">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mysql_handler/tests/test_mysql_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mysql_handler/tests/test_mysql_handler.py</a><br>
    <b>Line number: </b>121<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
105	        new_table = table_for_creation
106	        res = handler.native_query(f&quot;CREATE TABLE IF NOT EXISTS {new_table} (test_col INT)&quot;)
107	        check_valid_response(res)
108	        tables = get_table_names(handler)
109	        assert new_table in tables, f&quot;expected to have {new_table} in database, but got: {tables}&quot;
110	
111	#TODO - edit this test so that it can be run on it&#x27;s own - perhaps run drop table as a clean up method? 
112	
113	    def test_drop_table(self, handler):
114	        drop_table = table_for_creation
115	        res = handler.native_query(f&quot;DROP TABLE IF EXISTS {drop_table}&quot;)
116	        check_valid_response(res)
117	        tables = get_table_names(handler)
118	        assert drop_table not in tables
119	
120	    def test_insert_table(self, handler):
121	        res = handler.native_query(f&quot;INSERT INTO test VALUES (4, -4, 0.4, &#x27;D&#x27;)&quot;)
122	        check_valid_response(res)
123	        handler.disconnect()
124	        handler.connect()
125	        res = handler.query(f&quot;SELECT count(*) as x FROM test&quot;)
126	        check_valid_response(res)
127	        got_rows = res.data_frame[&#x27;x&#x27;][0]
128	        assert got_rows == 4
129	
130	
131	class TestMySQLHandlerColumns:
132	    def test_get_columns(self, handler):
133	        described = handler.get_columns(&quot;test&quot;)
134	        describe_data = described.data_frame
135	        check_valid_response(described)
136	        got_columns = list(describe_data.iloc[:, 0])
</pre>
</div>


</div>
</div>

<div id="issue-181">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/mysql_handler/tests/test_mysql_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/mysql_handler/tests/test_mysql_handler.py</a><br>
    <b>Line number: </b>125<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
109	        assert new_table in tables, f&quot;expected to have {new_table} in database, but got: {tables}&quot;
110	
111	#TODO - edit this test so that it can be run on it&#x27;s own - perhaps run drop table as a clean up method? 
112	
113	    def test_drop_table(self, handler):
114	        drop_table = table_for_creation
115	        res = handler.native_query(f&quot;DROP TABLE IF EXISTS {drop_table}&quot;)
116	        check_valid_response(res)
117	        tables = get_table_names(handler)
118	        assert drop_table not in tables
119	
120	    def test_insert_table(self, handler):
121	        res = handler.native_query(f&quot;INSERT INTO test VALUES (4, -4, 0.4, &#x27;D&#x27;)&quot;)
122	        check_valid_response(res)
123	        handler.disconnect()
124	        handler.connect()
125	        res = handler.query(f&quot;SELECT count(*) as x FROM test&quot;)
126	        check_valid_response(res)
127	        got_rows = res.data_frame[&#x27;x&#x27;][0]
128	        assert got_rows == 4
129	
130	
131	class TestMySQLHandlerColumns:
132	    def test_get_columns(self, handler):
133	        described = handler.get_columns(&quot;test&quot;)
134	        describe_data = described.data_frame
135	        check_valid_response(described)
136	        got_columns = list(describe_data.iloc[:, 0])
137	        assert got_columns == expected_columns, f&quot;expected to have next columns in test table:\n{expected_columns}\nbut got:\n{got_columns}&quot;
138	
139	
140	class TestMySQLHandlerDisconnect:
</pre>
</div>


</div>
</div>

<div id="issue-182">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from sklearn.metrics import r2_score
2	import dill
3	import pandas as pd
4	import tempfile
5	from mindsdb.integrations.libs.base import BaseMLEngine
6	from mindsdb.integrations.utilities.time_series_utils import (
7	    transform_to_nixtla_df,
8	    get_results_from_nixtla_df,
9	    infer_frequency,
10	    get_model_accuracy_dict,
11	    get_hierarchy_from_df,
12	    reconcile_forecasts
13	)
14	from neuralforecast import NeuralForecast
15	from neuralforecast.models import NHITS
16	from neuralforecast.auto import AutoNHITS
17	from ray.tune.search.hyperopt import HyperOptSearch
18	
19	# hierarchicalforecast is an optional dependency
20	try:
21	    from hierarchicalforecast.core import HierarchicalReconciliation
22	except ImportError:
23	    HierarchicalReconciliation = None
24	
25	
26	class NeuralForecastHandler(BaseMLEngine):
27	    &quot;&quot;&quot;Integration with the Nixtla NeuralForecast library for
28	    time series forecasting with neural networks.
29	    &quot;&quot;&quot;
30	
31	    name = &quot;neuralforecast&quot;
32	
</pre>
</div>


</div>
</div>

<div id="issue-183">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py</a><br>
    <b>Line number: </b>104<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
88	        &quot;&quot;&quot;Makes forecasts with the NeuralForecast Handler.
89	
90	        NeuralForecast is setup to predict for all groups, so it won&#x27;t handle
91	        a dataframe that&#x27;s been filtered to one group very well. Instead, we make
92	        the prediction for all groups then take care of the filtering after the
93	        forecasting. Prediction is nearly instant.
94	        &quot;&quot;&quot;
95	        # Load model arguments
96	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
97	
98	        prediction_df = transform_to_nixtla_df(df, model_args)
99	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
100	
101	        neural = NeuralForecast.load(model_args[&quot;model_folder&quot;])
102	        forecast_df = neural.predict()
103	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
104	            training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
105	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
106	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
107	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
108	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
109	        else:
110	            results_df = forecast_df[forecast_df.index.isin(groups_to_keep)].rename({
111	                &quot;y&quot;: model_args[&quot;target&quot;],  # auto mode
112	                &quot;NHITS&quot;: model_args[&quot;target&quot;],  # non-auto mode
113	            }, axis=1)
114	        return get_results_from_nixtla_df(results_df, model_args)
115	
116	    def describe(self, attribute=None):
117	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
118	
119	        if attribute == &quot;model&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-184">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py</a><br>
    <b>Line number: </b>105<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
89	
90	        NeuralForecast is setup to predict for all groups, so it won&#x27;t handle
91	        a dataframe that&#x27;s been filtered to one group very well. Instead, we make
92	        the prediction for all groups then take care of the filtering after the
93	        forecasting. Prediction is nearly instant.
94	        &quot;&quot;&quot;
95	        # Load model arguments
96	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
97	
98	        prediction_df = transform_to_nixtla_df(df, model_args)
99	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
100	
101	        neural = NeuralForecast.load(model_args[&quot;model_folder&quot;])
102	        forecast_df = neural.predict()
103	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
104	            training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
105	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
106	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
107	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
108	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
109	        else:
110	            results_df = forecast_df[forecast_df.index.isin(groups_to_keep)].rename({
111	                &quot;y&quot;: model_args[&quot;target&quot;],  # auto mode
112	                &quot;NHITS&quot;: model_args[&quot;target&quot;],  # non-auto mode
113	            }, axis=1)
114	        return get_results_from_nixtla_df(results_df, model_args)
115	
116	    def describe(self, attribute=None):
117	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
118	
119	        if attribute == &quot;model&quot;:
120	            return pd.DataFrame({k: [model_args[k]] for k in [&quot;model_name&quot;, &quot;frequency&quot;, &quot;hierarchy&quot;]})
</pre>
</div>


</div>
</div>

<div id="issue-185">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/neuralforecast_handler/neuralforecast_handler.py</a><br>
    <b>Line number: </b>106<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
90	        NeuralForecast is setup to predict for all groups, so it won&#x27;t handle
91	        a dataframe that&#x27;s been filtered to one group very well. Instead, we make
92	        the prediction for all groups then take care of the filtering after the
93	        forecasting. Prediction is nearly instant.
94	        &quot;&quot;&quot;
95	        # Load model arguments
96	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
97	
98	        prediction_df = transform_to_nixtla_df(df, model_args)
99	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
100	
101	        neural = NeuralForecast.load(model_args[&quot;model_folder&quot;])
102	        forecast_df = neural.predict()
103	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
104	            training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
105	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
106	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
107	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
108	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
109	        else:
110	            results_df = forecast_df[forecast_df.index.isin(groups_to_keep)].rename({
111	                &quot;y&quot;: model_args[&quot;target&quot;],  # auto mode
112	                &quot;NHITS&quot;: model_args[&quot;target&quot;],  # non-auto mode
113	            }, axis=1)
114	        return get_results_from_nixtla_df(results_df, model_args)
115	
116	    def describe(self, attribute=None):
117	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
118	
119	        if attribute == &quot;model&quot;:
120	            return pd.DataFrame({k: [model_args[k]] for k in [&quot;model_name&quot;, &quot;frequency&quot;, &quot;hierarchy&quot;]})
121	
</pre>
</div>


</div>
</div>

<div id="issue-186">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/npm_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/npm_handler/api.py</a><br>
    <b>Line number: </b>7<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
1	import requests
2	
3	
4	class NPM:
5	
6	    def __init__(self, package_name: str):
7	        resp = requests.get(&quot;https://api.npms.io/v2/package/&quot; + package_name)
8	        if not resp or resp.status_code != 200:
9	            raise Exception(f&quot;Unable to get package datails: &#x27;{package_name}&#x27;&quot;)
10	        self.data = resp.json()
11	
12	    def get_data(self):
13	        return self.data
14	
15	    @staticmethod
16	    def is_connected():
17	        return True if requests.get(&quot;https://api.npms.io/v2/search?q=a&amp;size=1&quot;).status_code == 200 else False
18	
19	    def get_cols_in(self, path, cols):
20	        curr_root = self.data
21	        for p in path:
22	            curr_root = curr_root[p]
23	        req_cols = {}
24	        for col in cols:
25	            req_cols[col] = curr_root[col] if col in curr_root else {}
26	        return req_cols
</pre>
</div>


</div>
</div>

<div id="issue-187">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/npm_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/npm_handler/api.py</a><br>
    <b>Line number: </b>17<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
1	import requests
2	
3	
4	class NPM:
5	
6	    def __init__(self, package_name: str):
7	        resp = requests.get(&quot;https://api.npms.io/v2/package/&quot; + package_name)
8	        if not resp or resp.status_code != 200:
9	            raise Exception(f&quot;Unable to get package datails: &#x27;{package_name}&#x27;&quot;)
10	        self.data = resp.json()
11	
12	    def get_data(self):
13	        return self.data
14	
15	    @staticmethod
16	    def is_connected():
17	        return True if requests.get(&quot;https://api.npms.io/v2/search?q=a&amp;size=1&quot;).status_code == 200 else False
18	
19	    def get_cols_in(self, path, cols):
20	        curr_root = self.data
21	        for p in path:
22	            curr_root = curr_root[p]
23	        req_cols = {}
24	        for col in cols:
25	            req_cols[col] = curr_root[col] if col in curr_root else {}
26	        return req_cols
</pre>
</div>


</div>
</div>

<div id="issue-188">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'goalie'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/connection_args.py</a><br>
    <b>Line number: </b>55<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
39	    },
40	    jar_location={
41	        &#x27;type&#x27;: ARG_TYPE.STR,
42	        &#x27;description&#x27;: &#x27;The location of the jar files which contain the JDBC class. This need not be specified if the required classes are already added to the CLASSPATH variable.&#x27;
43	    },
44	    driver_args={
45	        &#x27;type&#x27;: ARG_TYPE.STR,
46	        &#x27;description&#x27;: &quot;&quot;&quot;
47	            The extra arguments which can be specified to the driver. 
48	            Specify this in the format: &quot;arg1=value1,arg2=value2. 
49	            More information on the supported paramters can be found at: https://doc.nuodb.com/nuodb/latest/deployment-models/physical-or-vmware-environments-with-nuodb-admin/reference-information/connection-properties/&#x27;
50	        &quot;&quot;&quot;
51	    }
52	)
53	
54	
55	connection_args_example = OrderedDict(
56	    host=&quot;localhost&quot;,
57	    port=&quot;48006&quot;,
58	    database=&quot;test&quot;,
59	    schema=&quot;hockey&quot;,
60	    user=&quot;dba&quot;,
61	    password=&quot;goalie&quot;,
62	    jar_location=&quot;/Users/kavelbaruah/Desktop/nuodb-jdbc-24.0.0.jar&quot;,
63	    is_direct=&quot;true&quot;,
64	    driver_args=&quot;schema=hockey,clientInfo=info&quot;
65	)
</pre>
</div>


</div>
</div>

<div id="issue-189">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/nuo_jdbc_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/nuo_jdbc_handler.py</a><br>
    <b>Line number: </b>207<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
191	        &quot;&quot;&quot;
192	        if isinstance(query, ASTNode):
193	            query_str = query.to_string()
194	        else:
195	            query_str = str(query)
196	
197	        return self.native_query(query_str)
198	
199	
200	    def get_tables(self) -&gt; StatusResponse:
201	        &quot;&quot;&quot;Get a list of all the tables in the database.
202	
203	        Returns:
204	            Response: Names of the tables in the database.
205	        &quot;&quot;&quot;
206	        if self.schema: 
207	            query = f&#x27;&#x27;&#x27; SELECT TABLENAME FROM SYSTEM.TABLES WHERE SCHEMA = &#x27;{self.schema}&#x27; &#x27;&#x27;&#x27;
208	        else: 
209	            query = &#x27;&#x27;&#x27; SELECT TABLENAME FROM SYSTEM.TABLES WHERE SCHEMA != &#x27;SYSTEM&#x27; &#x27;&#x27;&#x27;
210	    
211	        result = self.native_query(query)
212	        df = result.data_frame
213	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
214	        return result
215	
216	    
217	    def get_columns(self, table_name: str) -&gt; StatusResponse:
218	        &quot;&quot;&quot;Get details about a table.
219	
220	        Args:
221	            table_name (str): Name of the table to retrieve details of.
222	
</pre>
</div>


</div>
</div>

<div id="issue-190">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/nuo_jdbc_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/nuo_jdbc_handler/nuo_jdbc_handler.py</a><br>
    <b>Line number: </b>227<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
211	        result = self.native_query(query)
212	        df = result.data_frame
213	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
214	        return result
215	
216	    
217	    def get_columns(self, table_name: str) -&gt; StatusResponse:
218	        &quot;&quot;&quot;Get details about a table.
219	
220	        Args:
221	            table_name (str): Name of the table to retrieve details of.
222	
223	        Returns:
224	            Response: Details of the table.
225	        &quot;&quot;&quot;
226	
227	        query = f&#x27;&#x27;&#x27; SELECT FIELD FROM SYSTEM.FIELDS WHERE TABLENAME=&#x27;{table_name}&#x27; &#x27;&#x27;&#x27;
228	        return self.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-191">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/oceanbase_handler/oceanbase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/oceanbase_handler/oceanbase_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the OceanBase server.&#x27;
27	    },
28	    database={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the OceanBase server.&#x27;
31	    },
32	    host={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;The host name or IP address of the OceanBase server. &#x27;
35	    },
36	    port={
37	        &#x27;type&#x27;: ARG_TYPE.INT,
38	        &#x27;description&#x27;: &#x27;The TCP/IP port of the OceanBase server. Must be an integer.&#x27;
39	    }
40	)
41	
42	connection_args_example = OrderedDict(
43	    host=&#x27;localhost&#x27;,
44	    port=9030,
45	    user=&#x27;root&#x27;,
46	    password=&#x27;&#x27;,
47	    database=&#x27;test&#x27;
48	)
</pre>
</div>


</div>
</div>

<div id="issue-192">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/oilpriceapi_handler/oilpriceapi.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/oilpriceapi_handler/oilpriceapi.py</a><br>
    <b>Line number: </b>15<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
1	import requests
2	
3	
4	class OilPriceAPIClient:
5	    def __init__(self, api_key):
6	        self.api_key = api_key
7	        self.base_endpoint = &quot;https://api.oilpriceapi.com/v1/prices&quot;
8	        self.valid_values_by_type = [&quot;spot_price&quot;, &quot;daily_average_price&quot;]
9	        self.valid_values_by_code = [&quot;BRENT_CRUDE_USD&quot;, &quot;WTI_USD&quot;]
10	
11	    def make_request(self, url, params={}):
12	        headers = {&#x27;Content-type&#x27;: &#x27;application/json&#x27;}
13	        if self.api_key:
14	            headers[&#x27;Authorization&#x27;] = &#x27;Token &#x27; + self.api_key
15	        resp = requests.get(url, headers=headers, params=params)
16	        content = {}
17	        if resp.status_code == 200:
18	            content = {&#x27;content&#x27;: resp.json(), &#x27;code&#x27;: 200}
19	        else:
20	            content = {&#x27;content&#x27;: {}, &#x27;code&#x27;: resp.status_code, &#x27;error&#x27;: resp.text}
21	        return content
22	
23	    def _is_valid_by_type(self, val):
24	        return val in self.valid_values_by_type
25	
26	    def _is_valid_by_code(self, val):
27	        return val in self.valid_values_by_code
28	
29	    def create_params_dict(self, by_type, by_code):
30	        params = {}
31	        if by_type is not None:
32	            params[&quot;by_type&quot;] = by_type
</pre>
</div>


</div>
</div>

<div id="issue-193">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py</a><br>
    <b>Line number: </b>27<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
11	class OllamaHandler(BaseMLEngine):
12	    name = &quot;ollama&quot;
13	    DEFAULT_SERVE_URL = &quot;http://localhost:11434&quot;
14	
15	    @staticmethod
16	    def create_validation(target, args=None, **kwargs):
17	        if &#x27;using&#x27; not in args:
18	            raise Exception(&quot;Ollama engine requires a USING clause! Refer to its documentation for more details.&quot;)
19	        else:
20	            args = args[&#x27;using&#x27;]
21	
22	        if &#x27;model_name&#x27; not in args:
23	            raise Exception(&#x27;`model_name` must be provided in the USING clause.&#x27;)
24	
25	        # check ollama service health
26	        connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
27	        status = requests.get(connection + &#x27;/api/tags&#x27;).status_code
28	        if status != 200:
29	            raise Exception(f&quot;Ollama service is not working (status `{status}`). Please double check it is running and try again.&quot;)  # noqa
30	
31	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
32	        &quot;&quot;&quot; Pull LLM artifacts with Ollama API. &quot;&quot;&quot;
33	        # arg setter
34	        args = args[&#x27;using&#x27;]
35	        args[&#x27;target&#x27;] = target
36	        connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
37	        self.model_storage.json_set(&#x27;args&#x27;, args)
38	
39	        def _model_check():
40	            &quot;&quot;&quot; Checks model has been pulled and that it works correctly. &quot;&quot;&quot;
41	            try:
42	                return requests.post(
</pre>
</div>


</div>
</div>

<div id="issue-194">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
26	        connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
27	        status = requests.get(connection + &#x27;/api/tags&#x27;).status_code
28	        if status != 200:
29	            raise Exception(f&quot;Ollama service is not working (status `{status}`). Please double check it is running and try again.&quot;)  # noqa
30	
31	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
32	        &quot;&quot;&quot; Pull LLM artifacts with Ollama API. &quot;&quot;&quot;
33	        # arg setter
34	        args = args[&#x27;using&#x27;]
35	        args[&#x27;target&#x27;] = target
36	        connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
37	        self.model_storage.json_set(&#x27;args&#x27;, args)
38	
39	        def _model_check():
40	            &quot;&quot;&quot; Checks model has been pulled and that it works correctly. &quot;&quot;&quot;
41	            try:
42	                return requests.post(
43	                    connection + &#x27;/api/generate&#x27;,
44	                    json={
45	                        &#x27;model&#x27;: args[&#x27;model_name&#x27;],
46	                        &#x27;prompt&#x27;: &#x27;Hello.&#x27;,
47	                    }
48	                ).status_code
49	            except Exception:
50	                return 500
51	
52	        # check model
53	        response = _model_check()
54	        if response != 200:
55	            # pull model (blocking operation) and serve
56	            # TODO: point to the engine storage folder instead of default location
57	            connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
58	            requests.post(connection + &#x27;/api/pull&#x27;, json={&#x27;name&#x27;: args[&#x27;model_name&#x27;]})
59	            # try one last time
60	            response = _model_check()
61	            if response != 200:
62	                raise Exception(f&quot;Ollama model `{args[&#x27;model_name&#x27;]}` is not working correctly (`pull` status code: {response}). Please try pulling this model manually, check it works correctly and try again.&quot;)  # noqa
63	
</pre>
</div>


</div>
</div>

<div id="issue-195">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py</a><br>
    <b>Line number: </b>58<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
42	                return requests.post(
43	                    connection + &#x27;/api/generate&#x27;,
44	                    json={
45	                        &#x27;model&#x27;: args[&#x27;model_name&#x27;],
46	                        &#x27;prompt&#x27;: &#x27;Hello.&#x27;,
47	                    }
48	                ).status_code
49	            except Exception:
50	                return 500
51	
52	        # check model
53	        response = _model_check()
54	        if response != 200:
55	            # pull model (blocking operation) and serve
56	            # TODO: point to the engine storage folder instead of default location
57	            connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
58	            requests.post(connection + &#x27;/api/pull&#x27;, json={&#x27;name&#x27;: args[&#x27;model_name&#x27;]})
59	            # try one last time
60	            response = _model_check()
61	            if response != 200:
62	                raise Exception(f&quot;Ollama model `{args[&#x27;model_name&#x27;]}` is not working correctly (`pull` status code: {response}). Please try pulling this model manually, check it works correctly and try again.&quot;)  # noqa
63	
64	    def predict(self, df: pd.DataFrame, args: Optional[Dict] = None) -&gt; pd.DataFrame:
65	        &quot;&quot;&quot;
66	        Generate text completions with the local LLM.
67	            Args:
68	                df (pd.DataFrame): The input DataFrame containing data to predict.
69	                args (Optional[Dict]): Additional arguments for prediction parameters.
70	            Returns:
71	                pd.DataFrame: The DataFrame containing row-wise text completions.
72	        &quot;&quot;&quot;
73	        # setup
</pre>
</div>


</div>
</div>

<div id="issue-196">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py</a><br>
    <b>Line number: </b>90<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
74	        pred_args = args.get(&#x27;predict_params&#x27;, {})
75	        args = self.model_storage.json_get(&#x27;args&#x27;)
76	        model_name, target_col = args[&#x27;model_name&#x27;], args[&#x27;target&#x27;]
77	        prompt_template = pred_args.get(&#x27;prompt_template&#x27;,
78	                                        args.get(&#x27;prompt_template&#x27;, &#x27;Answer the following question: {{{{text}}}}&#x27;))
79	        # TODO v2: add support for overriding modelfile params (e.g. temperature)
80	
81	        # prepare prompts
82	        prompts, empty_prompt_ids = get_completed_prompts(prompt_template, df)
83	        df[&#x27;__mdb_prompt&#x27;] = prompts
84	
85	        # call llm
86	        completions = []
87	        for i, row in df.iterrows():
88	            if i not in empty_prompt_ids:
89	                connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
90	                raw_output = requests.post(
91	                    connection + &#x27;/api/generate&#x27;,
92	                    json={
93	                        &#x27;model&#x27;: args[&#x27;model_name&#x27;],
94	                        &#x27;prompt&#x27;: row[&#x27;__mdb_prompt&#x27;],
95	                    }
96	                )
97	                out_tokens = raw_output.content.decode().split(&#x27;\n&#x27;)  # stream of output tokens
98	
99	                tokens = []
100	                for o in out_tokens:
101	                    if o != &#x27;&#x27;:
102	                        # TODO v2: add support for storing `context` short conversational memory
103	                        info = json.loads(o)
104	                        if &#x27;response&#x27; in info:
105	                            token = info[&#x27;response&#x27;]
106	                            tokens.append(token)
107	
108	                completions.append(&#x27;&#x27;.join(tokens))
109	            else:
110	                completions.append(&#x27;&#x27;)
111	
</pre>
</div>


</div>
</div>

<div id="issue-197">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ollama_handler/ollama_handler.py</a><br>
    <b>Line number: </b>128<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
112	        # consolidate output
113	        data = pd.DataFrame(completions)
114	        data.columns = [target_col]
115	        return data
116	
117	    def describe(self, attribute: Optional[str] = None) -&gt; pd.DataFrame:
118	        args = self.model_storage.json_get(&#x27;args&#x27;)
119	        model_name, target_col = args[&#x27;model_name&#x27;], args[&#x27;target&#x27;]
120	        prompt_template = args.get(&#x27;prompt_template&#x27;, &#x27;Answer the following question: {{{{text}}}}&#x27;)
121	
122	        if attribute == &quot;features&quot;:
123	            return pd.DataFrame([[target_col, prompt_template]], columns=[&#x27;target_column&#x27;, &#x27;mindsdb_prompt_template&#x27;])
124	
125	        # get model info
126	        else:
127	            connection = args.get(&#x27;ollama_serve_url&#x27;, OllamaHandler.DEFAULT_SERVE_URL)
128	            model_info = requests.post(connection + &#x27;/api/show&#x27;, json={&#x27;name&#x27;: model_name}).json()
129	            return pd.DataFrame([[
130	                model_name,
131	                model_info.get(&#x27;license&#x27;, &#x27;N/A&#x27;),
132	                model_info.get(&#x27;modelfile&#x27;, &#x27;N/A&#x27;),
133	                model_info.get(&#x27;parameters&#x27;, &#x27;N/A&#x27;),
134	                model_info.get(&#x27;template&#x27;, &#x27;N/A&#x27;),
135	            ]],
136	                columns=[
137	                    &#x27;model_type&#x27;,
138	                    &#x27;license&#x27;,
139	                    &#x27;modelfile&#x27;,
140	                    &#x27;parameters&#x27;,
141	                    &#x27;ollama_base_template&#x27;,
142	                ])
</pre>
</div>


</div>
</div>

<div id="issue-198">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py</a><br>
    <b>Line number: </b>8<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import os
2	import math
3	import json
4	import shutil
5	import tempfile
6	import datetime
7	import textwrap
8	import subprocess
9	import concurrent.futures
10	from typing import Text, Tuple, Dict, List, Optional, Any
11	import openai
12	from openai import OpenAI, NotFoundError, AuthenticationError
13	import numpy as np
14	import pandas as pd
15	
16	from mindsdb.utilities.hooks import before_openai_query, after_openai_query
17	from mindsdb.utilities import log
18	from mindsdb.integrations.libs.base import BaseMLEngine
19	from mindsdb.integrations.handlers.openai_handler.helpers import (
20	    retry_with_exponential_backoff,
21	    truncate_msgs_for_token_limit,
22	    get_available_models,
23	    PendingFT,
24	)
25	from mindsdb.integrations.handlers.openai_handler.constants import (
26	    CHAT_MODELS,
27	    IMAGE_MODELS,
28	    FINETUNING_MODELS,
29	    OPENAI_API_BASE,
30	)
31	from mindsdb.integrations.libs.llm.utils import get_completed_prompts
32	from mindsdb.integrations.utilities.handler_utils import get_api_key
</pre>
</div>


</div>
</div>

<div id="issue-199">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py</a><br>
    <b>Line number: </b>418<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
402	                empty_prompt_ids = np.where(
403	                    df[[args[&#x27;question_column&#x27;]]].isna().all(axis=1).values
404	                )[0]
405	                prompts = list(df[args[&#x27;question_column&#x27;]].apply(lambda x: str(x)))
406	
407	            # add json struct if available
408	            if args.get(&#x27;json_struct&#x27;, False):
409	                for i, prompt in enumerate(prompts):
410	                    json_struct = &#x27;&#x27;
411	                    if &#x27;json_struct&#x27; in df.columns and i not in empty_prompt_ids:
412	                        # if row has a specific json, we try to use it instead of the base prompt template
413	                        try:
414	                            if isinstance(df[&#x27;json_struct&#x27;][i], str):
415	                                df[&#x27;json_struct&#x27;][i] = json.loads(df[&#x27;json_struct&#x27;][i])
416	                            for ind, val in enumerate(df[&#x27;json_struct&#x27;][i].values()):
417	                                json_struct = json_struct + f&#x27;{ind}. {val}\n&#x27;
418	                        except Exception:
419	                            pass  # if the row&#x27;s json is invalid, we use the prompt template instead
420	
421	                    if json_struct == &#x27;&#x27;:
422	                        for ind, val in enumerate(args[&#x27;json_struct&#x27;].values()):
423	                            json_struct = json_struct + f&#x27;{ind + 1}. {val}\n&#x27;
424	
425	                    p = textwrap.dedent(
426	                        f&#x27;&#x27;&#x27;\
427	                            Based on the text following &#x27;The reference text is:&#x27;, assign values to the following {len(args[&#x27;json_struct&#x27;])} JSON attributes:
428	                            {{{{json_struct}}}}
429	
430	                            Values should follow the same order as the attributes above.
431	                            Each line in the answer should start with a dotted number, and should not repeat the name of the attribute, just the value.
432	                            Each answer must end with new line.
433	                            If there is no valid value to a given attribute in the text, answer with a - character.
434	                            Values should be as short as possible, ideally 1-2 words (unless otherwise specified).
</pre>
</div>


</div>
</div>

<div id="issue-200">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py</a><br>
    <b>Line number: </b>1031<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
1015	    @staticmethod
1016	    def _prepare_ft_jsonl(df: pd.DataFrame, _, temp_filename: Text, temp_model_path: Text) -&gt; Dict:
1017	        &quot;&quot;&quot;
1018	        Prepare the input data for fine-tuning.
1019	
1020	        Args:
1021	            df (pd.DataFrame): Input data to fine-tune on.
1022	            temp_filename (Text): Temporary filename.
1023	            temp_model_path (Text): Temporary model path.
1024	
1025	        Returns:
1026	            Dict: File names for the fine-tuning process.
1027	        &quot;&quot;&quot;
1028	        df.to_json(temp_model_path, orient=&#x27;records&#x27;, lines=True)
1029	
1030	        # TODO avoid subprocess usage once OpenAI enables non-CLI access, or refactor to use our own LLM utils instead
1031	        subprocess.run(
1032	            [
1033	                &quot;openai&quot;,
1034	                &quot;tools&quot;,
1035	                &quot;fine_tunes.prepare_data&quot;,
1036	                &quot;-f&quot;,
1037	                temp_model_path,  # from file
1038	                &#x27;-q&#x27;,  # quiet mode (accepts all suggestions)
1039	            ],
1040	            stdout=subprocess.PIPE,
1041	            stderr=subprocess.PIPE,
1042	            encoding=&quot;utf-8&quot;,
1043	        )
1044	
1045	        file_names = {
1046	            &#x27;original&#x27;: f&#x27;{temp_filename}.jsonl&#x27;,
1047	            &#x27;base&#x27;: f&#x27;{temp_filename}_prepared.jsonl&#x27;,
1048	            &#x27;train&#x27;: f&#x27;{temp_filename}_prepared_train.jsonl&#x27;,
1049	            &#x27;val&#x27;: f&#x27;{temp_filename}_prepared_valid.jsonl&#x27;,
1050	        }
1051	        return file_names
1052	
1053	    def _get_ft_model_type(self, model_name: Text) -&gt; Text:
1054	        &quot;&quot;&quot;
1055	        Get the model to use for fine-tuning. If the model is not supported, the default model (babbage-002) is used.
1056	
1057	        Args:
1058	            model_name (Text): Model name.
</pre>
</div>


</div>
</div>

<div id="issue-201">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/openai_handler/openai_handler.py</a><br>
    <b>Line number: </b>1031<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
1015	    @staticmethod
1016	    def _prepare_ft_jsonl(df: pd.DataFrame, _, temp_filename: Text, temp_model_path: Text) -&gt; Dict:
1017	        &quot;&quot;&quot;
1018	        Prepare the input data for fine-tuning.
1019	
1020	        Args:
1021	            df (pd.DataFrame): Input data to fine-tune on.
1022	            temp_filename (Text): Temporary filename.
1023	            temp_model_path (Text): Temporary model path.
1024	
1025	        Returns:
1026	            Dict: File names for the fine-tuning process.
1027	        &quot;&quot;&quot;
1028	        df.to_json(temp_model_path, orient=&#x27;records&#x27;, lines=True)
1029	
1030	        # TODO avoid subprocess usage once OpenAI enables non-CLI access, or refactor to use our own LLM utils instead
1031	        subprocess.run(
1032	            [
1033	                &quot;openai&quot;,
1034	                &quot;tools&quot;,
1035	                &quot;fine_tunes.prepare_data&quot;,
1036	                &quot;-f&quot;,
1037	                temp_model_path,  # from file
1038	                &#x27;-q&#x27;,  # quiet mode (accepts all suggestions)
1039	            ],
1040	            stdout=subprocess.PIPE,
1041	            stderr=subprocess.PIPE,
1042	            encoding=&quot;utf-8&quot;,
1043	        )
1044	
1045	        file_names = {
1046	            &#x27;original&#x27;: f&#x27;{temp_filename}.jsonl&#x27;,
1047	            &#x27;base&#x27;: f&#x27;{temp_filename}_prepared.jsonl&#x27;,
1048	            &#x27;train&#x27;: f&#x27;{temp_filename}_prepared_train.jsonl&#x27;,
1049	            &#x27;val&#x27;: f&#x27;{temp_filename}_prepared_valid.jsonl&#x27;,
1050	        }
1051	        return file_names
1052	
1053	    def _get_ft_model_type(self, model_name: Text) -&gt; Text:
1054	        &quot;&quot;&quot;
1055	        Get the model to use for fine-tuning. If the model is not supported, the default model (babbage-002) is used.
1056	
1057	        Args:
1058	            model_name (Text): Model name.
</pre>
</div>


</div>
</div>

<div id="issue-202">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/opengauss_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/opengauss_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the openGauss server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the openGauss server. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the openGauss server. Must be an integer.&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    host=&#x27;127.0.0.1&#x27;,
32	    port=5432,
33	    user=&#x27;mindsdb&#x27;,
34	    password=&#x27;password&#x27;,
35	    database=&#x27;database&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-203">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/opengauss_handler/tests/test_opengauss_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/opengauss_handler/tests/test_opengauss_handler.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
20	        self.handler.connect()
21	
22	    def test_1_check_connection(self):
23	        assert self.handler.check_connection()
24	
25	    def test_2_native_query_show_dbs(self):
26	        dbs = self.handler.native_query(&quot;SHOW DATABASES;&quot;)
27	        assert isinstance(dbs, list)
28	
29	    def test_3_get_tables(self):
30	        tbls = self.handler.get_tables()
31	        assert isinstance(tbls, list)
32	
33	    def test_5_create_table(self):
34	        try:
35	            self.handler.native_query(&quot;CREATE TABLE test_opengauss (test_col INTEGER)&quot;)
36	        except Exception:
37	            pass
38	
39	    def test_6_describe_table(self):
40	        described = self.handler.get_columns(&quot;dt_test&quot;)
41	        assert isinstance(described, list)
42	
43	    def test_7_select_query(self):
44	        query = &quot;SELECT * FROM dt_test WHERE &#x27;id&#x27;=&#x27;a&#x27;&quot;
45	        result = self.handler.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-204">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/oracle_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/oracle_handler/connection_args.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	    },
27	    password={
28	        &quot;type&quot;: ARG_TYPE.PWD,
29	        &quot;description&quot;: &quot;The password to authenticate the user against Oracle DB.&quot;,
30	        &quot;secret&quot;: True
31	    },
32	    disable_oob={
33	        &quot;type&quot;: ARG_TYPE.BOOL,
34	        &quot;description&quot;: &quot;Disable out-of-band breaks&quot;,
35	    },
36	    auth_mode={
37	        &quot;type&quot;: ARG_TYPE.STR,
38	        &quot;description&quot;: &quot;Database privilege for connection&quot;,
39	    },
40	)
41	
42	connection_args_example = OrderedDict(
43	    host=&quot;127.0.0.1&quot;,
44	    port=1521,
45	    user=&quot;admin&quot;,
46	    password=&quot;password&quot;,
47	    sid=&quot;ORCL&quot;,
48	)
</pre>
</div>


</div>
</div>

<div id="issue-205">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/oracle_handler/oracle_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/oracle_handler/oracle_handler.py</a><br>
    <b>Line number: </b>163<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
147	
148	    def get_tables(self) -&gt; Response:
149	        &quot;&quot;&quot;
150	        List all tables in Oracle DB owned by the current user.
151	        &quot;&quot;&quot;
152	        query = &quot;&quot;&quot;
153	            SELECT table_name
154	            FROM user_tables
155	            ORDER BY 1
156	        &quot;&quot;&quot;
157	        return self.native_query(query)
158	
159	    def get_columns(self, table_name: str) -&gt; Response:
160	        &quot;&quot;&quot;
161	        Show details about the table.
162	        &quot;&quot;&quot;
163	        query = f&quot;&quot;&quot;
164	            SELECT 
165	                column_name,
166	                data_type
167	            FROM USER_TAB_COLUMNS
168	            WHERE table_name = &#x27;{table_name}&#x27;
169	        &quot;&quot;&quot;
170	        result = self.native_query(query)
171	        return result
</pre>
</div>


</div>
</div>

<div id="issue-206">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<???>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/orioledb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/orioledb_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the OrioleDB server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the OrioleDB server. &#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the OrioleDB server. Must be an integer.&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    host=&#x27;127.0.0.1&#x27;,
32	    port=5432,
33	    user=&#x27;postgres&#x27;,
34	    password=&#x27;&lt;???&gt;&#x27;,
35	    database=&#x27;database&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-207">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<secret>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/paypal_handler/paypal_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/paypal_handler/paypal_handler.py</a><br>
    <b>Line number: </b>141<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
125	        &quot;label&quot;: &quot;MODE&quot;,
126	    },
127	    client_id={
128	        &quot;type&quot;: ARG_TYPE.PWD,
129	        &quot;description&quot;: &quot;Client id of the App&quot;,
130	        &quot;required&quot;: True,
131	        &quot;label&quot;: &quot;Client ID&quot;,
132	    },
133	    client_secret={
134	        &quot;type&quot;: ARG_TYPE.STR,
135	        &quot;description&quot;: &quot;Client secret of the App&quot;,
136	        &quot;required&quot;: True,
137	        &quot;label&quot;: &quot;Client Secret&quot;,
138	    },
139	)
140	
141	connection_args_example = OrderedDict(
142	    mode=&quot;sandbox&quot;,
143	    client_id=&quot;xxxx-xxxx-xxxx-xxxx&quot;,
144	    client_secret=&quot;&lt;secret&gt;&quot;,
145	)
</pre>
</div>


</div>
</div>

<div id="issue-208">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/connection_args.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
36	        &quot;label&quot;: &quot;Port&quot;,
37	    },
38	    schema={
39	        &quot;type&quot;: ARG_TYPE.STR,
40	        &quot;description&quot;: &quot;The schema in which objects are searched first.&quot;,
41	        &quot;required&quot;: False,
42	        &quot;label&quot;: &quot;Schema&quot;,
43	    },
44	    sslmode={
45	        &quot;type&quot;: ARG_TYPE.STR,
46	        &quot;description&quot;: &quot;sslmode that will be used for connection.&quot;,
47	        &quot;required&quot;: False,
48	        &quot;label&quot;: &quot;sslmode&quot;,
49	    },
50	)
51	
52	connection_args_example = OrderedDict(
53	    host=&quot;127.0.0.1&quot;, port=5432, user=&quot;root&quot;, password=&quot;password&quot;, database=&quot;database&quot;
54	)
</pre>
</div>


</div>
</div>

<div id="issue-209">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py</a><br>
    <b>Line number: </b>152<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
136	        after_from_clause = self._construct_full_after_from_clause(
137	            where_clause, offset_clause, limit_clause
138	        )
139	
140	        if columns is None:
141	            targets = &#x27;*&#x27;
142	        else:
143	            targets = &#x27;, &#x27;.join(columns)
144	
145	
146	        if filter_conditions:
147	
148	            if embedding_search:
149	                # if search vector, return similar rows, apply other filters after if any
150	                search_vector = filter_conditions[&quot;embeddings&quot;][&quot;value&quot;][0]
151	                filter_conditions.pop(&quot;embeddings&quot;)
152	                return f&quot;SELECT {targets} FROM {table_name} ORDER BY embeddings &lt;=&gt; &#x27;{search_vector}&#x27; {after_from_clause}&quot;
153	            else:
154	                # if filter conditions, return filtered rows
155	                return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
156	        else:
157	            # if no filter conditions, return all rows
158	            return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
159	
160	    def select(
161	        self,
162	        table_name: str,
163	        columns: List[str] = None,
164	        conditions: List[FilterCondition] = None,
165	        offset: int = None,
166	        limit: int = None,
167	    ) -&gt; pd.DataFrame:
</pre>
</div>


</div>
</div>

<div id="issue-210">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py</a><br>
    <b>Line number: </b>155<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
139	
140	        if columns is None:
141	            targets = &#x27;*&#x27;
142	        else:
143	            targets = &#x27;, &#x27;.join(columns)
144	
145	
146	        if filter_conditions:
147	
148	            if embedding_search:
149	                # if search vector, return similar rows, apply other filters after if any
150	                search_vector = filter_conditions[&quot;embeddings&quot;][&quot;value&quot;][0]
151	                filter_conditions.pop(&quot;embeddings&quot;)
152	                return f&quot;SELECT {targets} FROM {table_name} ORDER BY embeddings &lt;=&gt; &#x27;{search_vector}&#x27; {after_from_clause}&quot;
153	            else:
154	                # if filter conditions, return filtered rows
155	                return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
156	        else:
157	            # if no filter conditions, return all rows
158	            return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
159	
160	    def select(
161	        self,
162	        table_name: str,
163	        columns: List[str] = None,
164	        conditions: List[FilterCondition] = None,
165	        offset: int = None,
166	        limit: int = None,
167	    ) -&gt; pd.DataFrame:
168	        &quot;&quot;&quot;
169	        Retrieve the data from the SQL statement with eliminated rows that dont satisfy the WHERE condition
170	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-211">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py</a><br>
    <b>Line number: </b>158<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
142	        else:
143	            targets = &#x27;, &#x27;.join(columns)
144	
145	
146	        if filter_conditions:
147	
148	            if embedding_search:
149	                # if search vector, return similar rows, apply other filters after if any
150	                search_vector = filter_conditions[&quot;embeddings&quot;][&quot;value&quot;][0]
151	                filter_conditions.pop(&quot;embeddings&quot;)
152	                return f&quot;SELECT {targets} FROM {table_name} ORDER BY embeddings &lt;=&gt; &#x27;{search_vector}&#x27; {after_from_clause}&quot;
153	            else:
154	                # if filter conditions, return filtered rows
155	                return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
156	        else:
157	            # if no filter conditions, return all rows
158	            return f&quot;SELECT {targets} FROM {table_name} {after_from_clause}&quot;
159	
160	    def select(
161	        self,
162	        table_name: str,
163	        columns: List[str] = None,
164	        conditions: List[FilterCondition] = None,
165	        offset: int = None,
166	        limit: int = None,
167	    ) -&gt; pd.DataFrame:
168	        &quot;&quot;&quot;
169	        Retrieve the data from the SQL statement with eliminated rows that dont satisfy the WHERE condition
170	        &quot;&quot;&quot;
171	        if columns is None:
172	            columns = [&quot;id&quot;, &quot;content&quot;, &quot;embeddings&quot;, &quot;metadata&quot;]
173	
</pre>
</div>


</div>
</div>

<div id="issue-212">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py</a><br>
    <b>Line number: </b>213<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
197	
198	    def insert(
199	        self, table_name: str, data: pd.DataFrame
200	    ):
201	        &quot;&quot;&quot;
202	        Insert data into the pgvector table database.
203	        &quot;&quot;&quot;
204	        data_dict = data.to_dict(orient=&quot;list&quot;)
205	
206	        if &#x27;metadata&#x27; in data_dict:
207	            data_dict[&#x27;metadata&#x27;] = [json.dumps(i) for i in data_dict[&#x27;metadata&#x27;]]
208	        transposed_data = list(zip(*data_dict.values()))
209	
210	        columns = &quot;, &quot;.join(data.keys())
211	        values = &quot;, &quot;.join([&quot;%s&quot;] * len(data.keys()))
212	
213	        insert_statement = f&quot;INSERT INTO {table_name} ({columns}) VALUES ({values})&quot;
214	
215	        with self.connection.cursor() as cur:
216	            cur.executemany(insert_statement, transposed_data)
217	            self.connection.commit()
218	
219	    def update(
220	        self, table_name: str, data: pd.DataFrame, key_columns: List[str] = None
221	    ):
222	        &quot;&quot;&quot;
223	        Udate data into the pgvector table database.
224	        &quot;&quot;&quot;
225	
226	        where = None
227	        update_columns = {}
228	
</pre>
</div>


</div>
</div>

<div id="issue-213">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pgvector_handler/pgvector_handler.py</a><br>
    <b>Line number: </b>283<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
267	
268	    def delete(
269	        self, table_name: str, conditions: List[FilterCondition] = None
270	    ):
271	
272	        filter_conditions = self._translate_conditions(conditions)
273	        where_clause = self._construct_where_clause(filter_conditions)
274	
275	        with self.connection.cursor() as cur:
276	
277	            # convert search embedding to string
278	
279	            # we need to use the &lt;-&gt; operator to search for similar vectors,
280	            # so we need to convert the string to a vector and also use a threshold (e.g. 0.5)
281	
282	            query = (
283	                f&quot;DELETE FROM {table_name} {where_clause}&quot;
284	            )
285	            cur.execute(query)
286	            self.connection.commit()
287	
288	    def drop_table(self, table_name: str, if_exists=True):
289	        &quot;&quot;&quot;
290	        Run a drop table query on the pgvector database.
291	        &quot;&quot;&quot;
292	        with self.connection.cursor() as cur:
293	            cur.execute(f&quot;DROP TABLE IF EXISTS {table_name}&quot;)
294	            self.connection.commit()
</pre>
</div>


</div>
</div>

<div id="issue-214">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/phoenix_handler/phoenix_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/phoenix_handler/phoenix_handler.py</a><br>
    <b>Line number: </b>206<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
190	
191	    def get_columns(self, table_name: str) -&gt; StatusResponse:
192	        &quot;&quot;&quot;
193	        Returns a list of entity columns.
194	        Args:
195	            table_name (str): name of one of tables returned by self.get_tables()
196	        Returns:
197	            HandlerResponse
198	        &quot;&quot;&quot;
199	
200	        need_to_close = self.is_connected is False
201	
202	        connection = self.connect()
203	        cursor = connection.cursor()
204	
205	        try:
206	            query = f&quot;SELECT * from {table_name} LIMIT 5&quot;
207	            cursor.execute(query)
208	            cursor.fetchall()
209	
210	            response = Response(
211	                RESPONSE_TYPE.TABLE,
212	                data_frame=pd.DataFrame(
213	                    [(x[0], x[1]) for x in cursor.description],
214	                    columns=[&#x27;column_name&#x27;, &#x27;data_type&#x27;]
215	                )
216	            )
217	
218	        except Exception as e:
219	            logger.error(f&#x27;Error running query: {query} on the Phoenix Query Server!&#x27;)
220	            response = Response(
221	                RESPONSE_TYPE.ERROR,
</pre>
</div>


</div>
</div>

<div id="issue-215">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py</a><br>
    <b>Line number: </b>184<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
168	        Returns:
169	            HandlerResponse
170	        &quot;&quot;&quot;
171	        renderer = SqlalchemyRender(PinotDialect)
172	        query_str = renderer.get_string(query, with_failback=True)
173	        return self.native_query(query_str)
174	
175	    def get_tables(self) -&gt; StatusResponse:
176	        &quot;&quot;&quot;
177	        Return list of entities that will be accessible as tables.
178	        Returns:
179	            HandlerResponse
180	        &quot;&quot;&quot;
181	
182	        api_url = f&quot;{self.connection_data[&#x27;host&#x27;]}:{self.connection_data[&#x27;controller_port&#x27;]}/tables&quot;
183	        try:
184	            result = requests.get(api_url)
185	        except InvalidSchema as e:
186	            api_url = f&quot;{self.connection_data[&#x27;scheme&#x27;]}://{api_url}&quot;
187	            result = requests.get(api_url)
188	
189	        response = Response(
190	            RESPONSE_TYPE.TABLE,
191	            data_frame=pd.DataFrame(
192	                json.loads(result.content)[&#x27;tables&#x27;],
193	                columns=[&#x27;table_name&#x27;]
194	            )
195	        )
196	
197	        return response
198	
199	    def get_columns(self, table_name: str) -&gt; StatusResponse:
</pre>
</div>


</div>
</div>

<div id="issue-216">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py</a><br>
    <b>Line number: </b>187<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
171	        renderer = SqlalchemyRender(PinotDialect)
172	        query_str = renderer.get_string(query, with_failback=True)
173	        return self.native_query(query_str)
174	
175	    def get_tables(self) -&gt; StatusResponse:
176	        &quot;&quot;&quot;
177	        Return list of entities that will be accessible as tables.
178	        Returns:
179	            HandlerResponse
180	        &quot;&quot;&quot;
181	
182	        api_url = f&quot;{self.connection_data[&#x27;host&#x27;]}:{self.connection_data[&#x27;controller_port&#x27;]}/tables&quot;
183	        try:
184	            result = requests.get(api_url)
185	        except InvalidSchema as e:
186	            api_url = f&quot;{self.connection_data[&#x27;scheme&#x27;]}://{api_url}&quot;
187	            result = requests.get(api_url)
188	
189	        response = Response(
190	            RESPONSE_TYPE.TABLE,
191	            data_frame=pd.DataFrame(
192	                json.loads(result.content)[&#x27;tables&#x27;],
193	                columns=[&#x27;table_name&#x27;]
194	            )
195	        )
196	
197	        return response
198	
199	    def get_columns(self, table_name: str) -&gt; StatusResponse:
200	        &quot;&quot;&quot;
201	        Returns a list of entity columns.
202	        Args:
</pre>
</div>


</div>
</div>

<div id="issue-217">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py</a><br>
    <b>Line number: </b>210<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
194	            )
195	        )
196	
197	        return response
198	
199	    def get_columns(self, table_name: str) -&gt; StatusResponse:
200	        &quot;&quot;&quot;
201	        Returns a list of entity columns.
202	        Args:
203	            table_name (str): name of one of tables returned by self.get_tables()
204	        Returns:
205	            HandlerResponse
206	        &quot;&quot;&quot;
207	
208	        api_url = f&quot;{self.connection_data[&#x27;host&#x27;]}:{self.connection_data[&#x27;controller_port&#x27;]}/tables/{table_name}/schema&quot;
209	        try:
210	            result = requests.get(api_url)
211	        except InvalidSchema as e:
212	            api_url = f&quot;{self.connection_data[&#x27;scheme&#x27;]}://{api_url}&quot;
213	            result = requests.get(api_url)
214	
215	        df = pd.DataFrame(json.loads(result.content)[&#x27;dimensionFieldSpecs&#x27;])
216	        df = df.rename(columns={&#x27;name&#x27;: &#x27;column_name&#x27;, &#x27;dataType&#x27;: &#x27;data_type&#x27;})
217	
218	        response = Response(
219	            RESPONSE_TYPE.TABLE,
220	            data_frame=df
221	        )
222	
223	        return response
</pre>
</div>


</div>
</div>

<div id="issue-218">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pinot_handler/pinot_handler.py</a><br>
    <b>Line number: </b>213<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
197	        return response
198	
199	    def get_columns(self, table_name: str) -&gt; StatusResponse:
200	        &quot;&quot;&quot;
201	        Returns a list of entity columns.
202	        Args:
203	            table_name (str): name of one of tables returned by self.get_tables()
204	        Returns:
205	            HandlerResponse
206	        &quot;&quot;&quot;
207	
208	        api_url = f&quot;{self.connection_data[&#x27;host&#x27;]}:{self.connection_data[&#x27;controller_port&#x27;]}/tables/{table_name}/schema&quot;
209	        try:
210	            result = requests.get(api_url)
211	        except InvalidSchema as e:
212	            api_url = f&quot;{self.connection_data[&#x27;scheme&#x27;]}://{api_url}&quot;
213	            result = requests.get(api_url)
214	
215	        df = pd.DataFrame(json.loads(result.content)[&#x27;dimensionFieldSpecs&#x27;])
216	        df = df.rename(columns={&#x27;name&#x27;: &#x27;column_name&#x27;, &#x27;dataType&#x27;: &#x27;data_type&#x27;})
217	
218	        response = Response(
219	            RESPONSE_TYPE.TABLE,
220	            data_frame=df
221	        )
222	
223	        return response
</pre>
</div>


</div>
</div>

<div id="issue-219">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pirateweather_handler/pirateweather_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pirateweather_handler/pirateweather_handler.py</a><br>
    <b>Line number: </b>219<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
203	            &quot;exclude&quot;: &quot;currently,minutely,alerts,hourly,daily&quot;.replace(&quot;,&quot; + method_name, &quot;&quot;),
204	            &quot;units&quot;: params.get(&quot;units&quot;),
205	        }
206	
207	        # Build the query
208	        query = self.query_string_template.format(
209	            api_key=self._api_key,
210	            latitude=params[&quot;latitude&quot;],
211	            longitude=params[&quot;longitude&quot;]
212	        )
213	        if &quot;time&quot; in params:
214	            query += f&quot;,{params[&#x27;time&#x27;]}&quot;
215	        # Add optional parameters
216	        query += &quot;?&quot; + &quot;&amp;&quot;.join([f&quot;{k}={v}&quot; for k, v in opt_params.items() if v])
217	
218	        # Call the API
219	        response = requests.get(query)
220	        response.raise_for_status()
221	
222	        # Parse the response
223	        data = response.json()
224	        if method_name not in data:
225	            raise ValueError(f&quot;API response did not contain {method_name} data. Check your API key. Got response: {data}&quot;)
226	
227	        # Convert to dataframe
228	        df = pd.DataFrame(data[method_name][&quot;data&quot;]).assign(
229	            latitude=params[&quot;latitude&quot;],
230	            longitude=params[&quot;longitude&quot;],
231	            timezone=data[&quot;timezone&quot;],
232	            offset=data[&quot;offset&quot;]
233	        )
234	        df[&quot;localtime&quot;] = pd.to_datetime(df[&quot;time&quot;], utc=True, unit=&quot;s&quot;).dt.tz_convert(data[&quot;timezone&quot;])
</pre>
</div>


</div>
</div>

<div id="issue-220">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/planetscale_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/planetscale_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Planetscale server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the Planetscale server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Planetscale server. Must be an integer.&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    host=&#x27;127.0.0.1&#x27;,
32	    port=4000,
33	    user=&#x27;root&#x27;,
34	    password=&#x27;password&#x27;,
35	    database=&#x27;database&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-221">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/popularity_recommender_handler/popularity_recommender_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/popularity_recommender_handler/popularity_recommender_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Dict, Optional
2	
3	import dill
4	import pandas as pd
5	import polars as pl
6	
7	from mindsdb.integrations.libs.base import BaseMLEngine
8	
9	
10	class PopularityRecommenderHandler(BaseMLEngine):
11	    &quot;&quot;&quot;
12	    Integration with polar based popularity recommender.
13	    &quot;&quot;&quot;
14	
15	    name = &quot;popularity-recommender&quot;
16	
17	    def create(
18	        self,
19	        target: str,
20	        df: pd.DataFrame = None,
21	        meta_data: Dict = None,
22	        args: Optional[Dict] = None,
23	    ) -&gt; None:
24	
25	        args = args[&quot;using&quot;]
26	
27	        interaction_data = pl.from_pandas(df)
28	
29	        args[&quot;ave_per_item_user&quot;] = (
30	            interaction_data.get_column(args[&quot;user_id&quot;])
31	            .value_counts()
32	            .mean()[&quot;counts&quot;][0]
</pre>
</div>


</div>
</div>

<div id="issue-222">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/popularity_recommender_handler/popularity_recommender_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/popularity_recommender_handler/popularity_recommender_handler.py</a><br>
    <b>Line number: </b>56<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
40	            .head(
41	                args[&quot;n_recommendations&quot;] * args[&quot;ave_per_item_user&quot;]
42	            )  # to ensure there are enough to predict
43	            .to_pandas()
44	            .reset_index()
45	            .to_dict(orient=&quot;list&quot;)
46	        )
47	
48	        self.model_storage.file_set(&quot;interaction&quot;, dill.dumps(df))
49	        self.model_storage.json_set(&quot;popularity&quot;, popularity)
50	        self.model_storage.json_set(&quot;args&quot;, args)
51	
52	    def predict(self, df=None, args: Optional[dict] = None):
53	
54	        args = self.model_storage.json_get(&quot;args&quot;)
55	        popularity = self.model_storage.json_get(&quot;popularity&quot;)
56	        interaction = dill.loads(self.model_storage.file_get(&quot;interaction&quot;))
57	
58	        global_popularity = [*popularity.values()][1]
59	
60	        if df is not None:
61	            # get recommendations for specific users if specified
62	            user_ids = df[args[&quot;user_id&quot;]].unique().tolist()
63	
64	            interaction_data = pl.from_pandas(interaction).filter(
65	                pl.col(args[&quot;user_id&quot;]).is_in(user_ids)
66	            )
67	
68	        else:
69	            # get recommendations for all users
70	            interaction_data = pl.from_pandas(interaction)
71	
</pre>
</div>


</div>
</div>

<div id="issue-223">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/postgres_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/postgres_handler/connection_args.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
36	        &#x27;label&#x27;: &#x27;Port&#x27;
37	    },
38	    schema={
39	        &#x27;type&#x27;: ARG_TYPE.STR,
40	        &#x27;description&#x27;: &#x27;The schema in which objects are searched first.&#x27;,
41	        &#x27;required&#x27;: False,
42	        &#x27;label&#x27;: &#x27;Schema&#x27;
43	    },
44	    sslmode={
45	        &#x27;type&#x27;: ARG_TYPE.STR,
46	        &#x27;description&#x27;: &#x27;sslmode that will be used for connection.&#x27;,
47	        &#x27;required&#x27;: False,
48	        &#x27;label&#x27;: &#x27;sslmode&#x27;
49	    }
50	)
51	
52	connection_args_example = OrderedDict(
53	    host=&#x27;127.0.0.1&#x27;,
54	    port=5432,
55	    user=&#x27;root&#x27;,
56	    schema=&#x27;public&#x27;,
57	    password=&#x27;password&#x27;,
58	    database=&#x27;database&#x27;
59	)
</pre>
</div>


</div>
</div>

<div id="issue-224">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/postgres_handler/postgres_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/postgres_handler/postgres_handler.py</a><br>
    <b>Line number: </b>289<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
273	
274	    def get_columns(self, table_name: str) -&gt; Response:
275	        &quot;&quot;&quot;
276	        Retrieves column details for a specified table in the PostgreSQL database.
277	
278	        Args:
279	            table_name (str): The name of the table for which to retrieve column information.
280	
281	        Returns:
282	            Response: A response object containing the column details, formatted as per the `Response` class.
283	        Raises:
284	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
285	        &quot;&quot;&quot;
286	
287	        if not table_name or not isinstance(table_name, str):
288	            raise ValueError(&quot;Invalid table name provided.&quot;)
289	        query = f&quot;&quot;&quot;
290	            SELECT
291	                column_name as &quot;Field&quot;,
292	                data_type as &quot;Type&quot;
293	            FROM
294	                information_schema.columns
295	            WHERE
296	                table_name = &#x27;{table_name}&#x27;
297	            AND
298	                table_schema = current_schema()
299	        &quot;&quot;&quot;
300	        return self.native_query(query)
301	
302	    def subscribe(self, stop_event, callback, table_name, columns=None, **kwargs):
303	
304	        config = self._make_connection_args()
305	        config[&#x27;autocommit&#x27;] = True
306	
307	        conn = psycopg.connect(connect_timeout=10, **config)
308	
309	        # create db trigger
310	        trigger_name = f&#x27;mdb_notify_{table_name}&#x27;
311	
312	        before, after = &#x27;&#x27;, &#x27;&#x27;
313	
314	        if columns:
</pre>
</div>


</div>
</div>

<div id="issue-225">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/postgres_handler/postgres_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/postgres_handler/postgres_handler.py</a><br>
    <b>Line number: </b>316<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
300	        return self.native_query(query)
301	
302	    def subscribe(self, stop_event, callback, table_name, columns=None, **kwargs):
303	
304	        config = self._make_connection_args()
305	        config[&#x27;autocommit&#x27;] = True
306	
307	        conn = psycopg.connect(connect_timeout=10, **config)
308	
309	        # create db trigger
310	        trigger_name = f&#x27;mdb_notify_{table_name}&#x27;
311	
312	        before, after = &#x27;&#x27;, &#x27;&#x27;
313	
314	        if columns:
315	            # check column exist
316	            conn.execute(f&#x27;select {&quot;,&quot;.join(columns)} from {table_name} limit 0&#x27;)
317	
318	            columns = set(columns)
319	            trigger_name += &#x27;_&#x27; + &#x27;_&#x27;.join(columns)
320	
321	            news, olds = [], []
322	            for column in columns:
323	                news.append(f&#x27;NEW.{column}&#x27;)
324	                olds.append(f&#x27;OLD.{column}&#x27;)
325	
326	            before = f&#x27;IF ({&quot;, &quot;.join(news)}) IS DISTINCT FROM ({&quot;, &quot;.join(olds)}) then\n&#x27;
327	            after = &#x27;\nEND IF;&#x27;
328	        else:
329	            columns = set()
330	
331	        func_code = f&#x27;&#x27;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-226">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pycaret_handler/test/test_pycaret.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pycaret_handler/test/test_pycaret.py</a><br>
    <b>Line number: </b>24<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
8	from tests.unit.executor_test_base import BaseExecutorTest
9	
10	try:
11	    importlib.import_module(&quot;pycaret&quot;)
12	    PYCARET_INSTALLED = True
13	except ImportError:
14	    PYCARET_INSTALLED = False
15	
16	
17	@pytest.mark.skipif(not PYCARET_INSTALLED, reason=&quot;pycaret is not installed&quot;)
18	class TestPyCaret(BaseExecutorTest):
19	
20	    def wait_predictor(self, project, name):
21	        done = False
22	        for attempt in range(200):
23	            ret = self.run_sql(
24	                f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
25	            )
26	            if not ret.empty:
27	                if ret[&#x27;STATUS&#x27;][0] == &#x27;complete&#x27;:
28	                    done = True
29	                    break
30	                elif ret[&#x27;STATUS&#x27;][0] == &#x27;error&#x27;:
31	                    break
32	            time.sleep(0.5)
33	        if not done:
34	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
35	
36	    def run_sql(self, sql):
37	        ret = self.command_executor.execute_command(
38	            parse_sql(sql, dialect=&#x27;mindsdb&#x27;)
39	        )
</pre>
</div>


</div>
</div>

<div id="issue-227">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py</a><br>
    <b>Line number: </b>38<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
22	
23	    def recent(self, period: str = None) -&gt; pd.DataFrame:
24	        &quot;&quot;&quot;recent endpoint
25	
26	        Args:
27	            period (str, optional): the desired `day` or `week` or `month` period. Defaults to None.
28	
29	        Returns:
30	            pd.DataFrame: pandas dataframe
31	        &quot;&quot;&quot;
32	        endpoint: str = path.join(self.endpoint, &quot;recent&quot;)
33	        params: Dict = {}
34	
35	        if period:
36	            params[&quot;period&quot;] = period
37	
38	        payload = requests.get(endpoint, params=params).json()[&quot;data&quot;]
39	
40	        df = self.__to_dataframe(payload, [0])
41	
42	        return df
43	
44	    def overall(self, mirrors: bool = None) -&gt; pd.DataFrame:
45	        &quot;&quot;&quot;overall endpoint
46	
47	        Args:
48	            mirrors (bool, optional): filter by mirrors. Defaults to None.
49	
50	        Returns:
51	            pd.DataFrame: pandas dataframe
52	        &quot;&quot;&quot;
53	        endpoint: str = path.join(self.endpoint, &quot;overall&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-228">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py</a><br>
    <b>Line number: </b>59<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
43	
44	    def overall(self, mirrors: bool = None) -&gt; pd.DataFrame:
45	        &quot;&quot;&quot;overall endpoint
46	
47	        Args:
48	            mirrors (bool, optional): filter by mirrors. Defaults to None.
49	
50	        Returns:
51	            pd.DataFrame: pandas dataframe
52	        &quot;&quot;&quot;
53	        endpoint: str = path.join(self.endpoint, &quot;overall&quot;)
54	        params: Dict = {}
55	
56	        if mirrors is not None:
57	            params[&quot;mirrors&quot;] = str(mirrors).lower()
58	
59	        payload = requests.get(endpoint, params=params).json()[&quot;data&quot;]
60	        df = self.__to_dataframe(payload, limit=self.limit)
61	
62	        return df
63	
64	    def python_major(self, version: str = None) -&gt; pd.DataFrame:
65	        &quot;&quot;&quot;python major endpoint
66	
67	        Args:
68	            version (str, optional): filter by the major version number. Defaults to None.
69	
70	        Returns:
71	            pd.DataFrame: pandas dataframe
72	        &quot;&quot;&quot;
73	        endpoint: str = path.join(self.endpoint, &quot;python_major&quot;)
74	        params: Dict = {}
</pre>
</div>


</div>
</div>

<div id="issue-229">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py</a><br>
    <b>Line number: </b>79<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
63	
64	    def python_major(self, version: str = None) -&gt; pd.DataFrame:
65	        &quot;&quot;&quot;python major endpoint
66	
67	        Args:
68	            version (str, optional): filter by the major version number. Defaults to None.
69	
70	        Returns:
71	            pd.DataFrame: pandas dataframe
72	        &quot;&quot;&quot;
73	        endpoint: str = path.join(self.endpoint, &quot;python_major&quot;)
74	        params: Dict = {}
75	
76	        if version is not None:
77	            params[&quot;version&quot;] = version
78	
79	        payload = requests.get(endpoint, params=params).json()[&quot;data&quot;]
80	        df = self.__to_dataframe(payload, limit=self.limit)
81	
82	        return df
83	
84	    def python_minor(self, version: str = None) -&gt; pd.DataFrame:
85	        &quot;&quot;&quot;python minor endpoint
86	
87	        Args:
88	            version (str, optional): filter by the minor.patch version number. Defaults to None.
89	
90	        Returns:
91	            pd.DataFrame: pandas dataframe
92	        &quot;&quot;&quot;
93	        endpoint: str = path.join(self.endpoint, &quot;python_minor&quot;)
94	        params: Dict = {}
</pre>
</div>


</div>
</div>

<div id="issue-230">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py</a><br>
    <b>Line number: </b>99<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
83	
84	    def python_minor(self, version: str = None) -&gt; pd.DataFrame:
85	        &quot;&quot;&quot;python minor endpoint
86	
87	        Args:
88	            version (str, optional): filter by the minor.patch version number. Defaults to None.
89	
90	        Returns:
91	            pd.DataFrame: pandas dataframe
92	        &quot;&quot;&quot;
93	        endpoint: str = path.join(self.endpoint, &quot;python_minor&quot;)
94	        params: Dict = {}
95	
96	        if version is not None:
97	            params[&quot;version&quot;] = version
98	
99	        payload = requests.get(endpoint, params=params).json()[&quot;data&quot;]
100	        df = self.__to_dataframe(payload, limit=self.limit)
101	
102	        return df
103	
104	    def system(self, os: str = None) -&gt; pd.DataFrame:
105	        &quot;&quot;&quot;system endpoint
106	
107	        Args:
108	            os (str, optional): filter by the operating system. Defaults to None.
109	
110	        Returns:
111	            pd.DataFrame: pandas dataframe
112	        &quot;&quot;&quot;
113	        endpoint: str = path.join(self.endpoint, &quot;system&quot;)
114	        params: Dict = {}
</pre>
</div>


</div>
</div>

<div id="issue-231">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/pypi_handler/api.py</a><br>
    <b>Line number: </b>119<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
103	
104	    def system(self, os: str = None) -&gt; pd.DataFrame:
105	        &quot;&quot;&quot;system endpoint
106	
107	        Args:
108	            os (str, optional): filter by the operating system. Defaults to None.
109	
110	        Returns:
111	            pd.DataFrame: pandas dataframe
112	        &quot;&quot;&quot;
113	        endpoint: str = path.join(self.endpoint, &quot;system&quot;)
114	        params: Dict = {}
115	
116	        if os is not None:
117	            params[&quot;os&quot;] = os
118	
119	        payload = requests.get(endpoint, params=params).json()[&quot;data&quot;]
120	        df = self.__to_dataframe(payload, limit=self.limit)
121	
122	        return df
123	
124	    @staticmethod
125	    def __to_dataframe(
126	        json_data: Dict,
127	        index: Collection = None,
128	        limit: int = 20,
129	    ) -&gt; pd.DataFrame:
130	        &quot;&quot;&quot;_summary_
131	
132	        Args:
133	            json_data (Dict): data
134	            index (Collection, optional): desired index. Defaults to None.
</pre>
</div>


</div>
</div>

<div id="issue-232">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/questdb_handler/questdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/questdb_handler/questdb_handler.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
24	
25	    def __init__(self, name, **kwargs):
26	        super().__init__(name, **kwargs)
27	
28	    def get_tables(self):
29	        &quot;&quot;&quot;
30	        List all tabels in QuestDB
31	        &quot;&quot;&quot;
32	        query = &quot;SHOW TABLES&quot;
33	        response = super().native_query(query)
34	        return response
35	
36	    def get_columns(self, table_name):
37	        &quot;&quot;&quot;
38	        List information about the table
39	        &quot;&quot;&quot;
40	        query = f&quot;SELECT * FROM tables() WHERE name=&#x27;{table_name}&#x27;;&quot;
41	        response = super().native_query(query)
42	        return response
43	
44	    def qdb_connect(self):
45	        args = self.connection_args
46	        conf = f&quot;http::addr={args[&#x27;host&#x27;]}:9000;username={args[&#x27;user&#x27;]};password={args[&#x27;password&#x27;]};&quot;
47	        return Sender.from_conf(conf)
48	
49	    def insert(self, table_name: str, df: pd.DataFrame):
50	
51	        with self.qdb_connect() as sender:
52	            try:
53	                # find datetime column
54	                at_col = None
55	                for col, dtype in df.dtypes.items():
</pre>
</div>


</div>
</div>

<div id="issue-233">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/rag_handler/settings.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/rag_handler/settings.py</a><br>
    <b>Line number: </b>417<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
401	            documents.extend(url_to_documents(df[page_content_column].tolist()))
402	            continue
403	
404	        loader = DfLoader(data_frame=df, page_content_column=page_content_column)
405	        documents.extend(loader.load())
406	
407	    return documents
408	
409	
410	def url_to_documents(urls: Union[List[str], str]) -&gt; List[Document]:
411	    &quot;&quot;&quot;Converts a given url to a document&quot;&quot;&quot;
412	    documents = []
413	    if isinstance(urls, str):
414	        urls = [urls]
415	
416	    for url in urls:
417	        response = requests.get(url, headers=None).text
418	        html_to_text = html2text.html2text(response)
419	        documents.append(Document(page_content=html_to_text, metadata={&quot;source&quot;: url}))
420	
421	    return documents
422	
423	
424	@lru_cache()
425	def load_embeddings_model(embeddings_model_name, use_gpu=False):
426	    &quot;&quot;&quot;Load embeddings model from Hugging Face Hub&quot;&quot;&quot;
427	    try:
428	        model_kwargs = dict(device=&quot;cuda&quot; if use_gpu else &quot;cpu&quot;)
429	        embedding_model = HuggingFaceEmbeddings(
430	            model_name=embeddings_model_name, model_kwargs=model_kwargs
431	        )
432	    except ValueError:
</pre>
</div>


</div>
</div>

<div id="issue-234">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/rag_handler/settings.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/rag_handler/settings.py</a><br>
    <b>Line number: </b>434<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
418	        html_to_text = html2text.html2text(response)
419	        documents.append(Document(page_content=html_to_text, metadata={&quot;source&quot;: url}))
420	
421	    return documents
422	
423	
424	@lru_cache()
425	def load_embeddings_model(embeddings_model_name, use_gpu=False):
426	    &quot;&quot;&quot;Load embeddings model from Hugging Face Hub&quot;&quot;&quot;
427	    try:
428	        model_kwargs = dict(device=&quot;cuda&quot; if use_gpu else &quot;cpu&quot;)
429	        embedding_model = HuggingFaceEmbeddings(
430	            model_name=embeddings_model_name, model_kwargs=model_kwargs
431	        )
432	    except ValueError:
433	        raise ValueError(
434	            f&quot;The {embeddings_model_name}  is not supported, please select a valid option from Hugging Face Hub!&quot;
435	        )
436	    return embedding_model
437	
438	
439	def on_create_build_llm_params(
440	        args: dict, llm_config_class: Union[WriterLLMParameters, OpenAIParameters]
441	) -&gt; Dict:
442	    &quot;&quot;&quot;build llm params from create args&quot;&quot;&quot;
443	
444	    llm_params = {&quot;llm_name&quot;: args[&quot;llm_type&quot;]}
445	
446	    for param in llm_config_class.model_fields.keys():
447	        if param in args:
448	            llm_params[param] = args.pop(param)
449	
</pre>
</div>


</div>
</div>

<div id="issue-235">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ray_serve_handler/ray_serve_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ray_serve_handler/ray_serve_handler.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
18	
19	    @staticmethod
20	    def create_validation(target, args=None, **kwargs):
21	        if not args.get(&#x27;using&#x27;):
22	            raise Exception(&quot;Error: This engine requires some parameters via the &#x27;using&#x27; clause. Please refer to the documentation of the Ray Serve handler and try again.&quot;)  # noqa
23	        if not args[&#x27;using&#x27;].get(&#x27;train_url&#x27;):
24	            raise Exception(&quot;Error: Please provide a URL for the training endpoint.&quot;)
25	        if not args[&#x27;using&#x27;].get(&#x27;predict_url&#x27;):
26	            raise Exception(&quot;Error: Please provide a URL for the prediction endpoint.&quot;)
27	
28	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
29	        # TODO: use join_learn_process to notify users when ray has finished the training process
30	        args = args[&#x27;using&#x27;]  # ignore the rest of the problem definition
31	        args[&#x27;target&#x27;] = target
32	        self.model_storage.json_set(&#x27;args&#x27;, args)
33	        try:
34	            resp = requests.post(args[&#x27;train_url&#x27;],
35	                                 json={&#x27;df&#x27;: df.to_json(orient=&#x27;records&#x27;), &#x27;target&#x27;: target},
36	                                 headers={&#x27;content-type&#x27;: &#x27;application/json; format=pandas-records&#x27;})
37	        except requests.exceptions.InvalidSchema:
38	            raise Exception(&quot;Error: The URL provided for the training endpoint is invalid.&quot;)
39	
40	        resp = resp.json()
41	        if resp[&#x27;status&#x27;] != &#x27;ok&#x27;:
42	            raise Exception(&quot;Error: Training failed: &quot; + resp[&#x27;status&#x27;])
43	
44	    def predict(self, df, args=None):
45	        args = self.model_storage.json_get(&#x27;args&#x27;)  # override any incoming args for now
46	        resp = requests.post(args[&#x27;predict_url&#x27;],
47	                             json={&#x27;df&#x27;: df.to_json(orient=&#x27;records&#x27;)},
48	                             headers={&#x27;content-type&#x27;: &#x27;application/json; format=pandas-records&#x27;})
49	        answer = resp.json()
50	        predictions = pd.DataFrame({args[&#x27;target&#x27;]: answer[&#x27;prediction&#x27;]})
51	        return predictions
</pre>
</div>


</div>
</div>

<div id="issue-236">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/ray_serve_handler/ray_serve_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/ray_serve_handler/ray_serve_handler.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
30	        args = args[&#x27;using&#x27;]  # ignore the rest of the problem definition
31	        args[&#x27;target&#x27;] = target
32	        self.model_storage.json_set(&#x27;args&#x27;, args)
33	        try:
34	            resp = requests.post(args[&#x27;train_url&#x27;],
35	                                 json={&#x27;df&#x27;: df.to_json(orient=&#x27;records&#x27;), &#x27;target&#x27;: target},
36	                                 headers={&#x27;content-type&#x27;: &#x27;application/json; format=pandas-records&#x27;})
37	        except requests.exceptions.InvalidSchema:
38	            raise Exception(&quot;Error: The URL provided for the training endpoint is invalid.&quot;)
39	
40	        resp = resp.json()
41	        if resp[&#x27;status&#x27;] != &#x27;ok&#x27;:
42	            raise Exception(&quot;Error: Training failed: &quot; + resp[&#x27;status&#x27;])
43	
44	    def predict(self, df, args=None):
45	        args = self.model_storage.json_get(&#x27;args&#x27;)  # override any incoming args for now
46	        resp = requests.post(args[&#x27;predict_url&#x27;],
47	                             json={&#x27;df&#x27;: df.to_json(orient=&#x27;records&#x27;)},
48	                             headers={&#x27;content-type&#x27;: &#x27;application/json; format=pandas-records&#x27;})
49	        answer = resp.json()
50	        predictions = pd.DataFrame({args[&#x27;target&#x27;]: answer[&#x27;prediction&#x27;]})
51	        return predictions
52	
53	    def describe(self, key: Optional[str] = None) -&gt; pd.DataFrame:
54	        args = self.model_storage.json_get(&#x27;args&#x27;)
55	        description = {
56	            &#x27;TRAIN_URL&#x27;: [args[&#x27;train_url&#x27;]],
57	            &#x27;PREDICT_URL&#x27;: [args[&#x27;predict_url&#x27;]],
58	            &#x27;TARGET&#x27;: [args[&#x27;target&#x27;]],
59	        }
60	        return pd.DataFrame.from_dict(description)
</pre>
</div>


</div>
</div>

<div id="issue-237">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'my_password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/redshift_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/redshift_handler/connection_args.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
36	        &#x27;secret&#x27;: True
37	    },
38	    schema={
39	        &#x27;type&#x27;: ARG_TYPE.STR,
40	        &#x27;description&#x27;: &#x27;The schema in which objects are searched first.&#x27;,
41	        &#x27;required&#x27;: False,
42	        &#x27;label&#x27;: &#x27;Schema&#x27;
43	    },
44	    sslmode={
45	        &#x27;type&#x27;: ARG_TYPE.STR,
46	        &#x27;description&#x27;: &#x27;The SSL mode that will be used for connection.&#x27;,
47	        &#x27;required&#x27;: False,
48	        &#x27;label&#x27;: &#x27;sslmode&#x27;
49	    }
50	)
51	
52	connection_args_example = OrderedDict(
53	    host=&#x27;examplecluster.abc123xyz789.us-west-1.redshift.amazonaws.com&#x27;,
54	    port=&#x27;5439&#x27;,
55	    database=&#x27;dev&#x27;,
56	    user=&#x27;awsuser&#x27;,
57	    password=&#x27;my_password&#x27;
58	)
</pre>
</div>


</div>
</div>

<div id="issue-238">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/redshift_handler/redshift_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/redshift_handler/redshift_handler.py</a><br>
    <b>Line number: </b>50<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
34	        Handles the execution of INSERT statements.
35	
36	        Args:
37	            table_name (str): name of the table to insert the data into.
38	            df (pd.DataFrame): data to be inserted into the table.
39	        &quot;&quot;&quot;
40	        need_to_close = not self.is_connected
41	
42	        connection = self.connect()
43	
44	        # Replace NaN values with None
45	        df = df.replace({np.nan: None})
46	
47	        # Build the query to insert the data
48	        columns = &#x27;, &#x27;.join([f&#x27;&quot;{col}&quot;&#x27; if &#x27; &#x27; in col else col for col in df.columns])
49	        values = &#x27;, &#x27;.join([&#x27;%s&#x27; for _ in range(len(df.columns))])
50	        query = f&#x27;INSERT INTO {table_name} ({columns}) VALUES ({values})&#x27;
51	
52	        with connection.cursor() as cur:
53	            try:
54	                cur.executemany(query, df.values.tolist())
55	                response = Response(RESPONSE_TYPE.OK)
56	
57	                connection.commit()
58	            except Exception as e:
59	                logger.error(f&quot;Error inserting data into {table_name}, {e}!&quot;)
60	                response = Response(
61	                    RESPONSE_TYPE.ERROR,
62	                    error_code=0,
63	                    error_message=str(e)
64	                )
65	
</pre>
</div>


</div>
</div>

<div id="issue-239">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/redshift_handler/tests/test_redshift_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/redshift_handler/tests/test_redshift_handler.py</a><br>
    <b>Line number: </b>49<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
33	
34	
35	def seed_db():
36	    &quot;&quot;&quot;
37	    Seed the test DB by running the queries in the seed.sql file.
38	    &quot;&quot;&quot;
39	    # Connect to the dev (default) database to run seed queries
40	    conn_info = HANDLER_KWARGS[&quot;connection_data&quot;].copy()
41	    del conn_info[&quot;database&quot;]
42	    conn_info[&quot;dbname&quot;] = &quot;dev&quot;
43	    db = psycopg.connect(**conn_info)
44	    db.autocommit = True
45	
46	    cursor = db.cursor()
47	
48	    # Check if the database exists
49	    cursor.execute(f&quot;SELECT 1 FROM pg_database WHERE datname = &#x27;{HANDLER_KWARGS[&#x27;connection_data&#x27;][&#x27;database&#x27;]}&#x27;&quot;)
50	    result = cursor.fetchone()
51	    # If the database exists, drop it
52	    if result:
53	        cursor.execute(f&quot;DROP DATABASE {HANDLER_KWARGS[&#x27;connection_data&#x27;][&#x27;database&#x27;]}&quot;)
54	    # Create the test database
55	    cursor.execute(f&quot;CREATE DATABASE {HANDLER_KWARGS[&#x27;connection_data&#x27;][&#x27;database&#x27;]}&quot;)
56	
57	    # Reconnect to the new database
58	    conn_info[&quot;dbname&quot;] = HANDLER_KWARGS[&#x27;connection_data&#x27;][&#x27;database&#x27;]
59	    db = psycopg.connect(**conn_info)
60	    db.autocommit = True
61	    cursor = db.cursor()
62	
63	    with open(&quot;mindsdb/integrations/handlers/redshift_handler/tests/seed.sql&quot;, &quot;r&quot;) as f:
64	        for line in f.readlines():
</pre>
</div>


</div>
</div>

<div id="issue-240">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'rockset'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/rockset_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/rockset_handler/connection_args.py</a><br>
    <b>Line number: </b>37<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;Rockset API server&#x27;
23	    },
24	    host = {
25	        &#x27;type&#x27;: ARG_TYPE.STR,
26	        &#x27;description&#x27;: &#x27;Rockset host&#x27;
27	    },
28	    port = {
29	        &#x27;type&#x27;: ARG_TYPE.INT,
30	        &#x27;description&#x27;: &#x27;Rockset port&#x27;
31	    },
32	    database = {
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;Rockset database&#x27;
35	    }
36	)
37	connection_args_example = OrderedDict(
38	    user = &#x27;rockset&#x27;,
39	    password = &#x27;rockset&#x27;,
40	    api_key = &quot;adkjf234rksjfa23waejf2&quot;,
41	    api_server = &#x27;api-us-west-2.rockset.io&#x27;,
42	    host = &#x27;localhost&#x27;,
43	    port = &#x27;3306&#x27;,
44	    database = &#x27;test&#x27;
45	)
</pre>
</div>


</div>
</div>

<div id="issue-241">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'U/VjewPlNopsDmmwItl34r2neyC6WhZpUiip57i'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/s3_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/s3_handler/connection_args.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
18	        &#x27;description&#x27;: &#x27;The AWS region where the S3 bucket is located.&#x27;
19	    },
20	    bucket={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The name of the S3 bucket.&#x27;
23	    },
24	    key={
25	        &#x27;type&#x27;: ARG_TYPE.STR,
26	        &#x27;description&#x27;: &#x27;The key of the object to be queried.&#x27;
27	    },
28	    input_serialization={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The format of the data in the object that is to be queried.&#x27;
31	    }
32	)
33	
34	connection_args_example = OrderedDict(
35	    aws_access_key_id=&#x27;PCAQ2LJDOSWLNSQKOCPW&#x27;,
36	    aws_secret_access_key=&#x27;U/VjewPlNopsDmmwItl34r2neyC6WhZpUiip57i&#x27;,
37	    region_name=&#x27;us-east-1&#x27;,
38	    bucket=&#x27;mindsdb-bucket&#x27;,
39	    key=&#x27;iris.csv&#x27;,
40	    input_serialization=&quot;{&#x27;CSV&#x27;: {&#x27;FileHeaderInfo&#x27;: &#x27;NONE&#x27;}}&quot;,
41	)
</pre>
</div>


</div>
</div>

<div id="issue-242">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sentence_transformers_handler/tests/test_sentence_transformers.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sentence_transformers_handler/tests/test_sentence_transformers.py</a><br>
    <b>Line number: </b>16<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	
2	import time
3	
4	import pandas as pd
5	from mindsdb_sql import parse_sql
6	
7	from tests.unit.executor_test_base import BaseExecutorTest
8	
9	
10	class TestSentenceTransformers(BaseExecutorTest):
11	
12	    def wait_predictor(self, project, name):
13	        # wait
14	        done = False
15	        for attempt in range(200):
16	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
17	            if not ret.empty:
18	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
19	                    done = True
20	                    break
21	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
22	                    break
23	            time.sleep(0.5)
24	        if not done:
25	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
26	
27	    def run_sql(self, sql):
28	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
29	        assert ret.error_code is None
30	        if ret.data is not None:
31	            return ret.data.to_df()
32	
</pre>
</div>


</div>
</div>

<div id="issue-243">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py</a><br>
    <b>Line number: </b>252<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
236	        &quot;&quot;&quot;
237	        Creates a list with metadata information provided in the params
238	
239	        site_id: GUID of the site where the list is to be created
240	        list_template: a string which contains the list template information (type of list)
241	            eg.- &quot;{&#x27;template&#x27;: &#x27;documentLibrary&#x27;}&quot;
242	        display_name: the display name of the given list, which will be displayed in the site
243	        column: specifies the list of columns that should be created for the list
244	            eg.- &quot;[{&#x27;name&#x27;: &#x27;Author&#x27;, &#x27;text&#x27;: { }},{&#x27;name&#x27;: &#x27;PageCount&#x27;, &#x27;number&#x27;: { }}]&quot;
245	
246	        Returns
247	        None
248	        &quot;&quot;&quot;
249	        url = f&quot;https://graph.microsoft.com/v1.0/sites/{site_id}/lists/&quot;
250	        payload = {}
251	        if column:
252	            column = eval(column)
253	            payload[&quot;column&quot;] = column
254	        payload[&quot;displayName&quot;] = display_name
255	        payload[&quot;list&quot;] = eval(list_template)
256	        create_an_entity(url=url, payload=payload, bearer_token=self.bearer_token)
257	
258	    def get_site_columns_by_site(
259	        self, site_id: str, limit: int = None
260	    ) -&gt; List[Dict[Text, Any]]:
261	        &quot;&quot;&quot;
262	        Gets columns&#x27; information corresponding to a site
263	
264	        site_id:  GUID of a site
265	        limit: limits the number of columns for which information is returned
266	
267	        Returns
</pre>
</div>


</div>
</div>

<div id="issue-244">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py</a><br>
    <b>Line number: </b>255<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
239	        site_id: GUID of the site where the list is to be created
240	        list_template: a string which contains the list template information (type of list)
241	            eg.- &quot;{&#x27;template&#x27;: &#x27;documentLibrary&#x27;}&quot;
242	        display_name: the display name of the given list, which will be displayed in the site
243	        column: specifies the list of columns that should be created for the list
244	            eg.- &quot;[{&#x27;name&#x27;: &#x27;Author&#x27;, &#x27;text&#x27;: { }},{&#x27;name&#x27;: &#x27;PageCount&#x27;, &#x27;number&#x27;: { }}]&quot;
245	
246	        Returns
247	        None
248	        &quot;&quot;&quot;
249	        url = f&quot;https://graph.microsoft.com/v1.0/sites/{site_id}/lists/&quot;
250	        payload = {}
251	        if column:
252	            column = eval(column)
253	            payload[&quot;column&quot;] = column
254	        payload[&quot;displayName&quot;] = display_name
255	        payload[&quot;list&quot;] = eval(list_template)
256	        create_an_entity(url=url, payload=payload, bearer_token=self.bearer_token)
257	
258	    def get_site_columns_by_site(
259	        self, site_id: str, limit: int = None
260	    ) -&gt; List[Dict[Text, Any]]:
261	        &quot;&quot;&quot;
262	        Gets columns&#x27; information corresponding to a site
263	
264	        site_id:  GUID of a site
265	        limit: limits the number of columns for which information is returned
266	
267	        Returns
268	        response: metadata information/ fields corresponding to columns of the site
269	        &quot;&quot;&quot;
270	        url = f&quot;https://graph.microsoft.com/v1.0/sites/{site_id}/columns/&quot;
</pre>
</div>


</div>
</div>

<div id="issue-245">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py</a><br>
    <b>Line number: </b>413<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
397	        &quot;&quot;&quot;
398	        Creates a list with metadata information provided in the params
399	
400	        site_id: GUID of the site where the column is to be created
401	        enforced_unique_values: if true, no two list items may have the same value for this column
402	        hidden: specifies whether the column is displayed in the user interface
403	        name: the API-facing name of the column as it appears in the fields on a listItem.
404	        text: details regarding the text values in the column
405	
406	        Returns
407	        None
408	        &quot;&quot;&quot;
409	
410	        url = f&quot;https://graph.microsoft.com/v1.0/sites/{site_id}/columns/&quot;
411	        payload = {}
412	        if text:
413	            text = eval(text)
414	            payload[&quot;text&quot;] = text
415	        payload[&quot;name&quot;] = name
416	        if enforce_unique_values is not None:
417	            payload[&quot;enforceUniqueValues&quot;] = enforce_unique_values
418	        if hidden is not None:
419	            payload[&quot;hidden&quot;] = hidden
420	        if indexed is not None:
421	            payload[&quot;indexed&quot;] = indexed
422	        create_an_entity(url=url, payload=payload, bearer_token=self.bearer_token)
423	
424	    def get_items_by_sites_and_lists(
425	        self, site_id: str, list_id: str, limit: int = None
426	    ) -&gt; List[Dict[Text, Any]]:
427	        &quot;&quot;&quot;
428	        Gets items&#x27; information corresponding to a site and a list
</pre>
</div>


</div>
</div>

<div id="issue-246">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sharepoint_handler/sharepoint_api.py</a><br>
    <b>Line number: </b>577<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
561	            )
562	
563	    def create_an_item(self, site_id: str, list_id: str, fields: str) -&gt; None:
564	        &quot;&quot;&quot;
565	        Creates an item with metadata information provided in the params
566	
567	        site_id: GUID of the site where the list id present
568	        list_id: GUID of the list where the item is to be created
569	        fields: The values of the columns set on this list item.
570	
571	        Returns
572	        None
573	        &quot;&quot;&quot;
574	        url = f&quot;https://graph.microsoft.com/v1.0/sites/{site_id}/lists/{list_id}/items/&quot;
575	        payload = {}
576	        if fields:
577	            payload[&quot;fields&quot;] = eval(fields)
578	        create_an_entity(url=url, payload=payload, bearer_token=self.bearer_token)
</pre>
</div>


</div>
</div>

<div id="issue-247">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/shopify_handler/shopify_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/shopify_handler/shopify_handler.py</a><br>
    <b>Line number: </b>119<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
103	        try:
104	            api_session = self.connect()
105	            shopify.ShopifyResource.activate_session(api_session)
106	            shopify.Shop.current()
107	            response.success = True
108	        except Exception as e:
109	            logger.error(f&#x27;Error connecting to Shopify!&#x27;)
110	            raise ConnectionFailed(f&quot;Conenction to Shopify failed.&quot;)
111	            response.error_message = str(e)
112	
113	        if self.yotpo_app_key is not None and self.yotpo_access_token is not None:
114	            url = f&quot;https://api.yotpo.com/v1/apps/{self.yotpo_app_key}/reviews?count=1&amp;utoken={self.yotpo_access_token}&quot;
115	            headers = {
116	                &quot;accept&quot;: &quot;application/json&quot;,
117	                &quot;Content-Type&quot;: &quot;application/json&quot;
118	            }
119	            if requests.get(url, headers=headers).status_code == 200:
120	                response.success = True
121	            else:
122	                response.success = False
123	
124	        self.is_connected = response.success
125	
126	        return response
127	
128	    def native_query(self, query: str) -&gt; StatusResponse:
129	        &quot;&quot;&quot;Receive and process a raw query.
130	        Parameters
131	        ----------
132	        query : str
133	            query in a native format
134	        Returns
</pre>
</div>


</div>
</div>

<div id="issue-248">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/shopify_handler/shopify_tables.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/shopify_handler/shopify_tables.py</a><br>
    <b>Line number: </b>679<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
663	
664	        customer_reviews_df = select_statement_executor.execute_query()
665	
666	        return customer_reviews_df
667	
668	    def get_columns(self) -&gt; List[Text]:
669	        return pd.json_normalize(self.get_customer_reviews(limit=1)).columns.tolist()
670	
671	    def get_customer_reviews(self, **kwargs) -&gt; List[Dict]:
672	        if self.handler.yotpo_app_key is None or self.handler.yotpo_access_token is None:
673	            raise Exception(&quot;You need to provide &#x27;yotpo_app_key&#x27; and &#x27;yotpo_access_token&#x27; to retrieve customer reviews.&quot;)
674	        url = f&quot;https://api.yotpo.com/v1/apps/{self.handler.yotpo_app_key}/reviews?count=0&amp;utoken={self.handler.yotpo_access_token}&quot;
675	        headers = {
676	            &quot;accept&quot;: &quot;application/json&quot;,
677	            &quot;Content-Type&quot;: &quot;application/json&quot;
678	        }
679	        json_response = requests.get(url, headers=headers).json()
680	        return [review for review in json_response[&#x27;reviews&#x27;]] if &#x27;reviews&#x27; in json_response else []
681	
682	class CarrierServiceTable(APITable):
683	    &quot;&quot;&quot;The Shopify carrier service Table implementation. Example carrier services like usps, dhl etc.&quot;&quot;&quot;
684	
685	    def select(self, query: ast.Select) -&gt; pd.DataFrame:
686	        &quot;&quot;&quot;Pulls data from the Shopify &quot;GET /carrier_services&quot; API endpoint.
687	
688	        Parameters
689	        ----------
690	        query : ast.Select
691	           Given SQL SELECT query
692	
693	        Returns
694	        -------
</pre>
</div>


</div>
</div>

<div id="issue-249">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/snowflake_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/snowflake_handler/connection_args.py</a><br>
    <b>Line number: </b>58<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
42	        &#x27;label&#x27;: &#x27;Schema&#x27;
43	    },
44	    warehouse={
45	        &#x27;type&#x27;: ARG_TYPE.STR,
46	        &#x27;description&#x27;: &#x27;The warehouse to use when executing queries on the Snowflake account.&#x27;,
47	        &#x27;required&#x27;: False,
48	        &#x27;label&#x27;: &#x27;Warehouse&#x27;
49	    },
50	    role={
51	        &#x27;type&#x27;: ARG_TYPE.STR,
52	        &#x27;description&#x27;: &#x27;The role to use when executing queries on the Snowflake account.&#x27;,
53	        &#x27;required&#x27;: False,
54	        &#x27;label&#x27;: &#x27;Role&#x27;
55	    }
56	)
57	
58	connection_args_example = OrderedDict(
59	    account=&#x27;abcxyz-1234567&#x27;,
60	    user=&#x27;user&#x27;,
61	    password=&#x27;password&#x27;,
62	    database=&#x27;test&#x27;
63	)
</pre>
</div>


</div>
</div>

<div id="issue-250">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/snowflake_handler/snowflake_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/snowflake_handler/snowflake_handler.py</a><br>
    <b>Line number: </b>202<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
186	    def get_columns(self, table_name) -&gt; Response:
187	        &quot;&quot;&quot;
188	        Retrieves column details for a specified table in the Snowflake account.
189	
190	        Args:
191	            table_name (str): The name of the table for which to retrieve column information.
192	
193	        Returns:
194	            Response: A response object containing the column details, formatted as per the `Response` class.
195	        Raises:
196	            ValueError: If the &#x27;table_name&#x27; is not a valid string.
197	        &quot;&quot;&quot;
198	
199	        if not table_name or not isinstance(table_name, str):
200	            raise ValueError(&quot;Invalid table name provided.&quot;)
201	
202	        query = f&quot;&quot;&quot;
203	            SELECT COLUMN_NAME AS FIELD, DATA_TYPE AS TYPE
204	            FROM INFORMATION_SCHEMA.COLUMNS
205	            WHERE TABLE_NAME = &#x27;{table_name}&#x27;
206	              AND TABLE_SCHEMA = current_schema()
207	        &quot;&quot;&quot;
208	        result = self.native_query(query)
209	        result.data_frame = result.data_frame.rename(columns={&#x27;FIELD&#x27;: &#x27;Field&#x27;, &#x27;TYPE&#x27;: &#x27;Type&#x27;})
210	
211	        return result
</pre>
</div>


</div>
</div>

<div id="issue-251">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'demo_password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/solr_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/solr_handler/connection_args.py</a><br>
    <b>Line number: </b>38<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
22	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Solr server. Must be an integer.&#x27;
23	    },
24	    server_path={
25	        &#x27;type&#x27;: ARG_TYPE.STR,
26	        &#x27;description&#x27;: &#x27;The server path connecting with the Solr server. Defaults to solr when not provided.&#x27;
27	    },
28	    collection={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The collection name to use for the query in the Solr server.&#x27;
31	    },
32	    use_ssl={
33	        &#x27;type&#x27;: ARG_TYPE.BOOL,
34	        &#x27;description&#x27;: &#x27;The flag to set ssl for the query in the Solr server.Defaults to false.&#x27;
35	    }
36	)
37	
38	connection_args_example = OrderedDict(
39	    username = &quot;demo_user&quot;,
40	    password =  &quot;demo_password&quot;,
41	    host = &quot;127.0.0.1&quot;,
42	    port = 8981,
43	    server_path = &quot;solr&quot;,
44	    collection = &quot;gettingstarted&quot;,
45	    use_ssl = False,
46	)
</pre>
</div>


</div>
</div>

<div id="issue-252">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/solr_handler/solr_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/solr_handler/solr_handler.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
156	        return self.native_query(query.to_string())
157	
158	    def get_tables(self) -&gt; Response:
159	        &quot;&quot;&quot;
160	        Get a list with all of the tables in Solr
161	        &quot;&quot;&quot;
162	        result = {}
163	        result[&#x27;data_frame&#x27;] = pd.DataFrame([self.connection_data.get(&#x27;collection&#x27;)])
164	        df = result.data_frame
165	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;table_name&#x27;})
166	        return result
167	
168	    def get_columns(self, table_name) -&gt; Response:
169	        &quot;&quot;&quot;
170	        Show details about the table
171	        &quot;&quot;&quot;
172	        q = f&quot;select * from {table_name} limit 1&quot;
173	        result = self.native_query(q)
174	        df = pd.DataFrame([[col] for col in result.data_frame.columns])
175	        result.data_frame = df.rename(columns={df.columns[0]: &#x27;column_name&#x27;})
176	        return result
</pre>
</div>


</div>
</div>

<div id="issue-253">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sqlany_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sqlany_handler/connection_args.py</a><br>
    <b>Line number: </b>39<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
23	        &#x27;secret&#x27;: True
24	    },
25	    server={
26	        &#x27;type&#x27;: ARG_TYPE.STR,
27	        &#x27;description&#x27;: &#x27;Specifies the name of the server to connect to.&#x27;
28	    },
29	    database={
30	        &#x27;type&#x27;: ARG_TYPE.STR,
31	        &#x27;description&#x27;: &#x27;Specifies the name of the database to connect to.&#x27;
32	    },
33	    encrypt={
34	        &#x27;type&#x27;: ARG_TYPE.BOOL,
35	        &#x27;description&#x27;: &#x27;Enables or disables TLS encryption.&#x27;
36	    },
37	)
38	
39	connection_args_example = OrderedDict(
40	    host=&#x27;localhost&#x27;,
41	    port=55505,
42	    user=&#x27;DBADMIN&#x27;,
43	    password=&#x27;password&#x27;,
44	    serverName=&#x27;TestMe&#x27;,
45	    database=&#x27;MINDSDB&#x27;
46	)
</pre>
</div>


</div>
</div>

<div id="issue-254">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sqlany_handler/sqlany_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sqlany_handler/sqlany_handler.py</a><br>
    <b>Line number: </b>163<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
147	
148	        return response
149	
150	    def query(self, query: ASTNode) -&gt; Response:
151	        &quot;&quot;&quot;
152	        Retrieve the data from the SQL statement with eliminated rows that dont satisfy the WHERE condition
153	        &quot;&quot;&quot;
154	
155	        query_str = self.renderer.get_string(query, with_failback=True)
156	        return self.native_query(query_str)
157	
158	    def get_tables(self) -&gt; Response:
159	        &quot;&quot;&quot;
160	        List all tables in SAP SQL Anywhere in the current schema
161	        &quot;&quot;&quot;
162	
163	        return self.native_query(f&quot;&quot;&quot;
164	            SELECT USER_NAME(ob.UID) AS SCHEMA_NAME
165	            , st.TABLE_NAME
166	            , st.TABLE_TYPE
167	            FROM SYSOBJECTS ob
168	            INNER JOIN SYS.SYSTABLE st on ob.ID = st.OBJECT_ID
169	            WHERE ob.TYPE=&#x27;U&#x27; AND st.TABLE_TYPE &lt;&gt; &#x27;GBL TEMP&#x27;
170	        &quot;&quot;&quot;)
171	
172	    def get_columns(self, table_name: str) -&gt; Response:
173	        &quot;&quot;&quot;
174	        List all columns in a table in SAP SQL Anywhere in the current schema
175	        :param table_name: the table name for which to list the columns
176	        :return: returns the columns in the table
177	        &quot;&quot;&quot;
178	
179	        return self.renderer.dialect.get_columns(table_name)
</pre>
</div>


</div>
</div>

<div id="issue-255">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'sqream'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sqreamdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sqreamdb_handler/connection_args.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;Specify database name  to connect SQreamDB server&#x27;
27	    },
28	    service={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;Optional: service queue (default: &quot;sqream&quot;)&#x27;
31	    },
32	    use_ssl={
33	        &#x27;type&#x27;: ARG_TYPE.BOOL,
34	        &#x27;description&#x27;: &#x27;use SSL connection (default: False)&#x27;
35	    },
36	    clustered={
37	        &#x27;type&#x27;: ARG_TYPE.BOOL,
38	        &#x27;description&#x27;: &#x27;Optional:  Connect through load balancer, or direct to worker (Default: false - direct to worker)&#x27;
39	    },
40	)
41	
42	connection_args_example = OrderedDict(
43	    host=&#x27;127.0.0.1&#x27;,
44	    port=5000,
45	    password=&#x27;sqream&#x27;,
46	    user=&#x27;master&#x27;,
47	    database=&#x27;sqream&#x27;
48	)
</pre>
</div>


</div>
</div>

<div id="issue-256">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/sqreamdb_handler/sqreamdb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/sqreamdb_handler/sqreamdb_handler.py</a><br>
    <b>Line number: </b>150<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
134	        Retrieve the data from the SQL statement
135	        &quot;&quot;&quot;
136	        renderer = SqlalchemyRender(SqreamDialect)
137	        query_str = renderer.get_string(query, with_failback=True)
138	        return self.native_query(query_str)
139	
140	    def get_tables(self) -&gt; Response:
141	        &quot;&quot;&quot;
142	        List all tables in SQreamDB stored in &#x27;sqream_catalog&#x27; 
143	        &quot;&quot;&quot;
144	
145	        query = &quot;SELECT table_name FROM sqream_catalog.tables&quot;
146	
147	        return self.query(query)
148	
149	    def get_columns(self, table_name):
150	        query = f&quot;&quot;&quot;SELECT column_name, type_name 
151	        FROM sqream_catalog.columns 
152	        WHERE table_name = &#x27;{table_name}&#x27;;
153	        &quot;&quot;&quot;
154	        return self.query(query)
</pre>
</div>


</div>
</div>

<div id="issue-257">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/stabilityai_handler/stabilityai.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/stabilityai_handler/stabilityai.py</a><br>
    <b>Line number: </b>80<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
64	                    saved_image_paths.append(
65	                        &quot;Your request activated the API&#x27;s safety filters \
66	                        and could not be processed. Please modify the prompt and try again.&quot;)
67	                if artifact.type == generation.ARTIFACT_IMAGE:
68	                    saved_image_paths.append(self.save_image(artifact))
69	        return saved_image_paths
70	
71	    def get_existing_engines(self):
72	        &quot;&quot;&quot;Get the existing engines
73	
74	        Returns: Engines supported by the API
75	        &quot;&quot;&quot;
76	        url = &quot;https://api.stability.ai/v1/engines/list&quot;
77	        if self.api_key is None:
78	            raise Exception(&quot;Missing Stability API key.&quot;)
79	
80	        response = requests.get(url, headers={
81	            &quot;Authorization&quot;: f&quot;Bearer {self.api_key}&quot;
82	        })
83	
84	        if response.status_code != 200:
85	            raise Exception(&quot;Non-200 response: &quot; + str(response.text))
86	
87	        payload = response.json()
88	
89	        return {engine[&quot;id&quot;]: engine for engine in payload}
90	
91	    def _is_valid_engine(self, engine_id):
92	        &quot;&quot;&quot;Validates the given engine id against the supported engines by Stability
93	
94	        Args:
95	            engine_id: The engine id to check
96	
97	        Returns:
</pre>
</div>


</div>
</div>

<div id="issue-258">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/stabilityai_handler/stabilityai.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/stabilityai_handler/stabilityai.py</a><br>
    <b>Line number: </b>111<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
95	            engine_id: The engine id to check
96	
97	        Returns:
98	            True if valid engine else False
99	        &quot;&quot;&quot;
100	        return engine_id in self.available_engines
101	
102	    def _read_image_url(self, image_url):
103	        &quot;&quot;&quot;Downloads the given image url.
104	
105	        Args:
106	            image_url: The image url to download
107	
108	        Returns:
109	            Downloaded image
110	        &quot;&quot;&quot;
111	        return Image.open(requests.get(image_url, stream=True).raw)
112	
113	    def text_to_image(self, prompt, height=1024, width=1024):
114	        &quot;&quot;&quot;Converts the given text to image using stability API.
115	
116	        Args:
117	            prompt: The given text
118	            height (int, optional): Height of the image. Defaults to 1024.
119	            width (int, optional): Width of the image. Defaults to 1024.
120	
121	        Returns:
122	            The local saved paths of the generated images
123	        &quot;&quot;&quot;
124	        answers = self.stability_api.generate(
125	            prompt=prompt,
126	            height=height,
</pre>
</div>


</div>
</div>

<div id="issue-259">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<???>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/starrocks_handler/starrocks_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/starrocks_handler/starrocks_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the StarRocks server.&#x27;
27	    },
28	    database={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the StarRocks server.&#x27;
31	    },
32	    host={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;The host name or IP address of the StarRocks server.&#x27;
35	    },
36	    port={
37	        &#x27;type&#x27;: ARG_TYPE.INT,
38	        &#x27;description&#x27;: &#x27;The TCP/IP port of the StarRocks server. Must be an integer.&#x27;
39	    }
40	)
41	
42	connection_args_example = OrderedDict(
43	    host=&#x27;127.0.0.1&#x27;,
44	    port=5432,
45	    user=&#x27;root&#x27;,
46	    password=&#x27;&lt;???&gt;&#x27;,
47	    database=&#x27;database&#x27;
48	)
</pre>
</div>


</div>
</div>

<div id="issue-260">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import pandas as pd
2	import dill
3	from mindsdb.integrations.libs.base import BaseMLEngine
4	from mindsdb.integrations.utilities.time_series_utils import (
5	    transform_to_nixtla_df,
6	    get_results_from_nixtla_df,
7	    infer_frequency,
8	    get_best_model_from_results_df,
9	    get_model_accuracy_dict,
10	    reconcile_forecasts,
11	    get_hierarchy_from_df
12	)
13	from sklearn.metrics import r2_score
14	from statsforecast import StatsForecast
15	from statsforecast.models import AutoARIMA, AutoCES, AutoETS, AutoTheta
16	
17	# hierarchicalforecast is an optional dependency
18	try:
19	    from hierarchicalforecast.core import HierarchicalReconciliation
20	except ImportError:
21	    HierarchicalReconciliation = None
22	
23	DEFAULT_MODEL_NAME = &quot;AutoARIMA&quot;
24	model_dict = {
25	    &quot;AutoARIMA&quot;: AutoARIMA,
26	    &quot;AutoCES&quot;: AutoCES,
27	    &quot;AutoETS&quot;: AutoETS,
28	    &quot;AutoTheta&quot;: AutoTheta,
29	}
30	
31	
32	def get_season_length(frequency):
</pre>
</div>


</div>
</div>

<div id="issue-261">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py</a><br>
    <b>Line number: </b>147<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
131	
132	        ###### persist changes to handler folder
133	        self.model_storage.json_set(&quot;model_args&quot;, model_args)
134	        self.model_storage.file_set(&quot;training_df&quot;, dill.dumps(training_df))
135	        self.model_storage.file_set(&quot;fitted_models&quot;, dill.dumps(fitted_models))
136	
137	    def predict(self, df, args={}):
138	        &quot;&quot;&quot;Makes forecasts with the StatsForecast Handler.
139	
140	        StatsForecast is setup to predict for all groups, so it won&#x27;t handle
141	        a dataframe that&#x27;s been filtered to one group very well. Instead, we make
142	        the prediction for all groups then take care of the filtering after the
143	        forecasting. Prediction is nearly instant.
144	        &quot;&quot;&quot;
145	        # Load model arguments
146	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
147	        training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
148	        fitted_models = dill.loads(self.model_storage.file_get(&quot;fitted_models&quot;))
149	
150	        prediction_df = transform_to_nixtla_df(df, model_args)
151	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
152	
153	        sf = StatsForecast(models=[], freq=model_args[&quot;frequency&quot;], df=training_df)
154	        sf.fitted_ = fitted_models
155	        model_name = str(fitted_models[0][0])
156	        forecast_df = sf.predict(model_args[&quot;horizon&quot;])
157	        forecast_df.index = forecast_df.index.astype(str)
158	
159	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
160	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
161	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
162	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
</pre>
</div>


</div>
</div>

<div id="issue-262">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py</a><br>
    <b>Line number: </b>148<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
132	        ###### persist changes to handler folder
133	        self.model_storage.json_set(&quot;model_args&quot;, model_args)
134	        self.model_storage.file_set(&quot;training_df&quot;, dill.dumps(training_df))
135	        self.model_storage.file_set(&quot;fitted_models&quot;, dill.dumps(fitted_models))
136	
137	    def predict(self, df, args={}):
138	        &quot;&quot;&quot;Makes forecasts with the StatsForecast Handler.
139	
140	        StatsForecast is setup to predict for all groups, so it won&#x27;t handle
141	        a dataframe that&#x27;s been filtered to one group very well. Instead, we make
142	        the prediction for all groups then take care of the filtering after the
143	        forecasting. Prediction is nearly instant.
144	        &quot;&quot;&quot;
145	        # Load model arguments
146	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
147	        training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
148	        fitted_models = dill.loads(self.model_storage.file_get(&quot;fitted_models&quot;))
149	
150	        prediction_df = transform_to_nixtla_df(df, model_args)
151	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
152	
153	        sf = StatsForecast(models=[], freq=model_args[&quot;frequency&quot;], df=training_df)
154	        sf.fitted_ = fitted_models
155	        model_name = str(fitted_models[0][0])
156	        forecast_df = sf.predict(model_args[&quot;horizon&quot;])
157	        forecast_df.index = forecast_df.index.astype(str)
158	
159	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
160	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
161	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
162	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
163	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
</pre>
</div>


</div>
</div>

<div id="issue-263">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py</a><br>
    <b>Line number: </b>160<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
144	        &quot;&quot;&quot;
145	        # Load model arguments
146	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
147	        training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
148	        fitted_models = dill.loads(self.model_storage.file_get(&quot;fitted_models&quot;))
149	
150	        prediction_df = transform_to_nixtla_df(df, model_args)
151	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
152	
153	        sf = StatsForecast(models=[], freq=model_args[&quot;frequency&quot;], df=training_df)
154	        sf.fitted_ = fitted_models
155	        model_name = str(fitted_models[0][0])
156	        forecast_df = sf.predict(model_args[&quot;horizon&quot;])
157	        forecast_df.index = forecast_df.index.astype(str)
158	
159	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
160	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
161	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
162	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
163	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
164	
165	        else:
166	            results_df = forecast_df[forecast_df.index.isin(groups_to_keep)]
167	
168	        result = get_results_from_nixtla_df(results_df, model_args)
169	        result = result.rename(columns={model_name: model_args[&#x27;target&#x27;]})
170	        return result
171	
172	    def describe(self, attribute=None):
173	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
174	
175	        if attribute == &quot;model&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-264">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/statsforecast_handler/statsforecast_handler.py</a><br>
    <b>Line number: </b>161<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
145	        # Load model arguments
146	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
147	        training_df = dill.loads(self.model_storage.file_get(&quot;training_df&quot;))
148	        fitted_models = dill.loads(self.model_storage.file_get(&quot;fitted_models&quot;))
149	
150	        prediction_df = transform_to_nixtla_df(df, model_args)
151	        groups_to_keep = prediction_df[&quot;unique_id&quot;].unique()
152	
153	        sf = StatsForecast(models=[], freq=model_args[&quot;frequency&quot;], df=training_df)
154	        sf.fitted_ = fitted_models
155	        model_name = str(fitted_models[0][0])
156	        forecast_df = sf.predict(model_args[&quot;horizon&quot;])
157	        forecast_df.index = forecast_df.index.astype(str)
158	
159	        if model_args[&quot;hierarchy&quot;] and HierarchicalReconciliation is not None:
160	            hier_df = dill.loads(self.model_storage.file_get(&quot;hier_df&quot;))
161	            hier_dict = dill.loads(self.model_storage.file_get(&quot;hier_dict&quot;))
162	            reconciled_df = reconcile_forecasts(training_df, forecast_df, hier_df, hier_dict)
163	            results_df = reconciled_df[reconciled_df.index.isin(groups_to_keep)]
164	
165	        else:
166	            results_df = forecast_df[forecast_df.index.isin(groups_to_keep)]
167	
168	        result = get_results_from_nixtla_df(results_df, model_args)
169	        result = result.rename(columns={model_name: model_args[&#x27;target&#x27;]})
170	        return result
171	
172	    def describe(self, attribute=None):
173	        model_args = self.model_storage.json_get(&quot;model_args&quot;)
174	
175	        if attribute == &quot;model&quot;:
176	            return pd.DataFrame({k: [model_args[k]] for k in [&quot;model_name&quot;, &quot;frequency&quot;, &quot;season_length&quot;, &quot;hierarchy&quot;]})
</pre>
</div>


</div>
</div>

<div id="issue-265">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py</a><br>
    <b>Line number: </b>61<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
45	            response.success = True
46	        except Exception as e:
47	            logger.error(f&#x27;Error connecting to Strapi API: {e}!&#x27;)
48	            response.error_message = e
49	
50	        self.is_connected = response.success
51	        return response
52	
53	    def connect(self) -&gt; StatusResponse:
54	        &quot;&quot;&quot;making the connectino object
55	        &quot;&quot;&quot;
56	        if self.is_connected and self.connection:
57	            return self.connection
58	
59	        try:
60	            headers = {&quot;Authorization&quot;: f&quot;Bearer {self._api_token}&quot;}
61	            response = requests.get(f&quot;{self._base_url}&quot;, headers=headers)
62	            if response.status_code == 200:
63	                self.connection = response
64	                self.is_connected = True
65	                return StatusResponse(True)
66	            else:
67	                raise Exception(f&quot;Error connecting to Strapi API: {response.status_code} - {response.text}&quot;)
68	        except Exception as e:
69	            logger.error(f&#x27;Error connecting to Strapi API: {e}!&#x27;)
70	            return StatusResponse(False, error_message=e)
71	
72	    def native_query(self, query: str) -&gt; StatusResponse:
73	        &quot;&quot;&quot;Receive and process a raw query.
74	
75	        Parameters
76	        ----------
</pre>
</div>


</div>
</div>

<div id="issue-266">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py</a><br>
    <b>Line number: </b>98<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
82	        StatusResponse
83	            Request status
84	        &quot;&quot;&quot;
85	        ast = parse_sql(query, dialect=&quot;mindsdb&quot;)
86	        return self.query(ast)
87	
88	    def call_strapi_api(self, method: str, endpoint: str, params: dict = {}, json_data: dict = {}) -&gt; pd.DataFrame:
89	        headers = {&quot;Authorization&quot;: f&quot;Bearer {self._api_token}&quot;}
90	        url = f&quot;{self._base_url}{endpoint}&quot;
91	
92	        if method.upper() in (&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;):
93	            headers[&#x27;Content-Type&#x27;] = &#x27;application/json&#x27;
94	
95	            if method.upper() in (&#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;):
96	                response = requests.request(method, url, headers=headers, params=params, data=json_data)
97	            else:
98	                response = requests.get(url, headers=headers, params=params)
99	
100	            if response.status_code == 200:
101	                data = response.json()
102	                # Create an empty DataFrame
103	                df = pd.DataFrame()
104	                if isinstance(data.get(&#x27;data&#x27;, None), list):
105	                    for item in data[&#x27;data&#x27;]:
106	                        # Add &#x27;id&#x27; and &#x27;attributes&#x27; to the DataFrame
107	                        row_data = {&#x27;id&#x27;: item[&#x27;id&#x27;], **item[&#x27;attributes&#x27;]}
108	                        df = df._append(row_data, ignore_index=True)
109	                    return df
110	                elif isinstance(data.get(&#x27;data&#x27;, None), dict):
111	                    # Add &#x27;id&#x27; and &#x27;attributes&#x27; to the DataFrame
112	                    row_data = {&#x27;id&#x27;: data[&#x27;data&#x27;][&#x27;id&#x27;], **data[&#x27;data&#x27;][&#x27;attributes&#x27;]}
113	                    df = df._append(row_data, ignore_index=True)
</pre>
</div>


</div>
</div>

<div id="issue-267">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'c56c000d867e95848c'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/strapi_handler/strapi_handler.py</a><br>
    <b>Line number: </b>148<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
132	        &quot;label&quot;: &quot;Host&quot;,
133	    },
134	    port={
135	        &quot;type&quot;: ARG_TYPE.INT,
136	        &quot;description&quot;: &quot;Strapi API port to connect to.&quot;,
137	        &quot;required&quot;: True,
138	        &quot;label&quot;: &quot;Port&quot;,
139	    },
140	    plural_api_ids={
141	        &quot;type&quot;: list,
142	        &quot;description&quot;: &quot;Plural API id to use for querying.&quot;,
143	        &quot;required&quot;: True,
144	        &quot;label&quot;: &quot;Plural API id&quot;,
145	    },
146	)
147	
148	connection_args_example = OrderedDict(
149	    host=&quot;localhost&quot;,
150	    port=1337,
151	    api_token=&quot;c56c000d867e95848c&quot;,
152	    plural_api_ids=[&quot;posts&quot;, &quot;portfolios&quot;],
153	)
</pre>
</div>


</div>
</div>

<div id="issue-268">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<your-strava-api-token>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/strava_handler/strava_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/strava_handler/strava_handler.py</a><br>
    <b>Line number: </b>110<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
94	        &quot;&quot;&quot;
95	        ast = parse_sql(query, dialect=&quot;mindsdb&quot;)
96	        return self.query(ast)
97	
98	
99	connection_args = OrderedDict(
100	    strava_client_id={
101	        &#x27;type&#x27;: ARG_TYPE.STR,
102	        &#x27;description&#x27;: &#x27;Client id for accessing Strava Application API&#x27;
103	    },
104	    strava_access_token={
105	        &#x27;type&#x27;: ARG_TYPE.STR,
106	        &#x27;description&#x27;: &#x27;Access Token for accessing Strava Application API&#x27;
107	    }
108	)
109	
110	connection_args_example = OrderedDict(
111	    strava_client_id =&#x27;&lt;your-strava-client_id&gt;&#x27;,
112	    strava_access_token =&#x27;&lt;your-strava-api-token&gt;&#x27;
113	)
</pre>
</div>


</div>
</div>

<div id="issue-269">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/supabase_handler/tests/test_supabase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/supabase_handler/tests/test_supabase_handler.py</a><br>
    <b>Line number: </b>37<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
21	        self.handler.connect()
22	
23	    def test_1_check_connection(self):
24	        assert self.handler.check_connection()
25	
26	    def test_2_native_query_show_dbs(self):
27	        dbs = self.handler.native_query(&quot;SHOW DATABASES;&quot;)
28	        assert isinstance(dbs, list)
29	
30	    def test_3_get_tables(self):
31	        tbls = self.handler.get_tables()
32	        assert isinstance(tbls, list)
33	
34	    def test_5_create_table(self):
35	        try:
36	            self.handler.native_query(&quot;CREATE TABLE test_mdb (test_col INT)&quot;)
37	        except Exception:
38	            pass
39	
40	    def test_6_describe_table(self):
41	        described = self.handler.get_columns(&quot;dt_test&quot;)
42	        assert isinstance(described, list)
43	
44	    def test_7_select_query(self):
45	        query = &quot;SELECT * FROM dt_test WHERE &#x27;id&#x27;=&#x27;a&#x27;&quot;
46	        result = self.handler.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-270">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/surrealdb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/surrealdb_handler/connection_args.py</a><br>
    <b>Line number: </b>45<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
29	        &#x27;required&#x27;: True,
30	        &#x27;label&#x27;: &#x27;Host&#x27;
31	    },
32	    port={
33	        &#x27;type&#x27;: ARG_TYPE.INT,
34	        &#x27;description&#x27;: &#x27;The TCP/IP port of the SurrealDB server. Must be an integer.&#x27;,
35	        &#x27;required&#x27;: True,
36	        &#x27;label&#x27;: &#x27;Port&#x27;
37	    },
38	    namespace={
39	        &#x27;type&#x27;: ARG_TYPE.STR,
40	        &#x27;description&#x27;: &#x27;The namespace name to be connected&#x27;,
41	        &#x27;required&#x27;: True,
42	        &#x27;label&#x27;: &#x27;Namespace&#x27;
43	    }
44	)
45	connection_args_example = OrderedDict(
46	    host=&#x27;localhost&#x27;,
47	    port=17141,
48	    user=&#x27;admin&#x27;,
49	    password=&#x27;password&#x27;,
50	    database=&#x27;test&#x27;,
51	    namespace=&#x27;test&#x27;
52	)
</pre>
</div>


</div>
</div>

<div id="issue-271">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'app_secret'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/symbl_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/symbl_handler/connection_args.py</a><br>
    <b>Line number: </b>22<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
6	connection_args = OrderedDict(
7	    app_id={
8	        &quot;type&quot;: ARG_TYPE.PWD,
9	        &quot;description&quot;: &quot;App ID of symbl&quot;,
10	        &quot;required&quot;: True,
11	        &quot;label&quot;: &quot;app_id&quot;,
12	    },
13	    app_secret={
14	        &quot;type&quot;: ARG_TYPE.PWD,
15	        &quot;description&quot;: &quot;App Secret of symbl&quot;,
16	        &quot;required&quot;: True,
17	        &quot;label&quot;: &quot;app_secret&quot;,
18	        &quot;secret&quot;: True
19	    }
20	)
21	
22	connection_args_example = OrderedDict(
23	    app_id=&quot;app_id&quot;,
24	    app_secret=&quot;app_secret&quot;
25	)
</pre>
</div>


</div>
</div>

<div id="issue-272">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<token comes here>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tdengine_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tdengine_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the TDEngine server.&#x27;
19	    },
20	    url={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The url of the TDEngine server Instance. &#x27;
23	    },
24	    token={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;Unique Token to COnnect TDEngine&#x27;
27	    },
28	)
29	
30	connection_args_example = OrderedDict(
31	    url=&#x27;127.0.0.1:6041&#x27;,
32	    token=&#x27;&lt;token comes here&gt;&#x27;,
33	    user=&#x27;root&#x27;,
34	    password=&#x27;taosdata&#x27;,
35	    database=&#x27;test&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-273">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'dbc'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/teradata_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/teradata_handler/connection_args.py</a><br>
    <b>Line number: </b>74<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
58	        &#x27;description&#x27;: &#x27;Specifies the Teradata transaction mode.&#x27;
59	    },
60	    logmech={
61	        &#x27;type&#x27;: ARG_TYPE.STR,
62	        &#x27;description&#x27;: &#x27;Specifies the login authentication method.&#x27;
63	    },
64	    logdata={
65	        &#x27;type&#x27;: ARG_TYPE.STR,
66	        &#x27;description&#x27;: &#x27;Specifies extra data for the chosen logon authentication method.&#x27;
67	    },
68	    browser={
69	        &#x27;type&#x27;: ARG_TYPE.STR,
70	        &#x27;description&#x27;: &#x27;Specifies the command to open the browser for Browser Authentication.&#x27;
71	    }
72	)
73	
74	connection_args_example = OrderedDict(
75	    host=&#x27;192.168.0.41&#x27;,
76	    user=&#x27;dbc&#x27;,
77	    password=&#x27;dbc&#x27;,
78	    database=&#x27;HR&#x27;
79	)
</pre>
</div>


</div>
</div>

<div id="issue-274">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/teradata_handler/teradata_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/teradata_handler/teradata_handler.py</a><br>
    <b>Line number: </b>153<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
137	        return response
138	
139	    def query(self, query: ASTNode) -&gt; Response:
140	        &quot;&quot;&quot;
141	        Retrieve the data from the SQL statement with eliminated rows that dont satisfy the WHERE condition
142	        &quot;&quot;&quot;
143	
144	        query_str = self.renderer.get_string(query, with_failback=True)
145	        return self.native_query(query_str)
146	
147	    def get_tables(self) -&gt; Response:
148	        &quot;&quot;&quot;
149	        List all tables in Teradata in the current database
150	        &quot;&quot;&quot;
151	
152	        return self.native_query(
153	            str(text(f&quot;&quot;&quot;
154	            SELECT DataBaseName,
155	                   TableName,
156	                   TableKind
157	            FROM DBC.TablesV
158	            WHERE DatabaseName = :database
159	            AND (TableKind = &#x27;T&#x27;
160	                OR TableKind = &#x27;O&#x27;
161	                OR TableKind = &#x27;Q&#x27;)
162	            &quot;&quot;&quot;).bindparams(
163	                bindparam(&#x27;database&#x27;, value=self.database, type_=String)
164	            ).compile(compile_kwargs={&quot;literal_binds&quot;: True}))
165	        )
166	
167	    def get_columns(self, table_name: str) -&gt; Response:
168	        &quot;&quot;&quot;
169	        List all columns in a table in Teradata in the current schema
170	        :param table_name: the table name for which to list the columns
171	        :return: returns the columns in the table
172	        &quot;&quot;&quot;
173	
174	        return self.native_query(
175	            str(text(f&quot;&quot;&quot;
176	            SELECT ColumnName AS &quot;Field&quot;,
177	                   ColumnType AS &quot;Type&quot;
</pre>
</div>


</div>
</div>

<div id="issue-275">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/teradata_handler/teradata_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/teradata_handler/teradata_handler.py</a><br>
    <b>Line number: </b>175<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
159	            AND (TableKind = &#x27;T&#x27;
160	                OR TableKind = &#x27;O&#x27;
161	                OR TableKind = &#x27;Q&#x27;)
162	            &quot;&quot;&quot;).bindparams(
163	                bindparam(&#x27;database&#x27;, value=self.database, type_=String)
164	            ).compile(compile_kwargs={&quot;literal_binds&quot;: True}))
165	        )
166	
167	    def get_columns(self, table_name: str) -&gt; Response:
168	        &quot;&quot;&quot;
169	        List all columns in a table in Teradata in the current schema
170	        :param table_name: the table name for which to list the columns
171	        :return: returns the columns in the table
172	        &quot;&quot;&quot;
173	
174	        return self.native_query(
175	            str(text(f&quot;&quot;&quot;
176	            SELECT ColumnName AS &quot;Field&quot;,
177	                   ColumnType AS &quot;Type&quot;
178	            FROM DBC.ColumnsV
179	            WHERE DatabaseName (NOT CASESPECIFIC) = :database
180	            AND TableName (NOT CASESPECIFIC) = :table_name
181	            &quot;&quot;&quot;).bindparams(
182	                bindparam(&#x27;database&#x27;, value=self.database, type_=String),
183	                bindparam(&#x27;table_name&#x27;, value=table_name, type_=String)
184	            ).compile(compile_kwargs={&quot;literal_binds&quot;: True}))
185	        )
</pre>
</div>


</div>
</div>

<div id="issue-276">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tidb_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tidb_handler/connection_args.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
14	        &#x27;secret&#x27;: True
15	    },
16	    database={
17	        &#x27;type&#x27;: ARG_TYPE.STR,
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the TiDB server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the TiDB server. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the TiDB server. Must be an integer.&#x27;
27	    }
28	)
29	
30	connection_args_example = OrderedDict(
31	    host=&#x27;127.0.0.1&#x27;,
32	    port=4000,
33	    user=&#x27;root&#x27;,
34	    password=&#x27;password&#x27;,
35	    database=&#x27;database&#x27;
36	)
</pre>
</div>


</div>
</div>

<div id="issue-277">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tidb_handler/tests/test_tidb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tidb_handler/tests/test_tidb_handler.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
20	        self.handler.connect()
21	
22	    def test_1_check_connection(self):
23	        assert self.handler.check_connection()
24	
25	    def test_2_native_query_show_dbs(self):
26	        dbs = self.handler.native_query(&quot;SHOW DATABASES;&quot;)
27	        assert isinstance(dbs, list)
28	
29	    def test_3_get_tables(self):
30	        tbls = self.handler.get_tables()
31	        assert isinstance(tbls, list)
32	
33	    def test_5_create_table(self):
34	        try:
35	            self.handler.native_query(&quot;CREATE TABLE test_tidb (test_col INT)&quot;)
36	        except Exception:
37	            pass
38	
39	    def test_6_describe_table(self):
40	        described = self.handler.get_columns(&quot;dt_test&quot;)
41	        assert isinstance(described, list)
42	
43	    def test_7_select_query(self):
44	        query = &quot;SELECT * FROM dt_test WHERE &#x27;id&#x27;=&#x27;a&#x27;&quot;
45	        result = self.handler.native_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-278">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'P455W0rD'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/timescaledb_handler/timescaledb_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/timescaledb_handler/timescaledb_handler.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
24	        &quot;&quot;&quot;
25	    },
26	    user={
27	        &#x27;type&#x27;: ARG_TYPE.STR,
28	        &#x27;description&#x27;: &#x27;The user name used to authenticate with the TimeScaleDB server.&#x27;
29	    },
30	    password={
31	        &#x27;type&#x27;: ARG_TYPE.STR,
32	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the TimeScaleDB server.&#x27;
33	    },
34	    port={
35	        &#x27;type&#x27;: ARG_TYPE.INT,
36	        &#x27;description&#x27;: &#x27;Specify port to connect TimeScaleDB &#x27;
37	    }
38	)
39	
40	connection_args_example = OrderedDict(
41	    host=&#x27;127.0.0.1&#x27;,
42	    port=36806,
43	    password=&#x27;P455W0rD&#x27;,
44	    user=&#x27;tsdbadmin&#x27;,
45	    database=&quot;tsdb&quot;
46	)
</pre>
</div>


</div>
</div>

<div id="issue-279">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	from typing import Optional
2	import dill
3	import pandas as pd
4	from mindsdb.integrations.libs.base import BaseMLEngine
5	from typing import Dict, Optional
6	from type_infer.api import infer_types
7	from tpot import TPOTClassifier, TPOTRegressor
8	from sklearn.preprocessing import LabelEncoder
9	
10	
11	class TPOTHandler(BaseMLEngine):
12	    name = &quot;TPOT&quot;
13	    def create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None:
14	        if args is None:
15	            args = {}
16	        type_of_cols=infer_types(df,0).dtypes
17	        target_dtype=type_of_cols[target]
18	
19	
20	        if target_dtype in [&#x27;binary&#x27;,&#x27;categorical&#x27;,&#x27;tags&#x27;]:
21	            model = TPOTClassifier(generations=args.get(&#x27;generations&#x27;, 10),
22	                                       population_size=args.get(&#x27;population_size&#x27;, 100),
23	                                       verbosity=0,
24	                                       max_time_mins=args.get(&#x27;max_time_mins&#x27;, None),
25	                                       n_jobs=args.get(&#x27;n_jobs&#x27;, -1))
26	            
27	
28	        elif target_dtype in [&#x27;integer&#x27;,&#x27;float&#x27;,&#x27;quantity&#x27;] :
29	            model = TPOTRegressor(generations=args.get(&#x27;generations&#x27;, 10),
30	                                      population_size=args.get(&#x27;population_size&#x27;, 100),
31	                                      verbosity=0,
32	                                      max_time_mins=args.get(&#x27;max_time_mins&#x27;, None),
</pre>
</div>


</div>
</div>

<div id="issue-280">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py</a><br>
    <b>Line number: </b>63<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
47	                # Encode the categorical column using the fitted LabelEncoder
48	                df[col] = le.transform(df[col])
49	
50	
51	            model.fit(df.drop(columns=[target]), df[target])
52	            self.model_storage.json_set(&#x27;args&#x27;, args)
53	            self.model_storage.file_set(&#x27;le_dict&#x27;, dill.dumps(le_dict))
54	            self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model.fitted_pipeline_))
55	        else :
56	            raise Exception(
57	                &quot;Data is empty!!&quot;
58	            )
59	        
60	
61	    def predict(self, df: pd.DataFrame, args: Optional[Dict] = None) -&gt; pd.DataFrame:
62	
63	        model=dill.loads(self.model_storage.file_get(&quot;model&quot;))
64	        le_dict=dill.loads(self.model_storage.file_get(&quot;le_dict&quot;))
65	        target=self.model_storage.json_get(&#x27;args&#x27;).get(&quot;target&quot;)
66	
67	         # Encode the categorical columns in the input DataFrame using the saved LabelEncoders
68	        for col, le in le_dict.items():
69	            if col in df.columns:
70	                df[col] = le.transform(df[col])
71	                
72	        # Make predictions using the trained TPOT model
73	        results=pd.DataFrame(model.predict(df),columns=[target])
74	
75	        # Decode the predicted categorical values back into their original values
76	        for col, le in le_dict.items():
77	            if col in results.columns:
78	                results[col] = le.inverse_transform(results[col])
</pre>
</div>


</div>
</div>

<div id="issue-281">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tpot_handler/tpot_handler.py</a><br>
    <b>Line number: </b>64<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
48	                df[col] = le.transform(df[col])
49	
50	
51	            model.fit(df.drop(columns=[target]), df[target])
52	            self.model_storage.json_set(&#x27;args&#x27;, args)
53	            self.model_storage.file_set(&#x27;le_dict&#x27;, dill.dumps(le_dict))
54	            self.model_storage.file_set(&#x27;model&#x27;, dill.dumps(model.fitted_pipeline_))
55	        else :
56	            raise Exception(
57	                &quot;Data is empty!!&quot;
58	            )
59	        
60	
61	    def predict(self, df: pd.DataFrame, args: Optional[Dict] = None) -&gt; pd.DataFrame:
62	
63	        model=dill.loads(self.model_storage.file_get(&quot;model&quot;))
64	        le_dict=dill.loads(self.model_storage.file_get(&quot;le_dict&quot;))
65	        target=self.model_storage.json_get(&#x27;args&#x27;).get(&quot;target&quot;)
66	
67	         # Encode the categorical columns in the input DataFrame using the saved LabelEncoders
68	        for col, le in le_dict.items():
69	            if col in df.columns:
70	                df[col] = le.transform(df[col])
71	                
72	        # Make predictions using the trained TPOT model
73	        results=pd.DataFrame(model.predict(df),columns=[target])
74	
75	        # Decode the predicted categorical values back into their original values
76	        for col, le in le_dict.items():
77	            if col in results.columns:
78	                results[col] = le.inverse_transform(results[col])
79	
</pre>
</div>


</div>
</div>

<div id="issue-282">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tripadvisor_handler/tripadvisor_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tripadvisor_handler/tripadvisor_api.py</a><br>
    <b>Line number: </b>35<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
19	    Attributes:
20	        api_key (str): The unique API key to access Tripadvisor content.
21	    &quot;&quot;&quot;
22	
23	    def __init__(self, api_key):
24	        self.api_key = api_key
25	
26	    def checkTripAdvisorConnection(self):
27	        &quot;&quot;&quot;
28	        Check the connection with TripAdvisor
29	        &quot;&quot;&quot;
30	        url = &quot;https://api.content.tripadvisor.com/api/v1/location/search?language=en&amp;key={api_key}&amp;searchQuery={searchQuery}&quot;.format(
31	            api_key=self.api_key, searchQuery=&quot;London&quot;
32	        )
33	
34	        headers = {&quot;accept&quot;: &quot;application/json&quot;}
35	        response = requests.get(url, headers=headers)
36	        status_code = response.status_code
37	
38	        if status_code &gt;= 400 and status_code &lt;= 499:
39	            raise Exception(&quot;Client error: &quot; + response.text)
40	
41	        if status_code &gt;= 500 and status_code &lt;= 599:
42	            raise Exception(&quot;Server error: &quot; + response.text)
43	
44	    def getResponse(self, url: str) -&gt; Response:
45	        &quot;&quot;&quot;
46	        Getting a response from the API call
47	        &quot;&quot;&quot;
48	        headers = {&quot;accept&quot;: &quot;application/json&quot;}
49	        response = requests.get(url, headers=headers)
50	        return response
</pre>
</div>


</div>
</div>

<div id="issue-283">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/tripadvisor_handler/tripadvisor_api.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/tripadvisor_handler/tripadvisor_api.py</a><br>
    <b>Line number: </b>49<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
33	
34	        headers = {&quot;accept&quot;: &quot;application/json&quot;}
35	        response = requests.get(url, headers=headers)
36	        status_code = response.status_code
37	
38	        if status_code &gt;= 400 and status_code &lt;= 499:
39	            raise Exception(&quot;Client error: &quot; + response.text)
40	
41	        if status_code &gt;= 500 and status_code &lt;= 599:
42	            raise Exception(&quot;Server error: &quot; + response.text)
43	
44	    def getResponse(self, url: str) -&gt; Response:
45	        &quot;&quot;&quot;
46	        Getting a response from the API call
47	        &quot;&quot;&quot;
48	        headers = {&quot;accept&quot;: &quot;application/json&quot;}
49	        response = requests.get(url, headers=headers)
50	        return response
51	
52	    def getURLQuery(self, url: str, params_dict: dict) -&gt; str:
53	        &quot;&quot;&quot;
54	        Processing the query and adding parameters to the URL
55	        &quot;&quot;&quot;
56	        for idx, (queryParam, value) in enumerate(params_dict.items()):
57	            if value is not None or value != &quot;&quot;:
58	                if value != &quot;&quot; and any(
59	                    next_value != &quot;&quot; or value is not None
60	                    for next_value in list(params_dict.values())[idx + 1:]
61	                ):
62	                    url += &quot;{queryParam}={value}&amp;&quot;.format(
63	                        queryParam=queryParam, value=value
64	                    )
</pre>
</div>


</div>
</div>

<div id="issue-284">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py</a><br>
    <b>Line number: </b>487<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
471	
472	        data : Dict, Optional
473	            Data to be used in the request.
474	
475	        method : str, Optional
476	            HTTP method to be used in the request. Defaults to GET.
477	
478	        Returns
479	        -------
480	        Dict
481	            Response from the API.
482	        &quot;&quot;&quot;
483	
484	        headers = headers if headers else self.headers
485	
486	        if method == &quot;GET&quot;:
487	            response = requests.get(
488	                url=self.base_url + endpoint,
489	                headers=headers,
490	                params=data if data else {},
491	            )
492	
493	        elif method == &quot;POST&quot;:
494	            response = requests.post(
495	                url=self.base_url + endpoint,
496	                headers=headers,
497	                json=data if data else {},
498	            )
499	
500	        elif method == &quot;PUT&quot;:
501	            response = requests.put(
502	                url=self.base_url + endpoint,
503	                headers=headers,
504	                json=data if data else {},
505	            )
506	
</pre>
</div>


</div>
</div>

<div id="issue-285">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py</a><br>
    <b>Line number: </b>494<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
478	        Returns
479	        -------
480	        Dict
481	            Response from the API.
482	        &quot;&quot;&quot;
483	
484	        headers = headers if headers else self.headers
485	
486	        if method == &quot;GET&quot;:
487	            response = requests.get(
488	                url=self.base_url + endpoint,
489	                headers=headers,
490	                params=data if data else {},
491	            )
492	
493	        elif method == &quot;POST&quot;:
494	            response = requests.post(
495	                url=self.base_url + endpoint,
496	                headers=headers,
497	                json=data if data else {},
498	            )
499	
500	        elif method == &quot;PUT&quot;:
501	            response = requests.put(
502	                url=self.base_url + endpoint,
503	                headers=headers,
504	                json=data if data else {},
505	            )
506	
507	        else:
508	            raise Exception(f&quot;Method {method} not supported yet.&quot;)
509	
510	        return self._handle_response(response)
511	
512	    def _submit_multi_part_request(self, endpoint: str, headers: Dict = None, data: Dict = None, method: str = &quot;POST&quot;) -&gt; Dict:
513	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-286">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py</a><br>
    <b>Line number: </b>501<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
485	
486	        if method == &quot;GET&quot;:
487	            response = requests.get(
488	                url=self.base_url + endpoint,
489	                headers=headers,
490	                params=data if data else {},
491	            )
492	
493	        elif method == &quot;POST&quot;:
494	            response = requests.post(
495	                url=self.base_url + endpoint,
496	                headers=headers,
497	                json=data if data else {},
498	            )
499	
500	        elif method == &quot;PUT&quot;:
501	            response = requests.put(
502	                url=self.base_url + endpoint,
503	                headers=headers,
504	                json=data if data else {},
505	            )
506	
507	        else:
508	            raise Exception(f&quot;Method {method} not supported yet.&quot;)
509	
510	        return self._handle_response(response)
511	
512	    def _submit_multi_part_request(self, endpoint: str, headers: Dict = None, data: Dict = None, method: str = &quot;POST&quot;) -&gt; Dict:
513	        &quot;&quot;&quot;
514	        Submit a multi-part request to the Twelve Labs API.
515	
516	        Parameters
517	        ----------
518	        endpoint : str
519	            API endpoint.
520	
</pre>
</div>


</div>
</div>

<div id="issue-287">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/twelve_labs_handler/twelve_labs_api_client.py</a><br>
    <b>Line number: </b>541<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
525	            Data to be used in the request.
526	
527	        method : str, Optional
528	            HTTP method to be used in the request. Defaults to GET.
529	
530	        Returns
531	        -------
532	        Dict
533	            Response from the API.
534	        &quot;&quot;&quot;
535	
536	        headers = headers = headers if headers else self.headers
537	
538	        multipart_data = MultipartEncoder(fields=data)
539	        headers[&#x27;Content-Type&#x27;] = multipart_data.content_type
540	        if method == &quot;POST&quot;:
541	            response = requests.post(
542	                url=self.base_url + endpoint,
543	                headers=headers,
544	                data=multipart_data if multipart_data else {}
545	            )
546	
547	        else:
548	            raise Exception(f&quot;Method {method} not supported yet.&quot;)
549	        return self._handle_response(response)
550	
551	    def _handle_response(self, response):
552	        if response.status_code in (200, 201):
553	            if response.content:
554	                result = response.json()
555	                logger.info(&quot;API request was successful.&quot;)
556	                return result
557	            else:
558	                logger.info(&quot;API request was successful. No content returned.&quot;)
559	                return {}
560	        else:
</pre>
</div>


</div>
</div>

<div id="issue-288">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/twitter_handler/twitter_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/twitter_handler/twitter_handler.py</a><br>
    <b>Line number: </b>162<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
146	            if p not in self.handler.connection_args:
147	                raise Exception(f&#x27;To insert data into Twitter, you need to provide the following parameters when connecting it to MindsDB: {insert_params}&#x27;)  # noqa
148	
149	        for row in query.values:
150	            params = dict(zip(columns, row))
151	
152	            # split long text over 280 symbols
153	            max_text_len = 280
154	            text = params[&#x27;text&#x27;]
155	
156	            # Post image if column media_url is provided, only do this on last tweet
157	            media_ids = None
158	            if &#x27;media_url&#x27; in params:
159	                media_url = params.pop(&#x27;media_url&#x27;)
160	
161	                # create an in memory file
162	                resp = requests.get(media_url)
163	                img = io.BytesIO(resp.content)
164	
165	                # upload media to twitter
166	                api_v1 = self.handler.create_connection(api_version=1)
167	                content_type = resp.headers[&#x27;Content-Type&#x27;]
168	                file_type = content_type.split(&#x27;/&#x27;)[-1]
169	                media = api_v1.media_upload(filename=&quot;img.{file_type}&quot;.format(file_type=file_type), file=img)
170	
171	                media_ids = [media.media_id]
172	
173	
174	            words = re.split(&#x27;( )&#x27;, text)
175	
176	            messages = []
177	
</pre>
</div>


</div>
</div>

<div id="issue-289">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/vertica_handler/connection_args.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/vertica_handler/connection_args.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
18	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the VERTICA server.&#x27;
19	    },
20	    host={
21	        &#x27;type&#x27;: ARG_TYPE.STR,
22	        &#x27;description&#x27;: &#x27;The host name or IP address of the VERTICA server. NOTE: use \&#x27;127.0.0.1\&#x27; instead of \&#x27;localhost\&#x27; to connect to local server.&#x27;
23	    },
24	    port={
25	        &#x27;type&#x27;: ARG_TYPE.INT,
26	        &#x27;description&#x27;: &#x27;The TCP/IP port of the VERTICA server. Must be an integer.&#x27;
27	    },
28	    schema_name={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;Table are listed according to schema name (it is optional). Note: Default value is &quot;public&quot;&#x27;
31	    }
32	)
33	
34	connection_args_example = OrderedDict(
35	    host=&#x27;127.0.0.1&#x27;,
36	    port=5433,
37	    user=&#x27;root&#x27;,
38	    password=&#x27;password&#x27;,
39	    database=&#x27;database&#x27;,
40	    schema_name=&#x27;xyz&#x27;
41	)
</pre>
</div>


</div>
</div>

<div id="issue-290">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/vertica_handler/vertica_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/vertica_handler/vertica_handler.py</a><br>
    <b>Line number: </b>138<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
122	            self.disconnect()
123	
124	        return response
125	
126	    def query(self, query: ASTNode) -&gt; Response:
127	        &quot;&quot;&quot;
128	        Retrieve the data from the SQL statement.
129	        &quot;&quot;&quot;
130	        renderer = SqlalchemyRender(VerticaDialect)
131	        query_str = renderer.get_string(query, with_failback=True)
132	        return self.native_query(query_str)
133	
134	    def get_tables(self) -&gt; Response:
135	        &quot;&quot;&quot;
136	        Get a list with all of the tabels in VERTICA
137	        &quot;&quot;&quot;
138	        q = f&#x27;&#x27;&#x27;SELECT 
139	        TABLE_NAME,
140	        TABLE_SCHEMA
141	        from v_catalog.tables 
142	        WHERE table_schema=&#x27;{self.schema_name}&#x27; 
143	        order by
144	        table_name;&#x27;&#x27;&#x27;
145	
146	         
147	        return self.native_query(q)
148	
149	    def get_columns(self, table_name) -&gt; Response:
150	        &quot;&quot;&quot;
151	        Show details about the table
152	        &quot;&quot;&quot;
153	        q = f&#x27;&#x27;&#x27;SELECT 
154	        column_name , 
155	        data_type 
156	        FROM v_catalog.columns 
157	        WHERE table_name=&#x27;{table_name}&#x27;;&#x27;&#x27;&#x27;
158	
159	        
</pre>
</div>


</div>
</div>

<div id="issue-291">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/vertica_handler/vertica_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/vertica_handler/vertica_handler.py</a><br>
    <b>Line number: </b>153<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
137	        &quot;&quot;&quot;
138	        q = f&#x27;&#x27;&#x27;SELECT 
139	        TABLE_NAME,
140	        TABLE_SCHEMA
141	        from v_catalog.tables 
142	        WHERE table_schema=&#x27;{self.schema_name}&#x27; 
143	        order by
144	        table_name;&#x27;&#x27;&#x27;
145	
146	         
147	        return self.native_query(q)
148	
149	    def get_columns(self, table_name) -&gt; Response:
150	        &quot;&quot;&quot;
151	        Show details about the table
152	        &quot;&quot;&quot;
153	        q = f&#x27;&#x27;&#x27;SELECT 
154	        column_name , 
155	        data_type 
156	        FROM v_catalog.columns 
157	        WHERE table_name=&#x27;{table_name}&#x27;;&#x27;&#x27;&#x27;
158	
159	        
160	        return self.native_query(q)
</pre>
</div>


</div>
</div>

<div id="issue-292">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<???>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/vitess_handler/vitess_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/vitess_handler/vitess_handler.py</a><br>
    <b>Line number: </b>42<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
26	        &#x27;description&#x27;: &#x27;The password to authenticate the user with the Vitess server.&#x27;
27	    },
28	    database={
29	        &#x27;type&#x27;: ARG_TYPE.STR,
30	        &#x27;description&#x27;: &#x27;The database name to use when connecting with the Vitess server.&#x27;
31	    },
32	    host={
33	        &#x27;type&#x27;: ARG_TYPE.STR,
34	        &#x27;description&#x27;: &#x27;The host name or IP address of the Vitess server.&#x27;
35	    },
36	    port={
37	        &#x27;type&#x27;: ARG_TYPE.INT,
38	        &#x27;description&#x27;: &#x27;The TCP/IP port of the Vitess server. Must be an integer.&#x27;
39	    }
40	)
41	
42	connection_args_example = OrderedDict(
43	    host=&#x27;127.0.0.1&#x27;,
44	    port=5432,
45	    user=&#x27;root&#x27;,
46	    password=&#x27;&lt;???&gt;&#x27;,
47	    database=&#x27;database&#x27;
48	)
</pre>
</div>


</div>
</div>

<div id="issue-293">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/weaviate_handler/weaviate_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/weaviate_handler/weaviate_handler.py</a><br>
    <b>Line number: </b>338<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
322	        if columns:
323	            query = self._client.query.get(
324	                table_name,
325	                columns + [metadata_query],
326	            ).with_additional([&quot;id vector distance&quot;])
327	        else:
328	            query = self._client.query.get(
329	                table_name,
330	                [metadata_query],
331	            ).with_additional([&quot;id vector distance&quot;])
332	        if vector_filter:
333	            # similarity search
334	            # assuming the similarity search is on content
335	            # assuming there would be only one vector based search per query
336	            vector_filter = vector_filter[0]
337	            near_vector = {
338	                &quot;vector&quot;: eval(vector_filter.value)
339	                if isinstance(vector_filter.value, str)
340	                else vector_filter.value
341	            }
342	            query = query.with_near_vector(near_vector)
343	        if filters:
344	            query = query.with_where(filters)
345	        if limit:
346	            query = query.with_limit(limit)
347	        result = query.do()
348	        result = result[&quot;data&quot;][&quot;Get&quot;][table_name.capitalize()]
349	        ids = [query_obj[&quot;_additional&quot;][&quot;id&quot;] for query_obj in result]
350	        contents = [query_obj.get(&quot;content&quot;) for query_obj in result]
351	        distances = [
352	            query_obj.get(&quot;_additional&quot;).get(&quot;distance&quot;) for query_obj in result
353	        ]
</pre>
</div>


</div>
</div>

<div id="issue-294">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: '<your-youtube-api-token>'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/youtube_handler/youtube_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/youtube_handler/youtube_handler.py</a><br>
    <b>Line number: </b>164<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
148	        &#x27;type&#x27;: ARG_TYPE.STR,
149	        &#x27;description&#x27;: &#x27;Location of OAuth2 Credentials&#x27;,
150	        &#x27;label&#x27;: &#x27;Location of OAuth2 Credentials&#x27;,
151	    },
152	    credentials={
153	        &#x27;type&#x27;: ARG_TYPE.PATH,
154	        &#x27;description&#x27;: &#x27;OAuth2 Credentials&#x27;,
155	        &#x27;label&#x27;: &#x27;Upload OAuth2 Credentials&#x27;,
156	    },
157	    code={
158	        &#x27;type&#x27;: ARG_TYPE.STR,
159	        &#x27;description&#x27;: &#x27;Authentication Code&#x27;,
160	        &#x27;label&#x27;: &#x27;Authentication Code&#x27;,
161	    }
162	)
163	
164	connection_args_example = OrderedDict(youtube_api_token=&quot;&lt;your-youtube-api-token&gt;&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-295">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: ''<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/yugabyte_handler/yugabyte_handler.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/yugabyte_handler/yugabyte_handler.py</a><br>
    <b>Line number: </b>58<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
42	    },
43	    database={
44	        &#x27;type&#x27;: ARG_TYPE.STR,
45	        &#x27;description&#x27;: &#x27;Specify database name  to connect YugabyteDB server&#x27;,
46	    },
47	    schema={
48	        &#x27;type&#x27;: ARG_TYPE.STR,
49	        &#x27;description&#x27;: &#x27;(OPTIONAL) comma seperated value of schema to be considered while querying&#x27;,
50	    },
51	    sslmode={
52	        &#x27;type&#x27;: ARG_TYPE.STR,
53	        &#x27;description&#x27;: &#x27;&#x27;&#x27; (OPTIONAL) Specifies the SSL mode for the connection, determining whether to use SSL encryption and the level of verification required
54	        (e.g., &quot;**disable**&quot;, &quot;**allow**&quot;, &quot;**prefer**&quot;, &quot;**require**&quot;, &quot;**verify-ca**&quot;, &quot;**verify-full**&quot;)&#x27;&#x27;&#x27;,
55	    },
56	)
57	
58	connection_args_example = OrderedDict(
59	    host=&#x27;127.0.0.1&#x27;, port=5433, password=&#x27;&#x27;, user=&#x27;admin&#x27;, database=&#x27;yugabyte&#x27;
60	)
</pre>
</div>


</div>
</div>

<div id="issue-296">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/handlers/zipcodebase_handler/zipcodebase.py" target="_blank">/mindsdb/mindsdb/integrations/handlers/zipcodebase_handler/zipcodebase.py</a><br>
    <b>Line number: </b>14<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
1	import requests
2	
3	
4	class ZipCodeBaseClient:
5	
6	    def __init__(self, api_key):
7	        self.api_key = api_key
8	        self.base_endpoint = &quot;https://app.zipcodebase.com/api/v1&quot;
9	
10	    def make_request(self, url, params=None):
11	        headers = {&#x27;Content-type&#x27;: &#x27;application/json&#x27;}
12	        if self.api_key:
13	            headers[&#x27;apikey&#x27;] = self.api_key
14	        resp = requests.get(url, headers=headers, params=params)
15	        content = {}
16	        if resp.status_code == 200:
17	            content = {&#x27;content&#x27;: resp.json(), &#x27;code&#x27;: 200}
18	        else:
19	            content = {&#x27;content&#x27;: {}, &#x27;code&#x27;: resp.status_code, &#x27;error&#x27;: resp.text}
20	        return content
21	
22	    def code_to_location(self, codes):
23	        url = f&#x27;{self.base_endpoint}/search&#x27;
24	        params = (
25	            (&quot;codes&quot;, codes),
26	        )
27	        return self.make_request(url, params)
28	
29	    def codes_within_radius(self, code, radius, country, unit):
30	        url = f&#x27;{self.base_endpoint}/radius&#x27;
31	        params = (
32	            (&quot;code&quot;, code),
</pre>
</div>


</div>
</div>

<div id="issue-297">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: 'pwd'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/const.py" target="_blank">/mindsdb/mindsdb/integrations/libs/const.py</a><br>
    <b>Line number: </b>18<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
2	    __slots__ = ()
3	    DATA = &#x27;data&#x27;
4	    ML = &#x27;ml&#x27;
5	
6	
7	HANDLER_TYPE = HANDLER_TYPE()
8	
9	
10	class HANDLER_CONNECTION_ARG_TYPE:
11	    __slots__ = ()
12	    STR = &#x27;str&#x27;
13	    INT = &#x27;int&#x27;
14	    BOOL = &#x27;bool&#x27;
15	    URL = &#x27;url&#x27;
16	    PATH = &#x27;path&#x27;
17	    DICT = &#x27;dict&#x27;
18	    PWD = &#x27;pwd&#x27;
19	
20	
21	HANDLER_CONNECTION_ARG_TYPE = HANDLER_CONNECTION_ARG_TYPE()
22	
23	from mindsdb.interfaces.storage.db import PREDICTOR_STATUS  # noqa
</pre>
</div>


</div>
</div>

<div id="issue-298">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/handler_helpers.py" target="_blank">/mindsdb/mindsdb/integrations/libs/handler_helpers.py</a><br>
    <b>Line number: </b>48<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
32	    try:
33	        handler_module = importlib.import_module(f&#x27;mindsdb.integrations.handlers.{handler_folder_name}&#x27;)
34	        logger.debug(&quot;get_handler: handler module - %s&quot;, handler_module)
35	        handler = handler_module.Handler
36	        if handler is None:
37	            logger.error(&quot;get_handler: import error - %s&quot;, handler_module.import_error)
38	        logger.debug(&quot;get_handler: found handler - %s&quot;, handler)
39	        return handler
40	    except Exception as e:
41	        raise e
42	
43	
44	def registry(url, data, interval):
45	    def worker():
46	        while True:
47	            try:
48	                requests.post(url, json=data, headers={&quot;Content-Type&quot;: &quot;application/json&quot;})
49	            except Exception as e:
50	                logger.error(&quot;handler_register: unable to register the service - %s&quot;, e)
51	            time.sleep(interval)
52	
53	    _th_worker = Thread(target=worker)
54	    _th_worker.start()
55	    logger.info(&quot;handler_register: registering service. url - %s, data - %s, interval - %s&quot;, url, data, interval)
</pre>
</div>


</div>
</div>

<div id="issue-299">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/storage_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/storage_handler.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import os
2	import dill
3	import pickle
4	from typing import Dict
5	from hashlib import md5
6	
7	import redis
8	import sqlite3
9	
10	
11	class KVStorageHandler:
12	    &quot;&quot;&quot; 
13	    Simple key-value store. Instances of this handler shall store any information required by other handlers.
14	    Context should store anything relevant to the storage handler, e.g. CompanyID, UserID, parent handler name, among others. 
15	    &quot;&quot;&quot;  # noqa
16	    def __init__(self, context: Dict, config=None):
17	        self.config = config if config else os.getenv(&#x27;MDB_STORAGE_HANDLER_CONFIG&#x27;)
18	        self.serializer = pickle if config.get(&#x27;serializer&#x27;, &#x27;&#x27;) == &#x27;pickle&#x27; else dill
19	        self.context = self.serializer.dumps(context)  # store serialized
20	
21	    def _get_context_key(self, key: str):
22	        serialized_key = self.serializer.dumps(key)
23	        return md5(serialized_key).hexdigest() + md5(self.context).hexdigest()
24	
25	    def get(self, key, default_value=None):
26	        serialized_value = self._get(self._get_context_key(key))
27	        if serialized_value:
28	            return self.serializer.loads(serialized_value)
29	        elif default_value is not None:
30	            return default_value
31	        else:
32	            raise KeyError(f&quot;Key not found: {key}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-300">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/storage_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/storage_handler.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import os
2	import dill
3	import pickle
4	from typing import Dict
5	from hashlib import md5
6	
7	import redis
8	import sqlite3
9	
10	
11	class KVStorageHandler:
12	    &quot;&quot;&quot; 
13	    Simple key-value store. Instances of this handler shall store any information required by other handlers.
14	    Context should store anything relevant to the storage handler, e.g. CompanyID, UserID, parent handler name, among others. 
15	    &quot;&quot;&quot;  # noqa
16	    def __init__(self, context: Dict, config=None):
17	        self.config = config if config else os.getenv(&#x27;MDB_STORAGE_HANDLER_CONFIG&#x27;)
18	        self.serializer = pickle if config.get(&#x27;serializer&#x27;, &#x27;&#x27;) == &#x27;pickle&#x27; else dill
19	        self.context = self.serializer.dumps(context)  # store serialized
20	
21	    def _get_context_key(self, key: str):
22	        serialized_key = self.serializer.dumps(key)
23	        return md5(serialized_key).hexdigest() + md5(self.context).hexdigest()
24	
25	    def get(self, key, default_value=None):
26	        serialized_value = self._get(self._get_context_key(key))
27	        if serialized_value:
28	            return self.serializer.loads(serialized_value)
29	        elif default_value is not None:
30	            return default_value
31	        else:
32	            raise KeyError(f&quot;Key not found: {key}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-301">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/storage_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/storage_handler.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
7	import redis
8	import sqlite3
9	
10	
11	class KVStorageHandler:
12	    &quot;&quot;&quot; 
13	    Simple key-value store. Instances of this handler shall store any information required by other handlers.
14	    Context should store anything relevant to the storage handler, e.g. CompanyID, UserID, parent handler name, among others. 
15	    &quot;&quot;&quot;  # noqa
16	    def __init__(self, context: Dict, config=None):
17	        self.config = config if config else os.getenv(&#x27;MDB_STORAGE_HANDLER_CONFIG&#x27;)
18	        self.serializer = pickle if config.get(&#x27;serializer&#x27;, &#x27;&#x27;) == &#x27;pickle&#x27; else dill
19	        self.context = self.serializer.dumps(context)  # store serialized
20	
21	    def _get_context_key(self, key: str):
22	        serialized_key = self.serializer.dumps(key)
23	        return md5(serialized_key).hexdigest() + md5(self.context).hexdigest()
24	
25	    def get(self, key, default_value=None):
26	        serialized_value = self._get(self._get_context_key(key))
27	        if serialized_value:
28	            return self.serializer.loads(serialized_value)
29	        elif default_value is not None:
30	            return default_value
31	        else:
32	            raise KeyError(f&quot;Key not found: {key}&quot;)
33	
34	    def set(self, key: str, value: object):
35	        serialized_value = self.serializer.dumps(value)
36	        self._set(self._get_context_key(key), serialized_value)
37	
38	    def _get(self, serialized_key):
</pre>
</div>


</div>
</div>

<div id="issue-302">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/storage_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/storage_handler.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
7	import redis
8	import sqlite3
9	
10	
11	class KVStorageHandler:
12	    &quot;&quot;&quot; 
13	    Simple key-value store. Instances of this handler shall store any information required by other handlers.
14	    Context should store anything relevant to the storage handler, e.g. CompanyID, UserID, parent handler name, among others. 
15	    &quot;&quot;&quot;  # noqa
16	    def __init__(self, context: Dict, config=None):
17	        self.config = config if config else os.getenv(&#x27;MDB_STORAGE_HANDLER_CONFIG&#x27;)
18	        self.serializer = pickle if config.get(&#x27;serializer&#x27;, &#x27;&#x27;) == &#x27;pickle&#x27; else dill
19	        self.context = self.serializer.dumps(context)  # store serialized
20	
21	    def _get_context_key(self, key: str):
22	        serialized_key = self.serializer.dumps(key)
23	        return md5(serialized_key).hexdigest() + md5(self.context).hexdigest()
24	
25	    def get(self, key, default_value=None):
26	        serialized_value = self._get(self._get_context_key(key))
27	        if serialized_value:
28	            return self.serializer.loads(serialized_value)
29	        elif default_value is not None:
30	            return default_value
31	        else:
32	            raise KeyError(f&quot;Key not found: {key}&quot;)
33	
34	    def set(self, key: str, value: object):
35	        serialized_value = self.serializer.dumps(value)
36	        self._set(self._get_context_key(key), serialized_value)
37	
38	    def _get(self, serialized_key):
</pre>
</div>


</div>
</div>

<div id="issue-303">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/storage_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/storage_handler.py</a><br>
    <b>Line number: </b>63<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
47	    def __init__(self, context: Dict, config=None):
48	        super().__init__(context, config)
49	        name = self.config[&quot;name&quot;] if self.config[&quot;name&quot;][-3:] == &#x27;.db&#x27; else self.config[&quot;name&quot;] + &#x27;.db&#x27;
50	        path = os.path.join(self.config.get(&quot;path&quot;, &quot;./&quot;), name)
51	        self.connection = sqlite3.connect(path)
52	        self._setup_connection()
53	
54	    def _setup_connection(self):
55	        &quot;&quot;&quot; Checks that a key-value table exists, otherwise creates it. &quot;&quot;&quot;  # noqa
56	        cur = self.connection.cursor()
57	        if (&#x27;store&#x27;,) not in list(cur.execute(&quot;SELECT name FROM sqlite_master WHERE type=&#x27;table&#x27;;&quot;)):
58	            cur.execute(&quot;&quot;&quot;create table store (key text PRIMARY KEY, value text)&quot;&quot;&quot;)
59	            self.connection.commit()
60	
61	    def _get(self, serialized_key):
62	        cur = self.connection.cursor()
63	        results = list(cur.execute(f&quot;&quot;&quot;select value from store where key=&#x27;{serialized_key}&#x27;&quot;&quot;&quot;))
64	        if results:
65	            return results[0][0]  # should always be a single match, hence the [0]s
66	        else:
67	            return None
68	
69	    def _set(self, serialized_key, serialized_value):
70	        cur = self.connection.cursor()
71	        cur.execute(&quot;insert or replace into store values (?, ?)&quot;, (serialized_key, serialized_value))
72	        self.connection.commit()
73	
74	
75	class RedisStorageHandler(KVStorageHandler):
76	    &quot;&quot;&quot; StorageHandler that uses Redis as backend. &quot;&quot;&quot;  # noqa
77	    def __init__(self, context: Dict, config=None):
78	        super().__init__(context, config)
</pre>
</div>


</div>
</div>

<div id="issue-304">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py</a><br>
    <b>Line number: </b>245<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
229	        return self.do_upsert(table_name, pd.DataFrame(data))
230	
231	    def _dispatch_update(self, query: Update):
232	        &quot;&quot;&quot;
233	        Dispatch update query to the appropriate method.
234	        &quot;&quot;&quot;
235	        table_name = query.table.parts[-1]
236	
237	        row = {}
238	        for k, v in query.update_columns.items():
239	            k = k.lower()
240	            if isinstance(v, Constant):
241	                v = v.value
242	            if k == TableField.EMBEDDINGS.value and isinstance(v, str):
243	                # it could be embeddings in string
244	                try:
245	                    v = eval(v)
246	                except Exception:
247	                    pass
248	            row[k] = v
249	
250	        filters = conditions_to_filter(query.where)
251	        row.update(filters)
252	
253	        # checks
254	        if TableField.EMBEDDINGS.value not in row:
255	            raise Exception(&quot;Embeddings column is required!&quot;)
256	
257	        if TableField.CONTENT.value not in row:
258	            raise Exception(&quot;Content is required!&quot;)
259	
260	        # store
</pre>
</div>


</div>
</div>

<div id="issue-305">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py</a><br>
    <b>Line number: </b>246<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
230	
231	    def _dispatch_update(self, query: Update):
232	        &quot;&quot;&quot;
233	        Dispatch update query to the appropriate method.
234	        &quot;&quot;&quot;
235	        table_name = query.table.parts[-1]
236	
237	        row = {}
238	        for k, v in query.update_columns.items():
239	            k = k.lower()
240	            if isinstance(v, Constant):
241	                v = v.value
242	            if k == TableField.EMBEDDINGS.value and isinstance(v, str):
243	                # it could be embeddings in string
244	                try:
245	                    v = eval(v)
246	                except Exception:
247	                    pass
248	            row[k] = v
249	
250	        filters = conditions_to_filter(query.where)
251	        row.update(filters)
252	
253	        # checks
254	        if TableField.EMBEDDINGS.value not in row:
255	            raise Exception(&quot;Embeddings column is required!&quot;)
256	
257	        if TableField.CONTENT.value not in row:
258	            raise Exception(&quot;Content is required!&quot;)
259	
260	        # store
261	        df = pd.DataFrame([row])
262	
</pre>
</div>


</div>
</div>

<div id="issue-306">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py" target="_blank">/mindsdb/mindsdb/integrations/libs/vectordatabase_handler.py</a><br>
    <b>Line number: </b>272<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
256	
257	        if TableField.CONTENT.value not in row:
258	            raise Exception(&quot;Content is required!&quot;)
259	
260	        # store
261	        df = pd.DataFrame([row])
262	
263	        return self.do_upsert(table_name, df)
264	
265	    def do_upsert(self, table_name, df):
266	        # if handler supports it, call upsert method
267	
268	        id_col = TableField.ID.value
269	        content_col = TableField.CONTENT.value
270	
271	        def gen_hash(v):
272	            return hashlib.md5(str(v).encode()).hexdigest()
273	
274	        if id_col not in df.columns:
275	            # generate for all
276	            df[id_col] = df[content_col].apply(gen_hash)
277	        else:
278	            # generate for empty
279	            for i in range(len(df)):
280	                if pd.isna(df.loc[i, id_col]):
281	                    df.loc[i, id_col] = gen_hash(df.loc[i, content_col])
282	
283	        # remove duplicated ids
284	        df = df.drop_duplicates([TableField.ID.value])
285	
286	        # id is string TODO is it ok?
287	        df[id_col] = df[id_col].apply(str)
</pre>
</div>


</div>
</div>

<div id="issue-307">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py</a><br>
    <b>Line number: </b>26<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
10	class MSGraphAPIBaseClient:
11	    MICROSOFT_GRAPH_BASE_API_URL: str = &quot;https://graph.microsoft.com/&quot;
12	    MICROSOFT_GRAPH_API_VERSION: str = &quot;v1.0&quot;
13	    PAGINATION_COUNT: Optional[int] = 20
14	
15	    def __init__(self, access_token: str) -&gt; None:
16	        self.access_token = access_token
17	        self._group_ids = None
18	
19	    def _get_api_url(self, endpoint: str) -&gt; str:
20	        api_url = f&quot;{self.MICROSOFT_GRAPH_BASE_API_URL}{self.MICROSOFT_GRAPH_API_VERSION}/{endpoint}/&quot;
21	        return api_url
22	
23	    def _make_request(self, api_url: str, params: Optional[Dict] = None, data: Optional[Dict] = None, method: str = &quot;GET&quot;) -&gt; Union[Dict, object]:
24	        headers = {&quot;Authorization&quot;: f&quot;Bearer {self.access_token}&quot;}
25	        if method == &quot;GET&quot;:
26	            response = requests.get(api_url, headers=headers, params=params)
27	        elif method == &quot;POST&quot;:
28	            response = requests.post(api_url, headers=headers, json=data)
29	        else:
30	            raise NotImplementedError(f&quot;Method {method} not implemented&quot;)
31	        if response.status_code == 429:
32	            if &quot;Retry-After&quot; in response.headers:
33	                pause_time = float(response.headers[&quot;Retry-After&quot;])
34	                time.sleep(pause_time)
35	                response = requests.get(api_url, headers=headers, params=params)
36	        if response.status_code not in [200, 201]:
37	            raise requests.exceptions.RequestException(response.text)
38	        if response.headers[&quot;Content-Type&quot;] == &quot;application/octet-stream&quot;:
39	            raw_response = response.content
40	        else:
41	            raw_response = response.json()
</pre>
</div>


</div>
</div>

<div id="issue-308">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
12	    MICROSOFT_GRAPH_API_VERSION: str = &quot;v1.0&quot;
13	    PAGINATION_COUNT: Optional[int] = 20
14	
15	    def __init__(self, access_token: str) -&gt; None:
16	        self.access_token = access_token
17	        self._group_ids = None
18	
19	    def _get_api_url(self, endpoint: str) -&gt; str:
20	        api_url = f&quot;{self.MICROSOFT_GRAPH_BASE_API_URL}{self.MICROSOFT_GRAPH_API_VERSION}/{endpoint}/&quot;
21	        return api_url
22	
23	    def _make_request(self, api_url: str, params: Optional[Dict] = None, data: Optional[Dict] = None, method: str = &quot;GET&quot;) -&gt; Union[Dict, object]:
24	        headers = {&quot;Authorization&quot;: f&quot;Bearer {self.access_token}&quot;}
25	        if method == &quot;GET&quot;:
26	            response = requests.get(api_url, headers=headers, params=params)
27	        elif method == &quot;POST&quot;:
28	            response = requests.post(api_url, headers=headers, json=data)
29	        else:
30	            raise NotImplementedError(f&quot;Method {method} not implemented&quot;)
31	        if response.status_code == 429:
32	            if &quot;Retry-After&quot; in response.headers:
33	                pause_time = float(response.headers[&quot;Retry-After&quot;])
34	                time.sleep(pause_time)
35	                response = requests.get(api_url, headers=headers, params=params)
36	        if response.status_code not in [200, 201]:
37	            raise requests.exceptions.RequestException(response.text)
38	        if response.headers[&quot;Content-Type&quot;] == &quot;application/octet-stream&quot;:
39	            raw_response = response.content
40	        else:
41	            raw_response = response.json()
42	        return raw_response
43	
</pre>
</div>


</div>
</div>

<div id="issue-309">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/handlers/api_utilities/microsoft/ms_graph_api_utilities.py</a><br>
    <b>Line number: </b>35<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
19	    def _get_api_url(self, endpoint: str) -&gt; str:
20	        api_url = f&quot;{self.MICROSOFT_GRAPH_BASE_API_URL}{self.MICROSOFT_GRAPH_API_VERSION}/{endpoint}/&quot;
21	        return api_url
22	
23	    def _make_request(self, api_url: str, params: Optional[Dict] = None, data: Optional[Dict] = None, method: str = &quot;GET&quot;) -&gt; Union[Dict, object]:
24	        headers = {&quot;Authorization&quot;: f&quot;Bearer {self.access_token}&quot;}
25	        if method == &quot;GET&quot;:
26	            response = requests.get(api_url, headers=headers, params=params)
27	        elif method == &quot;POST&quot;:
28	            response = requests.post(api_url, headers=headers, json=data)
29	        else:
30	            raise NotImplementedError(f&quot;Method {method} not implemented&quot;)
31	        if response.status_code == 429:
32	            if &quot;Retry-After&quot; in response.headers:
33	                pause_time = float(response.headers[&quot;Retry-After&quot;])
34	                time.sleep(pause_time)
35	                response = requests.get(api_url, headers=headers, params=params)
36	        if response.status_code not in [200, 201]:
37	            raise requests.exceptions.RequestException(response.text)
38	        if response.headers[&quot;Content-Type&quot;] == &quot;application/octet-stream&quot;:
39	            raw_response = response.content
40	        else:
41	            raw_response = response.json()
42	        return raw_response
43	
44	    def _get_request_params(self, params: Optional[Dict] = None, pagination: bool = True) -&gt; Dict:
45	        if self.PAGINATION_COUNT and pagination:
46	            params = params if params else {}
47	            if &quot;$top&quot; not in params:
48	                params[&quot;$top&quot;] = self.PAGINATION_COUNT
49	        return params
50	
</pre>
</div>


</div>
</div>

<div id="issue-310">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/handlers/auth_utilities/google/google_service_account_oauth_utilities.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/handlers/auth_utilities/google/google_service_account_oauth_utilities.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
27	        try:
28	            if self.credentials_url:
29	                creds = service_account.Credentials.from_service_account_info(self._download_credentials_file())
30	                return creds
31	
32	            if self.credentials_file:
33	                creds = service_account.Credentials.from_service_account_file(self.credentials_file)
34	                return creds
35	
36	            if self.credentials_json:
37	                creds = service_account.Credentials.from_service_account_info(self.credentials_json)
38	                return creds
39	        except Exception as e:
40	            raise AuthException(f&quot;Authentication failed: {e}&quot;)
41	
42	    def _download_credentials_file(self):
43	        response = requests.get(self.credentials_url)
44	        # raise a HTTPError if the status is 4xx or 5xx
45	        response.raise_for_status()
46	
47	        return self._parse_credentials_json(response.json())
48	
49	    def _parse_credentials_json(self, credentials_json: str) -&gt; dict:
50	        if isinstance(credentials_json, str):
51	            try:
52	                # attempt to convert to JSON
53	                return json.loads(credentials_json)
54	            except json.JSONDecodeError:
55	                raise ValueError(&quot;Failed to parse credentials provided. Please provide a valid service account key.&quot;)
56	        else:
57	            # unescape new lines in private_key
58	            credentials_json[&#x27;private_key&#x27;] = credentials_json[&#x27;private_key&#x27;].replace(&#x27;\\n&#x27;, &#x27;\n&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-311">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/handlers/auth_utilities/google/google_user_oauth_utilities.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/handlers/auth_utilities/google/google_user_oauth_utilities.py</a><br>
    <b>Line number: </b>67<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
51	                    creds.refresh(Request())
52	                    logger.debug(&quot;Credentials refreshed successfully&quot;)
53	                else:
54	                    creds = self._execute_google_auth_flow(secret_file, self.scopes, self.code)
55	                    logger.debug(&quot;New credentials obtained&quot;)
56	
57	                self._save_credentials_to_file(creds, creds_file)
58	                logger.debug(f&quot;saved session credentials to {creds_file}&quot;)
59	                self.handler_storage.folder_sync(&#x27;config&#x27;)
60	
61	        return creds
62	
63	    def _download_secret_file(self, secret_file):
64	        # if credentials_url is set, attempt to download the file
65	        # this will be given preference over credentials_file
66	        if self.credentials_url:
67	            response = requests.get(self.credentials_url)
68	            if response.status_code == 200:
69	                with open(secret_file, &#x27;w&#x27;) as creds:
70	                    creds.write(response.text)
71	                return True
72	            else:
73	                logger.error(&quot;Failed to get credentials from S3&quot;, response.status_code)
74	
75	        # if credentials_file is set, attempt to copy the file
76	        if self.credentials_file and os.path.isfile(self.credentials_file):
77	            copyfile(self.credentials_file, secret_file)
78	            return True
79	        return False
80	
81	    def _execute_google_auth_flow(self, secret_file, scopes, code=None):
82	        flow = Flow.from_client_secrets_file(secret_file, scopes)
</pre>
</div>


</div>
</div>

<div id="issue-312">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/install.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/install.py</a><br>
    <b>Line number: </b>3<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import os
2	import sys
3	import subprocess
4	from typing import Text, List
5	
6	
7	def install_dependencies(dependencies: List[Text]) -&gt; dict:
8	    &quot;&quot;&quot;
9	    Installs the dependencies for a handler by calling the `pip install` command via subprocess.
10	
11	    Args:
12	        dependencies (List[Text]): List of dependencies for the handler.
13	
14	    Returns:
15	        dict: A dictionary containing the success status and an error message if an error occurs.
16	    &quot;&quot;&quot;
17	    outs = b&#x27;&#x27;
18	    errs = b&#x27;&#x27;
19	    result = {
20	        &#x27;success&#x27;: False,
21	        &#x27;error_message&#x27;: None
22	    }
23	    code = None
24	
25	    try:
26	        # split the dependencies by parsing the contents of the requirements.txt file
27	        split_dependencies = parse_dependencies(dependencies)
28	
29	        # run the pip install command
30	        sp = subprocess.Popen(
31	            [sys.executable, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;install&#x27;, *split_dependencies],
32	            stdout=subprocess.PIPE,
</pre>
</div>


</div>
</div>

<div id="issue-313">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/install.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/install.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
14	    Returns:
15	        dict: A dictionary containing the success status and an error message if an error occurs.
16	    &quot;&quot;&quot;
17	    outs = b&#x27;&#x27;
18	    errs = b&#x27;&#x27;
19	    result = {
20	        &#x27;success&#x27;: False,
21	        &#x27;error_message&#x27;: None
22	    }
23	    code = None
24	
25	    try:
26	        # split the dependencies by parsing the contents of the requirements.txt file
27	        split_dependencies = parse_dependencies(dependencies)
28	
29	        # run the pip install command
30	        sp = subprocess.Popen(
31	            [sys.executable, &#x27;-m&#x27;, &#x27;pip&#x27;, &#x27;install&#x27;, *split_dependencies],
32	            stdout=subprocess.PIPE,
33	            stderr=subprocess.PIPE
34	        )
35	        code = sp.wait()
36	        outs, errs = sp.communicate(timeout=1)
37	    except Exception as e:
38	        result[&#x27;error_message&#x27;] = str(e)
39	
40	    # return the result of the installation
41	    if code != 0:
42	        output = &#x27;&#x27;
43	        if isinstance(outs, bytes) and len(outs) &gt; 0:
44	            output = output + &#x27;Output: &#x27; + outs.decode()
45	        if isinstance(errs, bytes) and len(errs) &gt; 0:
46	            if len(output) &gt; 0:
47	                output = output + &#x27;\n&#x27;
48	            output = output + &#x27;Errors: &#x27; + errs.decode()
49	        result[&#x27;error_message&#x27;] = output
</pre>
</div>


</div>
</div>

<div id="issue-314">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/integrations/utilities/rag/loaders/vector_store_loader/vector_store_loader.py" target="_blank">/mindsdb/mindsdb/integrations/utilities/rag/loaders/vector_store_loader/vector_store_loader.py</a><br>
    <b>Line number: </b>108<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
92	            metadatas=metadata,
93	            ids=ids
94	        )
95	        return vectorstore
96	
97	    @staticmethod
98	    def _fetch_data_from_db(settings: VectorStoreConfig) -&gt; pd.DataFrame:
99	        &quot;&quot;&quot;
100	        Fetches data from the database using the provided connection_string in the settings
101	        :param settings:
102	        :return:
103	        &quot;&quot;&quot;
104	        try:
105	            engine = create_engine(settings.connection_string)
106	            db = scoped_session(sessionmaker(bind=engine))
107	
108	            df = pd.read_sql(f&quot;SELECT * FROM {settings.collection_name}&quot;, engine)
109	
110	            return df
111	        except DisconnectionError as e:
112	            logger.error(&quot;Unable to connect to the database. Please check your connection string and try again.&quot;)
113	            raise e
114	        except Exception as e:
115	            logger.error(f&quot;An error occurred while fetching data from the database: {e}&quot;)
116	            raise e
117	        finally:
118	            db.close()
</pre>
</div>


</div>
</div>

<div id="issue-315">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/database/integrations.py" target="_blank">/mindsdb/mindsdb/interfaces/database/integrations.py</a><br>
    <b>Line number: </b>93<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
77	        &quot;&quot;&quot; add (or replace) handler in cache
78	
79	            Args:
80	                handler (DatabaseHandler)
81	        &quot;&quot;&quot;
82	        # do not cache connections in handlers processes
83	        if multiprocessing.current_process().name.startswith(&#x27;HandlerProcess&#x27;):
84	            return
85	        with self._lock:
86	            try:
87	                key = (handler.name, ctx.company_id, threading.get_native_id())
88	                handler.connect()
89	                self.handlers[key] = {
90	                    &#x27;handler&#x27;: handler,
91	                    &#x27;expired_at&#x27;: time() + self.ttl
92	                }
93	            except Exception:
94	                pass
95	            self._start_clean()
96	
97	    def get(self, name: str) -&gt; Optional[DatabaseHandler]:
98	        &quot;&quot;&quot; get handler from cache by name
99	
100	            Args:
101	                name (str): handler name
102	
103	            Returns:
104	                DatabaseHandler
105	        &quot;&quot;&quot;
106	        with self._lock:
107	            key = (name, ctx.company_id, threading.get_native_id())
108	            if (
109	                key not in self.handlers
</pre>
</div>


</div>
</div>

<div id="issue-316">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/database/integrations.py" target="_blank">/mindsdb/mindsdb/interfaces/database/integrations.py</a><br>
    <b>Line number: </b>127<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
111	            ):
112	                return None
113	            self.handlers[key][&#x27;expired_at&#x27;] = time() + self.ttl
114	            return self.handlers[key][&#x27;handler&#x27;]
115	
116	    def delete(self, name: str) -&gt; None:
117	        &quot;&quot;&quot; delete handler from cache
118	
119	            Args:
120	                name (str): handler name
121	        &quot;&quot;&quot;
122	        with self._lock:
123	            key = (name, ctx.company_id, threading.get_native_id())
124	            if key in self.handlers:
125	                try:
126	                    self.handlers[key].disconnect()
127	                except Exception:
128	                    pass
129	                del self.handlers[key]
130	            if len(self.handlers) == 0:
131	                self._stop_clean()
132	
133	    def _clean(self) -&gt; None:
134	        &quot;&quot;&quot; worker that delete from cache handlers that was not in use for ttl
135	        &quot;&quot;&quot;
136	        while self._stop_event.wait(timeout=3) is False:
137	            with self._lock:
138	                for key in list(self.handlers.keys()):
139	                    if (
140	                        self.handlers[key][&#x27;expired_at&#x27;] &lt; time()
141	                        and sys.getrefcount(self.handlers[key]) == 2    # returned ref count is always 1 higher
142	                    ):
143	                        try:
</pre>
</div>


</div>
</div>

<div id="issue-317">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/database/integrations.py" target="_blank">/mindsdb/mindsdb/interfaces/database/integrations.py</a><br>
    <b>Line number: </b>145<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
129	                del self.handlers[key]
130	            if len(self.handlers) == 0:
131	                self._stop_clean()
132	
133	    def _clean(self) -&gt; None:
134	        &quot;&quot;&quot; worker that delete from cache handlers that was not in use for ttl
135	        &quot;&quot;&quot;
136	        while self._stop_event.wait(timeout=3) is False:
137	            with self._lock:
138	                for key in list(self.handlers.keys()):
139	                    if (
140	                        self.handlers[key][&#x27;expired_at&#x27;] &lt; time()
141	                        and sys.getrefcount(self.handlers[key]) == 2    # returned ref count is always 1 higher
142	                    ):
143	                        try:
144	                            self.handlers[key].disconnect()
145	                        except Exception:
146	                            pass
147	                        del self.handlers[key]
148	                if len(self.handlers) == 0:
149	                    self._stop_event.set()
150	
151	
152	class IntegrationController:
153	    @staticmethod
154	    def _is_not_empty_str(s):
155	        return isinstance(s, str) and len(s) &gt; 0
156	
157	    def __init__(self):
158	        self._load_handler_modules()
159	        self.handlers_cache = HandlersCache()
160	
161	    def _add_integration_record(self, name, engine, connection_args):
</pre>
</div>


</div>
</div>

<div id="issue-318">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/skills/sql_agent.py" target="_blank">/mindsdb/mindsdb/interfaces/skills/sql_agent.py</a><br>
    <b>Line number: </b>155<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
139	        dn = self._command_executor.session.datahub.get(integration)
140	
141	        fields, dtypes = [], []
142	        for column in dn.get_table_columns(table_name):
143	            fields.append(column[&#x27;name&#x27;])
144	            dtypes.append(column.get(&#x27;type&#x27;, &#x27;&#x27;))
145	
146	        info = f&#x27;Table named `{table_name}`\n&#x27;
147	        info += f&quot;\n/* Sample with first {self._sample_rows_in_table_info} rows from table {table_str}:\n&quot;
148	        info += &quot;\t&quot;.join([field for field in fields])
149	        info += self._get_sample_rows(table_str, fields) + &quot;\n*/&quot;
150	        info += &#x27;\nColumn data types: &#x27; + &quot;,\t&quot;.join(
151	            [f&#x27;`{field}` : `{dtype}`&#x27; for field, dtype in zip(fields, dtypes)]) + &#x27;\n&#x27;  # noqa
152	        return info
153	
154	    def _get_sample_rows(self, table: str, fields: List[str]) -&gt; str:
155	        command = f&quot;select {&#x27;,&#x27;.join(fields)} from {table} limit {self._sample_rows_in_table_info};&quot;
156	        try:
157	            ret = self._call_engine(command)
158	            sample_rows = ret.data.to_lists()
159	            sample_rows = list(
160	                map(lambda ls: [str(i) if len(str(i)) &lt; 100 else str[:100] + &#x27;...&#x27; for i in ls], sample_rows))
161	            sample_rows_str = &quot;\n&quot; + &quot;\n&quot;.join([&quot;\t&quot;.join(row) for row in sample_rows])
162	        except Exception as e:
163	            logger.warning(e)
164	            sample_rows_str = &quot;\n&quot; + &quot;\t [error] Couldn&#x27;t retrieve sample rows!&quot;
165	
166	        return sample_rows_str
167	
168	    def _clean_query(self, query: str) -&gt; str:
169	        # Sometimes LLM can input markdown into query tools.
170	        cmd = re.sub(r&#x27;```(sql)?&#x27;, &#x27;&#x27;, query)
</pre>
</div>


</div>
</div>

<div id="issue-319">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/storage/fs.py" target="_blank">/mindsdb/mindsdb/interfaces/storage/fs.py</a><br>
    <b>Line number: </b>60<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
44	
45	
46	DIR_LOCK_FILE_NAME = &#x27;dir.lock&#x27;
47	DIR_LAST_MODIFIED_FILE_NAME = &#x27;last_modified.txt&#x27;
48	SERVICE_FILES_NAMES = (DIR_LOCK_FILE_NAME, DIR_LAST_MODIFIED_FILE_NAME)
49	
50	
51	def copy(src, dst):
52	    if os.path.isdir(src):
53	        if os.path.exists(dst):
54	            if dirhash(src) == dirhash(dst):
55	                return
56	        shutil.rmtree(dst, ignore_errors=True)
57	        shutil.copytree(src, dst, dirs_exist_ok=True)
58	    else:
59	        if os.path.exists(dst):
60	            if hashlib.md5(open(src, &#x27;rb&#x27;).read()).hexdigest() == hashlib.md5(open(dst, &#x27;rb&#x27;).read()).hexdigest():
61	                return
62	        try:
63	            os.remove(dst)
64	        except Exception:
65	            pass
66	        shutil.copy2(src, dst)
67	
68	
69	class BaseFSStore(ABC):
70	    &quot;&quot;&quot;Base class for file storage
71	    &quot;&quot;&quot;
72	
73	    def __init__(self):
74	        self.config = Config()
75	        self.storage = self.config[&#x27;paths&#x27;][&#x27;storage&#x27;]
</pre>
</div>


</div>
</div>

<div id="issue-320">
<div class="issue-block issue-sev-high">
    <b>hashlib: </b> Use of weak MD5 hash for security. Consider usedforsecurity=False<br>
    <b>Test ID:</b> B324<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/327.html" target="_blank">CWE-327</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/storage/fs.py" target="_blank">/mindsdb/mindsdb/interfaces/storage/fs.py</a><br>
    <b>Line number: </b>60<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b324_hashlib.html</a><br>

<div class="code">
<pre>
44	
45	
46	DIR_LOCK_FILE_NAME = &#x27;dir.lock&#x27;
47	DIR_LAST_MODIFIED_FILE_NAME = &#x27;last_modified.txt&#x27;
48	SERVICE_FILES_NAMES = (DIR_LOCK_FILE_NAME, DIR_LAST_MODIFIED_FILE_NAME)
49	
50	
51	def copy(src, dst):
52	    if os.path.isdir(src):
53	        if os.path.exists(dst):
54	            if dirhash(src) == dirhash(dst):
55	                return
56	        shutil.rmtree(dst, ignore_errors=True)
57	        shutil.copytree(src, dst, dirs_exist_ok=True)
58	    else:
59	        if os.path.exists(dst):
60	            if hashlib.md5(open(src, &#x27;rb&#x27;).read()).hexdigest() == hashlib.md5(open(dst, &#x27;rb&#x27;).read()).hexdigest():
61	                return
62	        try:
63	            os.remove(dst)
64	        except Exception:
65	            pass
66	        shutil.copy2(src, dst)
67	
68	
69	class BaseFSStore(ABC):
70	    &quot;&quot;&quot;Base class for file storage
71	    &quot;&quot;&quot;
72	
73	    def __init__(self):
74	        self.config = Config()
75	        self.storage = self.config[&#x27;paths&#x27;][&#x27;storage&#x27;]
</pre>
</div>


</div>
</div>

<div id="issue-321">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/storage/fs.py" target="_blank">/mindsdb/mindsdb/interfaces/storage/fs.py</a><br>
    <b>Line number: </b>64<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
48	SERVICE_FILES_NAMES = (DIR_LOCK_FILE_NAME, DIR_LAST_MODIFIED_FILE_NAME)
49	
50	
51	def copy(src, dst):
52	    if os.path.isdir(src):
53	        if os.path.exists(dst):
54	            if dirhash(src) == dirhash(dst):
55	                return
56	        shutil.rmtree(dst, ignore_errors=True)
57	        shutil.copytree(src, dst, dirs_exist_ok=True)
58	    else:
59	        if os.path.exists(dst):
60	            if hashlib.md5(open(src, &#x27;rb&#x27;).read()).hexdigest() == hashlib.md5(open(dst, &#x27;rb&#x27;).read()).hexdigest():
61	                return
62	        try:
63	            os.remove(dst)
64	        except Exception:
65	            pass
66	        shutil.copy2(src, dst)
67	
68	
69	class BaseFSStore(ABC):
70	    &quot;&quot;&quot;Base class for file storage
71	    &quot;&quot;&quot;
72	
73	    def __init__(self):
74	        self.config = Config()
75	        self.storage = self.config[&#x27;paths&#x27;][&#x27;storage&#x27;]
76	
77	    @abstractmethod
78	    def get(self, local_name, base_dir):
79	        &quot;&quot;&quot;Copy file/folder from storage to {base_dir}
80	
</pre>
</div>


</div>
</div>

<div id="issue-322">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/storage/fs.py" target="_blank">/mindsdb/mindsdb/interfaces/storage/fs.py</a><br>
    <b>Line number: </b>197<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
181	        &quot;&quot;&quot; Args:
182	                relative_path (Path): path to resource directory relative to storage root
183	                mode (str): lock for read (r) or write (w)
184	        &quot;&quot;&quot;
185	        if os.name != &#x27;posix&#x27;:
186	            return
187	
188	        self._local_path = FileLock.lock_folder_path(relative_path)
189	        self._lock_file_name = DIR_LOCK_FILE_NAME
190	        self._lock_file_path = self._local_path / self._lock_file_name
191	        self._mode = fcntl.LOCK_EX if mode == &#x27;w&#x27; else fcntl.LOCK_SH
192	
193	        if self._lock_file_path.is_file() is False:
194	            self._local_path.mkdir(parents=True, exist_ok=True)
195	            try:
196	                self._lock_file_path.write_text(&#x27;&#x27;)
197	            except Exception:
198	                pass
199	
200	    def __enter__(self):
201	        if os.name != &#x27;posix&#x27;:
202	            return
203	
204	        try:
205	            # On at least some systems, LOCK_EX can only be used if the file
206	            # descriptor refers to a file opened for writing.
207	            self._lock_fd = os.open(self._lock_file_path, os.O_RDWR | os.O_CREAT)
208	            fcntl.lockf(self._lock_fd, self._mode | fcntl.LOCK_NB)
209	        except (ValueError, FileNotFoundError):
210	            # file probably was deleted between open and lock
211	            logger.error(f&#x27;Cant accure lock on {self._local_path}&#x27;)
212	            raise FileNotFoundError
213	        except BlockingIOError:
</pre>
</div>


</div>
</div>

<div id="issue-323">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/interfaces/storage/fs.py" target="_blank">/mindsdb/mindsdb/interfaces/storage/fs.py</a><br>
    <b>Line number: </b>224<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
208	            fcntl.lockf(self._lock_fd, self._mode | fcntl.LOCK_NB)
209	        except (ValueError, FileNotFoundError):
210	            # file probably was deleted between open and lock
211	            logger.error(f&#x27;Cant accure lock on {self._local_path}&#x27;)
212	            raise FileNotFoundError
213	        except BlockingIOError:
214	            logger.error(f&#x27;Directory is locked by another process: {self._local_path}&#x27;)
215	            fcntl.lockf(self._lock_fd, self._mode)
216	
217	    def __exit__(self, exc_type, exc_value, traceback):
218	        if os.name != &#x27;posix&#x27;:
219	            return
220	
221	        try:
222	            fcntl.lockf(self._lock_fd, fcntl.LOCK_UN)
223	            os.close(self._lock_fd)
224	        except Exception:
225	            pass
226	
227	
228	class S3FSStore(BaseFSStore):
229	    &quot;&quot;&quot;Storage that stores files in amazon s3
230	    &quot;&quot;&quot;
231	
232	    dt_format = &#x27;%d.%m.%y %H:%M:%S.%f&#x27;
233	
234	    def __init__(self):
235	        super().__init__()
236	        if &#x27;s3_credentials&#x27; in self.config[&#x27;permanent_storage&#x27;]:
237	            self.s3 = boto3.client(&#x27;s3&#x27;, **self.config[&#x27;permanent_storage&#x27;][&#x27;s3_credentials&#x27;])
238	        else:
239	            self.s3 = boto3.client(&#x27;s3&#x27;)
240	        self.bucket = self.config[&#x27;permanent_storage&#x27;][&#x27;bucket&#x27;]
</pre>
</div>


</div>
</div>

<div id="issue-324">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2021-11-30_17c3d2384711_init.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2021-11-30_17c3d2384711_init.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
156	    migration_script = produce_migrations(mc, target_metadata)
157	
158	    autogen_context = api.AutogenContext(
159	        mc, autogenerate=True
160	    )
161	
162	    # Seems to be the only way to apply changes to the database
163	    template_args = {}
164	    render._render_python_into_templatevars(
165	        autogen_context, migration_script, template_args
166	    )
167	
168	    code = template_args[&#x27;upgrades&#x27;]
169	    code = code.replace(&#x27;\n    &#x27;, &#x27;\n&#x27;)
170	    logger.info(&#x27;\nPerforming database changes:&#x27;)
171	    logger.info(code)
172	    exec(code)
173	
174	
175	def downgrade():
176	
177	    # We don&#x27;t know state to downgrade
178	    raise NotImplementedError()
</pre>
</div>


</div>
</div>

<div id="issue-325">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2022-05-25_d74c189b87e6_predictor_integration.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2022-05-25_d74c189b87e6_predictor_integration.py</a><br>
    <b>Line number: </b>69<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
53	        if &#x27;source_type&#x27; not in data:
54	            continue
55	        integration_name = data.get(&#x27;source_type&#x27;)
56	        if isinstance(integration_name, str) is False or len(integration_name) == 0:
57	            continue
58	        if integration_name.lower() == &#x27;file&#x27;:
59	            integration_name = &#x27;files&#x27;
60	
61	        fetch_data_query = data.get(&#x27;source&#x27;)
62	        if isinstance(fetch_data_query, dict) is False:
63	            continue
64	
65	        if integration_name == &#x27;files&#x27;:
66	            file_name = fetch_data_query.get(&#x27;mindsdb_file_name&#x27;)
67	            if isinstance(file_name, str) is False or len(file_name) == 0:
68	                continue
69	            fetch_data_query = f&#x27;select * from {file_name}&#x27;
70	        else:
71	            fetch_data_query = fetch_data_query.get(&#x27;query&#x27;)
72	            if isinstance(fetch_data_query, str) is False or len(fetch_data_query) == 0:
73	                continue
74	
75	        query = &#x27;&#x27;&#x27;
76	            select id
77	            from integration
78	            where company_id = :company_id and lower(name) = lower(:name)
79	        &#x27;&#x27;&#x27;
80	        if row[&#x27;company_id&#x27;] is None:
81	            query = &#x27;&#x27;&#x27;
82	                select id
83	                from integration
84	                where company_id is null and lower(name) = lower(:name)
</pre>
</div>


</div>
</div>

<div id="issue-326">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2022-08-29_473e8f239481_straighten.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2022-08-29_473e8f239481_straighten.py</a><br>
    <b>Line number: </b>62<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
46	            &#x27;engine&#x27;,
47	            existing_type=sa.VARCHAR(),
48	            nullable=False
49	        )
50	
51	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
52	        batch_op.drop_constraint(&#x27;unique_predictor_name_company_id&#x27;, type_=&#x27;unique&#x27;)
53	
54	    conn.execute(text(&#x27;&#x27;&#x27;
55	        delete from semaphor
56	    &#x27;&#x27;&#x27;))
57	    session.commit()
58	
59	    try:
60	        with op.batch_alter_table(&#x27;semaphor&#x27;, schema=None) as batch_op:
61	            batch_op.create_unique_constraint(&#x27;uniq_const&#x27;, [&#x27;entity_type&#x27;, &#x27;entity_id&#x27;])
62	    except Exception:
63	        pass
64	
65	
66	def downgrade():
67	    with op.batch_alter_table(&#x27;semaphor&#x27;, schema=None) as batch_op:
68	        batch_op.drop_constraint(&#x27;uniq_const&#x27;, type_=&#x27;unique&#x27;)
69	
70	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
71	        batch_op.create_unique_constraint(&#x27;unique_predictor_name_company_id&#x27;, [&#x27;name&#x27;, &#x27;company_id&#x27;])
72	
73	    with op.batch_alter_table(&#x27;integration&#x27;, schema=None) as batch_op:
74	        batch_op.alter_column(
75	            &#x27;engine&#x27;,
76	            existing_type=sa.VARCHAR(),
77	            nullable=True
78	        )
</pre>
</div>


</div>
</div>

<div id="issue-327">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2022-12-26_459218b0844c_fix_unique_constraint.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2022-12-26_459218b0844c_fix_unique_constraint.py</a><br>
    <b>Line number: </b>22<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
6	
7	&quot;&quot;&quot;
8	from alembic import op
9	
10	revision = &#x27;459218b0844c&#x27;
11	down_revision = &#x27;d429095b570f&#x27;
12	branch_labels = None
13	depends_on = None
14	
15	
16	def upgrade():
17	
18	    # try - for sqlite database
19	    try:
20	        op.execute(&quot;ALTER TABLE project DROP CONSTRAINT IF EXISTS unique_integration_name_company_id&quot;)
21	        op.execute(&quot;ALTER TABLE project DROP CONSTRAINT IF EXISTS unique_project_name_company_id&quot;)
22	    except Exception:
23	        pass
24	
25	    try:
26	        with op.batch_alter_table(&#x27;project&#x27;, schema=None) as batch_op:
27	            batch_op.create_unique_constraint(&#x27;unique_project_name_company_id&#x27;, [&#x27;name&#x27;, &#x27;company_id&#x27;])
28	    except Exception:
29	        pass
30	
31	
32	def downgrade():
33	    # do nothing
34	    ...
</pre>
</div>


</div>
</div>

<div id="issue-328">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2022-12-26_459218b0844c_fix_unique_constraint.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2022-12-26_459218b0844c_fix_unique_constraint.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
12	branch_labels = None
13	depends_on = None
14	
15	
16	def upgrade():
17	
18	    # try - for sqlite database
19	    try:
20	        op.execute(&quot;ALTER TABLE project DROP CONSTRAINT IF EXISTS unique_integration_name_company_id&quot;)
21	        op.execute(&quot;ALTER TABLE project DROP CONSTRAINT IF EXISTS unique_project_name_company_id&quot;)
22	    except Exception:
23	        pass
24	
25	    try:
26	        with op.batch_alter_table(&#x27;project&#x27;, schema=None) as batch_op:
27	            batch_op.create_unique_constraint(&#x27;unique_project_name_company_id&#x27;, [&#x27;name&#x27;, &#x27;company_id&#x27;])
28	    except Exception:
29	        pass
30	
31	
32	def downgrade():
33	    # do nothing
34	    ...
</pre>
</div>


</div>
</div>

<div id="issue-329">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2023-12-25_4b3c9d63e89c_predictor_index.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2023-12-25_4b3c9d63e89c_predictor_index.py</a><br>
    <b>Line number: </b>24<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
8	from alembic import op
9	import sqlalchemy as sa  # noqa
10	
11	
12	# revision identifiers, used by Alembic.
13	revision = &#x27;4b3c9d63e89c&#x27;
14	down_revision = &#x27;c67822e96833&#x27;
15	branch_labels = None
16	depends_on = None
17	
18	
19	def upgrade():
20	    with op.batch_alter_table(&#x27;agent_skills&#x27;, schema=None) as batch_op:
21	        try:
22	            batch_op.create_foreign_key(&#x27;agent_skills_agent_id_fk&#x27;, &#x27;agents&#x27;, [&#x27;agent_id&#x27;], [&#x27;id&#x27;])
23	            batch_op.create_foreign_key(&#x27;agent_skills_skill_id_fk&#x27;, &#x27;skills&#x27;, [&#x27;skill_id&#x27;], [&#x27;id&#x27;])
24	        except Exception:
25	            pass
26	
27	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
28	        batch_op.create_index(
29	            &#x27;predictor_index&#x27;,
30	            [&#x27;company_id&#x27;, &#x27;name&#x27;, &#x27;version&#x27;, &#x27;active&#x27;, &#x27;deleted_at&#x27;],
31	            unique=True
32	        )
33	
34	
35	def downgrade():
36	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
37	        batch_op.drop_index(&#x27;predictor_index&#x27;)
38	
39	    with op.batch_alter_table(&#x27;agent_skills&#x27;, schema=None) as batch_op:
40	        try:
</pre>
</div>


</div>
</div>

<div id="issue-330">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/migrations/versions/2023-12-25_4b3c9d63e89c_predictor_index.py" target="_blank">/mindsdb/mindsdb/migrations/versions/2023-12-25_4b3c9d63e89c_predictor_index.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
27	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
28	        batch_op.create_index(
29	            &#x27;predictor_index&#x27;,
30	            [&#x27;company_id&#x27;, &#x27;name&#x27;, &#x27;version&#x27;, &#x27;active&#x27;, &#x27;deleted_at&#x27;],
31	            unique=True
32	        )
33	
34	
35	def downgrade():
36	    with op.batch_alter_table(&#x27;predictor&#x27;, schema=None) as batch_op:
37	        batch_op.drop_index(&#x27;predictor_index&#x27;)
38	
39	    with op.batch_alter_table(&#x27;agent_skills&#x27;, schema=None) as batch_op:
40	        try:
41	            batch_op.drop_constraint(&#x27;agent_skills_agent_id_fk&#x27;, type_=&#x27;foreignkey&#x27;)
42	            batch_op.drop_constraint(&#x27;agent_skills_skill_id_fk&#x27;, type_=&#x27;foreignkey&#x27;)
43	        except Exception:
44	            pass
</pre>
</div>


</div>
</div>

<div id="issue-331">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/cache.py" target="_blank">/mindsdb/mindsdb/utilities/cache.py</a><br>
    <b>Line number: </b>97<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
81	
82	
83	def str_checksum(obj: str):
84	    checksum = hashlib.sha256(obj.encode()).hexdigest()
85	    return checksum
86	
87	
88	class BaseCache(ABC):
89	    def __init__(self, max_size=None, serializer=None):
90	        self.config = Config()
91	        if max_size is None:
92	            max_size = self.config[&quot;cache&quot;].get(&quot;max_size&quot;, 50)
93	        self.max_size = max_size
94	        if serializer is None:
95	            serializer_module = self.config[&quot;cache&quot;].get(&#x27;serializer&#x27;)
96	            if serializer_module == &#x27;pickle&#x27;:
97	                import pickle as s_module
98	            else:
99	                import dill as s_module
100	            self.serializer = s_module
101	
102	    # default functions
103	
104	    def set_df(self, name, df):
105	        return self.set(name, df)
106	
107	    def get_df(self, name):
108	        return self.get(name)
109	
110	    def serialize(self, value):
111	        return self.serializer.dumps(value)
112	
</pre>
</div>


</div>
</div>

<div id="issue-332">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with dill module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/cache.py" target="_blank">/mindsdb/mindsdb/utilities/cache.py</a><br>
    <b>Line number: </b>99<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
83	def str_checksum(obj: str):
84	    checksum = hashlib.sha256(obj.encode()).hexdigest()
85	    return checksum
86	
87	
88	class BaseCache(ABC):
89	    def __init__(self, max_size=None, serializer=None):
90	        self.config = Config()
91	        if max_size is None:
92	            max_size = self.config[&quot;cache&quot;].get(&quot;max_size&quot;, 50)
93	        self.max_size = max_size
94	        if serializer is None:
95	            serializer_module = self.config[&quot;cache&quot;].get(&#x27;serializer&#x27;)
96	            if serializer_module == &#x27;pickle&#x27;:
97	                import pickle as s_module
98	            else:
99	                import dill as s_module
100	            self.serializer = s_module
101	
102	    # default functions
103	
104	    def set_df(self, name, df):
105	        return self.set(name, df)
106	
107	    def get_df(self, name):
108	        return self.get(name)
109	
110	    def serialize(self, value):
111	        return self.serializer.dumps(value)
112	
113	    def deserialize(self, value):
114	        return self.serializer.loads(value)
</pre>
</div>


</div>
</div>

<div id="issue-333">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/cache.py" target="_blank">/mindsdb/mindsdb/utilities/cache.py</a><br>
    <b>Line number: </b>172<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
156	        df.to_pickle(path)
157	        self.clear_old_cache()
158	
159	    def set(self, name, value):
160	        path = self.file_path(name)
161	        value = self.serialize(value)
162	
163	        with open(path, &#x27;wb&#x27;) as fd:
164	            fd.write(value)
165	        self.clear_old_cache()
166	
167	    def get_df(self, name):
168	        path = self.file_path(name)
169	        with FileLock(self.path):
170	            if not os.path.exists(path):
171	                return None
172	            value = pd.read_pickle(path)
173	        return value
174	
175	    def get(self, name):
176	        path = self.file_path(name)
177	
178	        with FileLock(self.path):
179	            if not os.path.exists(path):
180	                return None
181	            with open(path, &#x27;rb&#x27;) as fd:
182	                value = fd.read()
183	        value = self.deserialize(value)
184	        return value
185	
186	    def delete(self, name):
187	        path = self.file_path(name)
</pre>
</div>


</div>
</div>

<div id="issue-334">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/config.py" target="_blank">/mindsdb/mindsdb/utilities/config.py</a><br>
    <b>Line number: </b>114<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
98	
99	        for path_name in paths:
100	            create_directory(paths[path_name])
101	
102	        ml_queue = {
103	            &#x27;type&#x27;: &#x27;local&#x27;
104	        }
105	
106	        if os.environ.get(&#x27;MINDSDB_ML_QUEUE_TYPE&#x27;, &#x27;&#x27;).lower() == &#x27;redis&#x27;:
107	            ml_queue[&#x27;type&#x27;] = &#x27;redis&#x27;
108	            ml_queue[&#x27;host&#x27;] = os.environ.get(&#x27;MINDSDB_ML_QUEUE_HOST&#x27;, &#x27;localhost&#x27;)
109	            ml_queue[&#x27;port&#x27;] = int(os.environ.get(&#x27;MINDSDB_ML_QUEUE_PORT&#x27;, 6379))
110	            ml_queue[&#x27;db&#x27;] = int(os.environ.get(&#x27;MINDSDB_ML_QUEUE_DB&#x27;, 0))
111	            ml_queue[&#x27;username&#x27;] = os.environ.get(&#x27;MINDSDB_ML_QUEUE_USERNAME&#x27;)
112	            ml_queue[&#x27;password&#x27;] = os.environ.get(&#x27;MINDSDB_ML_QUEUE_PASSWORD&#x27;)
113	
114	        api_host = &quot;127.0.0.1&quot; if not self.use_docker_env else &quot;0.0.0.0&quot;
115	        self._default_config = {
116	            &#x27;permanent_storage&#x27;: {
117	                &#x27;location&#x27;: &#x27;local&#x27;
118	            },
119	            &#x27;storage_dir&#x27;: os.environ[&#x27;MINDSDB_STORAGE_DIR&#x27;],
120	            &#x27;paths&#x27;: paths,
121	            &#x27;auth&#x27;: {
122	                &#x27;http_auth_enabled&#x27;: False,
123	                &#x27;username&#x27;: &#x27;mindsdb&#x27;,
124	                &#x27;password&#x27;: &#x27;&#x27;
125	            },
126	            &quot;log&quot;: {
127	                &quot;level&quot;: {
128	                    &quot;console&quot;: &quot;INFO&quot;,
129	                    &quot;file&quot;: &quot;DEBUG&quot;,
</pre>
</div>


</div>
</div>

<div id="issue-335">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/functions.py" target="_blank">/mindsdb/mindsdb/utilities/functions.py</a><br>
    <b>Line number: </b>67<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
51	def cast_row_types(row, field_types):
52	    &#x27;&#x27;&#x27;
53	    &#x27;&#x27;&#x27;
54	    keys = [x for x in row.keys() if x in field_types]
55	    for key in keys:
56	        t = field_types[key]
57	        if t == &#x27;Timestamp&#x27; and isinstance(row[key], (int, float)):
58	            timestamp = datetime.datetime.utcfromtimestamp(row[key])
59	            row[key] = timestamp.strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;)
60	        elif t == &#x27;Date&#x27; and isinstance(row[key], (int, float)):
61	            timestamp = datetime.datetime.utcfromtimestamp(row[key])
62	            row[key] = timestamp.strftime(&#x27;%Y-%m-%d&#x27;)
63	        elif t == &#x27;Int&#x27; and isinstance(row[key], (int, float, str)):
64	            try:
65	                logger.debug(f&#x27;cast {row[key]} to {int(row[key])}&#x27;)
66	                row[key] = int(row[key])
67	            except Exception:
68	                pass
69	
70	
71	def mark_process(name: str, custom_mark: str = None) -&gt; Callable:
72	    def mark_process_wrapper(func: Callable) -&gt; Callable:
73	        @wraps(func)
74	        def wrapper(*args, **kwargs):
75	            if custom_mark is None:
76	                mark = create_process_mark(name)
77	            else:
78	                mark = set_process_mark(name, custom_mark)
79	
80	            try:
81	                return func(*args, **kwargs)
82	            finally:
83	                delete_process_mark(name, mark)
</pre>
</div>


</div>
</div>

<div id="issue-336">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/ml_task_queue/consumer.py" target="_blank">/mindsdb/mindsdb/utilities/ml_task_queue/consumer.py</a><br>
    <b>Line number: </b>234<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
218	        while self._stop_event.is_set() is False:
219	            self._ready_event.wait(timeout=1)
220	            if self._ready_event.is_set() is False:
221	                continue
222	            self._ready_event.clear()
223	            threading.Thread(target=self._listen).start()
224	        self.stop()
225	
226	    def stop(self) -&gt; None:
227	        &quot;&quot;&quot; Stop all executing threads
228	        &quot;&quot;&quot;
229	        self._stop_event.set()
230	        for thread in (*self._listen_message_threads, self._collect_cpu_stat_thread):
231	            try:
232	                if thread.is_alive():
233	                    thread.join()
234	            except Exception:
235	                pass
236	
237	
238	@mark_process(name=&#x27;internal&#x27;, custom_mark=&#x27;ml_task_consumer&#x27;)
239	def start(verbose: bool) -&gt; None:
240	    &quot;&quot;&quot; Create task queue consumer and start listen the queue
241	    &quot;&quot;&quot;
242	    consumer = MLTaskConsumer()
243	    signal.signal(signal.SIGTERM, lambda _x, _y: consumer.stop())
244	    try:
245	        consumer.run()
246	    except Exception as e:
247	        consumer.stop()
248	        logger.error(f&#x27;Got exception: {e}&#x27;, flush=True)
249	        raise
250	    finally:
</pre>
</div>


</div>
</div>

<div id="issue-337">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/ml_task_queue/producer.py" target="_blank">/mindsdb/mindsdb/utilities/ml_task_queue/producer.py</a><br>
    <b>Line number: </b>1<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import pickle
2	
3	from walrus import Database
4	from pandas import DataFrame
5	
6	from mindsdb.utilities.context import context as ctx
7	from mindsdb.utilities.config import Config
8	from mindsdb.utilities.ml_task_queue.utils import RedisKey, to_bytes
9	from mindsdb.utilities.ml_task_queue.task import Task
10	from mindsdb.utilities.ml_task_queue.base import BaseRedisQueue
11	from mindsdb.utilities.ml_task_queue.const import (
12	    TASKS_STREAM_NAME,
13	    ML_TASK_TYPE,
14	    ML_TASK_STATUS
15	)
16	from mindsdb.utilities import log
17	
18	logger = log.getLogger(__name__)
19	
20	
21	class MLTaskProducer(BaseRedisQueue):
22	    &quot;&quot;&quot; Interface around the redis for putting tasks to the queue
23	
24	        Attributes:
25	            db (Redis): database object
26	            stream
27	            cache
28	            pubsub
29	    &quot;&quot;&quot;
30	
31	    def __init__(self) -&gt; None:
32	        config = Config().get(&#x27;ml_task_queue&#x27;, {})
</pre>
</div>


</div>
</div>

<div id="issue-338">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with pickle module.<br>
    <b>Test ID:</b> B403<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/ml_task_queue/utils.py" target="_blank">/mindsdb/mindsdb/utilities/ml_task_queue/utils.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b403-import-pickle</a><br>

<div class="code">
<pre>
1	import time
2	import pickle
3	import socket
4	import threading
5	
6	from walrus import Database
7	from redis.exceptions import ConnectionError as RedisConnectionError
8	
9	from mindsdb.utilities.context import context as ctx
10	from mindsdb.utilities.ml_task_queue.const import ML_TASK_STATUS
11	
12	
13	def to_bytes(obj: object) -&gt; bytes:
14	    &quot;&quot;&quot; dump object into bytes
15	
16	        Args:
17	            obj (object): object to convert
18	
19	        Returns:
20	            bytes
21	    &quot;&quot;&quot;
22	    return pickle.dumps(obj, protocol=5)
23	
24	
25	def from_bytes(b: bytes) -&gt; object:
26	    &quot;&quot;&quot; load object from bytes
27	
28	        Args:
29	            b (bytes):
30	
31	        Returns:
32	            object
</pre>
</div>


</div>
</div>

<div id="issue-339">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.<br>
    <b>Test ID:</b> B301<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/502.html" target="_blank">CWE-502</a><br>
    <b>File: </b><a href="/mindsdb/mindsdb/utilities/ml_task_queue/utils.py" target="_blank">/mindsdb/mindsdb/utilities/ml_task_queue/utils.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b301-pickle</a><br>

<div class="code">
<pre>
18	
19	        Returns:
20	            bytes
21	    &quot;&quot;&quot;
22	    return pickle.dumps(obj, protocol=5)
23	
24	
25	def from_bytes(b: bytes) -&gt; object:
26	    &quot;&quot;&quot; load object from bytes
27	
28	        Args:
29	            b (bytes):
30	
31	        Returns:
32	            object
33	    &quot;&quot;&quot;
34	    return pickle.loads(b)
35	
36	
37	def wait_redis_ping(db: Database, timeout: int = 30):
38	    &quot;&quot;&quot; Wait when redis.ping return True
39	
40	        Args:
41	            db (Database): redis db object
42	            timeout (int): seconds to wait for success ping
43	
44	        Raises:
45	            RedisConnectionError: if `ping` did not return `True` within `timeout` seconds
46	    &quot;&quot;&quot;
47	    end_time = time.time() + timeout
48	    while time.time() &lt;= end_time:
49	        try:
</pre>
</div>


</div>
</div>

<div id="issue-340">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/setup.py" target="_blank">/mindsdb/setup.py</a><br>
    <b>Line number: </b>28<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
12	DEFAULT_PIP_EXTRAS = [
13	    line.split(&quot;#&quot;)[0].rstrip()
14	    for line in open(&quot;default_handlers.txt&quot;).read().splitlines()
15	    if not line.strip().startswith(&quot;#&quot;)
16	]
17	
18	
19	class Deps:
20	    pkgs = []
21	    pkgs_exclude = [&quot;tests&quot;, &quot;tests.*&quot;]
22	    new_links = []
23	    extras = {}
24	
25	
26	about = {}
27	with open(&quot;mindsdb/__about__.py&quot;) as fp:
28	    exec(fp.read(), about)
29	
30	
31	with open(&quot;README.md&quot;, &quot;r&quot;, encoding=&quot;utf8&quot;) as fh:
32	    long_description = fh.read()
33	
34	
35	def expand_requirements_links(requirements: list) -&gt; list:
36	    &quot;&quot;&quot;Expand requirements that contain links to other requirement files&quot;&quot;&quot;
37	    to_add = []
38	    to_remove = []
39	
40	    for requirement in requirements:
41	        if requirement.startswith(&quot;-r &quot;):
42	            if os.path.exists(requirement.split()[1]):
43	                with open(requirement.split()[1]) as fh:
</pre>
</div>


</div>
</div>

<div id="issue-341">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_apache_doris_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_apache_doris_handler.py</a><br>
    <b>Line number: </b>91<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
75	                &quot;replication_allocation&quot; = &quot;tag.location.default: 1&quot;
76	            );
77	        &quot;&quot;&quot;)
78	        self.check_valid_response(res)
79	        tables = self.get_table_names(handler)
80	        assert new_table in tables, f&quot;expected to have {new_table} in database, but got: {tables}&quot;
81	
82	    def test_drop_table(self, handler):
83	        drop_table = &quot;test_mdb&quot;
84	        res = handler.native_query(f&quot;DROP TABLE IF EXISTS {drop_table}&quot;)
85	        self.check_valid_response(res)
86	        tables = self.get_table_names(handler)
87	        assert drop_table not in tables
88	
89	    def test_select_query(self, handler):
90	        limit = 3
91	        query = f&quot;SELECT * FROM example_tbl LIMIT {limit}&quot;
92	        res = handler.query(query)
93	        self.check_valid_response(res)
94	        got_rows = res.data_frame.shape[0]
95	        want_rows = limit
96	        assert got_rows == want_rows, f&quot;expected to have {want_rows} rows in response but got: {got_rows}&quot;
97	
98	    def test_select_where_query(self, handler):
99	        want_rows = 5
100	        query = &quot;SELECT * FROM example_tbl WHERE sex = 0&quot;
101	        res = handler.query(query)
102	        self.check_valid_response(res)
103	        got_rows = res.data_frame.shape[0]
104	        assert got_rows == want_rows, f&quot;expected to have {want_rows} rows in response but got: {got_rows}&quot;
</pre>
</div>


</div>
</div>

<div id="issue-342">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
30	        components_columns = self.handler.get_columns(table_name=&#x27;components&#x27;)
31	        assert type(status_pages_columns) is not RESPONSE_TYPE.ERROR
32	        assert type(components_columns) is not RESPONSE_TYPE.ERROR
33	
34	    def test_4_select_status_pages(self):
35	        query = &#x27;&#x27;&#x27;SELECT *
36	                    FROM mindsdb_instatus.status_pages&#x27;&#x27;&#x27;
37	        self.assertTrue(self.handler.native_query(query))
38	
39	    def test_5_select_status_pages_by_conditions(self):
40	        query = &#x27;&#x27;&#x27;SELECT name, status, subdomain
41	                    FROM mindsdb_instatus.status_pages
42	                    WHERE id = &quot;clo3xshsk1114842hkn377y3lrap&quot;&#x27;&#x27;&#x27;
43	        self.assertTrue(self.handler.native_query(query))
44	
45	    def test_6_insert_status_pages(self):
46	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.status_pages (email, name, subdomain, components, logoUrl) VALUES (&#x27;{os.environ.get(&#x27;EMAIL_ID&#x27;)}&#x27;, &#x27;mindsdb&#x27;, &#x27;somtirtha-roy&#x27;, &#x27;[&quot;Website&quot;, &quot;App&quot;, &quot;API&quot;]&#x27;, &#x27;https://instatus.com/sample.png&#x27;)&#x27;&#x27;&#x27;
47	        try:
48	            self.assertTrue(self.handler.native_query(query))
49	        except Exception as e:
50	            error_message = str(e)
51	            if &quot;This subdomain is taken by another status page&quot; in error_message:
52	                print(&quot;Subdomain is already taken. Choose a different one.&quot;)
53	
54	    def test_7_update_status_pages(self):
55	        # update the row with the id obtained
56	        query = f&#x27;&#x27;&#x27;UPDATE mindsdb_instatus.status_pages
57	                SET logoUrl = &#x27;https://instatus.com/sample.png&#x27;,
58	                    faviconUrl = &#x27;https://instatus.com/favicon-32x32.png&#x27;,
59	                    websiteUrl = &#x27;https://instatus.com&#x27;,
60	                    language = &#x27;en&#x27;,
61	                    useLargeHeader = true,
</pre>
</div>


</div>
</div>

<div id="issue-343">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>56<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
40	        query = &#x27;&#x27;&#x27;SELECT name, status, subdomain
41	                    FROM mindsdb_instatus.status_pages
42	                    WHERE id = &quot;clo3xshsk1114842hkn377y3lrap&quot;&#x27;&#x27;&#x27;
43	        self.assertTrue(self.handler.native_query(query))
44	
45	    def test_6_insert_status_pages(self):
46	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.status_pages (email, name, subdomain, components, logoUrl) VALUES (&#x27;{os.environ.get(&#x27;EMAIL_ID&#x27;)}&#x27;, &#x27;mindsdb&#x27;, &#x27;somtirtha-roy&#x27;, &#x27;[&quot;Website&quot;, &quot;App&quot;, &quot;API&quot;]&#x27;, &#x27;https://instatus.com/sample.png&#x27;)&#x27;&#x27;&#x27;
47	        try:
48	            self.assertTrue(self.handler.native_query(query))
49	        except Exception as e:
50	            error_message = str(e)
51	            if &quot;This subdomain is taken by another status page&quot; in error_message:
52	                print(&quot;Subdomain is already taken. Choose a different one.&quot;)
53	
54	    def test_7_update_status_pages(self):
55	        # update the row with the id obtained
56	        query = f&#x27;&#x27;&#x27;UPDATE mindsdb_instatus.status_pages
57	                SET logoUrl = &#x27;https://instatus.com/sample.png&#x27;,
58	                    faviconUrl = &#x27;https://instatus.com/favicon-32x32.png&#x27;,
59	                    websiteUrl = &#x27;https://instatus.com&#x27;,
60	                    language = &#x27;en&#x27;,
61	                    useLargeHeader = true,
62	                    brandColor = &#x27;#111&#x27;,
63	                    okColor = &#x27;#33B17E&#x27;,
64	                    disruptedColor = &#x27;#FF8C03&#x27;,
65	                    degradedColor = &#x27;#ECC94B&#x27;,
66	                    downColor = &#x27;#DC123D&#x27;,
67	                    noticeColor = &#x27;#70808F&#x27;,
68	                    unknownColor = &#x27;#DFE0E1&#x27;,
69	                    googleAnalytics = &#x27;UA-00000000-1&#x27;,
70	                    subscribeBySms = true,
71	                    smsService = &#x27;twilio&#x27;,
72	                    twilioSid = &#x27;YOUR_TWILIO_SID&#x27;,
73	                    twilioToken = &#x27;YOUR_TWILIO_TOKEN&#x27;,
74	                    twilioSender = &#x27;YOUR_TWILIO_SENDER&#x27;,
75	                    nexmoKey = null,
76	                    nexmoSecret = null,
77	                    nexmoSender = null,
78	                    htmlInMeta = null,
79	                    htmlAboveHeader = null,
80	                    htmlBelowHeader = null,
81	                    htmlAboveFooter = null,
82	                    htmlBelowFooter = null,
83	                    htmlBelowSummary = null,
84	                    cssGlobal = null,
85	                    launchDate = null,
86	                    dateFormat = &#x27;MMMMMM d, yyyy&#x27;,
87	                    dateFormatShort = &#x27;MMM yyyy&#x27;,
88	                    timeFormat = &#x27;p&#x27;,
89	                    private = false,
90	                    useAllowList = false,
91	                    translations = &#x27;{{
92	                    &quot;name&quot;: {{
93	                        &quot;fr&quot;: &quot;nasa&quot;
94	                        }}
95	                    }}&#x27;
96	                WHERE id = &quot;{self.pageId}&quot;&#x27;&#x27;&#x27;
97	        self.assertTrue(self.handler.native_query(query))
98	
99	    def test_8_select_components(self):
100	        query = f&#x27;&#x27;&#x27;SELECT *
101	                    FROM mindsdb_instatus.components
102	                    WHERE page_id = &#x27;{self.pageId}&#x27;;&#x27;&#x27;&#x27;
103	        self.assertTrue(self.handler.native_query(query))
104	
105	    def test_9_select_components_by_conditions(self):
106	        query = f&#x27;&#x27;&#x27;SELECT *
107	                    FROM mindsdb_instatus.components
108	                    WHERE page_id = &#x27;{self.pageId}&#x27;
109	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
110	        self.assertTrue(self.handler.native_query(query))
111	
</pre>
</div>


</div>
</div>

<div id="issue-344">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>100<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
84	                    cssGlobal = null,
85	                    launchDate = null,
86	                    dateFormat = &#x27;MMMMMM d, yyyy&#x27;,
87	                    dateFormatShort = &#x27;MMM yyyy&#x27;,
88	                    timeFormat = &#x27;p&#x27;,
89	                    private = false,
90	                    useAllowList = false,
91	                    translations = &#x27;{{
92	                    &quot;name&quot;: {{
93	                        &quot;fr&quot;: &quot;nasa&quot;
94	                        }}
95	                    }}&#x27;
96	                WHERE id = &quot;{self.pageId}&quot;&#x27;&#x27;&#x27;
97	        self.assertTrue(self.handler.native_query(query))
98	
99	    def test_8_select_components(self):
100	        query = f&#x27;&#x27;&#x27;SELECT *
101	                    FROM mindsdb_instatus.components
102	                    WHERE page_id = &#x27;{self.pageId}&#x27;;&#x27;&#x27;&#x27;
103	        self.assertTrue(self.handler.native_query(query))
104	
105	    def test_9_select_components_by_conditions(self):
106	        query = f&#x27;&#x27;&#x27;SELECT *
107	                    FROM mindsdb_instatus.components
108	                    WHERE page_id = &#x27;{self.pageId}&#x27;
109	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
110	        self.assertTrue(self.handler.native_query(query))
111	
112	    def test_10_insert_components(self):
113	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.components (page_id, name, description, status, order, showUptime, grouped, translations_name_in_fr, translations_desc_in_fr)
114	                    VALUES (
115	                        &#x27;{self.pageId}&#x27;,
116	                        &#x27;Test component&#x27;,
117	                        &#x27;Testing&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-345">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>106<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
90	                    useAllowList = false,
91	                    translations = &#x27;{{
92	                    &quot;name&quot;: {{
93	                        &quot;fr&quot;: &quot;nasa&quot;
94	                        }}
95	                    }}&#x27;
96	                WHERE id = &quot;{self.pageId}&quot;&#x27;&#x27;&#x27;
97	        self.assertTrue(self.handler.native_query(query))
98	
99	    def test_8_select_components(self):
100	        query = f&#x27;&#x27;&#x27;SELECT *
101	                    FROM mindsdb_instatus.components
102	                    WHERE page_id = &#x27;{self.pageId}&#x27;;&#x27;&#x27;&#x27;
103	        self.assertTrue(self.handler.native_query(query))
104	
105	    def test_9_select_components_by_conditions(self):
106	        query = f&#x27;&#x27;&#x27;SELECT *
107	                    FROM mindsdb_instatus.components
108	                    WHERE page_id = &#x27;{self.pageId}&#x27;
109	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
110	        self.assertTrue(self.handler.native_query(query))
111	
112	    def test_10_insert_components(self):
113	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.components (page_id, name, description, status, order, showUptime, grouped, translations_name_in_fr, translations_desc_in_fr)
114	                    VALUES (
115	                        &#x27;{self.pageId}&#x27;,
116	                        &#x27;Test component&#x27;,
117	                        &#x27;Testing&#x27;,
118	                        &#x27;OPERATIONAL&#x27;,
119	                        6,
120	                        true,
121	                        false,
122	                        &quot;Composant de test&quot;,
123	                        &quot;En test&quot;
124	                    );&#x27;&#x27;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-346">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>113<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
97	        self.assertTrue(self.handler.native_query(query))
98	
99	    def test_8_select_components(self):
100	        query = f&#x27;&#x27;&#x27;SELECT *
101	                    FROM mindsdb_instatus.components
102	                    WHERE page_id = &#x27;{self.pageId}&#x27;;&#x27;&#x27;&#x27;
103	        self.assertTrue(self.handler.native_query(query))
104	
105	    def test_9_select_components_by_conditions(self):
106	        query = f&#x27;&#x27;&#x27;SELECT *
107	                    FROM mindsdb_instatus.components
108	                    WHERE page_id = &#x27;{self.pageId}&#x27;
109	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
110	        self.assertTrue(self.handler.native_query(query))
111	
112	    def test_10_insert_components(self):
113	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.components (page_id, name, description, status, order, showUptime, grouped, translations_name_in_fr, translations_desc_in_fr)
114	                    VALUES (
115	                        &#x27;{self.pageId}&#x27;,
116	                        &#x27;Test component&#x27;,
117	                        &#x27;Testing&#x27;,
118	                        &#x27;OPERATIONAL&#x27;,
119	                        6,
120	                        true,
121	                        false,
122	                        &quot;Composant de test&quot;,
123	                        &quot;En test&quot;
124	                    );&#x27;&#x27;&#x27;
125	        self.assertTrue(self.handler.native_query(query))
126	
127	    def test_11_update_components(self):
128	        query = f&#x27;&#x27;&#x27;UPDATE mindsdb_instatus.components
129	                    SET
130	                        name = &#x27;Test component 4&#x27;,
131	                        description = &#x27;Test test test&#x27;,
132	                        status = &#x27;OPERATIONAL&#x27;,
133	                        order = 6,
134	                        showUptime = true,
135	                        grouped = false,
136	                        translations_name_in_fr = &quot;Composant de test 4&quot;,
137	                        translations_desc_in_fr = &quot;Test test test&quot;
138	                    WHERE page_id = &#x27;{self.pageId}&#x27;
139	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-347">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_instatus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_instatus_handler.py</a><br>
    <b>Line number: </b>128<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
112	    def test_10_insert_components(self):
113	        query = f&#x27;&#x27;&#x27;INSERT INTO mindsdb_instatus.components (page_id, name, description, status, order, showUptime, grouped, translations_name_in_fr, translations_desc_in_fr)
114	                    VALUES (
115	                        &#x27;{self.pageId}&#x27;,
116	                        &#x27;Test component&#x27;,
117	                        &#x27;Testing&#x27;,
118	                        &#x27;OPERATIONAL&#x27;,
119	                        6,
120	                        true,
121	                        false,
122	                        &quot;Composant de test&quot;,
123	                        &quot;En test&quot;
124	                    );&#x27;&#x27;&#x27;
125	        self.assertTrue(self.handler.native_query(query))
126	
127	    def test_11_update_components(self):
128	        query = f&#x27;&#x27;&#x27;UPDATE mindsdb_instatus.components
129	                    SET
130	                        name = &#x27;Test component 4&#x27;,
131	                        description = &#x27;Test test test&#x27;,
132	                        status = &#x27;OPERATIONAL&#x27;,
133	                        order = 6,
134	                        showUptime = true,
135	                        grouped = false,
136	                        translations_name_in_fr = &quot;Composant de test 4&quot;,
137	                        translations_desc_in_fr = &quot;Test test test&quot;
138	                    WHERE page_id = &#x27;{self.pageId}&#x27;
139	                    AND component_id = &#x27;{self.componentId}&#x27;;&#x27;&#x27;&#x27;
140	        self.assertTrue(self.handler.native_query(query))
141	
142	
143	if __name__ == &#x27;__main__&#x27;:
144	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-348">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_intercom_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_intercom_handler.py</a><br>
    <b>Line number: </b>54<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
38	
39	    def test_7_insert_article(self):
40	        query = &#x27;&#x27;&#x27;INSERT INTO myintercom.articles (title, description, body, author_id, state, parent_id, parent_type)
41	                VALUES (&#x27;Thanks for everything&#x27;,
42	                &#x27;Description of the Article&#x27;,
43	                &#x27;Body of the Article&#x27;,
44	                6840572,
45	                &#x27;published&#x27;,
46	                6801839,
47	                &#x27;collection&#x27;
48	                );&#x27;&#x27;&#x27;
49	        self.assertTrue(self.handler.native_query(query=query))
50	
51	    def test_8_update_article(self):
52	        df = pd.DataFrame(self.handler.call_intercom_api(endpoint=&#x27;/articles&#x27;, params={&#x27;page&#x27;: 1, &#x27;per_page&#x27;: 1})[&#x27;data&#x27;][0])
53	        _id = df[&#x27;id&#x27;][0]
54	        query = f&#x27;&#x27;&#x27;UPDATE myintercom.articles
55	                SET title = &#x27;Christmas is here!&#x27;,
56	                    body = &#x27;&lt;p&gt;New gifts in store for the jolly season&lt;/p&gt;&#x27;
57	                WHERE id = {_id};&#x27;&#x27;&#x27;
58	        self.assertTrue(self.handler.native_query(query=query))
59	
60	
61	if __name__ == &#x27;__main__&#x27;:
62	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-349">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>65<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
49	        sql = &quot;&quot;&quot;
50	            SELECT * FROM lightdash_datasource.user_ability;
51	        &quot;&quot;&quot;
52	        self.run_sql(sql)
53	        sql = &quot;&quot;&quot;
54	            SELECT * FROM lightdash_datasource.org;
55	        &quot;&quot;&quot;
56	        self.run_sql(sql)
57	        sql = &quot;&quot;&quot;
58	            SELECT * FROM lightdash_datasource.org_projects;
59	        &quot;&quot;&quot;
60	        self.run_sql(sql)
61	        sql = &quot;&quot;&quot;
62	            SELECT * FROM lightdash_datasource.org_members;
63	        &quot;&quot;&quot;
64	        self.run_sql(sql)
65	        sql = f&quot;&quot;&quot;
66	            SELECT * FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
67	        &quot;&quot;&quot;
68	        self.run_sql(sql)
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-350">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>69<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
53	        sql = &quot;&quot;&quot;
54	            SELECT * FROM lightdash_datasource.org;
55	        &quot;&quot;&quot;
56	        self.run_sql(sql)
57	        sql = &quot;&quot;&quot;
58	            SELECT * FROM lightdash_datasource.org_projects;
59	        &quot;&quot;&quot;
60	        self.run_sql(sql)
61	        sql = &quot;&quot;&quot;
62	            SELECT * FROM lightdash_datasource.org_members;
63	        &quot;&quot;&quot;
64	        self.run_sql(sql)
65	        sql = f&quot;&quot;&quot;
66	            SELECT * FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
67	        &quot;&quot;&quot;
68	        self.run_sql(sql)
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-351">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>73<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
57	        sql = &quot;&quot;&quot;
58	            SELECT * FROM lightdash_datasource.org_projects;
59	        &quot;&quot;&quot;
60	        self.run_sql(sql)
61	        sql = &quot;&quot;&quot;
62	            SELECT * FROM lightdash_datasource.org_members;
63	        &quot;&quot;&quot;
64	        self.run_sql(sql)
65	        sql = f&quot;&quot;&quot;
66	            SELECT * FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
67	        &quot;&quot;&quot;
68	        self.run_sql(sql)
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-352">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>77<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
61	        sql = &quot;&quot;&quot;
62	            SELECT * FROM lightdash_datasource.org_members;
63	        &quot;&quot;&quot;
64	        self.run_sql(sql)
65	        sql = f&quot;&quot;&quot;
66	            SELECT * FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
67	        &quot;&quot;&quot;
68	        self.run_sql(sql)
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-353">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>81<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
65	        sql = f&quot;&quot;&quot;
66	            SELECT * FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
67	        &quot;&quot;&quot;
68	        self.run_sql(sql)
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-354">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>85<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
69	        sql = f&quot;&quot;&quot;
70	            SELECT * FROM lightdash_datasource.warehouse_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
71	        &quot;&quot;&quot;
72	        self.run_sql(sql)
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-355">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>89<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
73	        sql = f&quot;&quot;&quot;
74	            SELECT * FROM lightdash_datasource.dbt_connection WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
75	        &quot;&quot;&quot;
76	        self.run_sql(sql)
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-356">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>93<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
77	        sql = f&quot;&quot;&quot;
78	            SELECT * FROM lightdash_datasource.dbt_env_vars WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
79	        &quot;&quot;&quot;
80	        self.run_sql(sql)
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-357">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>97<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
81	        sql = f&quot;&quot;&quot;
82	            SELECT * FROM lightdash_datasource.charts WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
83	        &quot;&quot;&quot;
84	        self.run_sql(sql)
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-358">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>101<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
85	        sql = f&quot;&quot;&quot;
86	            SELECT * FROM lightdash_datasource.spaces WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
87	        &quot;&quot;&quot;
88	        self.run_sql(sql)
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-359">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>105<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
89	        sql = f&quot;&quot;&quot;
90	            SELECT * FROM lightdash_datasource.access WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
91	        &quot;&quot;&quot;
92	        self.run_sql(sql)
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-360">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>109<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
93	        sql = f&quot;&quot;&quot;
94	            SELECT * FROM lightdash_datasource.validation WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
95	        &quot;&quot;&quot;
96	        self.run_sql(sql)
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-361">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>113<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
97	        sql = f&quot;&quot;&quot;
98	            SELECT * FROM lightdash_datasource.dashboards WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
99	        &quot;&quot;&quot;
100	        self.run_sql(sql)
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-362">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>117<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
101	        sql = f&quot;&quot;&quot;
102	            SELECT * FROM lightdash_datasource.queries WHERE project_uuid=&#x27;{self.project_uuid}&#x27; AND space_uuid=&#x27;{self.space_uuid}&#x27;;
103	        &quot;&quot;&quot;
104	        self.run_sql(sql)
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
</pre>
</div>


</div>
</div>

<div id="issue-363">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>121<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
105	        sql = f&quot;&quot;&quot;
106	            SELECT * FROM lightdash_datasource.chart_history WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27;;
107	        &quot;&quot;&quot;
108	        self.run_sql(sql)
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
135	        &quot;&quot;&quot;
136	        self.run_sql(sql)
137	
138	    def test_complex_select(self):
</pre>
</div>


</div>
</div>

<div id="issue-364">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>125<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
109	        sql = f&quot;&quot;&quot;
110	            SELECT * FROM lightdash_datasource.chart_config WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
111	        &quot;&quot;&quot;
112	        self.run_sql(sql)
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
135	        &quot;&quot;&quot;
136	        self.run_sql(sql)
137	
138	    def test_complex_select(self):
139	        sql = &quot;&quot;&quot;
140	            SELECT firstName, lastName FROM lightdash_datasource.user;
141	        &quot;&quot;&quot;
142	        assert self.run_sql(sql).shape[1] == 2
</pre>
</div>


</div>
</div>

<div id="issue-365">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>129<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
113	        sql = f&quot;&quot;&quot;
114	            SELECT * FROM lightdash_datasource.chart_additional_metrics WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
115	        &quot;&quot;&quot;
116	        self.run_sql(sql)
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
135	        &quot;&quot;&quot;
136	        self.run_sql(sql)
137	
138	    def test_complex_select(self):
139	        sql = &quot;&quot;&quot;
140	            SELECT firstName, lastName FROM lightdash_datasource.user;
141	        &quot;&quot;&quot;
142	        assert self.run_sql(sql).shape[1] == 2
143	        sql = f&quot;&quot;&quot;
144	            SELECT name FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
145	        &quot;&quot;&quot;
146	        assert self.run_sql(sql).shape[1] == 1
</pre>
</div>


</div>
</div>

<div id="issue-366">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>133<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
117	        sql = f&quot;&quot;&quot;
118	            SELECT * FROM lightdash_datasource.chart_table_calculations WHERE chart_uuid=&#x27;{self.chart_uuid}&#x27; AND version_uuid=&#x27;{self.chart_version_uuid}&#x27;;
119	        &quot;&quot;&quot;
120	        self.run_sql(sql)
121	        sql = f&quot;&quot;&quot;
122	            SELECT * FROM lightdash_datasource.scheduler_logs WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
123	        &quot;&quot;&quot;
124	        self.run_sql(sql)
125	        sql = f&quot;&quot;&quot;
126	            SELECT * FROM lightdash_datasource.scheduler WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
135	        &quot;&quot;&quot;
136	        self.run_sql(sql)
137	
138	    def test_complex_select(self):
139	        sql = &quot;&quot;&quot;
140	            SELECT firstName, lastName FROM lightdash_datasource.user;
141	        &quot;&quot;&quot;
142	        assert self.run_sql(sql).shape[1] == 2
143	        sql = f&quot;&quot;&quot;
144	            SELECT name FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
145	        &quot;&quot;&quot;
146	        assert self.run_sql(sql).shape[1] == 1
</pre>
</div>


</div>
</div>

<div id="issue-367">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_lightdash_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_lightdash_handler.py</a><br>
    <b>Line number: </b>143<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
127	        &quot;&quot;&quot;
128	        self.run_sql(sql)
129	        sql = f&quot;&quot;&quot;
130	            SELECT * FROM lightdash_datasource.scheduler_jobs WHERE scheduler_uuid=&#x27;{self.scheduler_uuid}&#x27;;
131	        &quot;&quot;&quot;
132	        self.run_sql(sql)
133	        sql = f&quot;&quot;&quot;
134	            SELECT * FROM lightdash_datasource.scheduler_job_status WHERE job_id=&#x27;{self.job_id}&#x27;;
135	        &quot;&quot;&quot;
136	        self.run_sql(sql)
137	
138	    def test_complex_select(self):
139	        sql = &quot;&quot;&quot;
140	            SELECT firstName, lastName FROM lightdash_datasource.user;
141	        &quot;&quot;&quot;
142	        assert self.run_sql(sql).shape[1] == 2
143	        sql = f&quot;&quot;&quot;
144	            SELECT name FROM lightdash_datasource.project_table WHERE project_uuid=&#x27;{self.project_uuid}&#x27;;
145	        &quot;&quot;&quot;
146	        assert self.run_sql(sql).shape[1] == 1
</pre>
</div>


</div>
</div>

<div id="issue-368">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_mariadb_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_mariadb_handler.py</a><br>
    <b>Line number: </b>151<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
135	    def test_create_table(self, handler):
136	        new_table = &quot;test_mdb&quot;
137	        res = handler.native_query(f&quot;CREATE TABLE IF NOT EXISTS {new_table} (test_col INT)&quot;)
138	        self.check_valid_response(res)
139	        tables = self.get_table_names(handler)
140	        assert new_table in tables, f&quot;expected to have {new_table} in database, but got: {tables}&quot;
141	
142	    def test_drop_table(self, handler):
143	        drop_table = &quot;test_md&quot;
144	        res = handler.native_query(f&quot;DROP TABLE IF EXISTS {drop_table}&quot;)
145	        self.check_valid_response(res)
146	        tables = self.get_table_names(handler)
147	        assert drop_table not in tables
148	
149	    def test_select_query(self, handler):
150	        limit = 5
151	        query = f&quot;SELECT * FROM rentals WHERE number_of_rooms = 2 LIMIT {limit}&quot;
152	        res = handler.query(query)
153	        self.check_valid_response(res)
154	        got_rows = res.data_frame.shape[0]
155	        want_rows = limit
156	        assert got_rows == want_rows, f&quot;expected to have {want_rows} rows in response but got: {got_rows}&quot;
157	
158	    def check_valid_response(self, res):
159	        if res.resp_type == RESPONSE_TYPE.TABLE:
160	            assert res.data_frame is not None, &quot;expected to have some data, but got None&quot;
161	        assert res.error_code == 0, f&quot;expected to have zero error_code, but got {res.error_code}&quot;
162	        assert res.error_message is None, f&quot;expected to have None in error message, but got {res.error_message}&quot;
163	
164	    def get_table_names(self, handler):
165	        res = handler.get_tables()
166	        tables = res.data_frame
</pre>
</div>


</div>
</div>

<div id="issue-369">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'password'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_milvus_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_milvus_handler.py</a><br>
    <b>Line number: </b>58<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
42	        self.run_sql(&quot;&quot;&quot;
43	            CREATE DATABASE milvus_test_auto_id
44	            WITH
45	              ENGINE = &#x27;milvus&#x27;,
46	              PARAMETERS = {
47	                &quot;alias&quot;: &quot;default&quot;,
48	                &quot;host&quot;: &quot;127.0.0.1&quot;,
49	                &quot;port&quot;: 19530,
50	                &quot;user&quot;: &quot;username&quot;,
51	                &quot;password&quot;: &quot;password&quot;,
52	                &quot;create_embedding_dim&quot;: 3,
53	                &quot;create_auto_id&quot;: true
54	            };
55	        &quot;&quot;&quot;)
56	
57	    def drop_table(self, table_name):
58	        pymilvus.connections.connect(
59	            alias=&quot;default&quot;,
60	            host=&quot;127.0.0.1&quot;,
61	            port=19530,
62	            user=&quot;username&quot;,
63	            password=&quot;password&quot;,
64	        )
65	        pymilvus.utility.drop_collection(table_name)
66	
67	    @pytest.mark.xfail(reason=&quot;create table for vectordatabase is not well supported&quot;)
68	    @patch(&quot;mindsdb.integrations.handlers.postgres_handler.Handler&quot;)
69	    def test_create_table(self, postgres_handler_mock):
70	        # create an empty table
71	        sql = &quot;&quot;&quot;
72	            CREATE TABLE milvus_test.testable;
73	        &quot;&quot;&quot;
74	        self.run_sql(sql)
75	        # create a table with the schema definition is not allowed
76	        sql = &quot;&quot;&quot;
77	            CREATE TABLE milvus_test.testable (
78	                id int,
79	                metadata text,
</pre>
</div>


</div>
</div>

<div id="issue-370">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>34<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
18	    def run_sql(self, sql):
19	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
20	        assert ret.error_code is None
21	        if ret.data is not None:
22	            return ret.data.to_df()
23	
24	    def setup_method(self):
25	        super().setup_method()
26	        self.test_package_name = &quot;handlebars&quot;
27	        self.run_sql(&quot;&quot;&quot;
28	            CREATE DATABASE npm_test
29	            WITH ENGINE = &quot;npm&quot;;
30	        &quot;&quot;&quot;)
31	
32	    def test_basic_select_from(self):
33	        # Select from metadata table
34	        sql = f&quot;&quot;&quot;
35	            SELECT * FROM npm_test.metadata WHERE package=&#x27;{self.test_package_name}&#x27;;
36	        &quot;&quot;&quot;
37	        assert self.run_sql(sql).shape[0] == 1
38	
39	        # Select from maintainers table
40	        sql = f&quot;&quot;&quot;
41	            SELECT * FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
42	        &quot;&quot;&quot;
43	        self.run_sql(sql)
44	
45	        # Select from keywords table
46	        sql = f&quot;&quot;&quot;
47	            SELECT * FROM npm_test.keywords WHERE package=&#x27;{self.test_package_name}&#x27;;
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
</pre>
</div>


</div>
</div>

<div id="issue-371">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
24	    def setup_method(self):
25	        super().setup_method()
26	        self.test_package_name = &quot;handlebars&quot;
27	        self.run_sql(&quot;&quot;&quot;
28	            CREATE DATABASE npm_test
29	            WITH ENGINE = &quot;npm&quot;;
30	        &quot;&quot;&quot;)
31	
32	    def test_basic_select_from(self):
33	        # Select from metadata table
34	        sql = f&quot;&quot;&quot;
35	            SELECT * FROM npm_test.metadata WHERE package=&#x27;{self.test_package_name}&#x27;;
36	        &quot;&quot;&quot;
37	        assert self.run_sql(sql).shape[0] == 1
38	
39	        # Select from maintainers table
40	        sql = f&quot;&quot;&quot;
41	            SELECT * FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
42	        &quot;&quot;&quot;
43	        self.run_sql(sql)
44	
45	        # Select from keywords table
46	        sql = f&quot;&quot;&quot;
47	            SELECT * FROM npm_test.keywords WHERE package=&#x27;{self.test_package_name}&#x27;;
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
52	        sql = f&quot;&quot;&quot;
53	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
</pre>
</div>


</div>
</div>

<div id="issue-372">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
30	        &quot;&quot;&quot;)
31	
32	    def test_basic_select_from(self):
33	        # Select from metadata table
34	        sql = f&quot;&quot;&quot;
35	            SELECT * FROM npm_test.metadata WHERE package=&#x27;{self.test_package_name}&#x27;;
36	        &quot;&quot;&quot;
37	        assert self.run_sql(sql).shape[0] == 1
38	
39	        # Select from maintainers table
40	        sql = f&quot;&quot;&quot;
41	            SELECT * FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
42	        &quot;&quot;&quot;
43	        self.run_sql(sql)
44	
45	        # Select from keywords table
46	        sql = f&quot;&quot;&quot;
47	            SELECT * FROM npm_test.keywords WHERE package=&#x27;{self.test_package_name}&#x27;;
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
52	        sql = f&quot;&quot;&quot;
53	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
58	        sql = f&quot;&quot;&quot;
59	            SELECT * FROM npm_test.dev_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
60	        &quot;&quot;&quot;
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
</pre>
</div>


</div>
</div>

<div id="issue-373">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
36	        &quot;&quot;&quot;
37	        assert self.run_sql(sql).shape[0] == 1
38	
39	        # Select from maintainers table
40	        sql = f&quot;&quot;&quot;
41	            SELECT * FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
42	        &quot;&quot;&quot;
43	        self.run_sql(sql)
44	
45	        # Select from keywords table
46	        sql = f&quot;&quot;&quot;
47	            SELECT * FROM npm_test.keywords WHERE package=&#x27;{self.test_package_name}&#x27;;
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
52	        sql = f&quot;&quot;&quot;
53	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
58	        sql = f&quot;&quot;&quot;
59	            SELECT * FROM npm_test.dev_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
60	        &quot;&quot;&quot;
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
64	        sql = f&quot;&quot;&quot;
65	            SELECT * FROM npm_test.optional_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
66	        &quot;&quot;&quot;
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
</pre>
</div>


</div>
</div>

<div id="issue-374">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>58<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
42	        &quot;&quot;&quot;
43	        self.run_sql(sql)
44	
45	        # Select from keywords table
46	        sql = f&quot;&quot;&quot;
47	            SELECT * FROM npm_test.keywords WHERE package=&#x27;{self.test_package_name}&#x27;;
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
52	        sql = f&quot;&quot;&quot;
53	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
58	        sql = f&quot;&quot;&quot;
59	            SELECT * FROM npm_test.dev_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
60	        &quot;&quot;&quot;
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
64	        sql = f&quot;&quot;&quot;
65	            SELECT * FROM npm_test.optional_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
66	        &quot;&quot;&quot;
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
70	        sql = f&quot;&quot;&quot;
71	            SELECT * FROM npm_test.github_stats WHERE package=&#x27;{self.test_package_name}&#x27;;
72	        &quot;&quot;&quot;
73	        assert self.run_sql(sql).shape[0] == 1
74	
75	    def test_complex_select(self):
</pre>
</div>


</div>
</div>

<div id="issue-375">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>64<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
48	        &quot;&quot;&quot;
49	        self.run_sql(sql)
50	
51	        # Select from dependencies table
52	        sql = f&quot;&quot;&quot;
53	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
58	        sql = f&quot;&quot;&quot;
59	            SELECT * FROM npm_test.dev_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
60	        &quot;&quot;&quot;
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
64	        sql = f&quot;&quot;&quot;
65	            SELECT * FROM npm_test.optional_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
66	        &quot;&quot;&quot;
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
70	        sql = f&quot;&quot;&quot;
71	            SELECT * FROM npm_test.github_stats WHERE package=&#x27;{self.test_package_name}&#x27;;
72	        &quot;&quot;&quot;
73	        assert self.run_sql(sql).shape[0] == 1
74	
75	    def test_complex_select(self):
76	        # Select email maintainers table
77	        sql = f&quot;&quot;&quot;
78	            SELECT email FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
79	        &quot;&quot;&quot;
80	        assert self.run_sql(sql).shape[1] == 1
81	
</pre>
</div>


</div>
</div>

<div id="issue-376">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>70<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
54	        &quot;&quot;&quot;
55	        self.run_sql(sql)
56	
57	        # Select from dev_dependencies table
58	        sql = f&quot;&quot;&quot;
59	            SELECT * FROM npm_test.dev_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
60	        &quot;&quot;&quot;
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
64	        sql = f&quot;&quot;&quot;
65	            SELECT * FROM npm_test.optional_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
66	        &quot;&quot;&quot;
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
70	        sql = f&quot;&quot;&quot;
71	            SELECT * FROM npm_test.github_stats WHERE package=&#x27;{self.test_package_name}&#x27;;
72	        &quot;&quot;&quot;
73	        assert self.run_sql(sql).shape[0] == 1
74	
75	    def test_complex_select(self):
76	        # Select email maintainers table
77	        sql = f&quot;&quot;&quot;
78	            SELECT email FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
79	        &quot;&quot;&quot;
80	        assert self.run_sql(sql).shape[1] == 1
81	
82	        # Select single dependency
83	        sql = f&quot;&quot;&quot;
84	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27; LIMIT 1;
85	        &quot;&quot;&quot;
86	        assert self.run_sql(sql).shape[0] == 1
</pre>
</div>


</div>
</div>

<div id="issue-377">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>77<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
61	        self.run_sql(sql)
62	
63	        # Select from optional_dependencies table
64	        sql = f&quot;&quot;&quot;
65	            SELECT * FROM npm_test.optional_dependencies WHERE package=&#x27;{self.test_package_name}&#x27;;
66	        &quot;&quot;&quot;
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
70	        sql = f&quot;&quot;&quot;
71	            SELECT * FROM npm_test.github_stats WHERE package=&#x27;{self.test_package_name}&#x27;;
72	        &quot;&quot;&quot;
73	        assert self.run_sql(sql).shape[0] == 1
74	
75	    def test_complex_select(self):
76	        # Select email maintainers table
77	        sql = f&quot;&quot;&quot;
78	            SELECT email FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
79	        &quot;&quot;&quot;
80	        assert self.run_sql(sql).shape[1] == 1
81	
82	        # Select single dependency
83	        sql = f&quot;&quot;&quot;
84	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27; LIMIT 1;
85	        &quot;&quot;&quot;
86	        assert self.run_sql(sql).shape[0] == 1
</pre>
</div>


</div>
</div>

<div id="issue-378">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_npm_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_npm_handler.py</a><br>
    <b>Line number: </b>83<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
67	        self.run_sql(sql)
68	
69	        # Select from github_stats table
70	        sql = f&quot;&quot;&quot;
71	            SELECT * FROM npm_test.github_stats WHERE package=&#x27;{self.test_package_name}&#x27;;
72	        &quot;&quot;&quot;
73	        assert self.run_sql(sql).shape[0] == 1
74	
75	    def test_complex_select(self):
76	        # Select email maintainers table
77	        sql = f&quot;&quot;&quot;
78	            SELECT email FROM npm_test.maintainers WHERE package=&#x27;{self.test_package_name}&#x27;;
79	        &quot;&quot;&quot;
80	        assert self.run_sql(sql).shape[1] == 1
81	
82	        # Select single dependency
83	        sql = f&quot;&quot;&quot;
84	            SELECT * FROM npm_test.dependencies WHERE package=&#x27;{self.test_package_name}&#x27; LIMIT 1;
85	        &quot;&quot;&quot;
86	        assert self.run_sql(sql).shape[0] == 1
</pre>
</div>


</div>
</div>

<div id="issue-379">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>41<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
25	        super().setup_method()
26	        self.app_id = os.environ.get(&quot;SYMBL_APP_ID&quot;)
27	        self.app_secret = os.environ.get(&quot;SYMBL_APP_SECRET&quot;)
28	        self.run_sql(f&quot;&quot;&quot;
29	            CREATE DATABASE mindsdb_symbl
30	                    WITH ENGINE = &#x27;symbl&#x27;,
31	                    PARAMETERS = {
32	                    &quot;app_id&quot;: &#x27;{self.app_id}&#x27;,
33	                    &quot;app_secret&quot;: &#x27;{self.app_secret}&#x27;
34	                    };
35	        &quot;&quot;&quot;)
36	
37	    def test_basic_select_from(self):
38	
39	        conversation_id = &quot;5682305049034752&quot;
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-380">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>44<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
28	        self.run_sql(f&quot;&quot;&quot;
29	            CREATE DATABASE mindsdb_symbl
30	                    WITH ENGINE = &#x27;symbl&#x27;,
31	                    PARAMETERS = {
32	                    &quot;app_id&quot;: &#x27;{self.app_id}&#x27;,
33	                    &quot;app_secret&quot;: &#x27;{self.app_secret}&#x27;
34	                    };
35	        &quot;&quot;&quot;)
36	
37	    def test_basic_select_from(self):
38	
39	        conversation_id = &quot;5682305049034752&quot;
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
57	        self.run_sql(sql)
</pre>
</div>


</div>
</div>

<div id="issue-381">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>47<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
31	                    PARAMETERS = {
32	                    &quot;app_id&quot;: &#x27;{self.app_id}&#x27;,
33	                    &quot;app_secret&quot;: &#x27;{self.app_secret}&#x27;
34	                    };
35	        &quot;&quot;&quot;)
36	
37	    def test_basic_select_from(self):
38	
39	        conversation_id = &quot;5682305049034752&quot;
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
57	        self.run_sql(sql)
</pre>
</div>


</div>
</div>

<div id="issue-382">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>50<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
34	                    };
35	        &quot;&quot;&quot;)
36	
37	    def test_basic_select_from(self):
38	
39	        conversation_id = &quot;5682305049034752&quot;
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
57	        self.run_sql(sql)
</pre>
</div>


</div>
</div>

<div id="issue-383">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>53<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
37	    def test_basic_select_from(self):
38	
39	        conversation_id = &quot;5682305049034752&quot;
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
57	        self.run_sql(sql)
</pre>
</div>


</div>
</div>

<div id="issue-384">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_symbl_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_symbl_handler.py</a><br>
    <b>Line number: </b>56<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
40	
41	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_messages where conversation_id=&quot;{conversation_id}&quot;&#x27;
42	        self.run_sql(sql)
43	
44	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_topics where conversation_id=&quot;{conversation_id}&quot;&#x27;
45	        self.run_sql(sql)
46	
47	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_questions where conversation_id=&quot;{conversation_id}&quot;&#x27;
48	        self.run_sql(sql)
49	
50	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_analytics where conversation_id=&quot;{conversation_id}&quot;&#x27;
51	        self.run_sql(sql)
52	
53	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_action_items where conversation_id=&quot;{conversation_id}&quot;&#x27;
54	        self.run_sql(sql)
55	
56	        sql = f&#x27;SELECT * FROM mindsdb_symbl.get_follow_ups where conversation_id=&quot;{conversation_id}&quot;&#x27;
57	        self.run_sql(sql)
</pre>
</div>


</div>
</div>

<div id="issue-385">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_webz_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_webz_handler.py</a><br>
    <b>Line number: </b>107<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
91	                &quot;q&quot;: &quot;language:english&quot;,
92	                &quot;sort&quot;: &quot;relevancy&quot;,
93	                &quot;order&quot;: &quot;default&quot;,
94	                &quot;size&quot;: 10,
95	            },
96	        )
97	        self.assertEqual(results.shape[1], len(COLUMNS_POST))
98	        for column in COLUMNS_POST:
99	            self.assertEqual(first_result[column], SAMPLE_POST.get(column, None))
100	
101	    def test_select_with_targets(self):
102	        webz_handler = Mock(WebzHandler)
103	        webz_handler.call_webz_api.return_value = pd.DataFrame([SAMPLE_POST])
104	        posts_table = WebzPostsTable(webz_handler)
105	        target_field = &quot;thread__uuid&quot;
106	        query = parse_sql(
107	            f&quot;SELECT {target_field} FROM posts&quot;,
108	            dialect=&quot;mindsdb&quot;,
109	        )
110	        results = posts_table.select(query)
111	        first_result = results.iloc[0]
112	        webz_handler.call_webz_api.assert_called_once_with(
113	            method_name=&quot;posts&quot;,
114	            params={},
115	        )
116	        self.assertEqual(results.shape[1], 1)
117	        self.assertEqual(first_result[target_field], SAMPLE_POST[target_field])
118	
119	    def test_select_with_invalid_order_by_field_fails(self):
120	        webz_handler = Mock(WebzHandler)
121	        webz_handler.call_webz_api.return_value = pd.DataFrame([SAMPLE_POST])
122	        posts_table = WebzPostsTable(webz_handler)
</pre>
</div>


</div>
</div>

<div id="issue-386">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/handler_tests/test_webz_handler.py" target="_blank">/mindsdb/tests/handler_tests/test_webz_handler.py</a><br>
    <b>Line number: </b>209<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
193	                &quot;q&quot;: &quot;language:english&quot;,
194	                &quot;sort&quot;: &quot;reviews_count&quot;,
195	                &quot;order&quot;: &quot;default&quot;,
196	                &quot;size&quot;: 10,
197	            },
198	        )
199	        self.assertEqual(results.shape[1], len(COLUMNS_REVIEW))
200	        for column in COLUMNS_REVIEW:
201	            self.assertEqual(first_result[column], SAMPLE_REVIEW.get(column, None))
202	
203	    def test_select_with_targets(self):
204	        webz_handler = Mock(WebzHandler)
205	        webz_handler.call_webz_api.return_value = pd.DataFrame([SAMPLE_REVIEW])
206	        reviews_table = WebzReviewsTable(webz_handler)
207	        target_field = &quot;uuid&quot;
208	        query = parse_sql(
209	            f&quot;SELECT {target_field} FROM reviews&quot;,
210	            dialect=&quot;mindsdb&quot;,
211	        )
212	        results = reviews_table.select(query)
213	        first_result = results.iloc[0]
214	        webz_handler.call_webz_api.assert_called_once_with(
215	            method_name=&quot;reviews&quot;,
216	            params={},
217	        )
218	        self.assertEqual(results.shape[1], 1)
219	        self.assertEqual(first_result[target_field], SAMPLE_REVIEW[target_field])
220	
221	    def test_select_with_invalid_order_by_field_fails(self):
222	        webz_handler = Mock(WebzHandler)
223	        webz_handler.call_webz_api.return_value = pd.DataFrame([SAMPLE_REVIEW])
224	        reviews_table = WebzReviewsTable(webz_handler)
</pre>
</div>


</div>
</div>

<div id="issue-387">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/conftest.py" target="_blank">/mindsdb/tests/integration_tests/flows/conftest.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import os
2	import sys
3	import time
4	import json
5	import shutil
6	import subprocess
7	from pathlib import Path
8	
9	import docker
10	import pytest
11	import psutil
12	import requests
13	import netifaces
14	import pandas as pd
15	from walrus import Database
16	
17	from mindsdb.utilities import log
18	from mindsdb.utilities.ps import get_child_pids
19	
20	
21	logger = log.getLogger(__name__)
22	
23	HTTP_API_ROOT = &#x27;http://127.0.0.1:47334/api&#x27;
24	USE_PERSISTENT_STORAGE = bool(int(os.getenv(&#x27;USE_PERSISTENT_STORAGE&#x27;) or &quot;0&quot;))
25	TEST_CONFIG = os.path.dirname(os.path.realpath(__file__)) + &#x27;/config/config.json&#x27;
26	TEMP_DIR = Path(__file__).parent.absolute().joinpath(&#x27;../../&#x27;).joinpath(
27	    f&#x27;temp/test_storage_{int(time.time()*1000)}/&#x27; if not USE_PERSISTENT_STORAGE else &#x27;temp/test_storage/&#x27;
28	).resolve()
29	TEMP_DIR.mkdir(parents=True, exist_ok=True)
30	CONFIG_PATH = TEMP_DIR.joinpath(&#x27;config.json&#x27;)
31	
32	
</pre>
</div>


</div>
</div>

<div id="issue-388">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/conftest.py" target="_blank">/mindsdb/tests/integration_tests/flows/conftest.py</a><br>
    <b>Line number: </b>44<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
28	).resolve()
29	TEMP_DIR.mkdir(parents=True, exist_ok=True)
30	CONFIG_PATH = TEMP_DIR.joinpath(&#x27;config.json&#x27;)
31	
32	
33	def remove_container(container_name: str):
34	    &quot;&quot;&quot; Stop and remove docker contaier
35	
36	        Args:
37	            container_name (str): name of conteiner to remove
38	    &quot;&quot;&quot;
39	    try:
40	        docker_client = docker.from_env()
41	        container = docker_client.containers.get(container_name)
42	        try:
43	            container.kill()
44	        except Exception:
45	            pass
46	        container.remove()
47	    except docker.errors.NotFound:
48	        pass
49	
50	
51	def make_test_csv(name, data):
52	    test_csv_path = TEMP_DIR.joinpath(f&#x27;{name}.csv&#x27;).resolve()
53	    df = pd.DataFrame(data)
54	    df.to_csv(test_csv_path, index=False)
55	    return str(test_csv_path)
56	
57	
58	def docker_inet_ip():
59	    &quot;&quot;&quot;Get ip of docker0 interface.&quot;&quot;&quot;
60	    if &quot;docker0&quot; not in netifaces.interfaces():
</pre>
</div>


</div>
</div>

<div id="issue-389">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/conftest.py" target="_blank">/mindsdb/tests/integration_tests/flows/conftest.py</a><br>
    <b>Line number: </b>138<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
122	        f.write(json.dumps(config))
123	
124	    os.environ[&#x27;CHECK_FOR_UPDATES&#x27;] = &#x27;0&#x27;
125	    cmd = [&#x27;python3&#x27;, &#x27;-m&#x27;, &#x27;mindsdb&#x27;, f&#x27;--api={api_str}&#x27;, f&#x27;--config={config_path}&#x27;, &#x27;--verbose&#x27;]
126	    if getattr(request.module, &quot;USE_GUI&quot;, False) is False:
127	        cmd.append(&#x27;--no_studio&#x27;)
128	    if getattr(request.module, &quot;ML_TASK_QUEUE_CONSUMER&quot;, False) is True:
129	        cmd.append(&#x27;--ml_task_queue_consumer&#x27;)
130	    timeout = 90
131	
132	    print(&#x27;Starting mindsdb process!&#x27;)
133	    app = subprocess.Popen(
134	        cmd,
135	        close_fds=True,
136	        stdout=sys.stdout,
137	        stderr=sys.stderr,
138	        shell=False
139	    )
140	    threshold = time.time() + timeout
141	
142	    while True:
143	        try:
144	            host = config[&quot;api&quot;][&quot;http&quot;][&quot;host&quot;]
145	            port = config[&quot;api&quot;][&quot;http&quot;][&quot;port&quot;]
146	            r = requests.get(f&quot;http://{host}:{port}/api/util/ping&quot;)
147	            r.raise_for_status()
148	            break
149	        except Exception:
150	            time.sleep(1)
151	            if time.time() &gt; threshold:
152	                raise Exception(f&quot;unable to launch mindsdb app in {timeout} seconds&quot;)
153	
154	    def cleanup():
155	        print(&quot;Stopping Application&quot;)
156	        for ch in get_child_pids(app.pid):
157	            try:
158	                ch.kill()
159	            except psutil.NoSuchProcess:
</pre>
</div>


</div>
</div>

<div id="issue-390">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/conftest.py" target="_blank">/mindsdb/tests/integration_tests/flows/conftest.py</a><br>
    <b>Line number: </b>146<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
130	    timeout = 90
131	
132	    print(&#x27;Starting mindsdb process!&#x27;)
133	    app = subprocess.Popen(
134	        cmd,
135	        close_fds=True,
136	        stdout=sys.stdout,
137	        stderr=sys.stderr,
138	        shell=False
139	    )
140	    threshold = time.time() + timeout
141	
142	    while True:
143	        try:
144	            host = config[&quot;api&quot;][&quot;http&quot;][&quot;host&quot;]
145	            port = config[&quot;api&quot;][&quot;http&quot;][&quot;port&quot;]
146	            r = requests.get(f&quot;http://{host}:{port}/api/util/ping&quot;)
147	            r.raise_for_status()
148	            break
149	        except Exception:
150	            time.sleep(1)
151	            if time.time() &gt; threshold:
152	                raise Exception(f&quot;unable to launch mindsdb app in {timeout} seconds&quot;)
153	
154	    def cleanup():
155	        print(&quot;Stopping Application&quot;)
156	        for ch in get_child_pids(app.pid):
157	            try:
158	                ch.kill()
159	            except psutil.NoSuchProcess:
160	                pass
161	        app.kill()
</pre>
</div>


</div>
</div>

<div id="issue-391">
<div class="issue-block issue-sev-low">
    <b>try_except_pass: </b> Try, Except, Pass detected.<br>
    <b>Test ID:</b> B110<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/703.html" target="_blank">CWE-703</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/conftest.py" target="_blank">/mindsdb/tests/integration_tests/flows/conftest.py</a><br>
    <b>Line number: </b>341<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b110_try_except_pass.html</a><br>

<div class="code">
<pre>
325	        remove_container(container_name)
326	
327	        docker_client.containers.run(
328	            image_name,
329	            detach=True,
330	            network=&#x27;host&#x27;,
331	            name=container_name
332	        )
333	
334	        # region check connection to redis
335	        db = Database(protocol=3)
336	        start_time = time.time()
337	        connected = False
338	        while (connected is False) and (time.time() - start_time &lt; 30):
339	            try:
340	                connected = db.ping()
341	            except Exception:
342	                pass
343	            time.sleep(1)
344	        if connected is False:
345	            raise Exception(&quot;Cant conect to redis in 10s&quot;)
346	        # endregion
347	
348	        yield
349	    except Exception as e:
350	        print(f&#x27;Got exception during redis container starting: {e}&#x27;)
351	        raise
352	    finally:
353	        remove_container(container_name)
354	        docker_client.close()
</pre>
</div>


</div>
</div>

<div id="issue-392">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_company_independent.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_company_independent.py</a><br>
    <b>Line number: </b>305<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
289	            self.sql_via_http(
290	                query.format(f&#x27;test_view_{char}&#x27;, char),
291	                company_id=cid,
292	                expected_resp_type=RESPONSE_TYPE.OK
293	            )
294	
295	            tables = self.get_tables_in(&#x27;mindsdb&#x27;, cid)
296	            self.assert_list(
297	                tables, {
298	                    &#x27;models&#x27;,
299	                    f&#x27;test_view_{char}&#x27;
300	                }
301	            )
302	
303	        for cid, char in [(CID_A, &#x27;a&#x27;), (CID_B, &#x27;b&#x27;)]:
304	            response = self.sql_via_http(
305	                f&quot;select * from mindsdb.test_view_{char}&quot;,
306	                company_id=cid,
307	                expected_resp_type=RESPONSE_TYPE.TABLE
308	            )
309	            assert len(response[&#x27;data&#x27;]) == 50
310	
311	            response = self.sql_via_http(
312	                f&quot;DROP VIEW mindsdb.test_view_{char}&quot;,
313	                company_id=cid,
314	                expected_resp_type=RESPONSE_TYPE.OK
315	            )
316	
317	            tables = self.get_tables_in(&#x27;mindsdb&#x27;, cid)
318	            self.assert_list(
319	                tables, {
320	                    &#x27;models&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-393">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_company_independent.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_company_independent.py</a><br>
    <b>Line number: </b>325<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
309	            assert len(response[&#x27;data&#x27;]) == 50
310	
311	            response = self.sql_via_http(
312	                f&quot;DROP VIEW mindsdb.test_view_{char}&quot;,
313	                company_id=cid,
314	                expected_resp_type=RESPONSE_TYPE.OK
315	            )
316	
317	            tables = self.get_tables_in(&#x27;mindsdb&#x27;, cid)
318	            self.assert_list(
319	                tables, {
320	                    &#x27;models&#x27;,
321	                }
322	            )
323	
324	            self.sql_via_http(
325	                f&quot;select * from mindsdb.test_view_{char}&quot;,
326	                company_id=cid,
327	                expected_resp_type=RESPONSE_TYPE.ERROR
328	            )
329	
330	    def test_model(self):
331	        query = &quot;&quot;&quot;
332	            CREATE MODEL mindsdb.model_{}
333	            FROM test_integration_{} (
334	                select * from rentals limit 50
335	            ) PREDICT rental_price
336	            USING join_learn_process=true, time_aim=5
337	        &quot;&quot;&quot;
338	
339	        predict_query = &quot;&quot;&quot;
340	            select * from mindsdb.model_{} where sqft = 100
</pre>
</div>


</div>
</div>

<div id="issue-394">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_http.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_http.py</a><br>
    <b>Line number: </b>53<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
37	    @classmethod
38	    def setup_class(cls):
39	        cls._sql_via_http_context = {}
40	
41	    def show_databases(self):
42	        resp = self.sql_via_http(&#x27;show databases&#x27;, RESPONSE_TYPE.TABLE)
43	        return [x[0] for x in resp[&#x27;data&#x27;]]
44	
45	    @pytest.mark.parametrize(&quot;util_uri&quot;, [&quot;util/ping&quot;, &quot;util/ping_native&quot;, &quot;config/vars&quot;])
46	    def test_utils(self, util_uri):
47	        &quot;&quot;&quot;
48	        Call utilities ping endpoint
49	        THEN check the response is success
50	        &quot;&quot;&quot;
51	
52	        path = f&quot;{HTTP_API_ROOT}/{util_uri}&quot;
53	        response = requests.get(path)
54	        assert response.status_code == 200
55	
56	    def test_auth(self):
57	        session = requests.Session()
58	
59	        response = session.get(f&#x27;{HTTP_API_ROOT}/status&#x27;)
60	        assert response.status_code == 200
61	        assert response.json()[&#x27;auth&#x27;][&#x27;http_auth_enabled&#x27;] is False
62	
63	        response = session.get(f&#x27;{HTTP_API_ROOT}/config/&#x27;)
64	        assert response.status_code == 200
65	        assert response.json()[&#x27;auth&#x27;][&#x27;http_auth_enabled&#x27;] is False
66	
67	        response = session.get(f&#x27;{HTTP_API_ROOT}/tree/&#x27;)
68	        assert response.status_code == 200
</pre>
</div>


</div>
</div>

<div id="issue-395">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_http.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_http.py</a><br>
    <b>Line number: </b>130<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
114	        response = session.put(f&#x27;{HTTP_API_ROOT}/config/&#x27;, json={
115	            &#x27;auth&#x27;: {
116	                &#x27;http_auth_enabled&#x27;: False,
117	                &#x27;username&#x27;: &#x27;mindsdb&#x27;,
118	                &#x27;password&#x27;: &#x27;mindsdb&#x27;
119	            }
120	        })
121	
122	        response = session.get(f&#x27;{HTTP_API_ROOT}/status&#x27;)
123	        assert response.status_code == 200
124	        assert response.json()[&#x27;auth&#x27;][&#x27;http_auth_enabled&#x27;] is False
125	
126	    def test_gui_is_served(self):
127	        &quot;&quot;&quot;
128	        GUI downloaded and available
129	        &quot;&quot;&quot;
130	        response = requests.get(&#x27;http://localhost:47334/&#x27;)
131	        assert response.status_code == 200
132	        assert response.content.decode().find(&#x27;&lt;head&gt;&#x27;) &gt; 0
133	
134	    def test_files(self):
135	        &#x27;&#x27;&#x27; sql-via-http:
136	            upload file
137	            delete file
138	            upload file again
139	        &#x27;&#x27;&#x27;
140	        files_list = self.get_files_list()
141	        assert len(files_list) == 0
142	
143	        if Path(&#x27;train.csv&#x27;).is_file() is False:
144	            resp = requests.get(&#x27;https://raw.githubusercontent.com/mindsdb/mindsdb-examples/master/classics/home_rentals/dataset/train.csv&#x27;)
145	            with open(&#x27;tests/train.csv&#x27;, &#x27;wb&#x27;) as f:
</pre>
</div>


</div>
</div>

<div id="issue-396">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_http.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_http.py</a><br>
    <b>Line number: </b>144<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
128	        GUI downloaded and available
129	        &quot;&quot;&quot;
130	        response = requests.get(&#x27;http://localhost:47334/&#x27;)
131	        assert response.status_code == 200
132	        assert response.content.decode().find(&#x27;&lt;head&gt;&#x27;) &gt; 0
133	
134	    def test_files(self):
135	        &#x27;&#x27;&#x27; sql-via-http:
136	            upload file
137	            delete file
138	            upload file again
139	        &#x27;&#x27;&#x27;
140	        files_list = self.get_files_list()
141	        assert len(files_list) == 0
142	
143	        if Path(&#x27;train.csv&#x27;).is_file() is False:
144	            resp = requests.get(&#x27;https://raw.githubusercontent.com/mindsdb/mindsdb-examples/master/classics/home_rentals/dataset/train.csv&#x27;)
145	            with open(&#x27;tests/train.csv&#x27;, &#x27;wb&#x27;) as f:
146	                f.write(resp.content)
147	
148	        file_path = Path(&#x27;tests/train.csv&#x27;)
149	        df = pd.read_csv(file_path)
150	        test_csv_path = make_test_csv(&#x27;test_home_rentals&#x27;, df.head(50))
151	        small_test_csv_path = make_test_csv(&#x27;small_test_home_rentals&#x27;, df.head(5))
152	
153	        with open(test_csv_path) as td:
154	            files = {
155	                &#x27;file&#x27;: (&#x27;test_data.csv&#x27;, td, &#x27;text/csv&#x27;),
156	                &#x27;original_file_name&#x27;: (None, &#x27;super_test_data.csv&#x27;)  # optional
157	            }
158	
159	            response = requests.request(&#x27;PUT&#x27;, f&#x27;{HTTP_API_ROOT}/files/test_file&#x27;, files=files, json=None, params=None, data=None)
</pre>
</div>


</div>
</div>

<div id="issue-397">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_http.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_http.py</a><br>
    <b>Line number: </b>165<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
149	        df = pd.read_csv(file_path)
150	        test_csv_path = make_test_csv(&#x27;test_home_rentals&#x27;, df.head(50))
151	        small_test_csv_path = make_test_csv(&#x27;small_test_home_rentals&#x27;, df.head(5))
152	
153	        with open(test_csv_path) as td:
154	            files = {
155	                &#x27;file&#x27;: (&#x27;test_data.csv&#x27;, td, &#x27;text/csv&#x27;),
156	                &#x27;original_file_name&#x27;: (None, &#x27;super_test_data.csv&#x27;)  # optional
157	            }
158	
159	            response = requests.request(&#x27;PUT&#x27;, f&#x27;{HTTP_API_ROOT}/files/test_file&#x27;, files=files, json=None, params=None, data=None)
160	            assert response.status_code == 200
161	
162	        files_list = self.get_files_list()
163	        assert files_list[0][&#x27;name&#x27;] == &#x27;test_file&#x27;
164	
165	        response = requests.delete(f&#x27;{HTTP_API_ROOT}/files/test_file&#x27;)
166	        assert response.status_code == 200
167	
168	        files_list = self.get_files_list()
169	        assert len(files_list) == 0
170	
171	        with open(test_csv_path) as td:
172	            files = {
173	                &#x27;file&#x27;: (&#x27;test_data.csv&#x27;, td, &#x27;text/csv&#x27;),
174	                &#x27;original_file_name&#x27;: (None, &#x27;super_test_data.csv&#x27;)  # optional
175	            }
176	
177	            response = requests.request(&#x27;PUT&#x27;, f&#x27;{HTTP_API_ROOT}/files/test_file&#x27;, files=files, json=None, params=None, data=None)
178	            assert response.status_code == 200
179	
180	        with open(small_test_csv_path) as td:
</pre>
</div>


</div>
</div>

<div id="issue-398">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>114<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
98	        # and try to drop one of the datasources
99	        if db_type == &#x27;mysql&#x27;:
100	            self.query(f&#x27;DROP DATABASE {db_type.upper()};&#x27;)
101	            # and create again
102	            self.query(_query)
103	
104	    @staticmethod
105	    def upload_ds(df, name):
106	        &quot;&quot;&quot;Upload pandas df as csv file.&quot;&quot;&quot;
107	        with tempfile.NamedTemporaryFile(mode=&#x27;w+&#x27;, newline=&#x27;&#x27;, delete=False) as f:
108	            df.to_csv(f, index=False)
109	            f.flush()
110	            url = f&#x27;{HTTP_API_ROOT}/files/{name}&#x27;
111	            data = {
112	                &quot;file&quot;: (f.name, f, &#x27;text/csv&#x27;)
113	            }
114	            res = requests.put(url, files=data)
115	            res.raise_for_status()
116	
117	    def verify_file_ds(self, ds_name):
118	        timeout = 5
119	        threshold = time.time() + timeout
120	        res = &#x27;&#x27;
121	        while time.time() &lt; threshold:
122	            _query = &quot;USE files; SHOW tables;&quot;
123	            res = self.query(_query)
124	            if &#x27;Tables_in_files&#x27; in res and res.get_record(&#x27;Tables_in_files&#x27;, ds_name):
125	                break
126	            time.sleep(0.5)
127	        assert &#x27;Tables_in_files&#x27; in res and res.get_record(&#x27;Tables_in_files&#x27;, ds_name), f&quot;file datasource {ds_name} is not ready to use after {timeout} seconds&quot;
128	
129	    def check_predictor_readiness(self, predictor_name):
</pre>
</div>


</div>
</div>

<div id="issue-399">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>134<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
118	        timeout = 5
119	        threshold = time.time() + timeout
120	        res = &#x27;&#x27;
121	        while time.time() &lt; threshold:
122	            _query = &quot;USE files; SHOW tables;&quot;
123	            res = self.query(_query)
124	            if &#x27;Tables_in_files&#x27; in res and res.get_record(&#x27;Tables_in_files&#x27;, ds_name):
125	                break
126	            time.sleep(0.5)
127	        assert &#x27;Tables_in_files&#x27; in res and res.get_record(&#x27;Tables_in_files&#x27;, ds_name), f&quot;file datasource {ds_name} is not ready to use after {timeout} seconds&quot;
128	
129	    def check_predictor_readiness(self, predictor_name):
130	        timeout = 600
131	        threshold = time.time() + timeout
132	        res = &#x27;&#x27;
133	        while time.time() &lt; threshold:
134	            _query = &quot;SELECT status, error FROM mindsdb.models WHERE name=&#x27;{}&#x27;;&quot;.format(predictor_name)
135	            res = self.query(_query)
136	            if &#x27;status&#x27; in res:
137	                if res.get_record(&#x27;status&#x27;, &#x27;complete&#x27;):
138	                    break
139	                elif res.get_record(&#x27;status&#x27;, &#x27;error&#x27;):
140	                    raise Exception(res[0][&#x27;error&#x27;])
141	            time.sleep(2)
142	        assert &#x27;status&#x27; in res and res.get_record(&#x27;status&#x27;, &#x27;complete&#x27;), f&quot;predictor {predictor_name} is not complete after {timeout} seconds&quot;
143	
144	    def validate_database_creation(self, db_data):
145	        ds_type = db_data[&quot;type&quot;]
146	        res = self.query(&quot;SELECT name FROM information_schema.databases WHERE name=&#x27;{}&#x27;;&quot;.format(ds_type.upper()))
147	        assert &quot;name&quot; in res and res.get_record(&quot;name&quot;, ds_type.upper()), f&quot;Expected datasource is not found after creation - {ds_type.upper()}: {res}&quot;
148	
149	
</pre>
</div>


</div>
</div>

<div id="issue-400">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>146<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
130	        timeout = 600
131	        threshold = time.time() + timeout
132	        res = &#x27;&#x27;
133	        while time.time() &lt; threshold:
134	            _query = &quot;SELECT status, error FROM mindsdb.models WHERE name=&#x27;{}&#x27;;&quot;.format(predictor_name)
135	            res = self.query(_query)
136	            if &#x27;status&#x27; in res:
137	                if res.get_record(&#x27;status&#x27;, &#x27;complete&#x27;):
138	                    break
139	                elif res.get_record(&#x27;status&#x27;, &#x27;error&#x27;):
140	                    raise Exception(res[0][&#x27;error&#x27;])
141	            time.sleep(2)
142	        assert &#x27;status&#x27; in res and res.get_record(&#x27;status&#x27;, &#x27;complete&#x27;), f&quot;predictor {predictor_name} is not complete after {timeout} seconds&quot;
143	
144	    def validate_database_creation(self, db_data):
145	        ds_type = db_data[&quot;type&quot;]
146	        res = self.query(&quot;SELECT name FROM information_schema.databases WHERE name=&#x27;{}&#x27;;&quot;.format(ds_type.upper()))
147	        assert &quot;name&quot; in res and res.get_record(&quot;name&quot;, ds_type.upper()), f&quot;Expected datasource is not found after creation - {ds_type.upper()}: {res}&quot;
148	
149	
150	@pytest.mark.usefixtures(&#x27;mindsdb_app&#x27;, &#x27;postgres_db&#x27;, &#x27;maria_db&#x27;, &#x27;mysql_db&#x27;)
151	class TestMySqlApi(BaseStuff):
152	    &quot;&quot;&quot;Test mindsdb mysql api.
153	    All sql commands are being executed through a docker container with mysql client within.
154	    In general all tests do next:
155	        1. Do some preconditions
156	        2. Specify SQL query needs to be executed
157	        3. Launch a docker container with mysql client
158	        4. Send the query to the container
159	        5. Mysql client inside the container connects to mindsdb mysql api
160	        and execute the query&quot;&quot;&quot;
161	
</pre>
</div>


</div>
</div>

<div id="issue-401">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>191<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
175	    def tear_down(cls):
176	        cls.docker_client.close()
177	
178	    def test_create_postgres_datasources(self):
179	        self.create_database(self.postgres_db)
180	        self.validate_database_creation(self.postgres_db)
181	
182	    def test_create_mariadb_datasources(self):
183	        self.create_database(self.maria_db)
184	        self.validate_database_creation(self.maria_db)
185	
186	    def test_create_mysql_datasources(self):
187	        self.create_database(self.mysql_db)
188	        self.validate_database_creation(self.mysql_db)
189	
190	    def test_create_predictor(self):
191	        _query = f&quot;CREATE MODEL {self.predictor_name} from MYSQL (select * from test.rentals) PREDICT rental_price;&quot;
192	        self.query(_query)
193	        self.check_predictor_readiness(self.predictor_name)
194	
195	    def test_making_prediction(self):
196	        _query = f&quot;&quot;&quot;
197	            SELECT rental_price, rental_price_explain
198	            FROM {self.predictor_name}
199	            WHERE number_of_rooms = 2 and sqft = 400 and location = &#x27;downtown&#x27; and days_on_market = 2 and initial_price= 2500;
200	        &quot;&quot;&quot;
201	        res = self.query(_query)
202	        assert &#x27;rental_price&#x27; in res and &#x27;rental_price_explain&#x27; in res, f&quot;error getting prediction from {self.predictor_name} - {res}&quot;
203	
204	    @pytest.mark.parametrize(&quot;describe_attr&quot;, [&quot;model&quot;, &quot;features&quot;, &quot;ensemble&quot;])
205	    def test_describe_predictor_attrs(self, describe_attr):
206	        self.query(f&quot;describe mindsdb.{self.predictor_name}.{describe_attr};&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-402">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>196<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
180	        self.validate_database_creation(self.postgres_db)
181	
182	    def test_create_mariadb_datasources(self):
183	        self.create_database(self.maria_db)
184	        self.validate_database_creation(self.maria_db)
185	
186	    def test_create_mysql_datasources(self):
187	        self.create_database(self.mysql_db)
188	        self.validate_database_creation(self.mysql_db)
189	
190	    def test_create_predictor(self):
191	        _query = f&quot;CREATE MODEL {self.predictor_name} from MYSQL (select * from test.rentals) PREDICT rental_price;&quot;
192	        self.query(_query)
193	        self.check_predictor_readiness(self.predictor_name)
194	
195	    def test_making_prediction(self):
196	        _query = f&quot;&quot;&quot;
197	            SELECT rental_price, rental_price_explain
198	            FROM {self.predictor_name}
199	            WHERE number_of_rooms = 2 and sqft = 400 and location = &#x27;downtown&#x27; and days_on_market = 2 and initial_price= 2500;
200	        &quot;&quot;&quot;
201	        res = self.query(_query)
202	        assert &#x27;rental_price&#x27; in res and &#x27;rental_price_explain&#x27; in res, f&quot;error getting prediction from {self.predictor_name} - {res}&quot;
203	
204	    @pytest.mark.parametrize(&quot;describe_attr&quot;, [&quot;model&quot;, &quot;features&quot;, &quot;ensemble&quot;])
205	    def test_describe_predictor_attrs(self, describe_attr):
206	        self.query(f&quot;describe mindsdb.{self.predictor_name}.{describe_attr};&quot;)
207	
208	    @pytest.mark.parametrize(&quot;service_req&quot;, [
209	        &quot;show databases;&quot;,
210	        &quot;show schemas;&quot;,
211	        &quot;show tables;&quot;,
212	        &quot;show tables from mindsdb;&quot;,
213	        &quot;show tables in mindsdb;&quot;,
214	        &quot;show full tables from mindsdb;&quot;,
215	        &quot;show full tables in mindsdb;&quot;,
</pre>
</div>


</div>
</div>

<div id="issue-403">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>240<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
224	        &quot;show function status where db = &#x27;mindsdb&#x27;;&quot;,
225	        &quot;show procedure status where db = &#x27;mindsdb&#x27;;&quot;
226	    ])
227	    def test_service_requests(self, service_req):
228	        self.query(service_req)
229	
230	    def test_train_model_from_files(self):
231	        df = pd.DataFrame({
232	            &#x27;x1&#x27;: [x for x in range(100, 210)] + [x for x in range(100, 210)],
233	            &#x27;x2&#x27;: [x * 2 for x in range(100, 210)] + [x * 3 for x in range(100, 210)],
234	            &#x27;y&#x27;: [x * 3 for x in range(100, 210)] + [x * 2 for x in range(100, 210)]
235	        })
236	        file_predictor_name = &quot;predictor_from_file&quot;
237	        self.upload_ds(df, self.file_datasource_name)
238	        self.verify_file_ds(self.file_datasource_name)
239	
240	        _query = f&quot;&quot;&quot;
241	            CREATE MODEL {file_predictor_name}
242	            from files (select * from {self.file_datasource_name})
243	            predict y;
244	        &quot;&quot;&quot;
245	        self.query(_query)
246	        self.check_predictor_readiness(file_predictor_name)
247	
248	    def test_select_from_files(self):
249	        _query = f&quot;select * from files.{self.file_datasource_name};&quot;
250	        self.query(_query)
251	
252	    def test_ts_train_and_predict(self, subtests):
253	        train_df = pd.DataFrame({
254	            &#x27;gby&#x27;: [&quot;A&quot; for _ in range(100, 210)] + [&quot;B&quot; for _ in range(100, 210)],
255	            &#x27;oby&#x27;: [x for x in range(100, 210)] + [x for x in range(200, 310)],
256	            &#x27;x1&#x27;: [x for x in range(100, 210)] + [x for x in range(100, 210)],
257	            &#x27;x2&#x27;: [x * 2 for x in range(100, 210)] + [x * 3 for x in range(100, 210)],
258	            &#x27;y&#x27;: [x * 3 for x in range(100, 210)] + [x * 2 for x in range(100, 210)]
259	        })
</pre>
</div>


</div>
</div>

<div id="issue-404">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>249<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
233	            &#x27;x2&#x27;: [x * 2 for x in range(100, 210)] + [x * 3 for x in range(100, 210)],
234	            &#x27;y&#x27;: [x * 3 for x in range(100, 210)] + [x * 2 for x in range(100, 210)]
235	        })
236	        file_predictor_name = &quot;predictor_from_file&quot;
237	        self.upload_ds(df, self.file_datasource_name)
238	        self.verify_file_ds(self.file_datasource_name)
239	
240	        _query = f&quot;&quot;&quot;
241	            CREATE MODEL {file_predictor_name}
242	            from files (select * from {self.file_datasource_name})
243	            predict y;
244	        &quot;&quot;&quot;
245	        self.query(_query)
246	        self.check_predictor_readiness(file_predictor_name)
247	
248	    def test_select_from_files(self):
249	        _query = f&quot;select * from files.{self.file_datasource_name};&quot;
250	        self.query(_query)
251	
252	    def test_ts_train_and_predict(self, subtests):
253	        train_df = pd.DataFrame({
254	            &#x27;gby&#x27;: [&quot;A&quot; for _ in range(100, 210)] + [&quot;B&quot; for _ in range(100, 210)],
255	            &#x27;oby&#x27;: [x for x in range(100, 210)] + [x for x in range(200, 310)],
256	            &#x27;x1&#x27;: [x for x in range(100, 210)] + [x for x in range(100, 210)],
257	            &#x27;x2&#x27;: [x * 2 for x in range(100, 210)] + [x * 3 for x in range(100, 210)],
258	            &#x27;y&#x27;: [x * 3 for x in range(100, 210)] + [x * 2 for x in range(100, 210)]
259	        })
260	
261	        test_df = pd.DataFrame({
262	            &#x27;gby&#x27;: [&quot;A&quot; for _ in range(210, 220)] + [&quot;B&quot; for _ in range(210, 220)],
263	            &#x27;oby&#x27;: [x for x in range(210, 220)] + [x for x in range(310, 320)],
264	            &#x27;x1&#x27;: [x for x in range(210, 220)] + [x for x in range(210, 220)],
</pre>
</div>


</div>
</div>

<div id="issue-405">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>277<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
261	        test_df = pd.DataFrame({
262	            &#x27;gby&#x27;: [&quot;A&quot; for _ in range(210, 220)] + [&quot;B&quot; for _ in range(210, 220)],
263	            &#x27;oby&#x27;: [x for x in range(210, 220)] + [x for x in range(310, 320)],
264	            &#x27;x1&#x27;: [x for x in range(210, 220)] + [x for x in range(210, 220)],
265	            &#x27;x2&#x27;: [x * 2 for x in range(210, 220)] + [x * 3 for x in range(210, 220)],
266	            &#x27;y&#x27;: [x * 3 for x in range(210, 220)] + [x * 2 for x in range(210, 220)]
267	        })
268	
269	        train_ds_name = &quot;train_ts_file_ds&quot;
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
</pre>
</div>


</div>
</div>

<div id="issue-406">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>278<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
262	            &#x27;gby&#x27;: [&quot;A&quot; for _ in range(210, 220)] + [&quot;B&quot; for _ in range(210, 220)],
263	            &#x27;oby&#x27;: [x for x in range(210, 220)] + [x for x in range(310, 320)],
264	            &#x27;x1&#x27;: [x for x in range(210, 220)] + [x for x in range(210, 220)],
265	            &#x27;x2&#x27;: [x * 2 for x in range(210, 220)] + [x * 3 for x in range(210, 220)],
266	            &#x27;y&#x27;: [x * 3 for x in range(210, 220)] + [x * 2 for x in range(210, 220)]
267	        })
268	
269	        train_ds_name = &quot;train_ts_file_ds&quot;
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
</pre>
</div>


</div>
</div>

<div id="issue-407">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>281<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
265	            &#x27;x2&#x27;: [x * 2 for x in range(210, 220)] + [x * 3 for x in range(210, 220)],
266	            &#x27;y&#x27;: [x * 3 for x in range(210, 220)] + [x * 2 for x in range(210, 220)]
267	        })
268	
269	        train_ds_name = &quot;train_ts_file_ds&quot;
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
</pre>
</div>


</div>
</div>

<div id="issue-408">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>282<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
266	            &#x27;y&#x27;: [x * 3 for x in range(210, 220)] + [x * 2 for x in range(210, 220)]
267	        })
268	
269	        train_ds_name = &quot;train_ts_file_ds&quot;
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
297	                               select_query=select_query,
</pre>
</div>


</div>
</div>

<div id="issue-409">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>285<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
269	        train_ds_name = &quot;train_ts_file_ds&quot;
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
297	                               select_query=select_query,
298	                               res_len=res_len):
299	                self.query(create_query % predictor_name)
300	                self.check_predictor_readiness(predictor_name)
</pre>
</div>


</div>
</div>

<div id="issue-410">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>286<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
270	        test_ds_name = &quot;test_ts_file_ds&quot;
271	        for df, ds_name in [(train_df, train_ds_name), (test_df, test_ds_name)]:
272	            self.upload_ds(df, ds_name)
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
297	                               select_query=select_query,
298	                               res_len=res_len):
299	                self.query(create_query % predictor_name)
300	                self.check_predictor_readiness(predictor_name)
301	                res = self.query(select_query % predictor_name)
</pre>
</div>


</div>
</div>

<div id="issue-411">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>289<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
273	            self.verify_file_ds(ds_name)
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
297	                               select_query=select_query,
298	                               res_len=res_len):
299	                self.query(create_query % predictor_name)
300	                self.check_predictor_readiness(predictor_name)
301	                res = self.query(select_query % predictor_name)
302	                assert len(res) == res_len, f&quot;prediction result {res} contains more that {res_len} records&quot;
</pre>
</div>


</div>
</div>

<div id="issue-412">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_api.py</a><br>
    <b>Line number: </b>290<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
274	
275	        params = [
276	            (&quot;with_group_by_hor1&quot;,
277	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 1;&quot;,
278	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 1;&quot;,
279	                1),
280	            (&quot;no_group_by_hor1&quot;,
281	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 1;&quot;,
282	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 1;&quot;,
283	                1),
284	            (&quot;with_group_by_hor2&quot;,
285	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby GROUP BY gby WINDOW 10 HORIZON 2;&quot;,
286	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res WHERE source.gby= &#x27;A&#x27; LIMIT 2;&quot;,
287	                2),
288	            (&quot;no_group_by_hor2&quot;,
289	                f&quot;CREATE MODEL %s from files (select * from {train_ds_name}) PREDICT y ORDER BY oby WINDOW 10 HORIZON 2;&quot;,
290	                f&quot;SELECT res.gby, res.y as PREDICTED_RESULT FROM files.{test_ds_name} as source JOIN mindsdb.%s as res LIMIT 2;&quot;,
291	                2),
292	        ]
293	        for predictor_name, create_query, select_query, res_len in params:
294	            with subtests.test(msg=predictor_name,
295	                               predictor_name=predictor_name,
296	                               create_query=create_query,
297	                               select_query=select_query,
298	                               res_len=res_len):
299	                self.query(create_query % predictor_name)
300	                self.check_predictor_readiness(predictor_name)
301	                res = self.query(select_query % predictor_name)
302	                assert len(res) == res_len, f&quot;prediction result {res} contains more that {res_len} records&quot;
</pre>
</div>


</div>
</div>

<div id="issue-413">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py</a><br>
    <b>Line number: </b>59<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
43	
44	            res = Dlist()
45	            for row in data:
46	                res.append(dict(zip(columns, row)))
47	
48	        else:
49	            res = {}
50	
51	        return res
52	
53	    def test_tableau_queries(self, subtests):
54	        test_ds_name = self.file_datasource_name
55	        predictor_name = &quot;predictor_from_file&quot;
56	        integration = &quot;files&quot;
57	
58	        queries = [
59	            f&#x27;&#x27;&#x27;
60	               SELECT TABLE_NAME,TABLE_COMMENT,IF(TABLE_TYPE=&#x27;BASE TABLE&#x27;, &#x27;TABLE&#x27;, TABLE_TYPE),
61	               TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES
62	               WHERE TABLE_SCHEMA LIKE &#x27;{integration}&#x27;
63	                AND ( TABLE_TYPE=&#x27;BASE TABLE&#x27; OR TABLE_TYPE=&#x27;VIEW&#x27; ) ORDER BY TABLE_SCHEMA, TABLE_NAME
64	            &#x27;&#x27;&#x27;,
65	            f&#x27;&#x27;&#x27;
66	                SELECT SUM(1) AS `cnt__0B4A4E8BD11C48FFB4730D4D2C32191A_ok`,
67	                  max(`Custom SQL Query`.`x1`) AS `sum_height_ok`,
68	                  max(`Custom SQL Query`.`y`) AS `sum_length1_ok`
69	                FROM (
70	                  SELECT res.x1, res.y
71	                   FROM files.{test_ds_name} as source
72	                   JOIN mindsdb.{predictor_name} as res
73	                ) `Custom SQL Query`
74	                HAVING (COUNT(1) &gt; 0)
75	            &#x27;&#x27;&#x27;,
76	            f&#x27;&#x27;&#x27;
77	                SHOW FULL TABLES FROM {integration}
78	            &#x27;&#x27;&#x27;,
79	            &#x27;&#x27;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-414">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py</a><br>
    <b>Line number: </b>65<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
49	            res = {}
50	
51	        return res
52	
53	    def test_tableau_queries(self, subtests):
54	        test_ds_name = self.file_datasource_name
55	        predictor_name = &quot;predictor_from_file&quot;
56	        integration = &quot;files&quot;
57	
58	        queries = [
59	            f&#x27;&#x27;&#x27;
60	               SELECT TABLE_NAME,TABLE_COMMENT,IF(TABLE_TYPE=&#x27;BASE TABLE&#x27;, &#x27;TABLE&#x27;, TABLE_TYPE),
61	               TABLE_SCHEMA FROM INFORMATION_SCHEMA.TABLES
62	               WHERE TABLE_SCHEMA LIKE &#x27;{integration}&#x27;
63	                AND ( TABLE_TYPE=&#x27;BASE TABLE&#x27; OR TABLE_TYPE=&#x27;VIEW&#x27; ) ORDER BY TABLE_SCHEMA, TABLE_NAME
64	            &#x27;&#x27;&#x27;,
65	            f&#x27;&#x27;&#x27;
66	                SELECT SUM(1) AS `cnt__0B4A4E8BD11C48FFB4730D4D2C32191A_ok`,
67	                  max(`Custom SQL Query`.`x1`) AS `sum_height_ok`,
68	                  max(`Custom SQL Query`.`y`) AS `sum_length1_ok`
69	                FROM (
70	                  SELECT res.x1, res.y
71	                   FROM files.{test_ds_name} as source
72	                   JOIN mindsdb.{predictor_name} as res
73	                ) `Custom SQL Query`
74	                HAVING (COUNT(1) &gt; 0)
75	            &#x27;&#x27;&#x27;,
76	            f&#x27;&#x27;&#x27;
77	                SHOW FULL TABLES FROM {integration}
78	            &#x27;&#x27;&#x27;,
79	            &#x27;&#x27;&#x27;
80	                SELECT `table_name`, `column_name`
81	                FROM `information_schema`.`columns`
82	                WHERE `data_type`=&#x27;enum&#x27; AND `table_schema`=&#x27;views&#x27;;
83	            &#x27;&#x27;&#x27;,
84	            &#x27;&#x27;&#x27;
85	                SHOW KEYS FROM `mindsdb`.`predictors`
86	            &#x27;&#x27;&#x27;,
87	            &#x27;&#x27;&#x27;
88	                show full columns from `predictors`
89	            &#x27;&#x27;&#x27;,
90	            &#x27;&#x27;&#x27;
</pre>
</div>


</div>
</div>

<div id="issue-415">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py</a><br>
    <b>Line number: </b>94<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
78	            &#x27;&#x27;&#x27;,
79	            &#x27;&#x27;&#x27;
80	                SELECT `table_name`, `column_name`
81	                FROM `information_schema`.`columns`
82	                WHERE `data_type`=&#x27;enum&#x27; AND `table_schema`=&#x27;views&#x27;;
83	            &#x27;&#x27;&#x27;,
84	            &#x27;&#x27;&#x27;
85	                SHOW KEYS FROM `mindsdb`.`predictors`
86	            &#x27;&#x27;&#x27;,
87	            &#x27;&#x27;&#x27;
88	                show full columns from `predictors`
89	            &#x27;&#x27;&#x27;,
90	            &#x27;&#x27;&#x27;
91	                SELECT `table_name`, `column_name` FROM `information_schema`.`columns`
92	                 WHERE `data_type`=&#x27;enum&#x27; AND `table_schema`=&#x27;mindsdb&#x27;
93	            &#x27;&#x27;&#x27;,
94	            f&#x27;&#x27;&#x27;
95	                SELECT `Custom SQL Query`.`x1` AS `height`,
96	                  `Custom SQL Query`.`y` AS `length1`
97	                FROM (
98	                   SELECT res.x1, res.y
99	                   FROM files.{test_ds_name} as source
100	                   JOIN mindsdb.{predictor_name} as res
101	                ) `Custom SQL Query`
102	                LIMIT 100
103	            &#x27;&#x27;&#x27;,
104	            f&#x27;&#x27;&#x27;
105	            SELECT
106	              `Custom SQL Query`.`x1` AS `x1`,
107	              SUM(`Custom SQL Query`.`y2`) AS `sum_y2_ok`
108	            FROM (
109	               SELECT res.x1, res.y as y2
110	               FROM files.{test_ds_name} as source
111	               JOIN mindsdb.{predictor_name} as res
112	            ) `Custom SQL Query`
113	            GROUP BY 1
114	            &#x27;&#x27;&#x27;,
115	            f&#x27;&#x27;&#x27;
116	            SELECT
117	              `Custom SQL Query`.`x1` AS `x1`,
118	              COUNT(DISTINCT TRUNCATE(`Custom SQL Query`.`y`,0)) AS `ctd_y_ok`
</pre>
</div>


</div>
</div>

<div id="issue-416">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py</a><br>
    <b>Line number: </b>104<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
88	                show full columns from `predictors`
89	            &#x27;&#x27;&#x27;,
90	            &#x27;&#x27;&#x27;
91	                SELECT `table_name`, `column_name` FROM `information_schema`.`columns`
92	                 WHERE `data_type`=&#x27;enum&#x27; AND `table_schema`=&#x27;mindsdb&#x27;
93	            &#x27;&#x27;&#x27;,
94	            f&#x27;&#x27;&#x27;
95	                SELECT `Custom SQL Query`.`x1` AS `height`,
96	                  `Custom SQL Query`.`y` AS `length1`
97	                FROM (
98	                   SELECT res.x1, res.y
99	                   FROM files.{test_ds_name} as source
100	                   JOIN mindsdb.{predictor_name} as res
101	                ) `Custom SQL Query`
102	                LIMIT 100
103	            &#x27;&#x27;&#x27;,
104	            f&#x27;&#x27;&#x27;
105	            SELECT
106	              `Custom SQL Query`.`x1` AS `x1`,
107	              SUM(`Custom SQL Query`.`y2`) AS `sum_y2_ok`
108	            FROM (
109	               SELECT res.x1, res.y as y2
110	               FROM files.{test_ds_name} as source
111	               JOIN mindsdb.{predictor_name} as res
112	            ) `Custom SQL Query`
113	            GROUP BY 1
114	            &#x27;&#x27;&#x27;,
115	            f&#x27;&#x27;&#x27;
116	            SELECT
117	              `Custom SQL Query`.`x1` AS `x1`,
118	              COUNT(DISTINCT TRUNCATE(`Custom SQL Query`.`y`,0)) AS `ctd_y_ok`
119	            FROM (
120	               SELECT res.x1, res.y
121	               FROM files.{test_ds_name} as source
122	               JOIN mindsdb.{predictor_name} as res
123	            ) `Custom SQL Query`
124	            GROUP BY 1
125	            &#x27;&#x27;&#x27;,
126	        ]
127	        for i, _query in enumerate(queries):
128	            with subtests.test(msg=i, _query=_query):
129	                self.query(_query)
</pre>
</div>


</div>
</div>

<div id="issue-417">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_mysql_bin_api.py</a><br>
    <b>Line number: </b>115<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
99	                   FROM files.{test_ds_name} as source
100	                   JOIN mindsdb.{predictor_name} as res
101	                ) `Custom SQL Query`
102	                LIMIT 100
103	            &#x27;&#x27;&#x27;,
104	            f&#x27;&#x27;&#x27;
105	            SELECT
106	              `Custom SQL Query`.`x1` AS `x1`,
107	              SUM(`Custom SQL Query`.`y2`) AS `sum_y2_ok`
108	            FROM (
109	               SELECT res.x1, res.y as y2
110	               FROM files.{test_ds_name} as source
111	               JOIN mindsdb.{predictor_name} as res
112	            ) `Custom SQL Query`
113	            GROUP BY 1
114	            &#x27;&#x27;&#x27;,
115	            f&#x27;&#x27;&#x27;
116	            SELECT
117	              `Custom SQL Query`.`x1` AS `x1`,
118	              COUNT(DISTINCT TRUNCATE(`Custom SQL Query`.`y`,0)) AS `ctd_y_ok`
119	            FROM (
120	               SELECT res.x1, res.y
121	               FROM files.{test_ds_name} as source
122	               JOIN mindsdb.{predictor_name} as res
123	            ) `Custom SQL Query`
124	            GROUP BY 1
125	            &#x27;&#x27;&#x27;,
126	        ]
127	        for i, _query in enumerate(queries):
128	            with subtests.test(msg=i, _query=_query):
129	                self.query(_query)
</pre>
</div>


</div>
</div>

<div id="issue-418">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_ts_predictions.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_ts_predictions.py</a><br>
    <b>Line number: </b>55<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
39	            &quot;host&quot;: &quot;samples.mindsdb.com&quot;,
40	            &quot;port&quot;: &quot;5432&quot;,
41	            &quot;database&quot;: &quot;demo&quot;
42	            };
43	        &#x27;&#x27;&#x27;
44	        resp = self.sql_via_http(sql, RESPONSE_TYPE.OK)
45	
46	        groups = [&#x27;a&#x27;, &#x27;b&#x27;]
47	        selects = []
48	        for i in range(30):
49	            day_str = str(datetime.date.today() + datetime.timedelta(days=i))
50	            for group in groups:
51	                value = random.randint(0, 10)
52	                selects.append(f&quot;select &#x27;{day_str}&#x27; as date, &#x27;{group}&#x27; as group, {value} as value&quot;)
53	        selects = &#x27; union all &#x27;.join(selects)
54	
55	        sql = f&#x27;&#x27;&#x27;
56	            create view testv as (
57	                select * from example_db ({selects})
58	            )
59	        &#x27;&#x27;&#x27;
60	
61	        resp = self.sql_via_http(sql, RESPONSE_TYPE.OK)
62	
63	        sql = &#x27;&#x27;&#x27;
64	            CREATE MODEL
65	                mindsdb.tstest
66	            FROM mindsdb (select * from testv)
67	            PREDICT value
68	            ORDER BY date
69	            GROUP BY group
70	            WINDOW 5
71	            HORIZON 3;
72	        &#x27;&#x27;&#x27;
73	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
74	
</pre>
</div>


</div>
</div>

<div id="issue-419">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_ts_predictions.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_ts_predictions.py</a><br>
    <b>Line number: </b>117<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
101	        assert len(data) == 0
102	
103	    def test_eq_latest_date(self):
104	        sql = &#x27;&#x27;&#x27;
105	            select p.date, p.group, p.value
106	            from mindsdb.testv as t join mindsdb.tstest as p
107	            where t.date = LATEST
108	        &#x27;&#x27;&#x27;
109	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
110	        data = to_dicts(resp[&#x27;data&#x27;])
111	        assert len(data) == 2
112	        assert len([x for x in data if x[&#x27;group&#x27;] == &#x27;a&#x27;]) == 1
113	        assert data[0][&#x27;date&#x27;] == (datetime.date.today() + datetime.timedelta(days=29))
114	
115	    def test_gt_particular_date(self):
116	        since = datetime.date.today() + datetime.timedelta(days=15)
117	        sql = f&#x27;&#x27;&#x27;
118	            select p.date, p.group, p.value
119	            from mindsdb.testv as t join mindsdb.tstest as p
120	            where t.date &gt; &#x27;{since}&#x27;
121	        &#x27;&#x27;&#x27;
122	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
123	        data = to_dicts(resp[&#x27;data&#x27;])
124	        assert len(data) == 34  # 14 * 2 + 6 (4 days, 2 groups, 2*3 horizon)
125	        assert len([x for x in data if x[&#x27;group&#x27;] == &#x27;a&#x27;]) == 17  # 14 + 3
126	        assert data[0][&#x27;date&#x27;] == (datetime.date.today() + datetime.timedelta(days=16))
127	
128	    def test_eq_particular_date(self):
129	        since = datetime.date.today() + datetime.timedelta(days=15)
130	        sql = f&#x27;&#x27;&#x27;
131	            select p.date, p.group, p.value
132	            from mindsdb.testv as t join mindsdb.tstest as p
133	            where t.date = &#x27;{since}&#x27;
134	        &#x27;&#x27;&#x27;
135	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
136	        data = to_dicts(resp[&#x27;data&#x27;])
</pre>
</div>


</div>
</div>

<div id="issue-420">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/flows/test_ts_predictions.py" target="_blank">/mindsdb/tests/integration_tests/flows/test_ts_predictions.py</a><br>
    <b>Line number: </b>130<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
114	
115	    def test_gt_particular_date(self):
116	        since = datetime.date.today() + datetime.timedelta(days=15)
117	        sql = f&#x27;&#x27;&#x27;
118	            select p.date, p.group, p.value
119	            from mindsdb.testv as t join mindsdb.tstest as p
120	            where t.date &gt; &#x27;{since}&#x27;
121	        &#x27;&#x27;&#x27;
122	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
123	        data = to_dicts(resp[&#x27;data&#x27;])
124	        assert len(data) == 34  # 14 * 2 + 6 (4 days, 2 groups, 2*3 horizon)
125	        assert len([x for x in data if x[&#x27;group&#x27;] == &#x27;a&#x27;]) == 17  # 14 + 3
126	        assert data[0][&#x27;date&#x27;] == (datetime.date.today() + datetime.timedelta(days=16))
127	
128	    def test_eq_particular_date(self):
129	        since = datetime.date.today() + datetime.timedelta(days=15)
130	        sql = f&#x27;&#x27;&#x27;
131	            select p.date, p.group, p.value
132	            from mindsdb.testv as t join mindsdb.tstest as p
133	            where t.date = &#x27;{since}&#x27;
134	        &#x27;&#x27;&#x27;
135	        resp = self.sql_via_http(sql, RESPONSE_TYPE.TABLE)
136	        data = to_dicts(resp[&#x27;data&#x27;])
137	        assert len(data) == 6  # 2 groups * 3 horizon
138	        assert len([x for x in data if x[&#x27;group&#x27;] == &#x27;a&#x27;]) == 3
139	        assert data[0][&#x27;date&#x27;] == (datetime.date.today() + datetime.timedelta(days=16))
</pre>
</div>


</div>
</div>

<div id="issue-421">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/integration_tests/metrics/test_metrics.py" target="_blank">/mindsdb/tests/integration_tests/metrics/test_metrics.py</a><br>
    <b>Line number: </b>26<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
10	# TODO: Refactor common fixtures out of conftest.
11	from tests.integration_tests.flows.conftest import config, mindsdb_app, config, temp_dir # noqa
12	
13	# U by mindsdb_app fixture in conftest
14	OVERRIDE_CONFIG = {
15	    &#x27;tasks&#x27;: {&#x27;disable&#x27;: True},
16	    &#x27;jobs&#x27;: {&#x27;disable&#x27;: True}
17	}
18	API_LIST = [&quot;http&quot;]
19	
20	
21	def _get_metrics():
22	    cfg = Config()
23	    base_host = cfg[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;host&#x27;]
24	    port = cfg[&#x27;api&#x27;][&#x27;http&#x27;][&#x27;port&#x27;]
25	    url = f&#x27;http://{base_host}:{port}/metrics&#x27;
26	    return requests.get(url).text
27	
28	
29	def _wait_for_metric(name: str, labels: Dict[str, str], value: str, timeout: datetime.timedelta = None):
30	    if timeout is None:
31	        timeout = datetime.timedelta(seconds=30)
32	    start_time = datetime.datetime.now()
33	    while datetime.datetime.now() - start_time &lt; timeout:
34	        metrics = _get_metrics()
35	        print(metrics)
36	        for metrics_line in metrics.split(&#x27;\n&#x27;):
37	            if name not in metrics_line:
38	                continue
39	            # Check labels match metric.
40	            for label_name, label_value in labels.items():
41	                if f&#x27;{label_name}=&quot;{label_value}&quot;&#x27; not in metrics_line:
</pre>
</div>


</div>
</div>

<div id="issue-422">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/tasks.py" target="_blank">/mindsdb/tests/load/tasks.py</a><br>
    <b>Line number: </b>41<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
25	            events.request.fire(request_type=&quot;POST&quot;, name=&quot;/api/sql/query&quot;, response_time=0, response_length=0, exception=e)
26	            self.interrupt(reschedule=True)
27	
28	    def create_new_datasource(self):
29	        &quot;&quot;&quot;This method creates a new data source.&quot;&quot;&quot;
30	        db_config = get_value_from_json_env_var(&quot;INTEGRATIONS_CONFIG&quot;, self.db_type)
31	        query = self.query_generator.create_database_query(
32	            self.random_db_name,
33	            self.db_type,
34	            db_config
35	        )
36	        self.__post_query(query)
37	
38	    @task
39	    def select_integration_query(self):
40	        &quot;&quot;&quot;This task performs a SELECT query from integration.&quot;&quot;&quot;
41	        query = f&#x27;SELECT * FROM {self.random_db_name}.{self.table_name} LIMIT 10&#x27;
42	        self.__post_query(query)
43	
44	    @task
45	    def run_native_query(self):
46	        &quot;&quot;&quot;This task runs a native DB select query.&quot;&quot;&quot;
47	        for n_query in self.native_queries:
48	            query = f&#x27;SELECT * FROM {self.random_db_name}( {n_query})&#x27;
49	            self.__post_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-423">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/tasks.py" target="_blank">/mindsdb/tests/load/tasks.py</a><br>
    <b>Line number: </b>48<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
32	            self.random_db_name,
33	            self.db_type,
34	            db_config
35	        )
36	        self.__post_query(query)
37	
38	    @task
39	    def select_integration_query(self):
40	        &quot;&quot;&quot;This task performs a SELECT query from integration.&quot;&quot;&quot;
41	        query = f&#x27;SELECT * FROM {self.random_db_name}.{self.table_name} LIMIT 10&#x27;
42	        self.__post_query(query)
43	
44	    @task
45	    def run_native_query(self):
46	        &quot;&quot;&quot;This task runs a native DB select query.&quot;&quot;&quot;
47	        for n_query in self.native_queries:
48	            query = f&#x27;SELECT * FROM {self.random_db_name}( {n_query})&#x27;
49	            self.__post_query(query)
</pre>
</div>


</div>
</div>

<div id="issue-424">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/test_postgresql.py" target="_blank">/mindsdb/tests/load/test_postgresql.py</a><br>
    <b>Line number: </b>12<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	from tests.load.tasks import BaseDBConnectionBehavior
2	
3	
4	class PostgreSQLConnectionBehavior(BaseDBConnectionBehavior):
5	    &quot;&quot;&quot;
6	    This class defines the behavior of a PostgreSQL connection.
7	    @TODO: Read query values from sql_queries.json file
8	    &quot;&quot;&quot;
9	    db_type = &quot;postgres&quot;
10	    table_name = &quot;solar_flare_data&quot;
11	    native_queries = [&quot;native_query_average&quot;, &quot;native_query_aggregation&quot;, &quot;native_query_max&quot;, &quot;native_query_grouping&quot;]
12	    native_query_aggregation = f&quot;SELECT COUNT(*) AS total_flares FROM tests.{table_name};&quot;
13	    native_query_average = f&quot;SELECT AVG(peak_c_per_s) AS avg_peak_counts FROM tests.{table_name};&quot;
14	    native_query_max = f&quot;SELECT MAX(energy_kev) AS max_energy FROM tests.{table_name};&quot;
15	    native_query_grouping = f&quot;SELECT active_region_ar, COUNT(*) AS flare_count  FROM tests.{table_name} GROUP BY active_region_ar;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-425">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/test_postgresql.py" target="_blank">/mindsdb/tests/load/test_postgresql.py</a><br>
    <b>Line number: </b>13<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	from tests.load.tasks import BaseDBConnectionBehavior
2	
3	
4	class PostgreSQLConnectionBehavior(BaseDBConnectionBehavior):
5	    &quot;&quot;&quot;
6	    This class defines the behavior of a PostgreSQL connection.
7	    @TODO: Read query values from sql_queries.json file
8	    &quot;&quot;&quot;
9	    db_type = &quot;postgres&quot;
10	    table_name = &quot;solar_flare_data&quot;
11	    native_queries = [&quot;native_query_average&quot;, &quot;native_query_aggregation&quot;, &quot;native_query_max&quot;, &quot;native_query_grouping&quot;]
12	    native_query_aggregation = f&quot;SELECT COUNT(*) AS total_flares FROM tests.{table_name};&quot;
13	    native_query_average = f&quot;SELECT AVG(peak_c_per_s) AS avg_peak_counts FROM tests.{table_name};&quot;
14	    native_query_max = f&quot;SELECT MAX(energy_kev) AS max_energy FROM tests.{table_name};&quot;
15	    native_query_grouping = f&quot;SELECT active_region_ar, COUNT(*) AS flare_count  FROM tests.{table_name} GROUP BY active_region_ar;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-426">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/test_postgresql.py" target="_blank">/mindsdb/tests/load/test_postgresql.py</a><br>
    <b>Line number: </b>14<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	from tests.load.tasks import BaseDBConnectionBehavior
2	
3	
4	class PostgreSQLConnectionBehavior(BaseDBConnectionBehavior):
5	    &quot;&quot;&quot;
6	    This class defines the behavior of a PostgreSQL connection.
7	    @TODO: Read query values from sql_queries.json file
8	    &quot;&quot;&quot;
9	    db_type = &quot;postgres&quot;
10	    table_name = &quot;solar_flare_data&quot;
11	    native_queries = [&quot;native_query_average&quot;, &quot;native_query_aggregation&quot;, &quot;native_query_max&quot;, &quot;native_query_grouping&quot;]
12	    native_query_aggregation = f&quot;SELECT COUNT(*) AS total_flares FROM tests.{table_name};&quot;
13	    native_query_average = f&quot;SELECT AVG(peak_c_per_s) AS avg_peak_counts FROM tests.{table_name};&quot;
14	    native_query_max = f&quot;SELECT MAX(energy_kev) AS max_energy FROM tests.{table_name};&quot;
15	    native_query_grouping = f&quot;SELECT active_region_ar, COUNT(*) AS flare_count  FROM tests.{table_name} GROUP BY active_region_ar;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-427">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/load/test_postgresql.py" target="_blank">/mindsdb/tests/load/test_postgresql.py</a><br>
    <b>Line number: </b>15<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	from tests.load.tasks import BaseDBConnectionBehavior
2	
3	
4	class PostgreSQLConnectionBehavior(BaseDBConnectionBehavior):
5	    &quot;&quot;&quot;
6	    This class defines the behavior of a PostgreSQL connection.
7	    @TODO: Read query values from sql_queries.json file
8	    &quot;&quot;&quot;
9	    db_type = &quot;postgres&quot;
10	    table_name = &quot;solar_flare_data&quot;
11	    native_queries = [&quot;native_query_average&quot;, &quot;native_query_aggregation&quot;, &quot;native_query_max&quot;, &quot;native_query_grouping&quot;]
12	    native_query_aggregation = f&quot;SELECT COUNT(*) AS total_flares FROM tests.{table_name};&quot;
13	    native_query_average = f&quot;SELECT AVG(peak_c_per_s) AS avg_peak_counts FROM tests.{table_name};&quot;
14	    native_query_max = f&quot;SELECT MAX(energy_kev) AS max_energy FROM tests.{table_name};&quot;
15	    native_query_grouping = f&quot;SELECT active_region_ar, COUNT(*) AS flare_count  FROM tests.{table_name} GROUP BY active_region_ar;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-428">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/tests/scripts/check_requirements.py" target="_blank">/mindsdb/tests/scripts/check_requirements.py</a><br>
    <b>Line number: </b>4<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import glob
2	import re
3	import sys
4	import subprocess
5	import os
6	import json
7	
8	pattern = &#x27;\=|~|&gt;|&lt;| |\n|#|\[&#x27;  # noqa: W605
9	
10	
11	def get_requirements_from_file(path):
12	    &quot;&quot;&quot;Takes a requirements file path and extracts only the package names from it&quot;&quot;&quot;
13	
14	    with open(path, &#x27;r&#x27;) as main_f:
15	        reqs = [
16	            re.split(pattern, line)[0]
17	            for line in main_f.readlines()
18	            if re.split(pattern, line)[0]
19	        ]
20	    return reqs
21	
22	
23	MAIN_REQS_PATH = &quot;requirements/requirements.txt&quot;
24	DEV_REQS_PATH = &quot;requirements/requirements-dev.txt&quot;
25	TEST_REQS_PATH = &quot;requirements/requirements-test.txt&quot;
26	
27	HANDLER_REQS_PATHS = list(
28	    set(glob.glob(&quot;**/requirements*.txt&quot;, recursive=True))
29	    - set(glob.glob(&quot;requirements/requirements*.txt&quot;))
30	)
31	
32	MAIN_EXCLUDE_PATHS = [&quot;mindsdb/integrations/handlers/.*_handler&quot;, &quot;pryproject.toml&quot;]
</pre>
</div>


</div>
</div>

<div id="issue-429">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/tests/scripts/check_requirements.py" target="_blank">/mindsdb/tests/scripts/check_requirements.py</a><br>
    <b>Line number: </b>150<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
134	        print()
135	
136	
137	def get_ignores_str(ignores_dict):
138	    &quot;&quot;&quot;Get a list of rule ignores for deptry&quot;&quot;&quot;
139	
140	    return &quot;,&quot;.join([f&quot;{k}={&#x27;|&#x27;.join(v)}&quot; for k, v in ignores_dict.items()])
141	
142	
143	def run_deptry(reqs, rule_ignores, path, extra_args=&quot;&quot;):
144	    &quot;&quot;&quot;Run a dependency check with deptry. Return a list of error messages&quot;&quot;&quot;
145	
146	    errors = []
147	    try:
148	        result = subprocess.run(
149	            f&quot;deptry -o deptry.json --no-ansi --known-first-party mindsdb --requirements-txt \&quot;{reqs}\&quot; --per-rule-ignores \&quot;{rule_ignores}\&quot; --package-module-name-map \&quot;{get_ignores_str(PACKAGE_NAME_MAP)}\&quot; {extra_args} {path}&quot;,
150	            shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.PIPE
151	        )
152	        if result.returncode != 0 and not os.path.exists(&quot;deptry.json&quot;):
153	            # There was some issue with running deptry
154	            errors.append(f&quot;Error running deptry: {result.stderr.decode(&#x27;utf-8&#x27;)}&quot;)
155	
156	        with open(&quot;deptry.json&quot;, &quot;r&quot;) as f:
157	            deptry_results = json.loads(f.read())
158	        for r in deptry_results:
159	            errors.append(
160	                f&quot;{r[&#x27;location&#x27;][&#x27;line&#x27;]}:{r[&#x27;location&#x27;][&#x27;column&#x27;]}: {r[&#x27;error&#x27;][&#x27;code&#x27;]} {r[&#x27;error&#x27;][&#x27;message&#x27;]}&quot;)
161	    finally:
162	        if os.path.exists(&quot;deptry.json&quot;):
163	            os.remove(&quot;deptry.json&quot;)
164	    return errors
165	
166	
167	def check_for_requirements_duplicates():
168	    &quot;&quot;&quot;Checks that handler requirements.txt and the main requirements.txt don&#x27;t contain any of the same packages&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-430">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_api_handler.py" target="_blank">/mindsdb/tests/unit/executor/test_api_handler.py</a><br>
    <b>Line number: </b>19<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
3	
4	from unittest.mock import patch
5	import datetime as dt
6	
7	import pandas as pd
8	
9	from tests.unit.executor_test_base import BaseExecutorDummyML
10	
11	from dataclasses import dataclass
12	
13	
14	# import modules virtually if it is not installed
15	try:
16	    import github  # noqa
17	except ImportError:
18	    module = types.ModuleType(&#x27;&#x27;)
19	    exec(&#x27;Github=None&#x27;, module.__dict__)
20	    sys.modules[&#x27;github&#x27;] = module
21	
22	try:
23	    import chardet  # noqa
24	except ImportError:
25	    sys.modules[&#x27;chardet&#x27;] = types.ModuleType(&#x27;&#x27;)
26	
27	
28	class TestApiHandler(BaseExecutorDummyML):
29	
30	    @patch(&#x27;github.Github&#x27;)
31	    def test_github(self, Github):
32	        &quot;&quot;&quot;
33	        Test for APIResource
34	        &quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-431">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_base_queires.py" target="_blank">/mindsdb/tests/unit/executor/test_base_queires.py</a><br>
    <b>Line number: </b>243<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
227	        ret = self.run_sql(sql)
228	        assert len(ret) == 3
229	
230	        assert list(ret.iloc[0]) == [21, 3]
231	        assert list(ret.iloc[1]) == [1, 1]
232	        assert list(ret.iloc[2]) == [2, 2]
233	
234	        # -- aggregating / grouping / cases --
235	        case = &#x27;&#x27;&#x27;
236	            case when s.id=1 then 10
237	                 when s.id=2 then 20
238	                 when s.id=3 then 30
239	                 else 100
240	            end
241	        &#x27;&#x27;&#x27;
242	
243	        sql = f&#x27;&#x27;&#x27;
244	             SELECT
245	               -- values for region_id=2: [20, 30, 100, 100]
246	               MAX({case}) c_max,   -- =100
247	               MIN({case}) c_min,   -- =20
248	               SUM({case}) c_sum,   -- =250
249	               COUNT({case}) c_count, -- =4
250	               AVG({case}) c_avg   -- 250/4=62.5
251	            from stores_view s  -- view is used
252	             join files.regions r on r.id = s.region_id
253	             join model1 m1
254	            group by r.id -- 2 records
255	            having max(r.id) = 2 -- 1 record
256	        &#x27;&#x27;&#x27;
257	
258	        ret = self.run_sql(sql)
259	
260	        assert len(ret) == 1
261	
262	        assert ret.c_max[0] == 100
263	        assert ret.c_min[0] == 20
264	        assert ret.c_sum[0] == 250
265	        assert ret.c_count[0] == 4
266	        assert ret.c_avg[0] == 62.5
267	
268	        sql = &#x27;&#x27;&#x27;
269	           SELECT
270	             s.*,
271	            ROW_NUMBER() OVER(PARTITION BY r.id ORDER BY s.id) ROW_NUMBER,
</pre>
</div>


</div>
</div>

<div id="issue-432">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_executor.py" target="_blank">/mindsdb/tests/unit/executor/test_executor.py</a><br>
    <b>Line number: </b>1004<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
988	        # --- drop view ---
989	        self.execute(&#x27;drop view vtasks&#x27;)
990	
991	    @patch(&#x27;mindsdb.integrations.handlers.postgres_handler.Handler&#x27;)
992	    def test_use_predictor_with_view(self, mock_handler):
993	        # set integration data
994	
995	        df = pd.DataFrame([
996	            {&#x27;a&#x27;: 1, &#x27;b&#x27;: &#x27;one&#x27;},
997	            {&#x27;a&#x27;: 2, &#x27;b&#x27;: &#x27;two&#x27;},
998	            {&#x27;a&#x27;: 1, &#x27;b&#x27;: &#x27;three&#x27;},
999	        ])
1000	        self.set_handler(mock_handler, name=&#x27;pg&#x27;, tables={&#x27;tasks&#x27;: df})
1001	
1002	        view_name = &#x27;vtasks&#x27;
1003	        # --- create view ---
1004	        self.execute(f&#x27;create view mindsdb.{view_name} (select * from pg (select * from tasks))&#x27;)
1005	
1006	        # --- use predictor ---
1007	        predicted_value = 3.14
1008	        predictor = {
1009	            &#x27;name&#x27;: &#x27;task_model&#x27;,
1010	            &#x27;predict&#x27;: &#x27;p&#x27;,
1011	            &#x27;dtypes&#x27;: {
1012	                &#x27;p&#x27;: dtype.float,
1013	                &#x27;a&#x27;: dtype.integer,
1014	                &#x27;b&#x27;: dtype.categorical
1015	            },
1016	            &#x27;predicted_value&#x27;: predicted_value
1017	        }
1018	        self.set_predictor(predictor)
1019	        ret = self.execute(f&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-433">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_executor.py" target="_blank">/mindsdb/tests/unit/executor/test_executor.py</a><br>
    <b>Line number: </b>1019<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1003	        # --- create view ---
1004	        self.execute(f&#x27;create view mindsdb.{view_name} (select * from pg (select * from tasks))&#x27;)
1005	
1006	        # --- use predictor ---
1007	        predicted_value = 3.14
1008	        predictor = {
1009	            &#x27;name&#x27;: &#x27;task_model&#x27;,
1010	            &#x27;predict&#x27;: &#x27;p&#x27;,
1011	            &#x27;dtypes&#x27;: {
1012	                &#x27;p&#x27;: dtype.float,
1013	                &#x27;a&#x27;: dtype.integer,
1014	                &#x27;b&#x27;: dtype.categorical
1015	            },
1016	            &#x27;predicted_value&#x27;: predicted_value
1017	        }
1018	        self.set_predictor(predictor)
1019	        ret = self.execute(f&quot;&quot;&quot;
1020	           select m.p, v.a
1021	           from mindsdb.{view_name} v
1022	           join mindsdb.task_model m
1023	           where v.a = 2
1024	        &quot;&quot;&quot;)
1025	
1026	        # native query was called
1027	        assert mock_handler().native_query.call_args[0][0] == &#x27;select * from tasks&#x27;
1028	
1029	        # check predictor call
1030	        # input = one row whit a==2
1031	        data_in = self.mock_predict.call_args[0][1]
1032	        assert len(data_in) == 1
1033	        assert data_in.iloc[0][&#x27;a&#x27;] == 2
1034	
1035	        # check prediction
1036	        assert ret.data.to_lists()[0][0] == predicted_value
1037	        assert len(ret.data) == 1
1038	
1039	    @patch(&#x27;mindsdb.integrations.handlers.postgres_handler.Handler&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-434">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_executor.py" target="_blank">/mindsdb/tests/unit/executor/test_executor.py</a><br>
    <b>Line number: </b>1057<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1041	        # set integration data
1042	
1043	        df = pd.DataFrame([
1044	            {&#x27;a&#x27;: 1, &#x27;t&#x27;: dt.datetime(2020, 1, 1), &#x27;g&#x27;: &#x27;x&#x27;},
1045	            {&#x27;a&#x27;: 2, &#x27;t&#x27;: dt.datetime(2020, 1, 2), &#x27;g&#x27;: &#x27;x&#x27;},
1046	            {&#x27;a&#x27;: 3, &#x27;t&#x27;: dt.datetime(2020, 1, 3), &#x27;g&#x27;: &#x27;x&#x27;},
1047	            {&#x27;a&#x27;: 4, &#x27;t&#x27;: dt.datetime(2020, 1, 1), &#x27;g&#x27;: &#x27;y&#x27;},
1048	            {&#x27;a&#x27;: 5, &#x27;t&#x27;: dt.datetime(2020, 1, 2), &#x27;g&#x27;: &#x27;y&#x27;},
1049	            {&#x27;a&#x27;: 6, &#x27;t&#x27;: dt.datetime(2020, 1, 3), &#x27;g&#x27;: &#x27;y&#x27;},
1050	            {&#x27;a&#x27;: 7, &#x27;t&#x27;: dt.datetime(2020, 1, 1), &#x27;g&#x27;: &#x27;z&#x27;},
1051	            {&#x27;a&#x27;: 8, &#x27;t&#x27;: dt.datetime(2020, 1, 2), &#x27;g&#x27;: &#x27;z&#x27;},
1052	            {&#x27;a&#x27;: 9, &#x27;t&#x27;: dt.datetime(2020, 1, 3), &#x27;g&#x27;: &#x27;z&#x27;},
1053	        ])
1054	        self.set_handler(mock_handler, name=&#x27;pg&#x27;, tables={&#x27;tasks&#x27;: df})
1055	        view_name = &#x27;vtasks&#x27;
1056	        # --- create view ---
1057	        self.execute(f&#x27;create view {view_name} (select * from pg (select * from tasks))&#x27;)
1058	
1059	        # --- use TS predictor ---
1060	        predicted_value = &#x27;right&#x27;
1061	        predictor = {
1062	            &#x27;name&#x27;: &#x27;task_model&#x27;,
1063	            &#x27;predict&#x27;: &#x27;p&#x27;,
1064	            &#x27;problem_definition&#x27;: {
1065	                &#x27;timeseries_settings&#x27;: {
1066	                    &#x27;is_timeseries&#x27;: True,
1067	                    &#x27;window&#x27;: 10,
1068	                    &#x27;order_by&#x27;: &#x27;t&#x27;,
1069	                    &#x27;group_by&#x27;: &#x27;g&#x27;,
1070	                    &#x27;horizon&#x27;: 1
1071	                }
1072	            },
</pre>
</div>


</div>
</div>

<div id="issue-435">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_executor.py" target="_blank">/mindsdb/tests/unit/executor/test_executor.py</a><br>
    <b>Line number: </b>1082<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1066	                    &#x27;is_timeseries&#x27;: True,
1067	                    &#x27;window&#x27;: 10,
1068	                    &#x27;order_by&#x27;: &#x27;t&#x27;,
1069	                    &#x27;group_by&#x27;: &#x27;g&#x27;,
1070	                    &#x27;horizon&#x27;: 1
1071	                }
1072	            },
1073	            &#x27;dtypes&#x27;: {
1074	                &#x27;p&#x27;: dtype.categorical,
1075	                &#x27;a&#x27;: dtype.integer,
1076	                &#x27;t&#x27;: dtype.date,
1077	                &#x27;g&#x27;: dtype.categorical,
1078	            },
1079	            &#x27;predicted_value&#x27;: predicted_value
1080	        }
1081	        self.set_predictor(predictor)
1082	        ret = self.execute(f&quot;&quot;&quot;
1083	           select task_model.*
1084	           from mindsdb.{view_name}
1085	           join mindsdb.task_model
1086	           where {view_name}.t = latest
1087	        &quot;&quot;&quot;)
1088	
1089	        # native query was called without filters
1090	        assert mock_handler().native_query.call_args[0][0] == &#x27;select * from tasks&#x27;
1091	
1092	        # input to predictor all 9 rows
1093	        when_data = self.mock_predict.call_args[0][1]
1094	        assert len(when_data) == 9
1095	
1096	        # all group values in input
1097	        group_values = {&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;}
1098	        assert set(pd.DataFrame(when_data)[&#x27;g&#x27;].unique()) == group_values
1099	
1100	        # check prediction
1101	        # output is has  g==&#x27;y&#x27; or None
1102	        ret_df = self.ret_to_df(ret)
</pre>
</div>


</div>
</div>

<div id="issue-436">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_string: </b> Possible hardcoded password: '******'<br>
    <b>Test ID:</b> B105<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_executor.py" target="_blank">/mindsdb/tests/unit/executor/test_executor.py</a><br>
    <b>Line number: </b>1426<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b105_hardcoded_password_string.html</a><br>

<div class="code">
<pre>
1410	            WHERE tables_in_mindsdb = &#x27;test_view2&#x27;
1411	        &quot;&quot;&quot;)
1412	        assert len(ret.data) == 0
1413	
1414	        # drop again without if exists should throw an error
1415	        sql = &quot;&quot;&quot;
1416	            DROP VIEW test_view2
1417	        &quot;&quot;&quot;
1418	        with pytest.raises(EntityNotExistsError):
1419	            self.execute(&#x27;DROP VIEW test_view2&#x27;)
1420	
1421	        # drop again with if exists should not throw an error
1422	        self.execute(&#x27;DROP VIEW IF EXISTS test_view2&#x27;)
1423	
1424	    @patch(&#x27;mindsdb.integrations.handlers.postgres_handler.Handler&#x27;)
1425	    def test_hide_secrets(self, mock_handler):
1426	        HIDDEN_PASSWORD = &#x27;******&#x27;
1427	        df = pd.DataFrame([
1428	            {&#x27;a&#x27;: 1, &#x27;b&#x27;: &#x27;one&#x27;},
1429	            {&#x27;a&#x27;: 2, &#x27;b&#x27;: &#x27;two&#x27;},
1430	            {&#x27;a&#x27;: 1, &#x27;b&#x27;: &#x27;three&#x27;},
1431	        ])
1432	        self.set_handler(mock_handler, name=&#x27;pg&#x27;, tables={&#x27;tasks&#x27;: df})
1433	
1434	        self.execute(&quot;&quot;&quot;
1435	            create ml_engine ml_test from dummy_ml using api_key = &#x27;123456&#x27;
1436	        &quot;&quot;&quot;)
1437	
1438	        # region Check that every secret is hidden
1439	        ret = self.execute(&quot;&quot;&quot;
1440	            select * from information_schema.ml_engines where name = &#x27;ml_test&#x27;
1441	        &quot;&quot;&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-437">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor/test_schema.py" target="_blank">/mindsdb/tests/unit/executor/test_schema.py</a><br>
    <b>Line number: </b>192<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
176	        assert &#x27;dummy_ml&#x27; in list(df.NAME)
177	
178	        # databases
179	        df = self.run_sql(&#x27;select * from information_schema.DATABASES&#x27;)
180	        assert &#x27;mindsdb&#x27; in list(df.NAME)
181	        assert &#x27;proj2&#x27; in list(df.NAME)
182	        assert &#x27;log&#x27; in list(df.NAME)
183	
184	        # ml engines
185	        df = self.run_sql(&#x27;select * from information_schema.ML_ENGINES&#x27;)
186	        assert &#x27;engine1&#x27; in list(df.NAME)
187	
188	        # project objects
189	        def _test_proj_obj(table_name, obj_name):
190	            # obj1 in mindsdb, obj2 in proj2
191	
192	            df = self.run_sql(f&#x27;select * from information_schema.{table_name}&#x27;)
193	            assert len(df) == 2
194	
195	            df1 = df[df.PROJECT == &#x27;mindsdb&#x27;]
196	            assert df1.iloc[0].NAME == f&#x27;{obj_name}1&#x27;
197	
198	            df1 = df[df.PROJECT == &#x27;proj2&#x27;]
199	            assert df1.iloc[0].NAME == f&#x27;{obj_name}2&#x27;
200	
201	        _test_proj_obj(&#x27;JOBS&#x27;, &#x27;j&#x27;)
202	        _test_proj_obj(&#x27;VIEWS&#x27;, &#x27;v&#x27;)
203	        _test_proj_obj(&#x27;TRIGGERS&#x27;, &#x27;trigger&#x27;)
204	        _test_proj_obj(&#x27;CHATBOTS&#x27;, &#x27;chatbot&#x27;)
205	        _test_proj_obj(&#x27;AGENTS&#x27;, &#x27;agent&#x27;)
206	        _test_proj_obj(&#x27;SKILLS&#x27;, &#x27;skill&#x27;)
207	
</pre>
</div>


</div>
</div>

<div id="issue-438">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor_test_base.py" target="_blank">/mindsdb/tests/unit/executor_test_base.py</a><br>
    <b>Line number: </b>138<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
122	        db.session.add(r)
123	
124	        db.session.flush()
125	
126	        self.lw_integration_id = r.id
127	
128	        # default project
129	        r = db.Project(name=&quot;mindsdb&quot;)
130	        db.session.add(r)
131	
132	        db.session.commit()
133	        return db
134	
135	    def set_data(self, table, data):
136	        con = duckdb.connect(self._dummy_db_path)
137	        con.execute(&#x27;DROP TABLE IF EXISTS {}&#x27;.format(table))
138	        con.execute(&#x27;CREATE TABLE {} AS SELECT * FROM data&#x27;.format(table))
139	
140	    def wait_predictor(self, project, name, timeout=100, filters=None):
141	        &quot;&quot;&quot;
142	        Wait for the predictor to be created,
143	        raising an exception if predictor creation fails or exceeds timeout
144	        &quot;&quot;&quot;
145	        for attempt in range(timeout):
146	            sql = f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
147	            if filters is not None:
148	                for k, v in filters.items():
149	                    sql += f&quot; and {k}=&#x27;{v}&#x27;&quot;
150	            ret = self.run_sql(sql)
151	            if not ret.empty:
152	                status = ret[&quot;STATUS&quot;][0]
153	                if status == &quot;complete&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-439">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor_test_base.py" target="_blank">/mindsdb/tests/unit/executor_test_base.py</a><br>
    <b>Line number: </b>146<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
130	        db.session.add(r)
131	
132	        db.session.commit()
133	        return db
134	
135	    def set_data(self, table, data):
136	        con = duckdb.connect(self._dummy_db_path)
137	        con.execute(&#x27;DROP TABLE IF EXISTS {}&#x27;.format(table))
138	        con.execute(&#x27;CREATE TABLE {} AS SELECT * FROM data&#x27;.format(table))
139	
140	    def wait_predictor(self, project, name, timeout=100, filters=None):
141	        &quot;&quot;&quot;
142	        Wait for the predictor to be created,
143	        raising an exception if predictor creation fails or exceeds timeout
144	        &quot;&quot;&quot;
145	        for attempt in range(timeout):
146	            sql = f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
147	            if filters is not None:
148	                for k, v in filters.items():
149	                    sql += f&quot; and {k}=&#x27;{v}&#x27;&quot;
150	            ret = self.run_sql(sql)
151	            if not ret.empty:
152	                status = ret[&quot;STATUS&quot;][0]
153	                if status == &quot;complete&quot;:
154	                    return
155	                elif status == &quot;error&quot;:
156	                    raise RuntimeError(&quot;Predictor failed&quot;, ret[&quot;ERROR&quot;][0])
157	            time.sleep(0.5)
158	        raise RuntimeError(&quot;Predictor wasn&#x27;t created&quot;)
159	
160	    def run_sql(self, sql):
161	        &quot;&quot;&quot;Execute SQL and return a DataFrame, raising an AssertionError if an error occurs&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-440">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of insecure and deprecated function (mktemp).<br>
    <b>Test ID:</b> B306<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/377.html" target="_blank">CWE-377</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/executor_test_base.py" target="_blank">/mindsdb/tests/unit/executor_test_base.py</a><br>
    <b>Line number: </b>271<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b306-mktemp-q" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b306-mktemp-q</a><br>

<div class="code">
<pre>
255	        sql_session = SessionController()
256	        sql_session.database = &quot;mindsdb&quot;
257	        sql_session.integration_controller = integration_controller
258	
259	        self.command_executor = ExecuteCommands(sql_session)
260	
261	        # disable cache. it is need to check predictor input
262	        config_patch = mock.patch(&quot;mindsdb.utilities.cache.FileCache.get&quot;)
263	        self.mock_config = config_patch.__enter__()
264	        self.mock_config.side_effect = lambda x: None
265	
266	    def teardown_method(self):
267	        # Don&#x27;t want cache to pick up a stale version with the wrong duckdb_path.
268	        self.command_executor.session.integration_controller.delete(&#x27;dummy_data&#x27;)
269	
270	    def save_file(self, name, df):
271	        file_path = tempfile.mktemp(prefix=&quot;mindsdb_file_&quot;)
272	        df.to_parquet(file_path)
273	        self.file_controller.save_file(name, file_path, name)
274	
275	    def set_handler(self, mock_handler, name, tables, engine=&quot;postgres&quot;):
276	        # integration
277	        # delete by name
278	        r = self.db.Integration.query.filter_by(name=name).first()
279	        if r is not None:
280	            self.db.session.delete(r)
281	
282	        # create
283	        r = self.db.Integration(
284	            name=name,
285	            data={&#x27;password&#x27;: &#x27;secret&#x27;},
286	            engine=engine
</pre>
</div>


</div>
</div>

<div id="issue-441">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_bigquery.py" target="_blank">/mindsdb/tests/unit/handlers/test_bigquery.py</a><br>
    <b>Line number: </b>91<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
75	
76	        with patch(&#x27;mindsdb.integrations.handlers.bigquery_handler.bigquery_handler.QueryJobConfig&#x27;) as mock_query_job_config:
77	            mock_query_job_config_instance = mock_query_job_config.return_value
78	            data = self.handler.native_query(query_str)
79	            mock_conn.query.assert_called_once_with(query_str, job_config=mock_query_job_config_instance)
80	            assert isinstance(data, Response)
81	            self.assertFalse(data.error_code)
82	
83	    def test_get_tables(self):
84	        &quot;&quot;&quot;
85	        Checks if the `get_tables` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
86	        &quot;&quot;&quot;
87	        self.handler.native_query = MagicMock()
88	
89	        self.handler.get_tables()
90	
91	        expected_query = f&quot;&quot;&quot;
92	            SELECT table_name, table_schema, table_type
93	            FROM `{self.dummy_connection_data[&#x27;project_id&#x27;]}.{self.dummy_connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.TABLES`
94	            WHERE table_type IN (&#x27;BASE TABLE&#x27;, &#x27;VIEW&#x27;)
95	        &quot;&quot;&quot;
96	
97	        self.handler.native_query.assert_called_once_with(expected_query)
98	
99	    def test_get_columns(self):
100	        &quot;&quot;&quot;
101	        Checks if the `get_columns` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
102	        &quot;&quot;&quot;
103	        self.handler.native_query = MagicMock()
104	
105	        table_name = &#x27;mock_table&#x27;
106	        self.handler.get_columns(table_name)
107	
108	        expected_query = f&quot;&quot;&quot;
109	            SELECT column_name AS Field, data_type as Type
110	            FROM `{self.dummy_connection_data[&#x27;project_id&#x27;]}.{self.dummy_connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.COLUMNS`
</pre>
</div>


</div>
</div>

<div id="issue-442">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_bigquery.py" target="_blank">/mindsdb/tests/unit/handlers/test_bigquery.py</a><br>
    <b>Line number: </b>108<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
92	            SELECT table_name, table_schema, table_type
93	            FROM `{self.dummy_connection_data[&#x27;project_id&#x27;]}.{self.dummy_connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.TABLES`
94	            WHERE table_type IN (&#x27;BASE TABLE&#x27;, &#x27;VIEW&#x27;)
95	        &quot;&quot;&quot;
96	
97	        self.handler.native_query.assert_called_once_with(expected_query)
98	
99	    def test_get_columns(self):
100	        &quot;&quot;&quot;
101	        Checks if the `get_columns` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
102	        &quot;&quot;&quot;
103	        self.handler.native_query = MagicMock()
104	
105	        table_name = &#x27;mock_table&#x27;
106	        self.handler.get_columns(table_name)
107	
108	        expected_query = f&quot;&quot;&quot;
109	            SELECT column_name AS Field, data_type as Type
110	            FROM `{self.dummy_connection_data[&#x27;project_id&#x27;]}.{self.dummy_connection_data[&#x27;dataset&#x27;]}.INFORMATION_SCHEMA.COLUMNS`
111	            WHERE table_name = &#x27;{table_name}&#x27;
112	        &quot;&quot;&quot;
113	
114	        self.handler.native_query.assert_called_once_with(expected_query)
115	
116	
117	if __name__ == &#x27;__main__&#x27;:
118	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-443">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'example_pass'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_clickhouse.py" target="_blank">/mindsdb/tests/unit/handlers/test_clickhouse.py</a><br>
    <b>Line number: </b>13<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
1	import unittest
2	from unittest.mock import patch, MagicMock
3	from sqlalchemy.exc import SQLAlchemyError
4	from collections import OrderedDict
5	from mindsdb.integrations.handlers.clickhouse_handler.clickhouse_handler import ClickHouseHandler
6	from mindsdb.integrations.libs.response import (
7	    HandlerResponse as Response
8	)
9	
10	
11	class TestClickHouseHandler(unittest.TestCase):
12	
13	    dummy_connection_data = OrderedDict(
14	        host=&#x27;127.0.0.1&#x27;,
15	        port=8123,
16	        user=&#x27;example_user&#x27;,
17	        password=&#x27;example_pass&#x27;,
18	        database=&#x27;example_db&#x27;,
19	        protocol=&#x27;native&#x27;
20	    )
21	
22	    def setUp(self):
23	        self.patcher = patch(&#x27;mindsdb.integrations.handlers.clickhouse_handler.clickhouse_handler.create_engine&#x27;, return_value=MagicMock())
24	        self.mock_connect = self.patcher.start()
25	        self.mock_engine = MagicMock()
26	        self.handler = ClickHouseHandler(&quot;test_handler&quot;, connection_data=self.dummy_connection_data)
27	
28	    def tearDown(self):
29	        self.patcher.stop()
30	
31	    def test_initialization(self):
32	        &quot;&quot;&quot;Test if the handler initializes with correct values and defaults.&quot;&quot;&quot;
33	        self.mock_connect.return_value = MagicMock()
34	        self.assertEqual(self.handler.name, &quot;test_handler&quot;)
35	        self.assertEqual(self.handler.dialect, &quot;clickhouse&quot;)
36	        self.assertFalse(self.handler.is_connected)
37	        self.assertEqual(self.handler.protocol, &quot;native&quot;)
38	
39	    def test_connect(self):
</pre>
</div>


</div>
</div>

<div id="issue-444">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'example_pass'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_mssql.py" target="_blank">/mindsdb/tests/unit/handlers/test_mssql.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
7	    HandlerResponse as Response,
8	    HandlerStatusResponse as StatusResponse,
9	)
10	from mindsdb.integrations.handlers.mssql_handler.mssql_handler import SqlServerHandler
11	
12	
13	class CursorContextManager(Mock):
14	    def __enter__(self):
15	        return self
16	
17	    def __exit__(self, *args):
18	        pass
19	
20	
21	class TestMSSQLHandler(unittest.TestCase):
22	
23	    dummy_connection_data = OrderedDict(
24	        host=&#x27;127.0.0.1&#x27;,
25	        port=1433,
26	        user=&#x27;example_user&#x27;,
27	        password=&#x27;example_pass&#x27;,
28	        database=&#x27;example_db&#x27;,
29	    )
30	
31	    def setUp(self):
32	        self.patcher = patch(&#x27;pymssql.connect&#x27;)
33	        self.mock_connect = self.patcher.start()
34	        self.handler = SqlServerHandler(&#x27;mssql&#x27;, connection_data=self.dummy_connection_data)
35	
36	    def tearDown(self):
37	        self.patcher.stop()
38	
39	    def test_connect_success(self):
40	        &quot;&quot;&quot;
41	        Test if `connect` method successfully establishes a connection and sets `is_connected` flag to True.
42	        Also, verifies that pymssql.connect is called exactly once.
43	        &quot;&quot;&quot;
44	
</pre>
</div>


</div>
</div>

<div id="issue-445">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_mssql.py" target="_blank">/mindsdb/tests/unit/handlers/test_mssql.py</a><br>
    <b>Line number: </b>104<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
88	        query_str = &quot;SELECT * FROM table&quot;
89	        data = self.handler.native_query(query_str)
90	        mock_cursor.execute.assert_called_once_with(query_str)
91	        assert isinstance(data, Response)
92	        self.assertFalse(data.error_code)
93	
94	    def test_get_columns(self):
95	        &quot;&quot;&quot;
96	        Checks if the `get_columns` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
97	        &quot;&quot;&quot;
98	
99	        self.handler.native_query = MagicMock()
100	
101	        table_name = &#x27;mock_table&#x27;
102	        self.handler.get_columns(table_name)
103	
104	        expected_query = f&quot;&quot;&quot;
105	            SELECT
106	                column_name as &quot;Field&quot;,
107	                data_type as &quot;Type&quot;
108	            FROM
109	                information_schema.columns
110	            WHERE
111	                table_name = &#x27;{table_name}&#x27;
112	        &quot;&quot;&quot;
113	
114	        self.handler.native_query.assert_called_once_with(expected_query)
115	
116	    def test_get_tables(self):
117	        &quot;&quot;&quot;
118	        Tests the `get_tables` method to confirm it correctly calls `native_query` with the appropriate SQL command.
119	        &quot;&quot;&quot;
120	
121	        self.handler.native_query = MagicMock()
122	        self.handler.get_tables()
123	
124	        expected_query = f&quot;&quot;&quot;
125	            SELECT
126	                table_schema,
127	                table_name,
</pre>
</div>


</div>
</div>

<div id="issue-446">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_mssql.py" target="_blank">/mindsdb/tests/unit/handlers/test_mssql.py</a><br>
    <b>Line number: </b>124<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
108	            FROM
109	                information_schema.columns
110	            WHERE
111	                table_name = &#x27;{table_name}&#x27;
112	        &quot;&quot;&quot;
113	
114	        self.handler.native_query.assert_called_once_with(expected_query)
115	
116	    def test_get_tables(self):
117	        &quot;&quot;&quot;
118	        Tests the `get_tables` method to confirm it correctly calls `native_query` with the appropriate SQL command.
119	        &quot;&quot;&quot;
120	
121	        self.handler.native_query = MagicMock()
122	        self.handler.get_tables()
123	
124	        expected_query = f&quot;&quot;&quot;
125	            SELECT
126	                table_schema,
127	                table_name,
128	                table_type
129	            FROM {self.dummy_connection_data[&#x27;database&#x27;]}.INFORMATION_SCHEMA.TABLES
130	            WHERE TABLE_TYPE in (&#x27;BASE TABLE&#x27;, &#x27;VIEW&#x27;);
131	        &quot;&quot;&quot;
132	
133	        self.handler.native_query.assert_called_once_with(expected_query)
134	
135	
136	if __name__ == &#x27;__main__&#x27;:
137	    unittest.main()
</pre>
</div>


</div>
</div>

<div id="issue-447">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'example_pass'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_mysql.py" target="_blank">/mindsdb/tests/unit/handlers/test_mysql.py</a><br>
    <b>Line number: </b>26<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
10	
11	class CursorContextManager(Mock):
12	    def __enter__(self):
13	        return self
14	
15	    def __exit__(self, *args):
16	        pass
17	
18	    description = [[&#x27;a&#x27;]]
19	
20	    def fetchall(self):
21	        return [[1]]
22	
23	
24	class TestMySQLHandler(unittest.TestCase):
25	
26	    dummy_connection_data = OrderedDict(
27	        host=&#x27;127.0.0.1&#x27;,
28	        port=3306,
29	        user=&#x27;example_user&#x27;,
30	        password=&#x27;example_pass&#x27;,
31	        database=&#x27;example_db&#x27;,
32	        url=&#x27;mysql://example_user:example_pass@localhost:3306/example_db&#x27;
33	    )
34	
35	    def setUp(self):
36	        self.patcher = patch(&#x27;mysql.connector.connect&#x27;)
37	        self.mock_connect = self.patcher.start()
38	        self.handler = MySQLHandler(&#x27;mysql&#x27;, connection_data=self.dummy_connection_data)
39	
40	    def tearDown(self):
41	        self.patcher.stop()
42	
43	    def test_connect_success(self):
44	        self.mock_connect.return_value = MagicMock()
45	        connection = self.handler.connect()
46	        self.assertIsNotNone(connection)
47	        self.assertTrue(self.handler.is_connected)
48	        self.mock_connect.assert_called_once()
</pre>
</div>


</div>
</div>

<div id="issue-448">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'example_pass'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_postgres.py" target="_blank">/mindsdb/tests/unit/handlers/test_postgres.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
7	from mindsdb.integrations.libs.response import (
8	    HandlerResponse as Response,
9	    HandlerStatusResponse as StatusResponse,
10	)
11	
12	
13	class CursorContextManager(Mock):
14	    def __enter__(self):
15	        return self
16	
17	    def __exit__(self, *args):
18	        pass
19	
20	
21	class TestPostgresHandler(unittest.TestCase):
22	
23	    dummy_connection_data = OrderedDict(
24	        host=&#x27;127.0.0.1&#x27;,
25	        port=5432,
26	        user=&#x27;example_user&#x27;,
27	        schema=&#x27;public&#x27;,
28	        password=&#x27;example_pass&#x27;,
29	        database=&#x27;example_db&#x27;,
30	        sslmode=&#x27;prefer&#x27;
31	    )
32	
33	    def setUp(self):
34	        self.patcher = patch(&#x27;psycopg.connect&#x27;)
35	        self.mock_connect = self.patcher.start()
36	        self.handler = PostgresHandler(&#x27;psql&#x27;, connection_data={&#x27;connection_data&#x27;: self.dummy_connection_data})
37	
38	    def tearDown(self):
39	        self.patcher.stop()
40	
41	    def test_connect_success(self):
42	        &quot;&quot;&quot;
43	        Test if `connect` method successfully establishes a connection and sets `is_connected` flag to True.
44	        Also, verifies that psycopg.connect is called exactly once.
45	        &quot;&quot;&quot;
46	        self.mock_connect.return_value = MagicMock()
</pre>
</div>


</div>
</div>

<div id="issue-449">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_postgres.py" target="_blank">/mindsdb/tests/unit/handlers/test_postgres.py</a><br>
    <b>Line number: </b>105<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
89	
90	        query_str = &quot;SELECT * FROM table&quot;
91	        data = self.handler.native_query(query_str)
92	        mock_cursor.execute.assert_called_once_with(query_str)
93	        assert isinstance(data, Response)
94	        self.assertFalse(data.error_code)
95	
96	    def test_get_columns(self):
97	        &quot;&quot;&quot;
98	        Checks if the `get_columns` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
99	        &quot;&quot;&quot;
100	        self.handler.native_query = MagicMock()
101	
102	        table_name = &#x27;mock_table&#x27;
103	        self.handler.get_columns(table_name)
104	
105	        expected_query = f&quot;&quot;&quot;
106	            SELECT
107	                column_name as &quot;Field&quot;,
108	                data_type as &quot;Type&quot;
109	            FROM
110	                information_schema.columns
111	            WHERE
112	                table_name = &#x27;{table_name}&#x27;
113	            AND
114	                table_schema = current_schema()
115	        &quot;&quot;&quot;
116	
117	        self.handler.native_query.assert_called_once_with(expected_query)
118	
119	    def test_get_tables(self):
120	        &quot;&quot;&quot;
121	        Tests the `get_tables` method to confirm it correctly calls `native_query` with the appropriate SQL command.
122	        &quot;&quot;&quot;
123	        self.handler.native_query = MagicMock()
124	        self.handler.get_tables()
125	
126	        expected_query = &quot;&quot;&quot;
127	            SELECT
128	                table_schema,
129	                table_name,
130	                table_type
</pre>
</div>


</div>
</div>

<div id="issue-450">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_redshift.py" target="_blank">/mindsdb/tests/unit/handlers/test_redshift.py</a><br>
    <b>Line number: </b>50<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
34	
35	        self.handler.connect = MagicMock(return_value=mock_conn)
36	        mock_conn.cursor = MagicMock(return_value=mock_cursor)
37	
38	        mock_cursor.executemany.return_value = None
39	
40	        df = pd.DataFrame({
41	            &#x27;column1&#x27;: [1, 2, 3, np.nan],
42	            &#x27;column2&#x27;: [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, None]
43	        })
44	
45	        table_name = &#x27;mock_table&#x27;
46	        response = self.handler.insert(table_name, df)
47	
48	        columns = &#x27;, &#x27;.join([f&#x27;&quot;{col}&quot;&#x27; if &#x27; &#x27; in col else col for col in df.columns])
49	        values = &#x27;, &#x27;.join([&#x27;%s&#x27; for _ in range(len(df.columns))])
50	        expected_query = f&#x27;INSERT INTO {table_name} ({columns}) VALUES ({values})&#x27;
51	
52	        mock_cursor.executemany.assert_called_once_with(expected_query, df.replace({np.nan: None}).values.tolist())
53	        assert isinstance(response, Response)
54	        self.assertEqual(response.type, RESPONSE_TYPE.OK)
55	
56	
57	if __name__ == &#x27;__main__&#x27;:
58	    test_classes_to_run = [TestRedshiftHandler]
59	
60	    loader = unittest.TestLoader()
61	
62	    suites_list = []
63	    for test_class in test_classes_to_run:
64	        suite = loader.loadTestsFromTestCase(test_class)
65	        suites_list.append(suite)
</pre>
</div>


</div>
</div>

<div id="issue-451">
<div class="issue-block issue-sev-low">
    <b>hardcoded_password_funcarg: </b> Possible hardcoded password: 'example_pass'<br>
    <b>Test ID:</b> B106<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/259.html" target="_blank">CWE-259</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_snowflake.py" target="_blank">/mindsdb/tests/unit/handlers/test_snowflake.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b106_hardcoded_password_funcarg.html</a><br>

<div class="code">
<pre>
7	    HandlerResponse as Response,
8	    HandlerStatusResponse as StatusResponse,
9	)
10	from mindsdb.integrations.handlers.snowflake_handler.snowflake_handler import SnowflakeHandler
11	
12	
13	class CursorContextManager(Mock):
14	    def __enter__(self):
15	        return self
16	
17	    def __exit__(self, *args):
18	        pass
19	
20	
21	class TestSnowflakeHandler(unittest.TestCase):
22	
23	    dummy_connection_data = OrderedDict(
24	        account=&#x27;tvuibdy-vm85921&#x27;,
25	        user=&#x27;example_user&#x27;,
26	        password=&#x27;example_pass&#x27;,
27	        database=&#x27;example_db&#x27;,
28	    )
29	
30	    def setUp(self):
31	        self.patcher = patch(&#x27;snowflake.connector.connect&#x27;)
32	        self.mock_connect = self.patcher.start()
33	        self.handler = SnowflakeHandler(&#x27;snowflake&#x27;, connection_data=self.dummy_connection_data)
34	
35	    def tearDown(self):
36	        self.patcher.stop()
37	
38	    def test_connect_success(self):
39	        &quot;&quot;&quot;
40	        Test if `connect` method successfully establishes a connection and sets `is_connected` flag to True.
41	        Also, verifies that snowflake.connector.connect is called exactly once.
42	        &quot;&quot;&quot;
43	
</pre>
</div>


</div>
</div>

<div id="issue-452">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/handlers/test_snowflake.py" target="_blank">/mindsdb/tests/unit/handlers/test_snowflake.py</a><br>
    <b>Line number: </b>103<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
87	        query_str = &quot;SELECT * FROM table&quot;
88	        data = self.handler.native_query(query_str)
89	        mock_cursor.execute.assert_called_once_with(query_str)
90	        assert isinstance(data, Response)
91	        self.assertFalse(data.error_code)
92	
93	    def test_get_columns(self):
94	        &quot;&quot;&quot;
95	        Checks if the `get_columns` method correctly constructs the SQL query and if it calls `native_query` with the correct query.
96	        &quot;&quot;&quot;
97	
98	        self.handler.native_query = MagicMock()
99	
100	        table_name = &#x27;mock_table&#x27;
101	        self.handler.get_columns(table_name)
102	
103	        expected_query = f&quot;&quot;&quot;
104	            SELECT COLUMN_NAME AS FIELD, DATA_TYPE AS TYPE
105	            FROM INFORMATION_SCHEMA.COLUMNS
106	            WHERE TABLE_NAME = &#x27;{table_name}&#x27;
107	              AND TABLE_SCHEMA = current_schema()
108	        &quot;&quot;&quot;
109	
110	        self.handler.native_query.assert_called_once_with(expected_query)
111	
112	    def test_get_tables(self):
113	        &quot;&quot;&quot;
114	        Tests the `get_tables` method to confirm it correctly calls `native_query` with the appropriate SQL commands.
115	        &quot;&quot;&quot;
116	
117	        self.handler.native_query = MagicMock()
118	
119	        self.handler.get_tables()
120	
121	        expected_query = &quot;&quot;&quot;
122	            SELECT TABLE_NAME, TABLE_SCHEMA, TABLE_TYPE
123	            FROM INFORMATION_SCHEMA.TABLES
</pre>
</div>


</div>
</div>

<div id="issue-453">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_anomaly_detection.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_anomaly_detection.py</a><br>
    <b>Line number: </b>52<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
36	        assert False
37	    except AssertionError:
38	        assert True
39	
40	
41	def test_preprocess_data():
42	    df = pd.read_csv(&quot;tests/unit/ml_handlers/data/anomaly_detection.csv&quot;)
43	    preprocessed_df = preprocess_data(df)
44	    assert len(preprocessed_df) == len(df)
45	
46	
47	class TestAnomalyDetectionHandler(BaseExecutorTest):
48	    def wait_predictor(self, project, name):
49	        # wait
50	        done = False
51	        for attempt in range(200):
52	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
53	            if not ret.empty:
54	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
55	                    done = True
56	                    break
57	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
58	                    break
59	            time.sleep(0.5)
60	        if not done:
61	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
62	
63	    def run_sql(self, sql):
64	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
65	        assert ret.error_code is None
66	        if ret.data is not None:
67	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-454">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_autogluon.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_autogluon.py</a><br>
    <b>Line number: </b>17<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	import time
2	from unittest.mock import patch
3	import pandas as pd
4	
5	from mindsdb_sql import parse_sql
6	
7	
8	from unit.executor_test_base import BaseExecutorTest
9	
10	
11	class TestAutoGluon(BaseExecutorTest):
12	    def wait_predictor(self, project, name):
13	        # wait
14	        done = False
15	        for attempt in range(200):
16	            ret = self.run_sql(
17	                f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
18	            )
19	            # print(ret[&#x27;STATUS&#x27;][0])
20	            if not ret.empty:
21	                if ret[&#x27;STATUS&#x27;][0] == &#x27;complete&#x27;:
22	                    done = True
23	                    break
24	                elif ret[&#x27;STATUS&#x27;][0] == &#x27;error&#x27;:
25	                    # print(f&quot;{ret[&#x27;ERROR&#x27;][0]}&quot;)
26	                    break
27	            time.sleep(15)
28	        if not done:
29	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
30	
31	    def run_sql(self, sql):
32	        ret = self.command_executor.execute_command(
</pre>
</div>


</div>
</div>

<div id="issue-455">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_autokeras.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_autokeras.py</a><br>
    <b>Line number: </b>30<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
14	
15	def test_format_categorical_preds():
16	    &quot;&quot;&quot;Tests helper function to put categorical predictions into the right format&quot;&quot;&quot;
17	    predictions = np.array([[0.9, 0.05, 0.05], [0, 1, 0], [0, 0, 1]])
18	    original_y = pd.Series([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;])
19	    keras_output_df = pd.DataFrame({&quot;target&quot;: predictions.tolist()})
20	    formatted_df = format_categorical_preds(predictions, original_y, keras_output_df, &quot;target&quot;)
21	    assert formatted_df[&quot;target&quot;].tolist() == [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
22	    assert formatted_df[&quot;confidence&quot;].tolist() == [max(row) for row in predictions]
23	
24	
25	class TestAutokeras(BaseExecutorTest):
26	    def wait_predictor(self, project, name):
27	        # wait
28	        done = False
29	        for attempt in range(200):
30	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
31	            if not ret.empty:
32	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
33	                    done = True
34	                    break
35	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
36	                    break
37	            time.sleep(0.5)
38	        if not done:
39	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
40	
41	    def run_sql(self, sql):
42	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
43	        assert ret.error_code is None
44	        if ret.data is not None:
45	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-456">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_huggingface.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_huggingface.py</a><br>
    <b>Line number: </b>44<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
28	            &quot;Baking is a method of preparing food that uses dry heat, typically in an oven, but can also be done in hot ashes, or on hot stones. The most common baked item is bread but many other types of foods can be baked. Heat is gradually transferred from the surface of cakes, cookies, and pieces of bread to their center. As heat travels through, it transforms batters and doughs into baked goods and more with a firm dry crust and a softer center. Baking can be combined with grilling to produce a hybrid barbecue variant by using both methods simultaneously, or one after the other. Baking is related to barbecuing because the concept of the masonry oven is similar to that of a smoke pit.&quot;,
29	        ]
30	
31	        df = pd.DataFrame(data=[text_spammy, text_short, text_long]).T
32	        df.columns = [&quot;text_spammy&quot;, &quot;text_short&quot;, &quot;text_long&quot;]
33	
34	        self.set_handler(mock_handler, name=&quot;pg&quot;, tables={&quot;df&quot;: df})
35	
36	        # create predictor
37	        ret = self.run_sql(create_sql)
38	        assert ret.error_code is None
39	
40	        # wait
41	        done = False
42	        for attempt in range(900):
43	            ret = self.run_sql(
44	                f&quot;select status from mindsdb.models where name=&#x27;{model_name}&#x27;&quot;
45	            )
46	            data = ret.data.to_lists()
47	            if len(data) &gt; 0:
48	                if data[0][0] == &quot;complete&quot;:
49	                    done = True
50	                    break
51	                elif data[0][0] == &quot;error&quot;:
52	                    break
53	            time.sleep(0.5)
54	        if not done:
55	            raise RuntimeError(&quot;predictor not created&quot;)
56	
57	        # use predictor
58	        ret = self.command_executor.execute_command(
59	            parse_sql(predict_sql, dialect=&quot;mindsdb&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-457">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_langchain.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_langchain.py</a><br>
    <b>Line number: </b>154<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
138	    @pytest.mark.skipif(OPENAI_API_KEY is None, reason=&#x27;Missing OpenAI API key (OPENAI_API_KEY env variable)&#x27;)
139	    def test_prompt_template_args(self):
140	        self.run_sql(
141	            f&quot;&quot;&quot;
142	           create model proj.test_prompt_template_model
143	           predict answer
144	           using
145	             engine=&#x27;langchain&#x27;,
146	             prompt_template=&#x27;Your name is {{{{name}}}}. Answer the user in a useful way: {{{{question}}}}&#x27;,
147	             openai_api_key=&#x27;{OPENAI_API_KEY}&#x27;;
148	        &quot;&quot;&quot;
149	        )
150	        self.wait_predictor(&quot;proj&quot;, &quot;test_prompt_template_model&quot;)
151	
152	        agent_name = &#x27;professor farnsworth&#x27;
153	        result_df = self.run_sql(
154	            f&quot;&quot;&quot;
155	            SELECT answer
156	            FROM proj.test_prompt_template_model
157	            WHERE question=&#x27;What is your name?&#x27; AND name=&#x27;{agent_name}&#x27;
158	        &quot;&quot;&quot;
159	        )
160	        assert agent_name in result_df[&#x27;answer&#x27;].iloc[0].lower()
</pre>
</div>


</div>
</div>

<div id="issue-458">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_langchain_embedding.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_langchain_embedding.py</a><br>
    <b>Line number: </b>17<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	import os
2	import time
3	from unittest.mock import patch
4	
5	import pandas as pd
6	import pytest
7	from mindsdb_sql import parse_sql
8	
9	from ..executor_test_base import BaseExecutorTest
10	
11	
12	class TestLangchainEmbedding(BaseExecutorTest):
13	    def wait_predictor(self, project, name):
14	        # wait
15	        done = False
16	        for _ in range(200):
17	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
18	            if not ret.empty:
19	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
20	                    done = True
21	                    break
22	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
23	                    break
24	            time.sleep(0.5)
25	        if not done:
26	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
27	
28	    def run_sql(self, sql):
29	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
30	        assert ret.error_code is None
31	        if ret.data is not None:
32	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-459">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_lightfm.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_lightfm.py</a><br>
    <b>Line number: </b>13<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	import time
2	from unittest.mock import patch
3	
4	from mindsdb_sql import parse_sql
5	from unit.executor_test_base import BaseExecutorTest
6	
7	
8	class TestLightFM(BaseExecutorTest):
9	    def wait_predictor(self, project, name):
10	        # wait
11	        done = False
12	        for attempt in range(200):
13	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
14	            if not ret.empty:
15	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
16	                    done = True
17	                    break
18	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
19	                    break
20	            time.sleep(0.5)
21	        if not done:
22	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
23	
24	    def run_sql(self, sql):
25	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
26	        assert ret.error_code is None
27	        if ret.data is not None:
28	            return ret.data.to_df()
29	
30	    @patch(&quot;mindsdb.integrations.handlers.postgres_handler.Handler&quot;)
31	    def test_collaborative_filter_user_item_recommendation_light_fm_handler(
32	        self, mock_handler, lightfm_interaction_data
</pre>
</div>


</div>
</div>

<div id="issue-460">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_lightwood.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_lightwood.py</a><br>
    <b>Line number: </b>18<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2	from unittest.mock import patch
3	import pandas as pd
4	
5	from mindsdb_sql import parse_sql
6	
7	
8	from tests.unit.executor_test_base import BaseExecutorTest
9	
10	
11	class TestLW(BaseExecutorTest):
12	
13	    def wait_predictor(self, project, name):
14	        # wait
15	        done = False
16	        for attempt in range(200):
17	            ret = self.run_sql(
18	                f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
19	            )
20	            if not ret.empty:
21	                if ret[&#x27;STATUS&#x27;][0] == &#x27;complete&#x27;:
22	                    done = True
23	                    break
24	                elif ret[&#x27;STATUS&#x27;][0] == &#x27;error&#x27;:
25	                    break
26	            time.sleep(0.5)
27	        if not done:
28	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
29	
30	    def run_sql(self, sql):
31	        ret = self.command_executor.execute_command(
32	            parse_sql(sql, dialect=&#x27;mindsdb&#x27;)
33	        )
</pre>
</div>


</div>
</div>

<div id="issue-461">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_ludwig.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_ludwig.py</a><br>
    <b>Line number: </b>18<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
2	from unittest.mock import patch
3	import pandas as pd
4	
5	from mindsdb_sql import parse_sql
6	
7	
8	from tests.unit.executor_test_base import BaseExecutorTest
9	
10	
11	class TestLudwig(BaseExecutorTest):
12	
13	    def wait_predictor(self, project, name):
14	        # wait
15	        done = False
16	        for attempt in range(200):
17	            ret = self.run_sql(
18	                f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;
19	            )
20	            if not ret.empty:
21	                if ret[&#x27;STATUS&#x27;][0] == &#x27;complete&#x27;:
22	                    done = True
23	                    break
24	                elif ret[&#x27;STATUS&#x27;][0] == &#x27;error&#x27;:
25	                    break
26	            time.sleep(0.5)
27	        if not done:
28	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
29	
30	    def run_sql(self, sql):
31	        ret = self.command_executor.execute_command(
32	            parse_sql(sql, dialect=&#x27;mindsdb&#x27;)
33	        )
</pre>
</div>


</div>
</div>

<div id="issue-462">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py</a><br>
    <b>Line number: </b>107<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
91	        assert rt_df is not None
92	        assert len(rt_df) == len(df_test)
93	        assert &quot;H1__upper&quot; in set(rt_df.columns.values) and &quot;H1__lower&quot; in set(rt_df.columns.values)
94	
95	    @patch(&#x27;mindsdb.integrations.handlers.postgres_handler.Handler&#x27;)
96	    def test_merlion_forecaster_sql(self, mock_handler):
97	        self.set_project()
98	        # prepare data
99	        df = self.get_m4_df()
100	        df[&quot;t&quot;] = df.index
101	        self.set_handler(mock_handler, name=&#x27;pg&#x27;, tables={&#x27;m4&#x27;: df})
102	        # test default
103	        self.exec_train_and_forecast(mock_handler=mock_handler, model_name=&quot;default&quot;, using=&quot;&quot;)
104	
105	    def exec_train_and_forecast(self, mock_handler, model_name, using):
106	        # create predictor
107	        create_sql = f&#x27;&#x27;&#x27;
108	                    CREATE PREDICTOR mindsdb.{model_name}_forecaster
109	                    FROM pg
110	                    (select t, H1 from m4 where train = 1)
111	                    PREDICT H1
112	                    USING engine=&#x27;merlion&#x27;{using}
113	                &#x27;&#x27;&#x27;
114	        ret = self.run_mindsdb_sql(sql=create_sql)
115	        assert ret.error_code is None, &quot;train failed: &quot; + model_name
116	
117	        self.wait_training(model_name=f&#x27;{model_name}_forecaster&#x27;)
118	
119	        predict_sql = f&#x27;&#x27;&#x27;
120	                    select p.t, p.H1 real, t.H1, t.H1__upper, t.H1__lower
121	                    from mindsdb.{model_name}_forecaster t
122	                    inner join pg.m4 p on t.t = p.t
123	                    where p.train = 0
124	                &#x27;&#x27;&#x27;
125	        ret = self.run_mindsdb_sql(sql=predict_sql)
126	        assert ret.error_code is None, &quot;forecast failed: &quot; + model_name
127	
128	    def test_merlion_detector(self):
</pre>
</div>


</div>
</div>

<div id="issue-463">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py</a><br>
    <b>Line number: </b>119<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
103	        self.exec_train_and_forecast(mock_handler=mock_handler, model_name=&quot;default&quot;, using=&quot;&quot;)
104	
105	    def exec_train_and_forecast(self, mock_handler, model_name, using):
106	        # create predictor
107	        create_sql = f&#x27;&#x27;&#x27;
108	                    CREATE PREDICTOR mindsdb.{model_name}_forecaster
109	                    FROM pg
110	                    (select t, H1 from m4 where train = 1)
111	                    PREDICT H1
112	                    USING engine=&#x27;merlion&#x27;{using}
113	                &#x27;&#x27;&#x27;
114	        ret = self.run_mindsdb_sql(sql=create_sql)
115	        assert ret.error_code is None, &quot;train failed: &quot; + model_name
116	
117	        self.wait_training(model_name=f&#x27;{model_name}_forecaster&#x27;)
118	
119	        predict_sql = f&#x27;&#x27;&#x27;
120	                    select p.t, p.H1 real, t.H1, t.H1__upper, t.H1__lower
121	                    from mindsdb.{model_name}_forecaster t
122	                    inner join pg.m4 p on t.t = p.t
123	                    where p.train = 0
124	                &#x27;&#x27;&#x27;
125	        ret = self.run_mindsdb_sql(sql=predict_sql)
126	        assert ret.error_code is None, &quot;forecast failed: &quot; + model_name
127	
128	    def test_merlion_detector(self):
129	        df = self.get_nab_df()
130	        df.index = pd.to_datetime(df[&quot;t&quot;])
131	        df.drop(columns=[&quot;t&quot;], inplace=True)
132	        df_train = df[df[&quot;train&quot;] == 1][[&quot;val&quot;]]
133	        df_test = df[df[&quot;train&quot;] == 0][[&quot;val&quot;]]
134	        # isolation
135	        adapter = IsolationForestDetectorAdapter()
136	        adapter.train(df_train.copy(deep=True), target=&quot;val&quot;)
137	        rt_df = adapter.predict(df_test.copy(deep=True), target=&quot;val&quot;)
138	        assert rt_df is not None
139	        assert len(rt_df[rt_df[&quot;val__anomaly_score&quot;] &gt; 0]) &gt; 0
</pre>
</div>


</div>
</div>

<div id="issue-464">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py</a><br>
    <b>Line number: </b>166<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
150	        assert rt_df is not None
151	        assert len(rt_df[rt_df[&quot;val__anomaly_score&quot;] &gt; 0]) &gt; 0
152	
153	    @patch(&#x27;mindsdb.integrations.handlers.postgres_handler.Handler&#x27;)
154	    def test_merlion_detector_sql(self, mock_handler):
155	        self.set_project()
156	        # prepare data
157	        df = self.get_nab_df()
158	        df[&quot;t&quot;] = pd.to_datetime(df[&quot;t&quot;])
159	        self.set_handler(mock_handler, name=&#x27;pg&#x27;, tables={&#x27;nba&#x27;: df})
160	
161	        # test isolation forest
162	        self.exec_train_and_detect(mock_handler=mock_handler, model_name=&quot;isolation&quot;, using_model=&quot;, model_type=&#x27;isolation&#x27;&quot;)
163	
164	    def exec_train_and_detect(self, mock_handler, model_name, using_model):
165	        # create predictor
166	        create_sql = f&#x27;&#x27;&#x27;
167	                    CREATE PREDICTOR mindsdb.{model_name}_detector
168	                    FROM pg
169	                    (select t, val from nba where train = 1)
170	                    PREDICT val
171	                    USING engine=&#x27;merlion&#x27;, task=&#x27;detector&#x27;{using_model}
172	                &#x27;&#x27;&#x27;
173	        ret = self.run_mindsdb_sql(sql=create_sql)
174	        assert ret.error_code is None, &quot;train failed: &quot; + model_name
175	
176	        self.wait_training(model_name=f&#x27;{model_name}_detector&#x27;)
177	
178	        predict_sql = f&#x27;&#x27;&#x27;
179	                    select p.t, p.val real, d.val__anomaly_score
180	                    from mindsdb.{model_name}_detector d
181	                    inner join pg.nba p on d.t = p.t and d.val = p.val
182	                    where p.train = 0
183	                    &#x27;&#x27;&#x27;
184	        ret = self.run_mindsdb_sql(sql=predict_sql)
185	        assert ret.error_code is None, &quot;detect failed: &quot; + model_name
186	
187	    def wait_training(self, model_name):
</pre>
</div>


</div>
</div>

<div id="issue-465">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py</a><br>
    <b>Line number: </b>178<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
162	        self.exec_train_and_detect(mock_handler=mock_handler, model_name=&quot;isolation&quot;, using_model=&quot;, model_type=&#x27;isolation&#x27;&quot;)
163	
164	    def exec_train_and_detect(self, mock_handler, model_name, using_model):
165	        # create predictor
166	        create_sql = f&#x27;&#x27;&#x27;
167	                    CREATE PREDICTOR mindsdb.{model_name}_detector
168	                    FROM pg
169	                    (select t, val from nba where train = 1)
170	                    PREDICT val
171	                    USING engine=&#x27;merlion&#x27;, task=&#x27;detector&#x27;{using_model}
172	                &#x27;&#x27;&#x27;
173	        ret = self.run_mindsdb_sql(sql=create_sql)
174	        assert ret.error_code is None, &quot;train failed: &quot; + model_name
175	
176	        self.wait_training(model_name=f&#x27;{model_name}_detector&#x27;)
177	
178	        predict_sql = f&#x27;&#x27;&#x27;
179	                    select p.t, p.val real, d.val__anomaly_score
180	                    from mindsdb.{model_name}_detector d
181	                    inner join pg.nba p on d.t = p.t and d.val = p.val
182	                    where p.train = 0
183	                    &#x27;&#x27;&#x27;
184	        ret = self.run_mindsdb_sql(sql=predict_sql)
185	        assert ret.error_code is None, &quot;detect failed: &quot; + model_name
186	
187	    def wait_training(self, model_name):
188	        # wait
189	        done = False
190	        for attempt in range(900):
191	            ret = self.run_mindsdb_sql(
192	                f&quot;select status from mindsdb.predictors where name=&#x27;{model_name}&#x27;&quot;
193	            )
194	            if len(ret.data) &gt; 0:
195	                data = ret.data.to_lists()
196	                if data[0][0] == &#x27;complete&#x27;:
197	                    done = True
198	                    break
</pre>
</div>


</div>
</div>

<div id="issue-466">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_merlion_handler.py</a><br>
    <b>Line number: </b>192<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
176	        self.wait_training(model_name=f&#x27;{model_name}_detector&#x27;)
177	
178	        predict_sql = f&#x27;&#x27;&#x27;
179	                    select p.t, p.val real, d.val__anomaly_score
180	                    from mindsdb.{model_name}_detector d
181	                    inner join pg.nba p on d.t = p.t and d.val = p.val
182	                    where p.train = 0
183	                    &#x27;&#x27;&#x27;
184	        ret = self.run_mindsdb_sql(sql=predict_sql)
185	        assert ret.error_code is None, &quot;detect failed: &quot; + model_name
186	
187	    def wait_training(self, model_name):
188	        # wait
189	        done = False
190	        for attempt in range(900):
191	            ret = self.run_mindsdb_sql(
192	                f&quot;select status from mindsdb.predictors where name=&#x27;{model_name}&#x27;&quot;
193	            )
194	            if len(ret.data) &gt; 0:
195	                data = ret.data.to_lists()
196	                if data[0][0] == &#x27;complete&#x27;:
197	                    done = True
198	                    break
199	                elif data[0][0] == &#x27;error&#x27;:
200	                    break
201	            time.sleep(0.5)
202	        if not done:
203	            raise RuntimeError(&quot;predictor didn&#x27;t created: &quot; + model_name)
</pre>
</div>


</div>
</div>

<div id="issue-467">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_neuralforecast.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_neuralforecast.py</a><br>
    <b>Line number: </b>17<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	import time
2	import pytest
3	from unittest.mock import patch
4	import pandas as pd
5	
6	from mindsdb_sql import parse_sql
7	
8	from tests.unit.ml_handlers.test_time_series_utils import create_mock_df
9	from tests.unit.executor_test_base import BaseExecutorTest
10	
11	
12	class TestNeuralForecast(BaseExecutorTest):
13	    def wait_predictor(self, project, name):
14	        # wait
15	        done = False
16	        for attempt in range(200):
17	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
18	            if not ret.empty:
19	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
20	                    done = True
21	                    break
22	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
23	                    break
24	            time.sleep(0.5)
25	        if not done:
26	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
27	
28	    def run_sql(self, sql):
29	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
30	        assert ret.error_code is None
31	        if ret.data is not None:
32	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-468">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_popularity_recommender.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_popularity_recommender.py</a><br>
    <b>Line number: </b>14<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
1	import time
2	from unittest.mock import patch
3	
4	from mindsdb_sql import parse_sql
5	from unit.executor_test_base import BaseExecutorTest
6	
7	
8	# wip
9	class TestPopularityRecommender(BaseExecutorTest):
10	    def wait_predictor(self, project, name):
11	        # wait
12	        done = False
13	        for attempt in range(200):
14	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
15	            if not ret.empty:
16	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
17	                    done = True
18	                    break
19	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
20	                    break
21	            time.sleep(0.5)
22	        if not done:
23	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
24	
25	    def run_sql(self, sql):
26	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
27	        assert ret.error_code is None
28	        if ret.data is not None:
29	            return ret.data.to_df()
30	
31	    @patch(&quot;mindsdb.integrations.handlers.postgres_handler.Handler&quot;)
32	    def test_popularity_handler(self, mock_handler, lightfm_interaction_data):
</pre>
</div>


</div>
</div>

<div id="issue-469">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_rag.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_rag.py</a><br>
    <b>Line number: </b>25<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
9	
10	OPENAI_API_KEY = os.environ.get(&quot;OPENAI_API_KEY&quot;)
11	os.environ[&quot;OPENAI_API_KEY&quot;] = OPENAI_API_KEY
12	
13	WRITER_API_KEY = os.environ.get(&quot;WRITER_API_KEY&quot;)
14	os.environ[&quot;WRITER_API_KEY&quot;] = WRITER_API_KEY
15	
16	WRITER_ORG_ID = os.environ.get(&quot;WRITER_ORG_ID&quot;)
17	os.environ[&quot;WRITER_ORG_ID&quot;] = WRITER_ORG_ID
18	
19	
20	class TestRAG(BaseExecutorTest):
21	    def wait_predictor(self, project, name):
22	        # wait
23	        done = False
24	        for attempt in range(200):
25	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
26	            if not ret.empty:
27	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
28	                    done = True
29	                    break
30	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
31	                    break
32	            time.sleep(0.5)
33	        if not done:
34	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
35	
36	    def run_sql(self, sql):
37	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
38	        assert ret.error_code is None
39	        if ret.data is not None:
40	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-470">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_rag.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_rag.py</a><br>
    <b>Line number: </b>171<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
155	                    &quot;However, other products marketed under the Lemsip &quot;
156	                    &quot;brand contain other active ingredients such as ibuprofen,&quot;
157	                    &quot;pseudoephedrine, phenylephrine, and guaifenesin.&quot;
158	                ],
159	                &quot;url&quot;: [
160	                    &quot;https://docs.mindsdb.com/sql/tutorials/recommenders/&quot;,
161	                    &quot;https://docs.mindsdb.com/sql/tutorials/llm-chatbot-ui/&quot;,
162	                    &quot;https://docs.mindsdb.com/sql/tutorials/house-sales-forecasting/&quot;,
163	                ],
164	            }
165	        )
166	        self.save_file(&quot;df&quot;, df)
167	
168	        # test openai qa with chromadb
169	
170	        self.run_sql(
171	            f&quot;&quot;&quot;
172	           create model proj.test_rag_openai_qa
173	           from files (select * from df)
174	           predict answer
175	           using
176	             engine=&#x27;rag&#x27;,
177	             llm_type=&#x27;openai&#x27;,
178	             openai_api_key=&#x27;{OPENAI_API_KEY}&#x27;,
179	             vector_store_folder_name=&#x27;rag_openai_qa_test&#x27;,
180	             input_column=&#x27;question&#x27;
181	        &quot;&quot;&quot;
182	        )
183	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_openai_qa&quot;)
184	
185	        result_df = self.run_sql(
186	            &quot;&quot;&quot;
187	            SELECT p.answer
188	            FROM proj.test_rag_openai_qa as p
189	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
190	        &quot;&quot;&quot;
191	        )
192	        assert result_df[&quot;answer&quot;].iloc[0]
193	
194	        # test batching with openai qa chroma
195	
196	        embeddings_batch_size = 1
</pre>
</div>


</div>
</div>

<div id="issue-471">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_rag.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_rag.py</a><br>
    <b>Line number: </b>199<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
183	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_openai_qa&quot;)
184	
185	        result_df = self.run_sql(
186	            &quot;&quot;&quot;
187	            SELECT p.answer
188	            FROM proj.test_rag_openai_qa as p
189	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
190	        &quot;&quot;&quot;
191	        )
192	        assert result_df[&quot;answer&quot;].iloc[0]
193	
194	        # test batching with openai qa chroma
195	
196	        embeddings_batch_size = 1
197	
198	        self.run_sql(
199	            f&quot;&quot;&quot;
200	           create model proj.test_rag_openai_qa_batch
201	           from files (select * from df)
202	           predict answer
203	           using
204	             engine=&#x27;rag&#x27;,
205	             llm_type=&#x27;openai&#x27;,
206	             openai_api_key=&#x27;{OPENAI_API_KEY}&#x27;,
207	             vector_store_folder_name=&#x27;rag_openai_qa_test_batch&#x27;,
208	             embeddings_batch_size={embeddings_batch_size},
209	             input_column=&#x27;question&#x27;
210	        &quot;&quot;&quot;
211	        )
212	
213	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_openai_qa_batch&quot;)
214	
215	        result_df = self.run_sql(
216	            &quot;&quot;&quot;
217	            SELECT p.answer
218	            FROM proj.test_rag_openai_qa_batch as p
219	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
220	        &quot;&quot;&quot;
221	        )
222	        assert result_df[&quot;answer&quot;].iloc[0]
223	
224	        # test writer qa with FAISS
225	
</pre>
</div>


</div>
</div>

<div id="issue-472">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_rag.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_rag.py</a><br>
    <b>Line number: </b>227<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
211	        )
212	
213	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_openai_qa_batch&quot;)
214	
215	        result_df = self.run_sql(
216	            &quot;&quot;&quot;
217	            SELECT p.answer
218	            FROM proj.test_rag_openai_qa_batch as p
219	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
220	        &quot;&quot;&quot;
221	        )
222	        assert result_df[&quot;answer&quot;].iloc[0]
223	
224	        # test writer qa with FAISS
225	
226	        self.run_sql(
227	            f&quot;&quot;&quot;
228	           create model proj.test_rag_writer_qa
229	           from files (select * from df)
230	           predict answer
231	           using
232	             engine=&#x27;rag&#x27;,
233	             llm_type=&#x27;writer&#x27;,
234	             vector_store_name=&#x27;faiss&#x27;,
235	             writer_api_key=&#x27;{WRITER_API_KEY}&#x27;,
236	             writer_org_id=&#x27;{WRITER_ORG_ID}&#x27;,
237	             vector_store_folder_name=&#x27;rag_writer_qa_test&#x27;,
238	             input_column=&#x27;question&#x27;
239	        &quot;&quot;&quot;
240	        )
241	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_writer_qa&quot;)
242	
243	        result_df = self.run_sql(
244	            &quot;&quot;&quot;
245	            SELECT p.answer
246	            FROM proj.test_rag_writer_qa as p
247	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
248	        &quot;&quot;&quot;
249	        )
250	        assert result_df[&quot;answer&quot;].iloc[0]
251	
252	        # test single url parsing
253	        self.run_sql(
254	            f&quot;&quot;&quot;
</pre>
</div>


</div>
</div>

<div id="issue-473">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_rag.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_rag.py</a><br>
    <b>Line number: </b>281<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
265	             input_column=&#x27;question&#x27;
266	        &quot;&quot;&quot;
267	        )
268	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_writer_qa_single_url&quot;)
269	
270	        result_df = self.run_sql(
271	            &quot;&quot;&quot;
272	            SELECT p.answer
273	            FROM proj.test_rag_writer_qa as p
274	            WHERE question=&#x27;What recommender models does mindsdb support?&#x27;
275	        &quot;&quot;&quot;
276	        )
277	        assert result_df[&quot;answer&quot;].iloc[0]
278	
279	        # test multi url parsing
280	        self.run_sql(
281	            f&quot;&quot;&quot;
282	           create model proj.test_rag_writer_qa_multi_url
283	           from files (select * from df)
284	           predict answer
285	           using
286	             engine=&#x27;rag&#x27;,
287	             llm_type=&#x27;writer&#x27;,
288	             vector_store_name=&#x27;faiss&#x27;,
289	             url_column_name=&#x27;url&#x27;,
290	             writer_api_key=&#x27;{WRITER_API_KEY}&#x27;,
291	             writer_org_id=&#x27;{WRITER_ORG_ID}&#x27;,
292	             vector_store_folder_name=&#x27;rag_writer_qa_test_multi_url&#x27;,
293	             input_column=&#x27;question&#x27;
294	        &quot;&quot;&quot;
295	        )
296	
297	        self.wait_predictor(&quot;proj&quot;, &quot;test_rag_writer_qa_multi_url&quot;)
298	
299	        result_df = self.run_sql(
300	            &quot;&quot;&quot;
301	            SELECT p.answer
302	            FROM proj.test_rag_writer_qa_multi_url as p
303	            WHERE question=&#x27;which chat app currently works with mindsdb chatbot?&#x27;
304	        &quot;&quot;&quot;
305	        )
306	
307	        assert result_df[&quot;answer&quot;].iloc[0]
308	
309	    def test_invalid_prompt_template(self):
</pre>
</div>


</div>
</div>

<div id="issue-474">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_statsforecast.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_statsforecast.py</a><br>
    <b>Line number: </b>35<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
19	
20	
21	def test_choose_model():
22	    # With this data and settings, AutoTheta should win
23	    model_args = {&quot;horizon&quot;: 1, &quot;frequency&quot;: &quot;M&quot;, &quot;model_name&quot;: &quot;auto&quot;}
24	    sample_df = AirPassengersDF.iloc[:100]
25	    results_df = get_insample_cv_results(model_args, sample_df)
26	    best_model = choose_model(model_args, results_df)
27	    assert best_model.__class__.__name__ == &quot;AutoTheta&quot;
28	
29	
30	class TestStatsForecast(BaseExecutorTest):
31	    def wait_predictor(self, project, name):
32	        # wait
33	        done = False
34	        for attempt in range(200):
35	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
36	            if not ret.empty:
37	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
38	                    done = True
39	                    break
40	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
41	                    raise RuntimeError(&quot;predictor failed&quot;, ret[&quot;ERROR&quot;][0])
42	            time.sleep(0.5)
43	        if not done:
44	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
45	
46	    def run_sql(self, sql):
47	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
48	        assert ret.error_code is None
49	        if ret.data is not None:
50	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-475">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_statsforecast.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_statsforecast.py</a><br>
    <b>Line number: </b>137<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
121	        # create project
122	        self.run_sql(&quot;create database proj&quot;)
123	        df = pd.read_parquet(&quot;https://datasets-nixtla.s3.amazonaws.com/m4-hourly.parquet&quot;)
124	        df = df[df.unique_id.isin([&quot;H1&quot;, &quot;H2&quot;, &quot;H3&quot;])]  # subset for speed
125	        n_groups = df[&quot;unique_id&quot;].nunique()
126	        self.set_handler(mock_handler, name=&quot;pg&quot;, tables={&quot;df&quot;: df})
127	
128	        # generate ground truth predictions from the package
129	        prediction_horizon = 4
130	        sf = StatsForecast(models=[AutoCES(season_length=24)], freq=&quot;H&quot;)
131	        sf.fit(df)
132	        forecast_df = sf.predict(prediction_horizon)
133	        package_predictions = forecast_df.reset_index(drop=True).iloc[:, -1]
134	
135	        # create predictor
136	        self.run_sql(
137	            f&quot;&quot;&quot;
138	           create model proj.modelx
139	           from pg (select * from df)
140	           predict y
141	           order by ds
142	           group by unique_id
143	           horizon {prediction_horizon}
144	           using
145	             engine=&#x27;statsforecast&#x27;,
146	             model_name=&#x27;AutoCES&#x27;,
147	             frequency=&#x27;H&#x27;
148	        &quot;&quot;&quot;
149	        )
150	        self.wait_predictor(&quot;proj&quot;, &quot;modelx&quot;)
151	
152	        # run predict
153	        result_df = self.run_sql(
154	            &quot;&quot;&quot;
155	           SELECT p.*
156	           FROM pg.df as t
157	           JOIN proj.modelx as p
158	        &quot;&quot;&quot;
159	        )
160	
161	        # check against ground truth
162	        mindsdb_result = result_df.iloc[:, -1]
163	        assert len(mindsdb_result) == prediction_horizon * n_groups
</pre>
</div>


</div>
</div>

<div id="issue-476">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_statsforecast.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_statsforecast.py</a><br>
    <b>Line number: </b>209<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
193	        model with the lowest error.
194	        &quot;&quot;&quot;
195	        # create project
196	        self.run_sql(&quot;create database proj&quot;)
197	        self.set_handler(mock_handler, name=&quot;pg&quot;, tables={&quot;df&quot;: AirPassengersDF})
198	
199	        # generate ground truth predictions from the package - AutoTheta should win here
200	        prediction_horizon = 1
201	        sf = StatsForecast(models=[m(season_length=12) for m in model_dict.values()], freq=&quot;M&quot;, df=AirPassengersDF)
202	        sf.cross_validation(prediction_horizon, fitted=True)
203	        sf_results_df = sf.cross_validation_fitted_values()
204	        best_model_name = get_best_model_from_results_df(sf_results_df)
205	        package_predictions = sf.forecast(prediction_horizon)[best_model_name]
206	
207	        # create predictor
208	        self.run_sql(
209	            f&quot;&quot;&quot;
210	           create model proj.modelx
211	           from pg (select * from df)
212	           predict y
213	           order by ds
214	           group by unique_id
215	           horizon {prediction_horizon}
216	           using
217	             engine=&#x27;statsforecast&#x27;,
218	             model_name=&#x27;auto&#x27;,
219	             frequency=&#x27;M&#x27;
220	        &quot;&quot;&quot;
221	        )
222	        self.wait_predictor(&quot;proj&quot;, &quot;modelx&quot;)
223	
224	        # run predict
225	        result_df = self.run_sql(
226	            &quot;&quot;&quot;
227	           SELECT p.*
228	           FROM pg.df as t
229	           JOIN proj.modelx as p
230	        &quot;&quot;&quot;
231	        )
232	
233	        # check against ground truth
234	        mindsdb_result = result_df.iloc[:, -1]
235	        assert np.allclose(mindsdb_result, package_predictions)
</pre>
</div>


</div>
</div>

<div id="issue-477">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_vertex.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_vertex.py</a><br>
    <b>Line number: </b>133<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
117	    &quot;&quot;&quot;Make a prediction from a JSON file&quot;&quot;&quot;
118	    with open(&quot;path_to_json&quot;, &quot;r&quot;) as f:
119	        data = json.load(f)
120	
121	    predictions = vertex_client.predict_from_dict(&quot;Endpoint1&quot;, data)
122	    assert predictions == &quot;JSON Predictions&quot;
123	
124	
125	# Test of Vertex handler
126	
127	
128	class TestVertex(BaseExecutorTest):
129	    def wait_predictor(self, project, name):
130	        # wait
131	        done = False
132	        for attempt in range(200):
133	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
134	            if not ret.empty:
135	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
136	                    done = True
137	                    break
138	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
139	                    break
140	            time.sleep(0.5)
141	        if not done:
142	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
143	
144	    def run_sql(self, sql):
145	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
146	        assert ret.error_code is None
147	        if ret.data is not None:
148	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-478">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_writer.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_writer.py</a><br>
    <b>Line number: </b>23<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
7	from mindsdb_sql import parse_sql
8	
9	from tests.unit.executor_test_base import BaseExecutorTest
10	
11	WRITER_API_KEY = os.environ.get(&quot;WRITER_API_KEY&quot;)
12	os.environ[&quot;WRITER_API_KEY&quot;] = WRITER_API_KEY
13	
14	WRITER_ORG_ID = os.environ.get(&quot;WRITER_ORG_ID&quot;)
15	os.environ[&quot;WRITER_ORG_ID&quot;] = WRITER_ORG_ID
16	
17	
18	class TestWriter(BaseExecutorTest):
19	    def wait_predictor(self, project, name):
20	        # wait
21	        done = False
22	        for attempt in range(200):
23	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
24	            if not ret.empty:
25	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
26	                    done = True
27	                    break
28	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
29	                    break
30	            time.sleep(0.5)
31	        if not done:
32	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
33	
34	    def run_sql(self, sql):
35	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
36	        assert ret.error_code is None
37	        if ret.data is not None:
38	            return ret.data.to_df()
</pre>
</div>


</div>
</div>

<div id="issue-479">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/ml_handlers/test_writer.py" target="_blank">/mindsdb/tests/unit/ml_handlers/test_writer.py</a><br>
    <b>Line number: </b>107<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
91	    @patch(&quot;mindsdb.integrations.handlers.postgres_handler.Handler&quot;)
92	    def test_qa(self, postgres_mock_handler):
93	        # create project
94	        self.run_sql(&quot;create database proj&quot;)
95	        df = pd.DataFrame.from_dict(
96	            {
97	                &quot;context&quot;: [
98	                    &quot;For adults and children age 5 and older, OTC decongestants, &quot;
99	                    &quot;antihistamines and pain relievers might offer some symptom relief. &quot;
100	                    &quot;However, they won&#x27;t prevent a cold or shorten its duration, and most have some side effects.&quot;,
101	                ]
102	            }
103	        )
104	        self.set_handler(postgres_mock_handler, name=&quot;pg&quot;, tables={&quot;df&quot;: df})
105	
106	        self.run_sql(
107	            f&quot;&quot;&quot;
108	           create model proj.test_writer_writer_qa
109	           from pg (select * from df)
110	           predict answer
111	           using
112	                engine=&#x27;writer&#x27;,
113	                writer_api_key=&#x27;{WRITER_API_KEY}&#x27;,
114	                writer_org_id=&#x27;{WRITER_ORG_ID}&#x27;;
115	        &quot;&quot;&quot;
116	        )
117	        self.wait_predictor(&quot;proj&quot;, &quot;test_writer_writer_qa&quot;)
118	
119	        result_df = self.run_sql(
120	            &quot;&quot;&quot;
121	            SELECT p.answer
122	            FROM proj.test_writer_writer_qa as p
123	            WHERE question=&#x27;What is the best treatment for a cold?&#x27;
124	        &quot;&quot;&quot;
125	        )
126	        assert &quot;cold&quot; in result_df[&quot;answer&quot;].iloc[0].lower()
127	
128	    def test_invalid_prompt_template(self):
129	        # create project
130	        self.run_sql(&quot;create database proj&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-480">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/test_knowledge_base.py" target="_blank">/mindsdb/tests/unit/test_knowledge_base.py</a><br>
    <b>Line number: </b>25<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
9	from mindsdb.interfaces.storage.db import KnowledgeBase
10	
11	from .executor_test_base import BaseExecutorTest
12	
13	
14	class TestKnowledgeBase(BaseExecutorTest):
15	    def run_sql(self, sql):
16	        ret = self.command_executor.execute_command(parse_sql(sql, dialect=&quot;mindsdb&quot;))
17	        assert ret.error_code is None
18	        if ret.data is not None:
19	            return ret.data.to_df()
20	
21	    def wait_predictor(self, project, name):
22	        # wait
23	        done = False
24	        for _ in range(200):
25	            ret = self.run_sql(f&quot;select * from {project}.models where name=&#x27;{name}&#x27;&quot;)
26	            if not ret.empty:
27	                if ret[&quot;STATUS&quot;][0] == &quot;complete&quot;:
28	                    done = True
29	                    break
30	                elif ret[&quot;STATUS&quot;][0] == &quot;error&quot;:
31	                    break
32	            time.sleep(0.5)
33	        if not done:
34	            raise RuntimeError(&quot;predictor wasn&#x27;t created&quot;)
35	
36	    @patch(&quot;mindsdb.integrations.handlers.postgres_handler.Handler&quot;)
37	    def setup_method(self, method, mock_handler):
38	        super().setup_method()
39	
40	        vectordatabase_name = &quot;chroma_test&quot;
</pre>
</div>


</div>
</div>

<div id="issue-481">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/unit/test_knowledge_base.py" target="_blank">/mindsdb/tests/unit/test_knowledge_base.py</a><br>
    <b>Line number: </b>72<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
56	            {
57	                &quot;id&quot;: [&quot;id1&quot;, &quot;id2&quot;, &quot;id3&quot;],
58	                &quot;content&quot;: [&quot;content1&quot;, &quot;content2&quot;, &quot;content3&quot;],
59	                &quot;metadata&quot;: [
60	                    &#x27;{&quot;datasource&quot;: &quot;web&quot;, &quot;some_field&quot;: &quot;some_value&quot;}&#x27;,
61	                    &#x27;{&quot;datasource&quot;: &quot;web&quot;}&#x27;,
62	                    &#x27;{&quot;datasource&quot;: &quot;web&quot;}&#x27;,
63	                ],
64	                &quot;embeddings&quot;: [[1, 2, 3], [4, 5, 6], [7, 8, 9]],
65	            }
66	        )
67	
68	        self.save_file(&quot;df&quot;, df)
69	
70	        # create the table
71	        vectordatabase_table_name = &quot;test_table&quot;
72	        sql = f&quot;&quot;&quot;
73	            CREATE TABLE chroma_test.{vectordatabase_table_name}
74	            (
75	                SELECT * FROM files.df
76	            )
77	        &quot;&quot;&quot;
78	        self.run_sql(sql)
79	
80	        # create an embedding model
81	        embedding_model_name = &quot;test_dummy_embedding&quot;
82	        self.run_sql(
83	            f&quot;&quot;&quot;
84	            CREATE MODEL {embedding_model_name}
85	            PREDICT embeddings
86	            USING
87	                engine=&#x27;langchain_embedding&#x27;,
88	                class = &#x27;FakeEmbeddings&#x27;,
89	                size = 3,
90	                input_columns = [&#x27;content&#x27;]
91	            &quot;&quot;&quot;
92	        )
</pre>
</div>


</div>
</div>

<div id="issue-482">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/utils/http_test_helpers.py" target="_blank">/mindsdb/tests/utils/http_test_helpers.py</a><br>
    <b>Line number: </b>60<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
44	        assert isinstance(response.get(&#x27;context&#x27;), dict)
45	        if response[&#x27;type&#x27;] == &#x27;table&#x27;:
46	            assert isinstance(response.get(&#x27;data&#x27;), list)
47	            assert isinstance(response.get(&#x27;column_names&#x27;), list)
48	        elif response[&#x27;type&#x27;] == &#x27;error&#x27;:
49	            assert isinstance(response.get(&#x27;error_code&#x27;), int)
50	            assert isinstance(response.get(&#x27;error_message&#x27;), str)
51	        self._sql_via_http_context = response[&#x27;context&#x27;]
52	        return response
53	
54	    def await_model(self, model_name: str, project_name: str = &#x27;mindsdb&#x27;,
55	                    version_number: int = 1, timeout: int = 60):
56	        start = time.time()
57	        status = None
58	        while (time.time() - start) &lt; timeout:
59	            response = self.sql_via_http(
60	                f&quot;&quot;&quot;
61	                    SELECT status
62	                    FROM {project_name}.models
63	                    WHERE name=&#x27;{model_name}&#x27; and version = {version_number}
64	                &quot;&quot;&quot;, RESPONSE_TYPE.TABLE
65	            )
66	            status = response[&#x27;data&#x27;][0][0]
67	            if status in [&#x27;complete&#x27;, &#x27;error&#x27;]:
68	                break
69	            time.sleep(1)
70	        return status
71	
72	    def await_model_by_query(self, query, timeout=60):
73	        start = time.time()
74	        status = None
75	        while (time.time() - start) &lt; timeout:
76	            resp = self.sql_via_http(query, RESPONSE_TYPE.TABLE)
77	            status_index = [x.lower() for x in resp[&#x27;column_names&#x27;]].index(&#x27;status&#x27;)
78	            status = resp[&#x27;data&#x27;][0][status_index]
79	            if status in [&#x27;complete&#x27;, &#x27;error&#x27;]:
</pre>
</div>


</div>
</div>

<div id="issue-483">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/utils/http_test_helpers.py" target="_blank">/mindsdb/tests/utils/http_test_helpers.py</a><br>
    <b>Line number: </b>89<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
73	        start = time.time()
74	        status = None
75	        while (time.time() - start) &lt; timeout:
76	            resp = self.sql_via_http(query, RESPONSE_TYPE.TABLE)
77	            status_index = [x.lower() for x in resp[&#x27;column_names&#x27;]].index(&#x27;status&#x27;)
78	            status = resp[&#x27;data&#x27;][0][status_index]
79	            if status in [&#x27;complete&#x27;, &#x27;error&#x27;]:
80	                break
81	            time.sleep(1)
82	        return status
83	
84	
85	def get_predictors_list(company_id=None):
86	    headers = {}
87	    if company_id is not None:
88	        headers[&#x27;company-id&#x27;] = f&#x27;{company_id}&#x27;
89	    res = requests.get(f&#x27;{HTTP_API_ROOT}/predictors/&#x27;, headers=headers)
90	    assert res.status_code == 200
91	    return res.json()
92	
93	
94	def get_predictors_names_list(company_id=None):
95	    predictors = get_predictors_list(company_id=company_id)
96	    return [x[&#x27;name&#x27;] for x in predictors]
97	
98	
99	def check_predictor_exists(name):
100	    assert name in get_predictors_names_list()
101	
102	
103	def check_predictor_not_exists(name):
104	    assert name not in get_predictors_names_list()
</pre>
</div>


</div>
</div>

<div id="issue-484">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/mindsdb/tests/utils/http_test_helpers.py" target="_blank">/mindsdb/tests/utils/http_test_helpers.py</a><br>
    <b>Line number: </b>128<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
112	    return None
113	
114	
115	def wait_predictor_learn(predictor_name):
116	    start_time = time.time()
117	    learn_done = False
118	    while learn_done is False and (time.time() - start_time) &lt; 180:
119	        learn_done = get_predictor_data(predictor_name)[&#x27;status&#x27;] == &#x27;complete&#x27;
120	        time.sleep(1)
121	    assert learn_done
122	
123	
124	def get_integrations_names(company_id=None):
125	    headers = {}
126	    if company_id is not None:
127	        headers[&#x27;company-id&#x27;] = f&#x27;{company_id}&#x27;
128	    res = requests.get(f&#x27;{HTTP_API_ROOT}/config/integrations&#x27;, headers=headers)
129	    assert res.status_code == 200
130	    return res.json()[&#x27;integrations&#x27;]
</pre>
</div>


</div>
</div>

<div id="issue-485">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_sql_expressions: </b> Possible SQL injection vector through string-based query construction.<br>
    <b>Test ID:</b> B608<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/89.html" target="_blank">CWE-89</a><br>
    <b>File: </b><a href="/mindsdb/tests/utils/query_generator.py" target="_blank">/mindsdb/tests/utils/query_generator.py</a><br>
    <b>Line number: </b>73<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b608_hardcoded_sql_expressions.html</a><br>

<div class="code">
<pre>
57	                ;&quot;&quot;&quot;
58	        return query
59	
60	    @staticmethod
61	    def simple_select_query(table_name: str, columns: list = None, limit: int = 10) -&gt; str:
62	        &quot;&quot;&quot;
63	        Generate a simple SELECT query with the given parameters.
64	
65	        :param table_name: The name of the table to query.
66	        :param columns: A list of columns to SELECT.
67	        :param limit: The number of rows to LIMIT the query to.
68	        :return: The generated SQL query as a string.
69	        &quot;&quot;&quot;
70	        columns = columns or [&quot;*&quot;]
71	        column_str = &quot;, &quot;.join(columns)
72	        limit_str = f&quot; LIMIT {limit}&quot; if limit else &quot;&quot;
73	        query = f&quot;&quot;&quot;SELECT {column_str} FROM {table_name}{limit_str};&quot;&quot;&quot;
74	        return query
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
