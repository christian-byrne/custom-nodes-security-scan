
<!DOCTYPE html>
<html>
<head>

<meta charset="UTF-8">

<title>
    Bandit Report
</title>

<style>

html * {
    font-family: "Arial", sans-serif;
}

pre {
    font-family: "Monaco", monospace;
}

.bordered-box {
    border: 1px solid black;
    padding-top:.5em;
    padding-bottom:.5em;
    padding-left:1em;
}

.metrics-box {
    font-size: 1.1em;
    line-height: 130%;
}

.metrics-title {
    font-size: 1.5em;
    font-weight: 500;
    margin-bottom: .25em;
}

.issue-description {
    font-size: 1.3em;
    font-weight: 500;
}

.candidate-issues {
    margin-left: 2em;
    border-left: solid 1px; LightGray;
    padding-left: 5%;
    margin-top: .2em;
    margin-bottom: .2em;
}

.issue-block {
    border: 1px solid LightGray;
    padding-left: .5em;
    padding-top: .5em;
    padding-bottom: .5em;
    margin-bottom: .5em;
}

.issue-sev-high {
    background-color: Pink;
}

.issue-sev-medium {
    background-color: NavajoWhite;
}

.issue-sev-low {
    background-color: LightCyan;
}

</style>
</head>

<body>

<div id="metrics">
    <div class="metrics-box bordered-box">
        <div class="metrics-title">
            Metrics:<br>
        </div>
        Total lines of code: <span id="loc">14599</span><br>
        Total lines skipped (#nosec): <span id="nosec">0</span>
    </div>
</div>




<br>
<div id="results">
    
<div id="issue-0">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>9<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
1	# flake8: noqa
2	# This file is used for deploying replicate models
3	# running: cog predict -i img=@inputs/whole_imgs/10045.png -i version=&#x27;v1.4&#x27; -i scale=2
4	# push: cog push r8.im/tencentarc/gfpgan
5	# push (backup): cog push r8.im/xinntao/gfpgan
6	
7	import os
8	
9	os.system(&#x27;python setup.py develop&#x27;)
10	os.system(&#x27;pip install realesrgan&#x27;)
11	
12	import cv2
13	import shutil
14	import tempfile
15	import torch
16	from basicsr.archs.srvgg_arch import SRVGGNetCompact
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-1">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>9<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
1	# flake8: noqa
2	# This file is used for deploying replicate models
3	# running: cog predict -i img=@inputs/whole_imgs/10045.png -i version=&#x27;v1.4&#x27; -i scale=2
4	# push: cog push r8.im/tencentarc/gfpgan
5	# push (backup): cog push r8.im/xinntao/gfpgan
6	
7	import os
8	
9	os.system(&#x27;python setup.py develop&#x27;)
10	os.system(&#x27;pip install realesrgan&#x27;)
11	
12	import cv2
13	import shutil
14	import tempfile
15	import torch
16	from basicsr.archs.srvgg_arch import SRVGGNetCompact
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-2">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
1	# flake8: noqa
2	# This file is used for deploying replicate models
3	# running: cog predict -i img=@inputs/whole_imgs/10045.png -i version=&#x27;v1.4&#x27; -i scale=2
4	# push: cog push r8.im/tencentarc/gfpgan
5	# push (backup): cog push r8.im/xinntao/gfpgan
6	
7	import os
8	
9	os.system(&#x27;python setup.py develop&#x27;)
10	os.system(&#x27;pip install realesrgan&#x27;)
11	
12	import cv2
13	import shutil
14	import tempfile
15	import torch
16	from basicsr.archs.srvgg_arch import SRVGGNetCompact
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-3">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
1	# flake8: noqa
2	# This file is used for deploying replicate models
3	# running: cog predict -i img=@inputs/whole_imgs/10045.png -i version=&#x27;v1.4&#x27; -i scale=2
4	# push: cog push r8.im/tencentarc/gfpgan
5	# push (backup): cog push r8.im/xinntao/gfpgan
6	
7	import os
8	
9	os.system(&#x27;python setup.py develop&#x27;)
10	os.system(&#x27;pip install realesrgan&#x27;)
11	
12	import cv2
13	import shutil
14	import tempfile
15	import torch
16	from basicsr.archs.srvgg_arch import SRVGGNetCompact
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
</pre>
</div>


</div>
</div>

<div id="issue-4">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
</pre>
</div>


</div>
</div>

<div id="issue-5">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>33<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
17	
18	from gfpgan import GFPGANer
19	
20	try:
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
</pre>
</div>


</div>
</div>

<div id="issue-6">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>37<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
</pre>
</div>


</div>
</div>

<div id="issue-7">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>37<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
21	    from cog import BasePredictor, Input, Path
22	    from realesrgan.utils import RealESRGANer
23	except Exception:
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
</pre>
</div>


</div>
</div>

<div id="issue-8">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
</pre>
</div>


</div>
</div>

<div id="issue-9">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>40<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
24	    print(&#x27;please install cog and realesrgan package&#x27;)
25	
26	
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
</pre>
</div>


</div>
</div>

<div id="issue-10">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
57	        # Use GFPGAN for face enhancement
58	        self.face_enhancer = GFPGANer(
59	            model_path=&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-11">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>43<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
27	class Predictor(BasePredictor):
28	
29	    def setup(self):
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
57	        # Use GFPGAN for face enhancement
58	        self.face_enhancer = GFPGANer(
59	            model_path=&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;,
</pre>
</div>


</div>
</div>

<div id="issue-12">
<div class="issue-block issue-sev-low">
    <b>start_process_with_a_shell: </b> Starting a process with a shell: Seems safe, but may be changed in the future, consider rewriting without shell<br>
    <b>Test ID:</b> B605<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b605_start_process_with_a_shell.html</a><br>

<div class="code">
<pre>
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
57	        # Use GFPGAN for face enhancement
58	        self.face_enhancer = GFPGANer(
59	            model_path=&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;,
60	            upscale=2,
61	            arch=&#x27;clean&#x27;,
62	            channel_multiplier=2,
63	            bg_upsampler=self.upsampler)
</pre>
</div>


</div>
</div>

<div id="issue-13">
<div class="issue-block issue-sev-low">
    <b>start_process_with_partial_path: </b> Starting a process with a partial executable path<br>
    <b>Test ID:</b> B607<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/cog_predict.py" target="_blank">/comfy_mtb/extern/GFPGAN/cog_predict.py</a><br>
    <b>Line number: </b>46<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b607_start_process_with_partial_path.html</a><br>

<div class="code">
<pre>
30	        os.makedirs(&#x27;output&#x27;, exist_ok=True)
31	        # download weights
32	        if not os.path.exists(&#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;):
33	            os.system(
34	                &#x27;wget https://github.com/xinntao/Real-ESRGAN/releases/download/v0.2.5.0/realesr-general-x4v3.pth -P ./gfpgan/weights&#x27;
35	            )
36	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.2.pth&#x27;):
37	            os.system(
38	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.2.pth -P ./gfpgan/weights&#x27;)
39	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.3.pth&#x27;):
40	            os.system(
41	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.3.pth -P ./gfpgan/weights&#x27;)
42	        if not os.path.exists(&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;):
43	            os.system(
44	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.0/GFPGANv1.4.pth -P ./gfpgan/weights&#x27;)
45	        if not os.path.exists(&#x27;gfpgan/weights/RestoreFormer.pth&#x27;):
46	            os.system(
47	                &#x27;wget https://github.com/TencentARC/GFPGAN/releases/download/v1.3.4/RestoreFormer.pth -P ./gfpgan/weights&#x27;
48	            )
49	
50	        # background enhancer with RealESRGAN
51	        model = SRVGGNetCompact(num_in_ch=3, num_out_ch=3, num_feat=64, num_conv=32, upscale=4, act_type=&#x27;prelu&#x27;)
52	        model_path = &#x27;gfpgan/weights/realesr-general-x4v3.pth&#x27;
53	        half = True if torch.cuda.is_available() else False
54	        self.upsampler = RealESRGANer(
55	            scale=4, model_path=model_path, model=model, tile=0, tile_pad=10, pre_pad=0, half=half)
56	
57	        # Use GFPGAN for face enhancement
58	        self.face_enhancer = GFPGANer(
59	            model_path=&#x27;gfpgan/weights/GFPGANv1.4.pth&#x27;,
60	            upscale=2,
61	            arch=&#x27;clean&#x27;,
62	            channel_multiplier=2,
63	            bg_upsampler=self.upsampler)
</pre>
</div>


</div>
</div>

<div id="issue-14">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/setup.py" target="_blank">/comfy_mtb/extern/GFPGAN/setup.py</a><br>
    <b>Line number: </b>6<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	#!/usr/bin/env python
2	
3	from setuptools import find_packages, setup
4	
5	import os
6	import subprocess
7	import time
8	
9	version_file = &#x27;gfpgan/version.py&#x27;
10	
11	
12	def readme():
13	    with open(&#x27;README.md&#x27;, encoding=&#x27;utf-8&#x27;) as f:
14	        content = f.read()
15	    return content
16	
17	
18	def get_git_hash():
19	
20	    def _minimal_ext_cmd(cmd):
21	        # construct minimal environment
22	        env = {}
23	        for k in [&#x27;SYSTEMROOT&#x27;, &#x27;PATH&#x27;, &#x27;HOME&#x27;]:
24	            v = os.environ.get(k)
25	            if v is not None:
26	                env[k] = v
27	        # LANGUAGE is used on win32
28	        env[&#x27;LANGUAGE&#x27;] = &#x27;C&#x27;
29	        env[&#x27;LANG&#x27;] = &#x27;C&#x27;
30	        env[&#x27;LC_ALL&#x27;] = &#x27;C&#x27;
31	        out = subprocess.Popen(cmd, stdout=subprocess.PIPE, env=env).communicate()[0]
32	        return out
</pre>
</div>


</div>
</div>

<div id="issue-15">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/setup.py" target="_blank">/comfy_mtb/extern/GFPGAN/setup.py</a><br>
    <b>Line number: </b>31<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
15	    return content
16	
17	
18	def get_git_hash():
19	
20	    def _minimal_ext_cmd(cmd):
21	        # construct minimal environment
22	        env = {}
23	        for k in [&#x27;SYSTEMROOT&#x27;, &#x27;PATH&#x27;, &#x27;HOME&#x27;]:
24	            v = os.environ.get(k)
25	            if v is not None:
26	                env[k] = v
27	        # LANGUAGE is used on win32
28	        env[&#x27;LANGUAGE&#x27;] = &#x27;C&#x27;
29	        env[&#x27;LANG&#x27;] = &#x27;C&#x27;
30	        env[&#x27;LC_ALL&#x27;] = &#x27;C&#x27;
31	        out = subprocess.Popen(cmd, stdout=subprocess.PIPE, env=env).communicate()[0]
32	        return out
33	
34	    try:
35	        out = _minimal_ext_cmd([&#x27;git&#x27;, &#x27;rev-parse&#x27;, &#x27;HEAD&#x27;])
36	        sha = out.strip().decode(&#x27;ascii&#x27;)
37	    except OSError:
38	        sha = &#x27;unknown&#x27;
39	
40	    return sha
41	
42	
43	def get_hash():
44	    if os.path.exists(&#x27;.git&#x27;):
45	        sha = get_git_hash()[:7]
46	    else:
</pre>
</div>


</div>
</div>

<div id="issue-16">
<div class="issue-block issue-sev-medium">
    <b>exec_used: </b> Use of exec detected.<br>
    <b>Test ID:</b> B102<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/setup.py" target="_blank">/comfy_mtb/extern/GFPGAN/setup.py</a><br>
    <b>Line number: </b>71<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b102_exec_used.html</a><br>

<div class="code">
<pre>
55	__version__ = &#x27;{}&#x27;
56	__gitsha__ = &#x27;{}&#x27;
57	version_info = ({})
58	&quot;&quot;&quot;
59	    sha = get_hash()
60	    with open(&#x27;VERSION&#x27;, &#x27;r&#x27;) as f:
61	        SHORT_VERSION = f.read().strip()
62	    VERSION_INFO = &#x27;, &#x27;.join([x if x.isdigit() else f&#x27;&quot;{x}&quot;&#x27; for x in SHORT_VERSION.split(&#x27;.&#x27;)])
63	
64	    version_file_str = content.format(time.asctime(), SHORT_VERSION, sha, VERSION_INFO)
65	    with open(version_file, &#x27;w&#x27;) as f:
66	        f.write(version_file_str)
67	
68	
69	def get_version():
70	    with open(version_file, &#x27;r&#x27;) as f:
71	        exec(compile(f.read(), version_file, &#x27;exec&#x27;))
72	    return locals()[&#x27;__version__&#x27;]
73	
74	
75	def get_requirements(filename=&#x27;requirements.txt&#x27;):
76	    here = os.path.dirname(os.path.realpath(__file__))
77	    with open(os.path.join(here, filename), &#x27;r&#x27;) as f:
78	        requires = [line.replace(&#x27;\n&#x27;, &#x27;&#x27;) for line in f.readlines()]
79	    return requires
80	
81	
82	if __name__ == &#x27;__main__&#x27;:
83	    write_version_py()
84	    setup(
85	        name=&#x27;gfpgan&#x27;,
86	        version=get_version(),
</pre>
</div>


</div>
</div>

<div id="issue-17">
<div class="issue-block issue-sev-medium">
    <b>yaml_load: </b> Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().<br>
    <b>Test ID:</b> B506<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/20.html" target="_blank">CWE-20</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/tests/test_ffhq_degradation_dataset.py" target="_blank">/comfy_mtb/extern/GFPGAN/tests/test_ffhq_degradation_dataset.py</a><br>
    <b>Line number: </b>10<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b506_yaml_load.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b506_yaml_load.html</a><br>

<div class="code">
<pre>
1	import pytest
2	import yaml
3	
4	from gfpgan.data.ffhq_degradation_dataset import FFHQDegradationDataset
5	
6	
7	def test_ffhq_degradation_dataset():
8	
9	    with open(&#x27;tests/data/test_ffhq_degradation_dataset.yml&#x27;, mode=&#x27;r&#x27;) as f:
10	        opt = yaml.load(f, Loader=yaml.FullLoader)
11	
12	    dataset = FFHQDegradationDataset(opt)
13	    assert dataset.io_backend_opt[&#x27;type&#x27;] == &#x27;disk&#x27;  # io backend
14	    assert len(dataset) == 1  # whether to read correct meta info
15	    assert dataset.kernel_list == [&#x27;iso&#x27;, &#x27;aniso&#x27;]  # correct initialization the degradation configurations
16	    assert dataset.color_jitter_prob == 1
17	
18	    # test __getitem__
19	    result = dataset.__getitem__(0)
20	    # check returned keys
21	    expected_keys = [&#x27;gt&#x27;, &#x27;lq&#x27;, &#x27;gt_path&#x27;]
22	    assert set(expected_keys).issubset(set(result.keys()))
23	    # check shape and contents
24	    assert result[&#x27;gt&#x27;].shape == (3, 512, 512)
25	    assert result[&#x27;lq&#x27;].shape == (3, 512, 512)
26	    assert result[&#x27;gt_path&#x27;] == &#x27;tests/data/gt/00000000.png&#x27;
27	
28	    # ------------------ test with probability = 0 -------------------- #
29	    opt[&#x27;color_jitter_prob&#x27;] = 0
30	    opt[&#x27;color_jitter_pt_prob&#x27;] = 0
31	    opt[&#x27;gray_prob&#x27;] = 0
32	    opt[&#x27;io_backend&#x27;] = dict(type=&#x27;disk&#x27;)
</pre>
</div>


</div>
</div>

<div id="issue-18">
<div class="issue-block issue-sev-medium">
    <b>yaml_load: </b> Use of unsafe yaml load. Allows instantiation of arbitrary objects. Consider yaml.safe_load().<br>
    <b>Test ID:</b> B506<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/20.html" target="_blank">CWE-20</a><br>
    <b>File: </b><a href="/comfy_mtb/extern/GFPGAN/tests/test_gfpgan_model.py" target="_blank">/comfy_mtb/extern/GFPGAN/tests/test_gfpgan_model.py</a><br>
    <b>Line number: </b>15<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b506_yaml_load.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b506_yaml_load.html</a><br>

<div class="code">
<pre>
1	import tempfile
2	import torch
3	import yaml
4	from basicsr.archs.stylegan2_arch import StyleGAN2Discriminator
5	from basicsr.data.paired_image_dataset import PairedImageDataset
6	from basicsr.losses.losses import GANLoss, L1Loss, PerceptualLoss
7	
8	from gfpgan.archs.arcface_arch import ResNetArcFace
9	from gfpgan.archs.gfpganv1_arch import FacialComponentDiscriminator, GFPGANv1
10	from gfpgan.models.gfpgan_model import GFPGANModel
11	
12	
13	def test_gfpgan_model():
14	    with open(&#x27;tests/data/test_gfpgan_model.yml&#x27;, mode=&#x27;r&#x27;) as f:
15	        opt = yaml.load(f, Loader=yaml.FullLoader)
16	
17	    # build model
18	    model = GFPGANModel(opt)
19	    # test attributes
20	    assert model.__class__.__name__ == &#x27;GFPGANModel&#x27;
21	    assert isinstance(model.net_g, GFPGANv1)  # generator
22	    assert isinstance(model.net_d, StyleGAN2Discriminator)  # discriminator
23	    # facial component discriminators
24	    assert isinstance(model.net_d_left_eye, FacialComponentDiscriminator)
25	    assert isinstance(model.net_d_right_eye, FacialComponentDiscriminator)
26	    assert isinstance(model.net_d_mouth, FacialComponentDiscriminator)
27	    # identity network
28	    assert isinstance(model.network_identity, ResNetArcFace)
29	    # losses
30	    assert isinstance(model.cri_pix, L1Loss)
31	    assert isinstance(model.cri_perceptual, PerceptualLoss)
32	    assert isinstance(model.cri_gan, GANLoss)
</pre>
</div>


</div>
</div>

<div id="issue-19">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/install.py" target="_blank">/comfy_mtb/install.py</a><br>
    <b>Line number: </b>7<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import argparse
2	import ast
3	import os
4	import platform
5	import shlex
6	import stat
7	import subprocess
8	import sys
9	from contextlib import contextmanager
10	from importlib import import_module
11	from pathlib import Path
12	
13	import requests
14	
15	# region constants
16	here = Path(__file__).parent
17	executable = Path(sys.executable)
18	
19	# - detect mode
20	mode = None
21	if os.environ.get(&quot;COLAB_GPU&quot;):
22	    mode = &quot;colab&quot;
23	elif &quot;python_embeded&quot; in str(executable):
24	    mode = &quot;embeded&quot;
25	elif &quot;.venv&quot; in str(executable):
26	    mode = &quot;venv&quot;
27	
28	
29	if mode is None:
30	    mode = &quot;unknown&quot;
31	
32	repo_url = &quot;https://github.com/melmass/comfy_mtb.git&quot;
</pre>
</div>


</div>
</div>

<div id="issue-20">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/install.py" target="_blank">/comfy_mtb/install.py</a><br>
    <b>Line number: </b>180<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
164	        _run_command(shell_cmd, ignored_lines_start)
165	    except subprocess.CalledProcessError as e:
166	        print(f&quot;Command failed with return code: {e.returncode}&quot;, file=sys.stderr)
167	        print(e.stderr.strip(), file=sys.stderr)
168	
169	    except KeyboardInterrupt:
170	        print(&quot;Command execution interrupted.&quot;)
171	
172	
173	def _run_command(shell_cmd, ignored_lines_start):
174	    print_formatted(f&quot;Running {shell_cmd}&quot;, &quot;bold&quot;)
175	    result = subprocess.run(
176	        shell_cmd,
177	        stdout=subprocess.PIPE,
178	        stderr=subprocess.PIPE,
179	        text=True,
180	        shell=True,
181	        check=True,
182	    )
183	
184	    stdout_lines = result.stdout.strip().split(&quot;\n&quot;)
185	    stderr_lines = result.stderr.strip().split(&quot;\n&quot;)
186	
187	    # Print stdout, skipping ignored lines
188	    for line in stdout_lines:
189	        if not any(line.startswith(ign) for ign in ignored_lines_start):
190	            print(line)
191	
192	    # Print stderr
193	    for line in stderr_lines:
194	        print(line, file=sys.stderr)
195	
196	    print(&quot;Command executed successfully!&quot;)
197	
198	
199	def is_pipe():
200	    if not sys.stdin.isatty():
201	        return False
202	    if sys.platform == &quot;win32&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-21">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/install.py" target="_blank">/comfy_mtb/install.py</a><br>
    <b>Line number: </b>256<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
240	    if os.path.isfile(init_file):
241	        with open(init_file, &quot;r&quot;) as f:
242	            tree = ast.parse(f.read())
243	            for node in ast.walk(tree):
244	                if isinstance(node, ast.Assign):
245	                    for target in node.targets:
246	                        if (
247	                            isinstance(target, ast.Name)
248	                            and target.id == &quot;__version__&quot;
249	                            and isinstance(node.value, ast.Str)
250	                        ):
251	                            return node.value.s
252	    return None
253	
254	
255	def download_file(url, file_name):
256	    with requests.get(url, stream=True) as response:
257	        response.raise_for_status()
258	        total_size = int(response.headers.get(&quot;content-length&quot;, 0))
259	        with open(file_name, &quot;wb&quot;) as file, tqdm(
260	            desc=file_name.stem,
261	            total=total_size,
262	            unit=&quot;B&quot;,
263	            unit_scale=True,
264	            unit_divisor=1024,
265	        ) as progress_bar:
266	            for chunk in response.iter_content(chunk_size=8192):
267	                file.write(chunk)
268	                progress_bar.update(len(chunk))
269	
270	
271	def try_import(requirement):
</pre>
</div>


</div>
</div>

<div id="issue-22">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/install.py" target="_blank">/comfy_mtb/install.py</a><br>
    <b>Line number: </b>336<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
320	                print_formatted(
321	                    f&quot;Failed to install package {pip_install_name} using pip package name  (import name: &#x27;{import_name}&#x27;). Error: {str(e)}&quot;,
322	                    &quot;bold&quot;,
323	                    color=&quot;red&quot;,
324	                )
325	
326	
327	def get_github_assets(tag=None):
328	    if tag:
329	        tag_url = (
330	            f&quot;https://api.github.com/repos/{repo_owner}/{repo_name}/releases/tags/{tag}&quot;
331	        )
332	    else:
333	        tag_url = (
334	            f&quot;https://api.github.com/repos/{repo_owner}/{repo_name}/releases/latest&quot;
335	        )
336	    response = requests.get(tag_url)
337	    if response.status_code == 404:
338	        # print_formatted(
339	        #     f&quot;Tag version &#x27;{apply_color(version,&#x27;cyan&#x27;)}&#x27; not found for {owner}/{repo} repository.&quot;
340	        # )
341	        print_formatted(&quot;Error retrieving the release assets.&quot;, color=&quot;red&quot;)
342	        sys.exit()
343	
344	    tag_data = response.json()
345	    tag_name = tag_data[&quot;name&quot;]
346	
347	    return tag_data, tag_name
348	
349	
350	# endregion
351	
</pre>
</div>


</div>
</div>

<div id="issue-23">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/generate.py" target="_blank">/comfy_mtb/nodes/generate.py</a><br>
    <b>Line number: </b>101<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
85	        import io
86	
87	        import requests
88	
89	        base_url = &quot;https://source.unsplash.com/random/&quot;
90	
91	        if width and height:
92	            base_url += f&quot;/{width}x{height}&quot;
93	
94	        if keyword:
95	            keyword = keyword.replace(&quot; &quot;, &quot;%20&quot;)
96	            base_url += f&quot;?{keyword}&amp;{random_seed}&quot;
97	        else:
98	            base_url += f&quot;?&amp;{random_seed}&quot;
99	        try:
100	            log.debug(f&quot;Getting unsplash image from {base_url}&quot;)
101	            response = requests.get(base_url)
102	            response.raise_for_status()
103	
104	            image = Image.open(io.BytesIO(response.content))
105	            return (
106	                pil2tensor(
107	                    image,
108	                ),
109	            )
110	
111	        except requests.exceptions.RequestException as e:
112	            print(&quot;Error retrieving image:&quot;, e)
113	            return (None,)
114	
115	
116	class MTB_QrCode:
</pre>
</div>


</div>
</div>

<div id="issue-24">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/graph_utils.py" target="_blank">/comfy_mtb/nodes/graph_utils.py</a><br>
    <b>Line number: </b>36<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
20	    numpy_NFOV,
21	    pil2tensor,
22	    tensor2np,
23	)
24	
25	
26	def get_image(filename, subfolder, folder_type):
27	    log.debug(
28	        f&quot;Getting image {filename} from foldertype {folder_type} {f&#x27;in subfolder: {subfolder}&#x27; if subfolder else &#x27;&#x27;}&quot;
29	    )
30	    data = {&quot;filename&quot;: filename, &quot;subfolder&quot;: subfolder, &quot;type&quot;: folder_type}
31	    base_url, port = get_server_info()
32	
33	    url_values = urllib.parse.urlencode(data)
34	    url = f&quot;http://{base_url}:{port}/view?{url_values}&quot;
35	    log.debug(f&quot;Fetching image from {url}&quot;)
36	    with urllib.request.urlopen(url) as response:
37	        return io.BytesIO(response.read())
38	
39	
40	class MTB_ToDevice:
41	    &quot;&quot;&quot;Send a image or mask tensor to the given device.&quot;&quot;&quot;
42	
43	    @classmethod
44	    def INPUT_TYPES(cls):
45	        devices = [&quot;cpu&quot;]
46	        if torch.backends.mps.is_available():
47	            devices.append(&quot;mps&quot;)
48	        if torch.cuda.is_available():
49	            devices.append(&quot;cuda&quot;)
50	            for i in range(torch.cuda.device_count()):
51	                devices.append(f&quot;cuda{i}&quot;)
</pre>
</div>


</div>
</div>

<div id="issue-25">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.<br>
    <b>Test ID:</b> B310<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">CWE-22</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/graph_utils.py" target="_blank">/comfy_mtb/nodes/graph_utils.py</a><br>
    <b>Line number: </b>372<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b310-urllib-urlopen</a><br>

<div class="code">
<pre>
356	        internal_count=0,  # hacky way to invalidate the node
357	        passthrough_image=None,
358	    ):
359	        if not enable or count == 0:
360	            if passthrough_image is not None:
361	                log.debug(&quot;Using passthrough image&quot;)
362	                return (passthrough_image,)
363	            log.debug(&quot;Load from history is disabled for this iteration&quot;)
364	            return (torch.zeros(0),)
365	        frames = []
366	
367	        base_url, port = get_server_info()
368	
369	        history_url = f&quot;http://{base_url}:{port}/history&quot;
370	        log.debug(f&quot;Fetching history from {history_url}&quot;)
371	        output = torch.zeros(0)
372	        with urllib.request.urlopen(history_url) as response:
373	            output = self.load_batch_frames(response, offset, count, frames)
374	
375	        if output.size(0) == 0:
376	            log.warn(&quot;No output found in history&quot;)
377	
378	        return (output,)
379	
380	    def load_batch_frames(self, response, offset, count, frames):
381	        history = json.loads(response.read())
382	
383	        output_images = []
384	
385	        for run in history.values():
386	            for node_output in run[&quot;outputs&quot;].values():
387	                if &quot;images&quot; in node_output:
</pre>
</div>


</div>
</div>

<div id="issue-26">
<div class="issue-block issue-sev-medium">
    <b>blacklist: </b> Use of possibly insecure function - consider using safer ast.literal_eval.<br>
    <b>Test ID:</b> B307<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/graph_utils.py" target="_blank">/comfy_mtb/nodes/graph_utils.py</a><br>
    <b>Line number: </b>515<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_calls.html#b307-eval</a><br>

<div class="code">
<pre>
499	
500	        for key, value in kwargs.items():
501	            print(f&quot;Replacing placeholder &lt;{key}&gt; with value {value}&quot;)
502	            expression = expression.replace(f&quot;&lt;{key}&gt;&quot;, str(value))
503	
504	        result = -1
505	        try:
506	            result = literal_eval(expression)
507	        except SyntaxError as e:
508	            raise ValueError(
509	                f&quot;The expression syntax is wrong &#x27;{expression}&#x27;: {e}&quot;
510	            ) from e
511	
512	        except ValueError:
513	            try:
514	                expression = expression.replace(&quot;^&quot;, &quot;**&quot;)
515	                result = eval(expression)
516	            except Exception as e:
517	                # Handle any other exceptions and provide a meaningful error message
518	                raise ValueError(
519	                    f&quot;Error evaluating expression &#x27;{expression}&#x27;: {e}&quot;
520	                ) from e
521	
522	        return (result, int(result))
523	
524	
525	class MTB_FitNumber:
526	    &quot;&quot;&quot;Fit the input float using a source and target range&quot;&quot;&quot;
527	
528	    @classmethod
529	    def INPUT_TYPES(cls):
530	        return {
</pre>
</div>


</div>
</div>

<div id="issue-27">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/image_processing.py" target="_blank">/comfy_mtb/nodes/image_processing.py</a><br>
    <b>Line number: </b>295<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
279	            &quot;required&quot;: {
280	                &quot;url&quot;: (
281	                    &quot;STRING&quot;,
282	                    {
283	                        &quot;default&quot;: &quot;https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Example.jpg/800px-Example.jpg&quot;
284	                    },
285	                ),
286	            }
287	        }
288	
289	    RETURN_TYPES = (&quot;IMAGE&quot;,)
290	    FUNCTION = &quot;load&quot;
291	    CATEGORY = &quot;mtb/IO&quot;
292	
293	    def load(self, url):
294	        # get the image from the url
295	        image = Image.open(requests.get(url, stream=True).raw)
296	        image = ImageOps.exif_transpose(image)
297	        return (pil2tensor(image),)
298	
299	
300	class MTB_Blur:
301	    &quot;&quot;&quot;Blur an image using a Gaussian filter.&quot;&quot;&quot;
302	
303	    @classmethod
304	    def INPUT_TYPES(cls):
305	        return {
306	            &quot;required&quot;: {
307	                &quot;image&quot;: (&quot;IMAGE&quot;,),
308	                &quot;sigmaX&quot;: (
309	                    &quot;FLOAT&quot;,
310	                    {&quot;default&quot;: 3.0, &quot;min&quot;: 0.0, &quot;max&quot;: 200.0, &quot;step&quot;: 0.01},
</pre>
</div>


</div>
</div>

<div id="issue-28">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/io.py" target="_blank">/comfy_mtb/nodes/io.py</a><br>
    <b>Line number: </b>2<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import json
2	import subprocess
3	import uuid
4	from pathlib import Path
5	from typing import List, Optional
6	
7	import comfy.model_management as model_management
8	import folder_paths
9	import numpy as np
10	import torch
11	from PIL import Image
12	
13	from ..log import log
14	from ..utils import PIL_FILTER_MAP, output_dir, session_id, tensor2np
15	
16	
17	def get_playlist_path(playlist_name: str, persistant_playlist=False):
18	    if persistant_playlist:
19	        return output_dir / &quot;playlists&quot; / f&quot;{playlist_name}.json&quot;
20	
21	    return output_dir / &quot;playlists&quot; / session_id / f&quot;{playlist_name}.json&quot;
22	
23	
24	class MTB_ReadPlaylist:
25	    &quot;&quot;&quot;Read a playlist&quot;&quot;&quot;
26	
27	    @classmethod
28	    def INPUT_TYPES(cls):
29	        return {
30	            &quot;required&quot;: {
31	                &quot;enable&quot;: (&quot;BOOLEAN&quot;, {&quot;default&quot;: True}),
32	                &quot;persistant_playlist&quot;: (&quot;BOOLEAN&quot;, {&quot;default&quot;: False}),
</pre>
</div>


</div>
</div>

<div id="issue-29">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/io.py" target="_blank">/comfy_mtb/nodes/io.py</a><br>
    <b>Line number: </b>197<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
181	
182	            # Prepare the FFmpeg command for concatenating videos from the playlist
183	            command = [
184	                &quot;ffmpeg&quot;,
185	                &quot;-f&quot;,
186	                &quot;concat&quot;,
187	                &quot;-safe&quot;,
188	                &quot;0&quot;,
189	                &quot;-i&quot;,
190	                temp_playlist_path.as_posix(),
191	                &quot;-c&quot;,
192	                &quot;copy&quot;,
193	                &quot;-y&quot;,
194	                out_path,
195	            ]
196	            log.debug(f&quot;Executing {command}&quot;)
197	            subprocess.run(command)
198	
199	            temp_playlist_path.unlink()
200	
201	            return (out_path,)
202	
203	        if (
204	            images is None or images.size(0) == 0
205	        ):  # the is None check is just for the type checker
206	            return (&quot;&quot;,)
207	
208	        frames = tensor2np(images)
209	        log.debug(f&quot;Frames type {type(frames[0])}&quot;)
210	        log.debug(f&quot;Exporting {len(frames)} frames&quot;)
211	
212	        if codec == &quot;gif&quot;:
</pre>
</div>


</div>
</div>

<div id="issue-30">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/io.py" target="_blank">/comfy_mtb/nodes/io.py</a><br>
    <b>Line number: </b>229<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
213	            out_path = (output_dir / file_id).as_posix()
214	            command = [
215	                &quot;ffmpeg&quot;,
216	                &quot;-f&quot;,
217	                &quot;image2pipe&quot;,
218	                &quot;-vcodec&quot;,
219	                &quot;png&quot;,
220	                &quot;-r&quot;,
221	                str(fps),
222	                &quot;-i&quot;,
223	                &quot;-&quot;,
224	                &quot;-vcodec&quot;,
225	                &quot;gif&quot;,
226	                &quot;-y&quot;,
227	                out_path,
228	            ]
229	            process = subprocess.Popen(command, stdin=subprocess.PIPE)
230	            for frame in frames:
231	                model_management.throw_exception_if_processing_interrupted()
232	                Image.fromarray(frame).save(process.stdin, &quot;PNG&quot;)
233	
234	            process.stdin.close()
235	            process.wait()
236	        else:
237	            frames = [frame.astype(np.uint16) * 257 for frame in frames]
238	
239	        height, width, _ = frames[0].shape
240	
241	        out_path = (output_dir / file_id).as_posix()
242	
243	        # Prepare the FFmpeg command
244	        command = [
</pre>
</div>


</div>
</div>

<div id="issue-31">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/io.py" target="_blank">/comfy_mtb/nodes/io.py</a><br>
    <b>Line number: </b>267<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
251	            &quot;-s&quot;,
252	            f&quot;{width}x{height}&quot;,
253	            &quot;-pix_fmt&quot;,
254	            pix_fmt,
255	            &quot;-r&quot;,
256	            str(fps),
257	            &quot;-i&quot;,
258	            &quot;-&quot;,
259	            &quot;-c:v&quot;,
260	            codec,
261	            &quot;-r&quot;,
262	            str(fps),
263	            &quot;-y&quot;,
264	            out_path,
265	        ]
266	
267	        process = subprocess.Popen(command, stdin=subprocess.PIPE)
268	
269	        for frame in frames:
270	            model_management.throw_exception_if_processing_interrupted()
271	            process.stdin.write(frame.tobytes())
272	
273	        process.stdin.close()
274	        process.wait()
275	
276	        return (out_path,)
277	
278	
279	def prepare_animated_batch(
280	    batch: torch.Tensor,
281	    pingpong=False,
282	    resize_by=1.0,
</pre>
</div>


</div>
</div>

<div id="issue-32">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/nodes/io.py" target="_blank">/comfy_mtb/nodes/io.py</a><br>
    <b>Line number: </b>376<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
360	            # Use FFmpeg to create the GIF from PIL images
361	            command = [
362	                &quot;ffmpeg&quot;,
363	                &quot;-f&quot;,
364	                &quot;image2pipe&quot;,
365	                &quot;-vcodec&quot;,
366	                &quot;png&quot;,
367	                &quot;-r&quot;,
368	                str(fps),
369	                &quot;-i&quot;,
370	                &quot;-&quot;,
371	                &quot;-vcodec&quot;,
372	                &quot;gif&quot;,
373	                &quot;-y&quot;,
374	                out_path,
375	            ]
376	            process = subprocess.Popen(command, stdin=subprocess.PIPE)
377	            for image in pil_images:
378	                model_management.throw_exception_if_processing_interrupted()
379	                image.save(process.stdin, &quot;PNG&quot;)
380	            process.stdin.close()
381	            process.wait()
382	
383	        else:
384	            pil_images[0].save(
385	                out_path,
386	                save_all=True,
387	                append_images=pil_images[1:],
388	                optimize=optimize,
389	                duration=int(1000 / fps),
390	                loop=0,
391	            )
</pre>
</div>


</div>
</div>

<div id="issue-33">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/scripts/download_models.py" target="_blank">/comfy_mtb/scripts/download_models.py</a><br>
    <b>Line number: </b>5<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import os
2	import requests
3	from rich.console import Console
4	from tqdm import tqdm
5	import subprocess
6	import sys
7	
8	try:
9	    import folder_paths
10	except ModuleNotFoundError:
11	    import sys
12	
13	    sys.path.append(os.path.join(os.path.dirname(__file__), &quot;../../..&quot;))
14	    import folder_paths
15	
16	models_to_download = {
17	    &quot;DeepBump&quot;: {
18	        &quot;size&quot;: 25.5,
19	        &quot;download_url&quot;: &quot;https://github.com/HugoTini/DeepBump/raw/master/deepbump256.onnx&quot;,
20	        &quot;destination&quot;: &quot;deepbump&quot;,
21	    },
22	    &quot;Face Swap&quot;: {
23	        &quot;size&quot;: 660,
24	        &quot;download_url&quot;: [
25	            &quot;https://github.com/xinntao/facexlib/releases/download/v0.1.0/detection_mobilenet0.25_Final.pth&quot;,
26	            &quot;https://github.com/xinntao/facexlib/releases/download/v0.1.0/detection_Resnet50_Final.pth&quot;,
27	            &quot;https://huggingface.co/deepinsight/inswapper/resolve/main/inswapper_128.onnx&quot;,
28	        ],
29	        &quot;destination&quot;: &quot;insightface&quot;,
30	    },
31	    &quot;GFPGAN (face enhancement)&quot;: {
32	        &quot;size&quot;: 332,
</pre>
</div>


</div>
</div>

<div id="issue-34">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/scripts/download_models.py" target="_blank">/comfy_mtb/scripts/download_models.py</a><br>
    <b>Line number: </b>71<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
55	from pathlib import Path
56	
57	
58	def download_model(download_url, destination):
59	    if isinstance(download_url, list):
60	        for url in download_url:
61	            download_model(url, destination)
62	        return
63	
64	    filename = os.path.basename(urlparse(download_url).path)
65	    response = None
66	    if &quot;drive.google.com&quot; in download_url:
67	        try:
68	            import gdown
69	        except ImportError:
70	            print(&quot;Installing gdown&quot;)
71	            subprocess.check_call(
72	                [
73	                    sys.executable,
74	                    &quot;-m&quot;,
75	                    &quot;pip&quot;,
76	                    &quot;install&quot;,
77	                    &quot;git+https://github.com/melMass/gdown@main&quot;,
78	                ]
79	            )
80	            import gdown
81	
82	        if &quot;/folders/&quot; in download_url:
83	            # download folder
84	            try:
85	                gdown.download_folder(download_url, output=destination, resume=True)
86	            except TypeError:
87	                gdown.download_folder(download_url, output=destination)
88	
89	            return
90	        # download from google drive
91	        gdown.download(download_url, destination, quiet=False, resume=True)
92	        return
93	
94	    response = requests.get(download_url, stream=True)
</pre>
</div>


</div>
</div>

<div id="issue-35">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/scripts/download_models.py" target="_blank">/comfy_mtb/scripts/download_models.py</a><br>
    <b>Line number: </b>94<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
78	                ]
79	            )
80	            import gdown
81	
82	        if &quot;/folders/&quot; in download_url:
83	            # download folder
84	            try:
85	                gdown.download_folder(download_url, output=destination, resume=True)
86	            except TypeError:
87	                gdown.download_folder(download_url, output=destination)
88	
89	            return
90	        # download from google drive
91	        gdown.download(download_url, destination, quiet=False, resume=True)
92	        return
93	
94	    response = requests.get(download_url, stream=True)
95	    total_size = int(response.headers.get(&quot;content-length&quot;, 0))
96	
97	    destination_path = os.path.join(destination, filename)
98	    with open(destination_path, &quot;wb&quot;) as file:
99	        with tqdm(
100	            total=total_size, unit=&quot;B&quot;, unit_scale=True, desc=destination_path, ncols=80
101	        ) as progress_bar:
102	            for data in response.iter_content(chunk_size=4096):
103	                file.write(data)
104	                progress_bar.update(len(data))
105	
106	    console.print(
107	        f&quot;Downloaded model from {download_url} to {destination_path}&quot;,
108	        style=&quot;bold green&quot;,
109	    )
</pre>
</div>


</div>
</div>

<div id="issue-36">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/scripts/interpolate_frames.py" target="_blank">/comfy_mtb/scripts/interpolate_frames.py</a><br>
    <b>Line number: </b>16<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import glob
2	from pathlib import Path
3	import uuid
4	import sys
5	from typing import List
6	
7	sys.path.append((Path(__file__).parent / &quot;extern&quot;).as_posix())
8	
9	
10	import argparse
11	from rich_argparse import RichHelpFormatter
12	from rich.console import Console
13	from rich.progress import Progress
14	
15	import numpy as np
16	import subprocess
17	
18	
19	def write_prores_444_video(output_file, frames: List[np.ndarray], fps):
20	    # Convert float images to the range of 0-65535 (12-bit color depth)
21	    frames = [(frame * 65535).clip(0, 65535).astype(np.uint16) for frame in frames]
22	
23	    height, width, _ = frames[0].shape
24	
25	    # Prepare the FFmpeg command
26	    command = [
27	        &quot;ffmpeg&quot;,
28	        &quot;-y&quot;,  # Overwrite output file if it already exists
29	        &quot;-f&quot;,
30	        &quot;rawvideo&quot;,
31	        &quot;-vcodec&quot;,
32	        &quot;rawvideo&quot;,
</pre>
</div>


</div>
</div>

<div id="issue-37">
<div class="issue-block issue-sev-low">
    <b>subprocess_without_shell_equals_true: </b> subprocess call - check for execution of untrusted input.<br>
    <b>Test ID:</b> B603<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/scripts/interpolate_frames.py" target="_blank">/comfy_mtb/scripts/interpolate_frames.py</a><br>
    <b>Line number: </b>53<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html</a><br>

<div class="code">
<pre>
37	        &quot;-r&quot;,
38	        str(fps),
39	        &quot;-i&quot;,
40	        &quot;-&quot;,
41	        &quot;-c:v&quot;,
42	        &quot;prores_ks&quot;,
43	        &quot;-profile:v&quot;,
44	        &quot;4&quot;,
45	        &quot;-pix_fmt&quot;,
46	        &quot;yuva444p10le&quot;,
47	        &quot;-r&quot;,
48	        str(fps),
49	        &quot;-y&quot;,  # Overwrite output file if it already exists
50	        output_file,
51	    ]
52	
53	    process = subprocess.Popen(command, stdin=subprocess.PIPE)
54	
55	    for frame in frames:
56	        process.stdin.write(frame.tobytes())
57	
58	    process.stdin.close()
59	    process.wait()
60	
61	
62	if __name__ == &quot;__main__&quot;:
63	    default_output = f&quot;./output_{uuid.uuid4()}.mov&quot;
64	    parser = argparse.ArgumentParser(
65	        description=&quot;FILM frame interpolation&quot;, formatter_class=RichHelpFormatter
66	    )
67	    parser.add_argument(&quot;inputs&quot;, nargs=&quot;*&quot;, help=&quot;Input image files&quot;)
68	    parser.add_argument(&quot;--output&quot;, help=&quot;Output JSON file&quot;, default=default_output)
</pre>
</div>


</div>
</div>

<div id="issue-38">
<div class="issue-block issue-sev-low">
    <b>blacklist: </b> Consider possible security implications associated with the subprocess module.<br>
    <b>Test ID:</b> B404<br>
    <b>Severity: </b>LOW<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/utils.py" target="_blank">/comfy_mtb/utils.py</a><br>
    <b>Line number: </b>9<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess" target="_blank">https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocess</a><br>

<div class="code">
<pre>
1	import contextlib
2	import functools
3	import importlib
4	import math
5	import os
6	import shlex
7	import shutil
8	import socket
9	import subprocess
10	import sys
11	import uuid
12	from pathlib import Path
13	from typing import List, Optional, Union
14	
15	import folder_paths
16	import numpy as np
17	import requests
18	import torch
19	from PIL import Image
20	
21	from .install import pip_map
22	
23	try:
24	    from .log import log
25	except ImportError:
26	    try:
27	        from log import log
28	
29	        log.warn(&quot;Imported log without relative path&quot;)
30	    except ImportError:
31	        import logging
32	
</pre>
</div>


</div>
</div>

<div id="issue-39">
<div class="issue-block issue-sev-medium">
    <b>request_without_timeout: </b> Requests call without timeout<br>
    <b>Test ID:</b> B113<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>LOW<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/400.html" target="_blank">CWE-400</a><br>
    <b>File: </b><a href="/comfy_mtb/utils.py" target="_blank">/comfy_mtb/utils.py</a><br>
    <b>Line number: </b>187<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b113_request_without_timeout.html</a><br>

<div class="code">
<pre>
171	                    return ip
172	        return None
173	
174	    @staticmethod
175	    def get_local_ips(prefix=&quot;192.168.&quot;):
176	        hostname = socket.gethostname()
177	        log.debug(f&quot;Getting local ips for {hostname}&quot;)
178	        for info in socket.getaddrinfo(hostname, None):
179	            # Filter out IPv6 addresses if you only want IPv4
180	            log.debug(info)
181	            # if info[1] == socket.SOCK_STREAM and
182	            if info[0] == socket.AF_INET and info[4][0].startswith(prefix):
183	                yield info[4][0]
184	
185	    def _test_url(self, url):
186	        try:
187	            response = requests.get(url)
188	            return response.status_code == 200
189	        except Exception:
190	            return False
191	
192	
193	@functools.lru_cache(maxsize=1)
194	def get_server_info():
195	    from comfy.cli_args import args
196	
197	    ip_checker = IPChecker()
198	    base_url = args.listen
199	    if base_url == &quot;0.0.0.0&quot;:
200	        log.debug(&quot;Server set to 0.0.0.0, we will try to resolve the host IP&quot;)
201	        base_url = ip_checker.get_working_ip(
202	            f&quot;http://{{}}:{args.port}/history&quot;
</pre>
</div>


</div>
</div>

<div id="issue-40">
<div class="issue-block issue-sev-medium">
    <b>hardcoded_bind_all_interfaces: </b> Possible binding to all interfaces.<br>
    <b>Test ID:</b> B104<br>
    <b>Severity: </b>MEDIUM<br>
    <b>Confidence: </b>MEDIUM<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/605.html" target="_blank">CWE-605</a><br>
    <b>File: </b><a href="/comfy_mtb/utils.py" target="_blank">/comfy_mtb/utils.py</a><br>
    <b>Line number: </b>199<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b104_hardcoded_bind_all_interfaces.html</a><br>

<div class="code">
<pre>
183	                yield info[4][0]
184	
185	    def _test_url(self, url):
186	        try:
187	            response = requests.get(url)
188	            return response.status_code == 200
189	        except Exception:
190	            return False
191	
192	
193	@functools.lru_cache(maxsize=1)
194	def get_server_info():
195	    from comfy.cli_args import args
196	
197	    ip_checker = IPChecker()
198	    base_url = args.listen
199	    if base_url == &quot;0.0.0.0&quot;:
200	        log.debug(&quot;Server set to 0.0.0.0, we will try to resolve the host IP&quot;)
201	        base_url = ip_checker.get_working_ip(
202	            f&quot;http://{{}}:{args.port}/history&quot;
203	        )
204	        log.debug(f&quot;Setting ip to {base_url}&quot;)
205	    return (base_url, args.port)
206	
207	
208	# endregion
209	
210	
211	# region MISC Utilities
212	def backup_file(
213	    fp: Path,
214	    target: Optional[Path] = None,
</pre>
</div>


</div>
</div>

<div id="issue-41">
<div class="issue-block issue-sev-high">
    <b>subprocess_popen_with_shell_equals_true: </b> subprocess call with shell=True identified, security issue.<br>
    <b>Test ID:</b> B602<br>
    <b>Severity: </b>HIGH<br>
    <b>Confidence: </b>HIGH<br>
    <b>CWE: </b><a href="https://cwe.mitre.org/data/definitions/78.html" target="_blank">CWE-78</a><br>
    <b>File: </b><a href="/comfy_mtb/utils.py" target="_blank">/comfy_mtb/utils.py</a><br>
    <b>Line number: </b>300<br>
    <b>More info: </b><a href="https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html" target="_blank">https://bandit.readthedocs.io/en/1.7.9/plugins/b602_subprocess_popen_with_shell_equals_true.html</a><br>

<div class="code">
<pre>
284	            f&quot;Command failed with return code: {e.returncode}&quot;, file=sys.stderr
285	        )
286	        print(e.stderr.strip(), file=sys.stderr)
287	
288	    except KeyboardInterrupt:
289	        print(&quot;Command execution interrupted.&quot;)
290	
291	
292	def _run_command(shell_cmd, ignored_lines_start):
293	    log.debug(f&quot;Running {shell_cmd}&quot;)
294	
295	    result = subprocess.run(
296	        shell_cmd,
297	        stdout=subprocess.PIPE,
298	        stderr=subprocess.PIPE,
299	        text=True,
300	        shell=True,
301	        check=True,
302	    )
303	
304	    stdout_lines = result.stdout.strip().split(&quot;\n&quot;)
305	    stderr_lines = result.stderr.strip().split(&quot;\n&quot;)
306	
307	    # Print stdout, skipping ignored lines
308	    for line in stdout_lines:
309	        if not any(line.startswith(ign) for ign in ignored_lines_start):
310	            print(line)
311	
312	    # Print stderr
313	    for line in stderr_lines:
314	        print(line, file=sys.stderr)
315	
316	    print(&quot;Command executed successfully!&quot;)
317	
318	
319	def import_install(package_name):
320	    package_spec = reqs_map.get(package_name, package_name)
321	
322	    try:
</pre>
</div>


</div>
</div>

</div>

</body>
</html>
